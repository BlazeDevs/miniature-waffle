/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2017 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

signed int j___ae_r();
// int __fastcall _errno(_DWORD); weak
// FILE *fopen(const char *filename, const char *modes);
// int fgetc(FILE *stream);
// size_t fread(void *ptr, size_t size, size_t n, FILE *stream);
// int fclose(FILE *stream);
// int strncmp(const char *s1, const char *s2, size_t n);
// int __fastcall _cxa_finalize(_DWORD); weak
// char *strncpy(char *dest, const char *src, size_t n);
// int pthread_mutex_lock(pthread_mutex_t *mutex);
// int pthread_attr_init(pthread_attr_t *attr);
// int pthread_attr_setdetachstate(pthread_attr_t *attr, int detachstate);
// int pthread_create(pthread_t *newthread, const pthread_attr_t *attr, void *(*start_routine)(void *), void *arg);
// char *strerror(int errnum);
// int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...); weak
// int pthread_cond_wait(pthread_cond_t *cond, pthread_mutex_t *mutex);
// int pthread_mutex_unlock(pthread_mutex_t *mutex);
void *ril_event_init(void);
// int pthread_cond_broadcast(pthread_cond_t *cond);
// int pipe(int pipedes[2]);
// int fcntl(int fd, int cmd, ...);
int __fastcall ril_event_set(int, int fd, int, int, int); // idb
int __fastcall ril_event_add(int a1);
int ril_event_loop(void);
// int kill(__pid_t pid, int sig);
// void abort(void);
int j_RIL_startEventLoop();
// int __fastcall _strncpy_chk2(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...); weak
// char *getenv(const char *name);
// int strtol(const char *nptr, char **endptr, int base);
// int listen(int fd, int n);
// int __fastcall _strlen_chk(_DWORD, _DWORD); weak
// int __fastcall _strlcat_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// void exit(int status);
// int __fastcall record_stream_get_next(_DWORD, _DWORD, _DWORD); weak
// _DWORD android::Parcel::Parcel(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::setData(android::Parcel *this, const unsigned __int8 *, unsigned int); idb
// _DWORD __cdecl android::Parcel::readInt32(android::Parcel *this, int *); idb
// _DWORD __cdecl android::Parcel::writeInt32(android::Parcel *this, int); idb
// _DWORD android::Parcel::data(android::Parcel *this); idb
// _DWORD android::Parcel::dataSize(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::~Parcel(android::Parcel *this); idb
// void *calloc(size_t nmemb, size_t size);
const char *__fastcall j_requestToString(int a1);
// int close(int fd);
int __fastcall ril_event_del(int a1);
// int __fastcall record_stream_free(_DWORD); weak
// int accept(int fd, struct sockaddr *addr, socklen_t *addr_len);
// int __cdecl _recvfrom_chk(_DWORD, _DWORD, _DWORD); weak
// int atoi(const char *nptr);
int __fastcall j_RIL_onUnsolicitedResponse(int a1, int a2, int a3);
// unsigned int sleep(unsigned int seconds);
int __fastcall RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2);
// _DWORD android::Parcel::dataPosition(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::setDataPosition(android::Parcel *this, unsigned int); idb
// void free(void *ptr);
// int __fastcall acquire_wake_lock(_DWORD, _DWORD); weak
// int __fastcall release_wake_lock(_DWORD); weak
// _DWORD android::elapsedRealtime(android *this); idb
// _DWORD __cdecl android::Parcel::writeInt64(android::Parcel *this, __int64); idb
// int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD); weak
int __fastcall ril_timer_add(int **a1, _DWORD *a2);
// int getsockopt(int fd, int level, int optname, void *optval, socklen_t *optlen);
// struct passwd *getpwuid(__uid_t uid);
// int strcmp(const char *s1, const char *s2);
char *__fastcall RilSocket::getListenEvent(RilSocket *this);
int __fastcall RilSocket::setCommandFd(RilSocket *this, int a2);
int __fastcall RilSocket::getCommandFd(RilSocket *this);
// int __fastcall record_stream_new(_DWORD, _DWORD); weak
// _DWORD __cdecl operator new(unsigned int); idb
char *__fastcall RilSocket::getCallbackEvent(RilSocket *this);
int __fastcall RilSocket::getCommandCb(RilSocket *this);
int __fastcall RilSocket::onNewCommandConnect(RilSocket *this);
// int __fastcall property_set(_DWORD, _DWORD); weak
// int __fastcall _write_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall _read_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall property_get(_DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl android::Parcel::readString16Inplace(android::Parcel *this, unsigned int *); idb
// int __fastcall strndup16to8(_DWORD, _DWORD); weak
// int __fastcall _aeabi_memclr(_DWORD, _DWORD); weak
// _DWORD __cdecl android::Parcel::write(android::Parcel *this, const void *, unsigned int); idb
// _DWORD __cdecl android::Parcel::readInplace(android::Parcel *this, unsigned int); idb
// _DWORD android::Parcel::readInt32(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::appendFrom(android::Parcel *this, const android::Parcel *, unsigned int, unsigned int); idb
// _DWORD android::Parcel::readString16(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::writeString16(android::Parcel *this, const android::String16 *); idb
// _DWORD __cdecl android::String16::~String16(android::String16 *this); idb
// int __fastcall _aeabi_memclr8(_DWORD, _DWORD); weak
// int __fastcall _aeabi_memclr4(_DWORD, _DWORD); weak
// _DWORD __cdecl android::Parcel::read(android::Parcel *this, void *, unsigned int); idb
int __fastcall j_RIL_onRequestComplete(int a1, int a2, int a3, int a4);
// int _android_log_print(_DWORD, _DWORD, const char *, ...); weak
// int strnlen16to8(void); weak
// int __fastcall strncpy16to8(_DWORD, _DWORD); weak
// int __fastcall strdup8to16(_DWORD, _DWORD); weak
// int __fastcall android::Parcel::writeString16(_DWORD, _DWORD, _DWORD); weak
// pthread_t pthread_self(void);
// int pthread_equal(pthread_t thread1, pthread_t thread2);
// int pthread_mutex_init(pthread_mutex_t *mutex, const pthread_mutexattr_t *mutexattr);
// int __fastcall _FD_SET_chk(_DWORD, _DWORD, _DWORD); weak
// int clock_gettime(clockid_t clock_id, struct timespec *tp);
// int __fastcall _FD_CLR_chk(_DWORD, _DWORD, _DWORD); weak
// int __fastcall _aeabi_memcpy8(_DWORD, _DWORD, _DWORD); weak
// int select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout);
// int __fastcall _FD_ISSET_chk(_DWORD, _DWORD, _DWORD); weak
int __fastcall rilEventAddWakeup_helper(int a1);
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3);
int __fastcall RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4);
int __fastcall RilSapSocket::getSocketById(int a1);
int __fastcall RilSapSocket::onRequestComplete(int a1, int a2, int a3, int a4, unsigned int a5);
int __fastcall RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4);
int __fastcall RilSapSocket::printList(RilSapSocket *this);
int __fastcall RilSapSocket::sendResponse(int a1, int *a2);
signed int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(int a1, int a2, int a3);
signed int __fastcall RilSapSocket::SocketExists(RilSapSocket *this, const char *a2);
signed int __fastcall RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3);
pthread_mutexattr_t *__fastcall RilSapSocket::RilSapSocket(pthread_mutexattr_t *a1, pthread_mutexattr_t a2, pthread_mutexattr_t a3, pthread_mutexattr_t a4);
// void *malloc(size_t size);
int __fastcall RilSocket::socketInit(RilSocket *this);
void __fastcall RilSapSocket::dispatchRequest(int a1, _DWORD *a2);
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(int a1);
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(int a1, int a2);
// int pthread_mutexattr_init(pthread_mutexattr_t *attr);
int __fastcall j_pb_get_encoded_size(_DWORD *a1, unsigned __int8 *a2, int *a3);
_DWORD *__fastcall j_pb_ostream_from_buffer(_DWORD *result, int a2, int a3);
signed int __fastcall j_pb_write(_DWORD *a1, int a2, int a3);
signed int __fastcall j_pb_encode(__int64 *a1, unsigned __int8 *a2, int *a3);
int __fastcall log_hex(const char *a1, const unsigned __int8 *a2, int a3);
int __fastcall blockingWrite_helper(int a1, void *a2, unsigned int a3);
signed int (__fastcall **__fastcall j_pb_istream_from_buffer(signed int (__fastcall **result)(int a1, char *a2, int a3), signed int (__fastcall *a2)(int a1, char *a2, int a3), signed int (__fastcall *a3)(int a1, char *a2, int a3)))(int a1, char *a2, int a3);
int __fastcall j_pb_decode(int a1, int a2, int a3);
void __fastcall RilSapSocket::dispatchDisconnect(int a1, int a2);
int __fastcall RilSapSocket::sendDisconnect(RilSapSocket *this);
// void __cdecl operator delete(void *); idb
void __fastcall RilSapSocket::sOnRequestComplete(_DWORD *a1, int a2, int a3, unsigned int a4);
RilSapSocket *__fastcall RilSapSocket::sOnUnsolicitedResponse(RilSapSocket *this, int a2, const void *a3, unsigned int a4);
int j_RIL_requestTimedCallback();
int __fastcall RilSapSocket::pushRecord(RilSapSocket *this, void *a2, unsigned int a3);
void __fastcall __noreturn RilSapSocket::processRequestsLoop(RilSapSocket *this);
int __fastcall RilSapSocket::onCommandsSocketClosed(RilSapSocket *this);
int __fastcall j_pb_read(int a1, int a2, int a3);
// int __fastcall _aeabi_memmove(_DWORD, _DWORD); weak
int __fastcall j_pb_skip_field(int a1, int a2);
signed int __fastcall j_pb_make_string_substream(int a1, _QWORD *a2);
// void *realloc(void *ptr, size_t size);
int __fastcall j_pb_decode_noinit(int a1, unsigned __int8 *a2, int a3);
int __fastcall j_pb_release(int a1, int a2);
signed int __fastcall j_pb_decode_varint(int a1, _DWORD *a2);
signed int __fastcall j_pb_encode_tag_for_field(_DWORD *a1, unsigned __int8 *a2);
signed int __fastcall j_pb_encode_varint(_DWORD *a1, int a2, __int64 a3);
signed int __fastcall j_pb_encode_submessage(_DWORD *a1, unsigned __int8 *a2, int *a3);
signed int __fastcall j_pb_encode_string(_DWORD *a1, int a2, int a3);
// int fprintf(FILE *stream, const char *format, ...);
// int dladdr(void); weak
// int __fastcall _gnu_Unwind_Find_exidx(_DWORD, _DWORD); weak
int j___aeabi_ldiv0();
// int raise(int sig);
void *sub_4200();
signed int _ae_r();
int sub_437C();
int (*__fastcall sub_439C(int (*result)(void)))(void);
char *__fastcall RIL_setRilSocketName(const char *a1);
int RIL_startEventLoop();
int sub_4540(); // weak
__int64 *__fastcall RIL_setcallbacks(__int64 *a1);
int __fastcall RIL_register(double *a1);
int __fastcall sub_4A2C(int a1, int a2, int *a3);
int __fastcall sub_4C80(int a1);
int (__fastcall *__fastcall RIL_register_socket(int (__fastcall *result)(void **, int, int), int a2, int a3, int a4))(void **, int, int);
int __fastcall RIL_onRequestAck(int a1);
signed int __fastcall sub_519C(int a1, int a2);
int __fastcall RIL_onRequestComplete(int a1, int a2, int a3, int a4);
const char *__fastcall requestToString(int a1);
int sub_5CE4();
int __fastcall RIL_onUnsolicitedResponse(int a1, int a2, int a3);
int __fastcall RIL_requestTimedCallback_0(int a1, int a2, __int64 *a3);
int sub_6190();
int RIL_requestTimedCallback(void); // weak
const char *__fastcall failCauseToString(int a1);
const char *__fastcall radioStateToString(unsigned int a1);
const char *__fastcall callStateToString(unsigned int a1);
const char *__fastcall rilSocketIdToString(int a1);
int __fastcall rilEventAddWakeup_helper(int a1);
_DWORD __fastcall listenCallback_helper(int, __int16, void *); // idb
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3);
_DWORD __fastcall blockingWrite_helper(int, void *, unsigned int); // idb
signed int __fastcall sub_69B4(int a1, int a2, unsigned int a3);
int sub_6A54();
int sub_6AAC();
int __fastcall sub_6AE4(int a1, int a2);
int __fastcall sub_6B00(android::Parcel *this, int *a2, unsigned int a3);
int __fastcall sub_6C40(android::Parcel *this, int *a2);
int __fastcall sub_6DB8(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_6E3C(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_6F70(android::Parcel *a1, int *a2);
int sub_70E0();
int __fastcall sub_70E4(int a1, int a2);
int __fastcall sub_70F0(android::Parcel *this, int *a2);
int __fastcall sub_71F4(android::Parcel *this, int *a2, int a3);
signed int __fastcall sub_7264(android::Parcel *a1, int *a2, unsigned int a3);
int __fastcall sub_73EC(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_7480(android::Parcel *a1, int a2);
int __fastcall sub_74E8(android::Parcel *this, int *a2, int a3);
int __fastcall sub_7550(android::Parcel *this, int *a2);
int __fastcall sub_7638(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_7674(android::Parcel *this, int *a2);
int __fastcall sub_7808(android::Parcel *this, int *a2, int a3);
int __fastcall sub_7870(android::Parcel *a1, int *a2);
int __fastcall sub_79A0(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_7A54(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_7D58(android::Parcel *this, int *a2);
int __fastcall sub_7DE4(android::Parcel *this, const void *a2, int a3);
int __fastcall sub_7E34(android::Parcel *a1, int *a2);
int __fastcall sub_7F28(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_7FBC(android::Parcel *a1, int *a2);
int __fastcall sub_805C(android::Parcel *a1, int *a2);
int __fastcall sub_810C(android::Parcel *a1, int a2, unsigned int a3);
int __fastcall sub_8178(android::Parcel *this, int a2);
int __fastcall sub_8308(android::Parcel *a1, int a2, unsigned int a3);
int __fastcall sub_835C(android::Parcel *this, int a2);
int __fastcall sub_84CC(android::Parcel *a1, int *a2);
int __fastcall sub_86C4(int a1, int a2);
int __fastcall sub_8774(int a1, int a2);
int __fastcall sub_8820(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_8AFC(android::Parcel *this, int *a2);
int __fastcall sub_8C48(android::Parcel *this, android::Parcel *a2);
int __fastcall sub_8F64(android::Parcel *this, int *a2);
int __fastcall sub_9074(android::Parcel *a1, int *a2);
int __fastcall sub_90F4(android::Parcel *this, int *a2);
int __fastcall sub_91B0(android::Parcel *this, int **a2);
int __fastcall sub_929C(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_938C(android::Parcel *this, int *a2);
int __fastcall sub_9478(android::Parcel *this, __int64 *a2, int a3);
int __fastcall sub_94C4(android::Parcel *this, int *a2);
int __fastcall sub_96E0(android::Parcel *this, int *a2, int a3);
int __fastcall sub_9764(android::Parcel *a1, int *a2);
int __fastcall sub_9864(android::Parcel *this, void *a2, int a3);
int __fastcall sub_98C8(android::Parcel *this, int *a2, int a3);
int __fastcall sub_993C(android::Parcel *this, int *a2, int a3);
int __fastcall sub_99D0(android::Parcel *this, int a2);
int __fastcall sub_9C2C(android::Parcel *this, int *a2, int a3);
int __fastcall sub_9D14(android::Parcel *this, int *a2);
int __fastcall sub_9DD8(android::Parcel *this, int *a2);
int __fastcall sub_9FD8(android::Parcel *a1, int *a2);
int __fastcall sub_A040(android::Parcel *a1, int a2, int a3);
int __fastcall sub_A0F8(int a1, int a2);
int __fastcall sub_A144(android::Parcel *a1, int *a2);
int __fastcall sub_A184(android::Parcel *this, _DWORD *a2);
int __fastcall sub_A200(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_A2F4(android::Parcel *a1, int a2);
int __fastcall sub_A47C(android::Parcel *this, int a2, unsigned int a3);
void __fastcall sub_A6C4(int a1, _DWORD *a2);
int __fastcall sub_A6F8(int a1, int a2, int a3);
int sub_A7B4();
signed int __fastcall sub_A7F8(int a1, unsigned int a2);
int __fastcall sub_A8B4(android::Parcel *this, int *a2, int a3);
int __fastcall sub_A92C(android::Parcel *this, int *a2, unsigned int a3);
signed int __fastcall sub_AA18(android::Parcel *a1, unsigned __int8 *a2, int a3);
signed int __fastcall sub_AA5C(android::Parcel *a1, int *a2, int a3);
int __fastcall sub_ABE0(android::Parcel *a1, int a2, unsigned int a3);
int __fastcall sub_AD10(android::Parcel *this, unsigned __int8 *a2, unsigned int a3);
signed int __fastcall sub_B034(android::Parcel *a1, int *a2, int a3);
int __fastcall sub_B210(android::Parcel *this, int *a2, int a3);
int __fastcall sub_B28C(android::Parcel *this, int *a2, int a3);
int __fastcall sub_B398(android::Parcel *a1, int *a2);
int __fastcall sub_B3B8(android::Parcel *a1, unsigned __int8 *a2);
void __fastcall sub_B3E0(int a1, int a2, void (__fastcall **a3)(_DWORD));
void *ril_event_init(void);
int __fastcall ril_event_set(int, int fd, int, int, int); // idb
int __fastcall ril_event_add(int a1);
int __fastcall ril_timer_add(int **a1, _DWORD *a2);
int __fastcall ril_event_del(int a1);
int __fastcall sub_B6BC(int a1, int a2);
int ril_event_loop(void);
int __fastcall RilSocket::socketInit(RilSocket *this);
int __fastcall RilSocket::sSocketListener(RilSocket *this, int a2, int a3, void *a4);
int __fastcall RilSocket::sSocketRequestsHandler(RilSocket *this, int a2, int a3, void *a4);
int __fastcall RilSocket::onNewCommandConnect(RilSocket *this);
int __fastcall ril_socket_process_requests_loop(int a1);
int __fastcall RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4);
int __fastcall RilSocket::setListenFd(int result, int a2);
int __fastcall RilSocket::setCommandFd(int result, int a2);
int __fastcall RilSocket::getListenFd(RilSocket *this);
int __fastcall RilSocket::getCommandFd(RilSocket *this);
int __fastcall RilSocket::setListenCb(int result, void (__cdecl *a2)(int, __int16, void *));
int __fastcall RilSocket::setCommandCb(int result, void (__cdecl *a2)(int, __int16, void *));
int __fastcall RilSocket::getListenCb(RilSocket *this);
int __fastcall RilSocket::getCommandCb(RilSocket *this);
_DWORD *__fastcall RilSocket::setListenEvent(_DWORD *result, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10);
_DWORD *__fastcall RilSocket::setCallbackEvent(_DWORD *result, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10);
char *__fastcall RilSocket::getListenEvent(RilSocket *this);
char *__fastcall RilSocket::getCallbackEvent(RilSocket *this);
void __fastcall RilSapSocket::sOnRequestComplete(_DWORD *a1, int a2, int a3, unsigned int a4);
RilSapSocket *__fastcall RilSapSocket::sOnUnsolicitedResponse(RilSapSocket *this, int a2, const void *a3, unsigned int a4);
int __fastcall RilSapSocket::getSocketById(int a1);
int __fastcall RilSapSocket::onRequestComplete(int a1, int a2, int a3, int a4, unsigned int a5);
int __fastcall RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4);
int __fastcall RilSapSocket::printList(RilSapSocket *this);
int __fastcall RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2);
signed int __fastcall RilSapSocket::SocketExists(RilSapSocket *this, const char *a2);
signed int __fastcall RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3);
void __fastcall __noreturn RilSapSocket::processRequestsLoop(RilSapSocket *this);
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(int a1);
void __fastcall RilSapSocket::dispatchRequest(int a1, _DWORD *a2);
pthread_mutexattr_t *__fastcall RilSapSocket::RilSapSocket(pthread_mutexattr_t *a1, pthread_mutexattr_t a2, pthread_mutexattr_t a3, pthread_mutexattr_t a4);
int __fastcall log_hex(const char *a1, const unsigned __int8 *a2, int a3);
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(int a1, int a2);
int __fastcall RilSapSocket::sendResponse(int a1, int *a2);
signed int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(int a1, int a2, int a3);
int __fastcall RilSapSocket::pushRecord(RilSapSocket *this, void *a2, unsigned int a3);
int __fastcall RilSapSocket::sendDisconnect(RilSapSocket *this);
void __fastcall RilSapSocket::dispatchDisconnect(int a1, int a2);
int __fastcall RilSapSocket::onCommandsSocketClosed(RilSapSocket *this);
signed int __fastcall pb_read(int a1, int a2, unsigned int a3);
signed int __fastcall sub_C9A0(int a1, char *a2, int a3);
signed int (__fastcall **__fastcall pb_istream_from_buffer(signed int (__fastcall **result)(int a1, char *a2, int a3), signed int (__fastcall *a2)(int a1, char *a2, int a3), signed int (__fastcall *a3)(int a1, char *a2, int a3)))(int a1, char *a2, int a3);
signed int __fastcall pb_decode_varint(int a1, _DWORD *a2);
signed int __fastcall sub_CAF0(int a1, int a2);
signed int __fastcall pb_decode_tag(int a1, int *a2, unsigned int *a3, _BYTE *a4);
signed int __fastcall sub_CB90(int a1, int *a2);
int __fastcall pb_skip_field(int a1, int a2);
signed int __fastcall pb_make_string_substream(int a1, _QWORD *a2);
int __fastcall pb_close_string_substream(int result, int a2);
int __fastcall pb_decode_noinit(int a1, unsigned __int8 *a2, int a3);
int __fastcall sub_CF3C(int a1, int a2, _DWORD *a3);
signed int __fastcall sub_D344(int *a1);
int __fastcall pb_decode(int a1, int a2, int a3);
int __fastcall sub_D3EC(int a1, int a2);
int __fastcall pb_release(int a1, int a2);
int __fastcall pb_decode_delimited(int a1, int a2, int a3);
signed int __fastcall pb_decode_svarint(int a1, int *a2);
int __fastcall pb_decode_fixed32(int a1, int a2);
int __fastcall pb_decode_fixed64(int a1, int a2);
signed int __fastcall sub_D630(int a1, int a2, int a3);
signed int __fastcall sub_D6B8(int a1, int a2, int *a3);
signed int __fastcall sub_D720(int a1, int a2, int *a3);
int __fastcall sub_D7A0(int a1, int a2, int a3);
int __fastcall sub_D7A8(int a1, int a2, int a3);
int __fastcall sub_D7B0(int a1, int a2, void **a3);
int __fastcall sub_D840(int a1, int a2, void **a3);
int __fastcall sub_D8D0(int a1, int a2, int a3);
_DWORD *__fastcall pb_ostream_from_buffer(_DWORD *result, int a2, int a3);
signed int __fastcall sub_D96C(int a1, char *a2, int a3);
signed int __fastcall pb_write(_DWORD *a1, int a2, int a3);
signed int __fastcall pb_encode(__int64 *a1, unsigned __int8 *a2, int *a3);
signed int __fastcall sub_DAE4(__int64 *a1, unsigned __int8 *a2, int (__fastcall *a3)(__int64 *));
signed int __fastcall pb_encode_submessage(_DWORD *a1, unsigned __int8 *a2, int *a3);
int __fastcall pb_get_encoded_size(_DWORD *a1, unsigned __int8 *a2, int *a3);
signed int __fastcall pb_encode_varint(_DWORD *a1, int a2, __int64 a3);
signed int __fastcall pb_encode_svarint(_DWORD *a1, int a2, int a3, int a4);
signed int __fastcall pb_encode_fixed32(_DWORD *a1, int a2);
signed int __fastcall pb_encode_fixed64(_DWORD *a1, int a2);
signed int __fastcall pb_encode_tag(_DWORD *a1, int a2, unsigned int a3);
signed int __fastcall pb_encode_tag_for_field(_DWORD *a1, unsigned __int8 *a2);
signed int __fastcall pb_encode_string(_DWORD *a1, int a2, int a3);
signed int __fastcall sub_DF40(_DWORD *a1, int a2, _DWORD *a3);
signed int __fastcall sub_DF88(_DWORD *a1, int a2, _DWORD *a3);
signed int __fastcall sub_DFB8(_DWORD *a1, int a2, int *a3);
signed int __fastcall sub_DFF4(_DWORD *a1, int a2, int a3);
signed int __fastcall sub_DFFC(_DWORD *a1, int a2, int a3);
int __fastcall sub_E004(_DWORD *a1, int a2, int *a3);
signed int __fastcall sub_E088(_DWORD *a1, int a2, int a3);
signed int __fastcall sub_E0C4(_DWORD *a1, int a2, int *a3);
unsigned int *__fastcall sub_E0E4(unsigned int *result, signed int *a2, _DWORD *a3);
signed int __fastcall sub_E134(int a1, int a2, unsigned int a3, unsigned int a4);
signed int __fastcall sub_E488(int a1, int a2, unsigned int a3, int a4, int *a5);
signed int __fastcall sub_E524(int a1, int a2, unsigned int a3, int a4);
signed int __fastcall sub_E658(int a1, int a2, int a3);
signed int __fastcall sub_E660(int a1, int a2);
signed int __fastcall sub_E6BC(int a1, int a2, int a3);
signed int __fastcall sub_E6C4(int a1, int a2, int a3);
int __fastcall sub_E778(int a1, int *a2, char a3);
void __fastcall __noreturn sub_E894(int a1, int a2, int a3);
int __fastcall sub_E960(_DWORD *a1, int a2, int a3, int a4, int a5);
_QWORD *__fastcall sub_E978(_QWORD *result);
_QWORD *__fastcall sub_E980(_QWORD *result);
_QWORD *__fastcall sub_E988(_QWORD *result);
void sub_E990();
void sub_E9D4();
int __fastcall sub_E9E8(int a1, int a2);
signed int __fastcall sub_EA30(int a1, int a2, _DWORD *a3);
signed int __fastcall sub_EA5E(int a1, int a2, int a3);
signed int __fastcall sub_EAA2(int a1, int a2, int *a3);
signed int __fastcall sub_EAD2(int a1, int a2, int a3, int a4);
int __fastcall sub_EB0A(int a1);
signed int __fastcall sub_EB10(int a1, int a2);
signed int __fastcall sub_EB2E(int a1);
int __fastcall sub_EB40(int a1);
signed int __fastcall sub_EB46(int a1, int a2);
int __fastcall sub_EB60(int a1, signed int a2);
int __fastcall sub_EBEC(int result, signed int a2, int a3);
int __fastcall sub_EC78(int a1, int a2);
__int64 __fastcall sub_EC98(int a1, int a2);
int __fastcall sub_ED3C(int a1, int a2, int a3, int a4);
int __fastcall sub_EE08(int a1);
_DWORD *__fastcall sub_EE58(int a1, _DWORD *a2);
void __fastcall sub_EE70(int a1);
int __fastcall sub_EE86(int a1);
signed int __fastcall sub_EE8C(int a1, int a2, int a3, _DWORD *a4);
int __fastcall sub_EEFC(int a1, int a2);
const char *__fastcall sub_EF6C(int a1, int a2);
int __fastcall sub_EF72(int result);
void __fastcall __noreturn sub_EF7C(int a1, int a2, int a3, int a4);
int __fastcall sub_EFA8(int a1);
int __fastcall sub_EFFC(int a1);
signed int __fastcall sub_F054(_DWORD *a1, int a2, _DWORD *a3);
int *__fastcall sub_F200(int *result, int a2, int a3, _DWORD *a4, int a5, int a6, int a7, _DWORD *a8);
int sub_F698(); // weak
__int64 *__fastcall sub_F6AC(__int64 *result);
__int64 *__fastcall sub_F6B4(__int64 *result);
__int64 *__fastcall sub_F6BC(__int64 *result);
int __fastcall sub_F6C4(int *a1);
int __fastcall sub_F708(int *a1);
int _aeabi_ldiv0();
char *__fastcall j_strncpy(char *dest, const char *src, size_t n);
int __fastcall j_RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2);
int __fastcall j_acquire_wake_lock(int a1, int a2);
int __fastcall j_pthread_mutex_unlock(pthread_mutex_t *mutex);
int __fastcall j_release_wake_lock(int a1);
int __fastcall j_j_RIL_onRequestComplete(int a1, int a2, int a3, int a4);
int __fastcall android::Parcel::writeInt32(android::Parcel *this, int a2);
void __fastcall j_free(void *ptr);
int __fastcall j_RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4);
int __fastcall j_RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4);
signed int __fastcall j_RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3);
int __fastcall j_RilSocket::socketInit(RilSocket *this);
void __fastcall operator delete(void *a1);
int __fastcall j_j_pb_read(int a1, int a2, int a3);
signed int __fastcall j_j_pb_encode_submessage(_DWORD *a1, unsigned __int8 *a2, int *a3);
signed int __fastcall j_j_pb_encode_varint(_DWORD *a1, int a2, __int64 a3);
signed int __fastcall j_j_pb_write(_DWORD *a1, int a2, int a3);
signed int __fastcall j_j_pb_encode_string(_DWORD *a1, int a2, int a3);
void sub_F914();
int __fastcall sub_F924(int *a1);

//-------------------------------------------------------------------------
// Data declarations

int dword_0 = 1179403647; // weak
Elf32_Sym stru_320 = { 1256u, 0u, 0u, 18u, 0u, 0u }; // weak
void *off_4FD0 = &unk_10000; // weak
void *off_4FE0 = &unk_10000; // weak
_UNKNOWN loc_6140; // weak
_UNKNOWN unk_13864; // weak
_DWORD dword_13870[8] = { 0, 0, 0, 0, 0, 0, 1, 1 }; // idb
_DWORD dword_13890[8] = { 3, 3, 3, 6, 6, 6, 6, 6 }; // idb
_DWORD dword_138B0[8] = { 4294967295, 3, 4, 4294967295, 6, 7, 4294967295, 4294967295 }; // idb
unsigned int dword_138D0[8] = { 0u, 0u, 0u, 5u, 1u, 2u, 2u, 2u }; // idb
void *off_1589C = (void *)0x3E8; // weak
char *off_15AE8[17] =
{
  "RADIO_OFF",
  "RADIO_UNAVAILABLE",
  "RADIO_SIM_NOT_READY",
  "RADIO_SIM_LOCKED_OR_ABSENT",
  "RADIO_SIM_READY",
  "RADIO_RUIM_NOT_READY",
  "RADIO_RUIM_READY",
  "RADIO_RUIM_LOCKED_OR_ABSENT",
  "RADIO_NV_NOT_READY",
  "RADIO_NV_READY",
  "RADIO_ON",
  "ACTIVE",
  "HOLDING",
  "DIALING",
  "ALERTING",
  "INCOMING",
  "WAITING"
}; // weak
char *off_15B14[6] = { "ACTIVE", "HOLDING", "DIALING", "ALERTING", "INCOMING", "WAITING" }; // weak
void *off_15B34 = (void *)0xC619; // weak
void *off_15B48 = (void *)0xD631; // weak
void *off_15B6C = (void *)0xDF41; // weak
void *off_15B98 = (void *)0x4471; // weak
void *off_16000 = &off_16000; // weak
char rild[5] = "rild"; // weak
int android::voiceRadioTech = 4294967295; // weak
int android::cdmaSubscriptionSource = 4294967295; // weak
int android::simRuimStatus = 4294967295; // weak
int dword_16018 = 4294967295; // weak
_UNKNOWN unk_1601C; // weak
void *RilSapSocket::uimRilEnv = (void *)0xBCC5; // weak
int android::s_callbacks; // weak
int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD); // weak
int (*dword_166E0)(void); // weak
_UNKNOWN unk_166E8; // weak
int (*dword_166EC)(void); // weak
int android::s_wakelock_count; // weak
char byte_166F4; // weak
_UNKNOWN unk_166F8; // weak
int dword_166FC; // weak
_UNKNOWN unk_16700; // weak
char byte_16704; // weak
int dword_16708; // weak
int dword_1670C; // weak
int dword_16710; // weak
int dword_16714; // weak
int dword_16718; // weak
int dword_1671C; // weak
int dword_16720; // weak
int dword_16724; // weak
int dword_16728; // weak
_UNKNOWN unk_1672C; // weak
_UNKNOWN unk_16750; // weak
_UNKNOWN unk_16774; // weak
int dword_16798; // weak
int dword_1679C; // weak
int dword_167A0; // weak
__int64 qword_167A4; // weak
_UNKNOWN unk_167AC; // weak
_UNKNOWN unk_167D0; // weak
int dword_167D4; // weak
_UNKNOWN unk_167D8; // weak
_UNKNOWN unk_167DC; // weak
_UNKNOWN unk_167E0; // weak
_DWORD dword_167E8[32]; // idb
int dword_16868; // weak
int dword_1686C; // weak
int dword_16870; // weak
_UNKNOWN unk_16878; // weak
_UNKNOWN unk_16880; // weak
int dword_16888; // weak
int dword_16890; // weak
int dword_16894; // weak
int dword_16898; // weak
_UNKNOWN unk_168A0; // weak
_UNKNOWN unk_168A8; // weak
int dword_168B0; // weak
_DWORD dword_168B8[2]; // idb
_UNKNOWN unk_168C0; // weak
_UNKNOWN unk_168C8; // weak
_UNKNOWN unk_168D0; // weak
int dword_168D8; // weak
int dword_168DC; // weak
_UNKNOWN unk_168E0; // weak
// extern _UNKNOWN _stack_chk_guard; weak
// extern _UNKNOWN MsgHeader_fields; weak
// extern _UNKNOWN RIL_SIM_SAP_DISCONNECT_REQ_fields; weak
// extern struct _IO_FILE *stderr;
// extern _UNKNOWN ae_p; weak


//----- (00003A5C) --------------------------------------------------------
signed int j___ae_r()
{
  return _ae_r();
}

//----- (00003B4C) --------------------------------------------------------
void *ril_event_init(void)
{
  return ril_event_init();
}

//----- (00003B7C) --------------------------------------------------------
int __fastcall ril_event_set(int a1, int fd, int a3, int a4, int a5)
{
  return ril_event_set(a1, fd, a3, a4, a5);
}

//----- (00003B88) --------------------------------------------------------
int __fastcall ril_event_add(int a1)
{
  return ril_event_add(a1);
}

//----- (00003B94) --------------------------------------------------------
int ril_event_loop(void)
{
  return ril_event_loop();
}

//----- (00003BB8) --------------------------------------------------------
int j_RIL_startEventLoop()
{
  return RIL_startEventLoop();
}

//----- (00003C90) --------------------------------------------------------
const char *__fastcall j_requestToString(int a1)
{
  return requestToString(a1);
}

//----- (00003CA8) --------------------------------------------------------
int __fastcall ril_event_del(int a1)
{
  return ril_event_del(a1);
}

//----- (00003CE4) --------------------------------------------------------
int __fastcall j_RIL_onUnsolicitedResponse(int a1, int a2, int a3)
{
  return RIL_onUnsolicitedResponse(a1, a2, a3);
}

//----- (00003CFC) --------------------------------------------------------
int __fastcall RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2)
{
  return RilSapSocket::initSapSocket(a1, a2);
}

//----- (00003D68) --------------------------------------------------------
int __fastcall ril_timer_add(int **a1, _DWORD *a2)
{
  return ril_timer_add(a1, a2);
}

//----- (00003D98) --------------------------------------------------------
char *__fastcall RilSocket::getListenEvent(RilSocket *this)
{
  return RilSocket::getListenEvent(this);
}

//----- (00003DA4) --------------------------------------------------------
int __fastcall RilSocket::setCommandFd(RilSocket *this, int a2)
{
  return RilSocket::setCommandFd((int)this, a2);
}

//----- (00003DB0) --------------------------------------------------------
int __fastcall RilSocket::getCommandFd(RilSocket *this)
{
  return RilSocket::getCommandFd(this);
}

//----- (00003DD4) --------------------------------------------------------
char *__fastcall RilSocket::getCallbackEvent(RilSocket *this)
{
  return RilSocket::getCallbackEvent(this);
}

//----- (00003DE0) --------------------------------------------------------
int __fastcall RilSocket::getCommandCb(RilSocket *this)
{
  return RilSocket::getCommandCb(this);
}

//----- (00003DEC) --------------------------------------------------------
int __fastcall RilSocket::onNewCommandConnect(RilSocket *this)
{
  return RilSocket::onNewCommandConnect(this);
}

//----- (00003EC4) --------------------------------------------------------
int __fastcall j_RIL_onRequestComplete(int a1, int a2, int a3, int a4)
{
  return RIL_onRequestComplete(a1, a2, a3, a4);
}

//----- (00003F78) --------------------------------------------------------
int __fastcall rilEventAddWakeup_helper(int a1)
{
  return rilEventAddWakeup_helper(a1);
}

//----- (00003F84) --------------------------------------------------------
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3)
{
  return listenCallback_helper(a1, a2, a3);
}

//----- (00003F90) --------------------------------------------------------
int __fastcall RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4)
{
  return RilSocket::socketRequestsHandler(a1, a2, a3, a4);
}

//----- (00003F9C) --------------------------------------------------------
int __fastcall RilSapSocket::getSocketById(int a1)
{
  return RilSapSocket::getSocketById(a1);
}

//----- (00003FA8) --------------------------------------------------------
int __fastcall RilSapSocket::onRequestComplete(int a1, int a2, int a3, int a4, unsigned int a5)
{
  return RilSapSocket::onRequestComplete(a1, a2, a3, a4, a5);
}

//----- (00003FB4) --------------------------------------------------------
int __fastcall RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4)
{
  return RilSapSocket::onUnsolicitedResponse(this, a2, a3, a4);
}

//----- (00003FC0) --------------------------------------------------------
int __fastcall RilSapSocket::printList(RilSapSocket *this)
{
  return RilSapSocket::printList(this);
}

//----- (00003FCC) --------------------------------------------------------
int __fastcall RilSapSocket::sendResponse(int a1, int *a2)
{
  return RilSapSocket::sendResponse(a1, a2);
}

//----- (00003FD8) --------------------------------------------------------
signed int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(int a1, int a2, int a3)
{
  return Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(a1, a2, a3);
}

//----- (00003FE4) --------------------------------------------------------
signed int __fastcall RilSapSocket::SocketExists(RilSapSocket *this, const char *a2)
{
  return RilSapSocket::SocketExists(this, a2);
}

//----- (00003FF0) --------------------------------------------------------
signed int __fastcall RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3)
{
  return RilSapSocket::addSocketToList(a1, a2, a3);
}

//----- (00003FFC) --------------------------------------------------------
pthread_mutexattr_t *__fastcall RilSapSocket::RilSapSocket(pthread_mutexattr_t *a1, pthread_mutexattr_t a2, pthread_mutexattr_t a3, pthread_mutexattr_t a4)
{
  return RilSapSocket::RilSapSocket(a1, a2, a3, a4);
}

//----- (00004014) --------------------------------------------------------
int __fastcall RilSocket::socketInit(RilSocket *this)
{
  return RilSocket::socketInit(this);
}

//----- (00004020) --------------------------------------------------------
void __fastcall RilSapSocket::dispatchRequest(int a1, _DWORD *a2)
{
  RilSapSocket::dispatchRequest(a1, a2);
}

//----- (0000402C) --------------------------------------------------------
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(int a1)
{
  return Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(a1);
}

//----- (00004038) --------------------------------------------------------
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(int a1, int a2)
{
  return Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(a1, a2);
}

//----- (00004050) --------------------------------------------------------
int __fastcall j_pb_get_encoded_size(_DWORD *a1, unsigned __int8 *a2, int *a3)
{
  return pb_get_encoded_size(a1, a2, a3);
}

//----- (0000405C) --------------------------------------------------------
_DWORD *__fastcall j_pb_ostream_from_buffer(_DWORD *result, int a2, int a3)
{
  return pb_ostream_from_buffer(result, a2, a3);
}

//----- (00004068) --------------------------------------------------------
signed int __fastcall j_pb_write(_DWORD *a1, int a2, int a3)
{
  return pb_write(a1, a2, a3);
}

//----- (00004074) --------------------------------------------------------
signed int __fastcall j_pb_encode(__int64 *a1, unsigned __int8 *a2, int *a3)
{
  return pb_encode(a1, a2, a3);
}

//----- (00004080) --------------------------------------------------------
int __fastcall log_hex(const char *a1, const unsigned __int8 *a2, int a3)
{
  return log_hex(a1, a2, a3);
}

//----- (0000408C) --------------------------------------------------------
int __fastcall blockingWrite_helper(int a1, void *a2, unsigned int a3)
{
  return blockingWrite_helper(a1, a2, a3);
}

//----- (00004098) --------------------------------------------------------
signed int (__fastcall **__fastcall j_pb_istream_from_buffer(signed int (__fastcall **result)(int a1, char *a2, int a3), signed int (__fastcall *a2)(int a1, char *a2, int a3), signed int (__fastcall *a3)(int a1, char *a2, int a3)))(int a1, char *a2, int a3)
{
  return pb_istream_from_buffer(result, a2, a3);
}

//----- (000040A4) --------------------------------------------------------
int __fastcall j_pb_decode(int a1, int a2, int a3)
{
  return pb_decode(a1, a2, a3);
}

//----- (000040B0) --------------------------------------------------------
void __fastcall RilSapSocket::dispatchDisconnect(int a1, int a2)
{
  RilSapSocket::dispatchDisconnect(a1, a2);
}

//----- (000040BC) --------------------------------------------------------
int __fastcall RilSapSocket::sendDisconnect(RilSapSocket *this)
{
  return RilSapSocket::sendDisconnect(this);
}

//----- (000040D4) --------------------------------------------------------
void __fastcall RilSapSocket::sOnRequestComplete(_DWORD *a1, int a2, int a3, unsigned int a4)
{
  RilSapSocket::sOnRequestComplete(a1, a2, a3, a4);
}

//----- (000040E0) --------------------------------------------------------
RilSapSocket *__fastcall RilSapSocket::sOnUnsolicitedResponse(RilSapSocket *this, int a2, const void *a3, unsigned int a4)
{
  return RilSapSocket::sOnUnsolicitedResponse(this, a2, a3, a4);
}

//----- (000040EC) --------------------------------------------------------
int j_RIL_requestTimedCallback()
{
  return RIL_requestTimedCallback();
}
// 6228: using guessed type int RIL_requestTimedCallback(void);

//----- (000040F8) --------------------------------------------------------
int __fastcall RilSapSocket::pushRecord(RilSapSocket *this, void *a2, unsigned int a3)
{
  return RilSapSocket::pushRecord(this, a2, a3);
}

//----- (00004104) --------------------------------------------------------
void __fastcall __noreturn RilSapSocket::processRequestsLoop(RilSapSocket *this)
{
  RilSapSocket::processRequestsLoop(this);
}

//----- (00004110) --------------------------------------------------------
int __fastcall RilSapSocket::onCommandsSocketClosed(RilSapSocket *this)
{
  return RilSapSocket::onCommandsSocketClosed(this);
}

//----- (0000411C) --------------------------------------------------------
int __fastcall j_pb_read(int a1, int a2, int a3)
{
  return pb_read(a1, a2, a3);
}

//----- (00004134) --------------------------------------------------------
int __fastcall j_pb_skip_field(int a1, int a2)
{
  return pb_skip_field(a1, a2);
}

//----- (00004140) --------------------------------------------------------
signed int __fastcall j_pb_make_string_substream(int a1, _QWORD *a2)
{
  return pb_make_string_substream(a1, a2);
}

//----- (00004164) --------------------------------------------------------
int __fastcall j_pb_decode_noinit(int a1, unsigned __int8 *a2, int a3)
{
  return pb_decode_noinit(a1, a2, a3);
}

//----- (00004170) --------------------------------------------------------
int __fastcall j_pb_release(int a1, int a2)
{
  return pb_release(a1, a2);
}

//----- (0000417C) --------------------------------------------------------
signed int __fastcall j_pb_decode_varint(int a1, _DWORD *a2)
{
  return pb_decode_varint(a1, a2);
}

//----- (00004188) --------------------------------------------------------
signed int __fastcall j_pb_encode_tag_for_field(_DWORD *a1, unsigned __int8 *a2)
{
  return pb_encode_tag_for_field(a1, a2);
}

//----- (00004194) --------------------------------------------------------
signed int __fastcall j_pb_encode_varint(_DWORD *a1, int a2, __int64 a3)
{
  return pb_encode_varint(a1, a2, a3);
}

//----- (000041A0) --------------------------------------------------------
signed int __fastcall j_pb_encode_submessage(_DWORD *a1, unsigned __int8 *a2, int *a3)
{
  return pb_encode_submessage(a1, a2, a3);
}

//----- (000041AC) --------------------------------------------------------
signed int __fastcall j_pb_encode_string(_DWORD *a1, int a2, int a3)
{
  return pb_encode_string(a1, a2, a3);
}

//----- (000041DC) --------------------------------------------------------
int j___aeabi_ldiv0()
{
  return _aeabi_ldiv0();
}

//----- (00004200) --------------------------------------------------------
void *sub_4200()
{
  void *result; // r0

  result = &ae_p;
  if ( &ae_p )
  {
    result = (void *)j___ae_r();
    ae_p = result;
  }
  return result;
}

//----- (0000423C) --------------------------------------------------------
signed int _ae_r()
{
  signed int v0; // r5
  int v1; // r6
  FILE *v2; // r4
  const char *v3; // r5
  int v4; // r0
  int v5; // t1
  size_t v6; // r5
  int v7; // r0
  int ptr; // [sp+4h] [bp-1Ch]

  v0 = 0;
  v1 = *(_DWORD *)((int (*)(void))_errno)();
  ptr = 0;
  v2 = fopen("/system/build.prop", "r");
  if ( v2 )
  {
    v3 = "ro.board.platform=";
    do
    {
      v4 = fgetc(v2);
      if ( v4 == -1 )
      {
        v7 = fclose(v2);
        goto LABEL_14;
      }
      v5 = *(unsigned __int8 *)v3;
      v3 = (char *)&dword_0 + (_DWORD)v3 + 1;
      if ( v4 != v5 )
        v3 = "ro.board.platform=";
    }
    while ( *v3 );
    v6 = fread(&ptr, 3u, 1u, v2);
    v7 = fclose(v2);
    if ( v6 == 1 )
    {
      v7 = strncmp((const char *)&ptr, "msm", 3u);
      if ( !v7
        || (v7 = strncmp((const char *)&ptr, "qsd", 3u)) == 0
        || (v7 = strncmp((const char *)&ptr, "apq", 3u)) == 0 )
      {
        v0 = 1;
        *(_DWORD *)_errno(v7) = v1;
        return v0;
      }
    }
LABEL_14:
    *(_DWORD *)_errno(v7) = v1;
    v0 = 0;
  }
  else
  {
    *(_DWORD *)((int (*)(void))_errno)() = v1;
  }
  return v0;
}
// 0: using guessed type int dword_0;
// 3A68: using guessed type int __fastcall _errno(_DWORD);

//----- (0000437C) --------------------------------------------------------
int sub_437C()
{
  return _cxa_finalize(&off_16000);
}
// 3AB0: using guessed type int __fastcall _cxa_finalize(_DWORD);
// 16000: using guessed type void *off_16000;

//----- (0000439C) --------------------------------------------------------
int (*__fastcall sub_439C(int (*result)(void)))(void)
{
  if ( result )
    result = (int (*)(void))result();
  return result;
}

//----- (0000445C) --------------------------------------------------------
char *__fastcall RIL_setRilSocketName(const char *a1)
{
  return j_strncpy(rild, a1, 6u);
}

//----- (00004474) --------------------------------------------------------
int RIL_startEventLoop()
{
  int v0; // r0
  char *v1; // r0
  pthread_attr_t attr; // [sp+4h] [bp-2Ch]

  byte_166F4 = 0;
  pthread_mutex_lock((pthread_mutex_t *)&unk_166F8);
  pthread_attr_init(&attr);
  pthread_attr_setdetachstate(&attr, 1);
  v0 = pthread_create((pthread_t *)&dword_166FC, &attr, (void *(*)(void *))sub_4540, 0);
  if ( v0 )
  {
    v1 = strerror(v0);
    _android_log_buf_print(1, 6, "RILC", "Failed to create dispatch thread: %s", v1);
  }
  else if ( !byte_166F4 )
  {
    do
      pthread_cond_wait((pthread_cond_t *)&unk_16700, (pthread_mutex_t *)&unk_166F8);
    while ( byte_166F4 != 1 );
  }
  pthread_mutex_unlock((pthread_mutex_t *)&unk_166F8);
  return _stack_chk_guard - *(&attr.__align + 6);
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 4540: using guessed type int sub_4540();
// 166F4: using guessed type char byte_166F4;
// 166FC: using guessed type int dword_166FC;

//----- (00004540) --------------------------------------------------------
int sub_4540()
{
  int v0; // r0
  int v1; // r0
  _DWORD *v2; // r0
  _DWORD *v3; // r0
  int result; // r0
  int pipedes[2]; // [sp+4h] [bp-1Ch]
  int v6; // [sp+Ch] [bp-14h]

  ril_event_init();
  pthread_mutex_lock((pthread_mutex_t *)&unk_166F8);
  byte_166F4 = 1;
  pthread_cond_broadcast((pthread_cond_t *)&unk_16700);
  pthread_mutex_unlock((pthread_mutex_t *)&unk_166F8);
  v0 = pipe(pipedes);
  if ( v0 <= -1 )
  {
    v3 = (_DWORD *)_errno(v0);
    _android_log_buf_print(1, 6, "RILC", "Error in pipe() errno:%d", *v3);
  }
  else
  {
    qword_167A4 = *(_QWORD *)pipedes;
    fcntl(pipedes[0], 4, 2048);
    ril_event_set((int)&unk_167AC, qword_167A4, 1, (int)sub_6A54, 0);
    ril_event_add((int)&unk_167AC);
    sub_A7B4();
    v1 = ril_event_loop();
    v2 = (_DWORD *)_errno(v1);
    _android_log_buf_print(1, 6, "RILC", "error in event_loop_base errno:%d", *v2);
    kill(0, 9);
  }
  result = _stack_chk_guard - v6;
  if ( _stack_chk_guard == v6 )
    result = 0;
  return result;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 4540: using guessed type int sub_4540();
// 166F4: using guessed type char byte_166F4;
// 167A4: using guessed type __int64 qword_167A4;

//----- (00004644) --------------------------------------------------------
__int64 *__fastcall RIL_setcallbacks(__int64 *a1)
{
  __int64 *result; // r0
  __int64 v2; // d16
  __int64 v3; // d17
  __int64 v4; // d18

  v2 = *a1;
  v3 = a1[1];
  result = a1 + 2;
  v4 = *result;
  *(_QWORD *)&android::s_callbacks = v2;
  *(_QWORD *)&dword_166E0 = v3;
  unk_166E8 = v4;
  return result;
}
// 166D8: using guessed type int android::s_callbacks;
// 166E0: using guessed type int (*dword_166E0)(void);

//----- (00004660) --------------------------------------------------------
int __fastcall RIL_register(double *a1)
{
  double *v1; // r4
  __int64 v2; // d16
  __int64 v3; // d17
  __int64 v4; // d18
  int v5; // r4
  signed int v6; // r1
  int v7; // r0
  int v8; // r1
  bool v9; // vf
  signed int v10; // r0
  bool v11; // zf
  char *v12; // r0
  const char *v13; // r6
  int *v14; // r5
  signed int v15; // r6
  unsigned int v16; // r0
  char *v17; // r0
  signed int v18; // r0
  int v19; // r0
  int result; // r0
  const char *v21; // r3
  char *v22; // r0
  char *v23; // r0
  char *v24; // [sp+4h] [bp-74h]
  double v25; // [sp+8h] [bp-70h]
  int v26; // [sp+10h] [bp-68h]
  char v27; // [sp+18h] [bp-60h]
  int v28; // [sp+58h] [bp-20h]

  v1 = a1;
  _android_log_buf_print(1, 4, "RILC", "SIM_COUNT: %d", 1);
  if ( !v1 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register: RIL_RadioFunctions * null");
    goto LABEL_32;
  }
  if ( *(_DWORD *)v1 <= 5 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register: version %d is to old, min version is %d", *(_DWORD *)v1, 6);
    goto LABEL_32;
  }
  _android_log_buf_print(1, 6, "RILC", "RIL_register: RIL version %d", *(_DWORD *)v1);
  if ( byte_16704 == 1 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register has been called more than once. Subsequent call ignored");
    goto LABEL_32;
  }
  v2 = *(_QWORD *)v1;
  v3 = *((_QWORD *)v1 + 1);
  v4 = *((_QWORD *)v1 + 2);
  v5 = 0;
  *(_QWORD *)&android::s_callbacks = v2;
  *(_QWORD *)&dword_166E0 = v3;
  unk_166E8 = v4;
  dword_1670C = -1;
  dword_16710 = -1;
  dword_16714 = (int)"radio";
  dword_16708 = 0;
  dword_16718 = (int)&unk_1672C;
  dword_1671C = (int)&unk_16750;
  dword_16720 = (int)sub_4A2C;
  dword_16724 = 0;
  dword_16728 = 0;
  byte_16704 = 1;
  _android_log_buf_print(1, 4, "RILC", "s_registerCalled flag set, %d", (unsigned __int8)byte_166F4);
  while ( v5 <= 141 )
  {
    v6 = 1;
    if ( v5 + 1 > v5 )
      v6 = 0;
    ++v5;
    if ( v6 )
LABEL_18:
      abort();
  }
  v7 = 0;
  while ( v7 < 49 )
  {
    v8 = v7 + 1;
    v9 = v7 + 1 <= v7;
    v10 = 1;
    if ( !v9 )
      v10 = 0;
    v11 = v10 == 0;
    v7 = v8;
    if ( !v11 )
      goto LABEL_18;
  }
  if ( !byte_166F4 )
    j_RIL_startEventLoop();
  v1 = &v25;
  v25 = 0.0;
  LOWORD(v26) = 0;
  _strncpy_chk2(&v25, rild, 9, 10, 6);
  _android_log_buf_print(1, 4, "RILC", "Start to listen %s", "RIL_SOCKET_1");
  _snprintf_chk(&v27, 64, 0, 64, "ANDROID_SOCKET_%s", &v25);
  v12 = getenv(&v27);
  v13 = v12;
  if ( !v12 )
    goto LABEL_33;
  v14 = (int *)_errno(v12);
  *v14 = 0;
  v15 = strtol(v13, 0, 10);
  if ( *v14 || v15 <= -1 )
    goto LABEL_33;
  if ( listen(v15, 4) <= -1 )
  {
    v23 = strerror(*v14);
    _android_log_buf_print(1, 6, "RILC", "Failed to listen on control socket '%d': %s", v15, v23);
    goto LABEL_40;
  }
  dword_1670C = v15;
  ril_event_set(dword_1671C, v15, 0, (int)listenCallback_helper, (int)&dword_16708);
  ril_event_add(dword_1671C);
  sub_A7B4();
  v16 = _strlen_chk(rild, 6);
  v26 = 26485;
  v25 = *(double *)"rild-debug";
  if ( v16 >= 4 )
    _strlcat_chk(&v25, &rild[4], 12, 12);
  _snprintf_chk(&v27, 64, 0, 64, "ANDROID_SOCKET_%s", &v25, v25, v26);
  v17 = getenv(&v27);
  if ( !v17 || (*v14 = 0, v18 = strtol(v17, 0, 10), *v14) )
  {
    dword_16018 = -1;
    goto LABEL_35;
  }
  dword_16018 = v18;
  if ( v18 <= -1 )
  {
LABEL_35:
    v22 = (char *)*v14;
    v21 = "Failed to get socket : %s errno:%d";
LABEL_38:
    v24 = v22;
    goto LABEL_39;
  }
  v19 = listen(v18, 4);
  v1 = (double *)dword_16018;
  if ( v19 <= -1 )
  {
    v22 = strerror(*v14);
    v21 = "Failed to listen on ril debug socket '%d': %s";
    goto LABEL_38;
  }
  ril_event_set((int)&unk_16774, dword_16018, 1, (int)sub_4C80, 0);
  ril_event_add((int)&unk_16774);
  sub_A7B4();
LABEL_32:
  result = _stack_chk_guard - v28;
  if ( _stack_chk_guard != v28 )
  {
LABEL_33:
    v21 = "Failed to get socket %s";
LABEL_39:
    _android_log_buf_print(1, 6, "RILC", v21, v1, v24);
LABEL_40:
    exit(-1);
  }
  return result;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BD0: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3C0C: using guessed type int __fastcall _strlcat_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 16018: using guessed type int dword_16018;
// 166D8: using guessed type int android::s_callbacks;
// 166E0: using guessed type int (*dword_166E0)(void);
// 166F4: using guessed type char byte_166F4;
// 16704: using guessed type char byte_16704;
// 16708: using guessed type int dword_16708;
// 1670C: using guessed type int dword_1670C;
// 16710: using guessed type int dword_16710;
// 16714: using guessed type int dword_16714;
// 16718: using guessed type int dword_16718;
// 1671C: using guessed type int dword_1671C;
// 16720: using guessed type int dword_16720;
// 16724: using guessed type int dword_16724;
// 16728: using guessed type int dword_16728;

//----- (00004A2C) --------------------------------------------------------
int __fastcall sub_4A2C(int a1, int a2, int *a3)
{
  int v3; // r10
  int v4; // r0
  const unsigned __int8 *v5; // r11
  signed int v6; // r2
  signed int v7; // r1
  const char *v8; // r6
  unsigned int v9; // r5
  int v10; // r9
  int v11; // r5
  const char *v12; // r11
  int v13; // r5
  unsigned int v14; // r0
  _DWORD *v15; // r0
  int v16; // r6
  const char *v17; // r0
  signed int v18; // r2
  signed int v19; // r1
  const char *v20; // r3
  int *v21; // r0
  bool v22; // zf
  int v23; // r0
  int v25; // [sp+0h] [bp-C0h]
  int fd; // [sp+18h] [bp-A8h]
  int *v27; // [sp+1Ch] [bp-A4h]
  char v28; // [sp+20h] [bp-A0h]
  const unsigned __int8 *v29; // [sp+24h] [bp-9Ch]
  char v30; // [sp+28h] [bp-98h]
  int v31; // [sp+5Ch] [bp-64h]
  int v32; // [sp+60h] [bp-60h]
  char v33; // [sp+64h] [bp-5Ch]
  int v34; // [sp+98h] [bp-28h]

  fd = a1;
  v27 = a3;
  v3 = a3[7];
  v4 = record_stream_get_next(v3, &v29, &v28);
  v5 = v29;
  v6 = 0;
  v7 = 0;
  if ( !v4 )
    v7 = 1;
  if ( !(v4 | (unsigned int)v29) )
    v6 = 1;
  if ( v4 >= 0 && !v6 )
  {
    v8 = "RILC";
    do
    {
      if ( v7 & 1 )
      {
        v9 = *(_DWORD *)&v28;
        v10 = *v27;
        android::Parcel::Parcel((android::Parcel *)&v33);
        android::Parcel::setData((android::Parcel *)&v33, v5, v9);
        android::Parcel::readInt32((android::Parcel *)&v33, &v32);
        if ( android::Parcel::readInt32((android::Parcel *)&v33, &v31) )
        {
          _android_log_buf_print(1, 6, v8, "invalid request block");
        }
        else
        {
          v11 = v32;
          if ( v32 == 800 )
          {
            sub_6190();
          }
          else
          {
            v12 = v8;
            if ( (unsigned int)(v32 - 1) < 0x8D )
            {
              v15 = calloc(1u, 0x18u);
              v16 = (int)v15;
              if ( v15 )
              {
                *v15 = v31;
                v15[4] = v10;
                v15[1] = (char *)&unk_1601C + 12 * v11;
                pthread_mutex_lock((pthread_mutex_t *)&unk_167D0);
                *(_DWORD *)(v16 + 8) = dword_167D4;
                dword_167D4 = v16;
                pthread_mutex_unlock((pthread_mutex_t *)&unk_167D0);
                (*(void (__fastcall **)(char *, int))(*(_DWORD *)(v16 + 4) + 4))(&v33, v16);
                v8 = v12;
              }
              else
              {
                v17 = j_requestToString(v11);
                v8 = v12;
                _android_log_buf_print(1, 6, v12, "Memory allocation failed for request %s", v17);
              }
            }
            else
            {
              android::Parcel::Parcel((android::Parcel *)&v30);
              _android_log_buf_print(1, 6, v8, "unsupported request code %d token %d", v32, v31);
              android::Parcel::writeInt32((android::Parcel *)&v30, 0);
              android::Parcel::writeInt32((android::Parcel *)&v30, v31);
              android::Parcel::writeInt32((android::Parcel *)&v30, 2);
              v13 = android::Parcel::data((android::Parcel *)&v30);
              v14 = android::Parcel::dataSize((android::Parcel *)&v30);
              sub_A7F8(v13, v14);
              android::Parcel::~Parcel((android::Parcel *)&v30);
            }
          }
        }
        android::Parcel::~Parcel((android::Parcel *)&v33);
      }
      v4 = record_stream_get_next(v3, &v29, &v28);
      v5 = v29;
      v7 = 0;
      if ( !v4 )
        v7 = 1;
      v18 = 0;
      if ( !(v4 | (unsigned int)v29) )
        v18 = 1;
    }
    while ( v4 >= 0 && v18 != 1 );
  }
  if ( v7 )
  {
    v19 = 5;
    v20 = "EOS.  Closing command socket.";
LABEL_31:
    _android_log_buf_print(1, v19, "RILC", v20, v25);
    close(fd);
    v23 = v27[4];
    v27[2] = -1;
    ril_event_del(v23);
    record_stream_free(v3);
    ril_event_add((int)&unk_16750);
    sub_A7B4();
    sub_6AAC();
    return _stack_chk_guard - v34;
  }
  v21 = (int *)_errno(v4);
  v22 = *v21 == 11;
  if ( *v21 != 11 )
    v22 = *v21 == 4;
  if ( !v22 )
  {
    v19 = 6;
    v25 = *v21;
    v20 = "error on reading command socket errno:%d\n";
    goto LABEL_31;
  }
  return _stack_chk_guard - v34;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C24: using guessed type int __fastcall record_stream_get_next(_DWORD, _DWORD, _DWORD);
// 3CB4: using guessed type int __fastcall record_stream_free(_DWORD);
// 167D4: using guessed type int dword_167D4;

//----- (00004C80) --------------------------------------------------------
int __fastcall sub_4C80(int a1)
{
  int v1; // r4
  int v2; // r0
  int v3; // r10
  signed int v4; // r4
  const char **v5; // r8
  const char *v6; // r7
  int v7; // r6
  int v8; // r5
  signed int v9; // r1
  const char *v10; // r4
  int v11; // r0
  int v12; // r0
  signed int v13; // r1
  int v14; // r0
  _DWORD *v15; // r0
  const char *v16; // r3
  const char *v17; // r3
  int v18; // r0
  void **v19; // r0
  __int64 v20; // d17
  const char *v21; // r3
  const char **v22; // r1
  int v23; // r0
  int v24; // r4
  int result; // r0
  int v26; // [sp+Ch] [bp-D4h]
  size_t nmemb; // [sp+10h] [bp-D0h]
  int v28; // [sp+14h] [bp-CCh]
  int v29; // [sp+18h] [bp-C8h]
  int v30; // [sp+20h] [bp-C0h]
  socklen_t addr_len; // [sp+24h] [bp-BCh]
  int v32; // [sp+28h] [bp-B8h]
  const char *v33; // [sp+2Ch] [bp-B4h]
  __int64 v34; // [sp+30h] [bp-B0h]
  __int64 v35; // [sp+38h] [bp-A8h]
  int v36; // [sp+40h] [bp-A0h]
  int v37; // [sp+44h] [bp-9Ch]
  struct sockaddr addr; // [sp+48h] [bp-98h]
  int v39; // [sp+B8h] [bp-28h]

  v1 = a1;
  addr_len = 110;
  v33 = "1";
  v32 = 1;
  _android_log_buf_print(1, 4, "RILC", "debugCallback for socket %s", "RIL_SOCKET_1");
  v2 = accept(v1, &addr, &addr_len);
  v3 = v2;
  if ( v2 <= -1 )
  {
    v15 = (_DWORD *)_errno(v2);
    _android_log_buf_print(1, 6, "RILC", "error accepting on debug port: %d\n", *v15);
    goto LABEL_52;
  }
  if ( _recvfrom_chk(v2, &nmemb, 4) == 4 )
  {
    v4 = nmemb;
    if ( (signed int)nmemb <= -1 )
    {
      v16 = "Invalid number of arguments: \n";
    }
    else
    {
      v5 = (const char **)calloc(nmemb, 4u);
      if ( v5 )
      {
        v6 = 0;
        if ( v4 < 1 )
        {
LABEL_20:
          switch ( atoi(v6) )
          {
            case 0:
              _android_log_buf_print(1, 4, "RILC", "Connection on debug port: issuing reset.");
              v14 = 58;
              goto LABEL_45;
            case 1:
              _android_log_buf_print(1, 4, "RILC", "Connection on debug port: issuing radio power off.");
              v30 = 0;
              sub_A6F8(23, (int)&v30, 4);
              if ( dword_16710 >= 1 )
              {
                close(dword_16710);
                dword_16710 = -1;
              }
              goto LABEL_49;
            case 2:
              _android_log_buf_print(1, 4, "RILC", "Debug port: issuing unsolicited voice network change.");
              j_RIL_onUnsolicitedResponse(1002, 0, 0);
              goto LABEL_49;
            case 3:
              _android_log_buf_print(1, 4, "RILC", "Debug port: QXDM log enable.");
              v19 = &off_4FE0;
              goto LABEL_37;
            case 4:
              _android_log_buf_print(1, 4, "RILC", "Debug port: QXDM log disable.");
              v19 = &off_4FD0;
LABEL_37:
              v20 = *((_QWORD *)v19 + 1);
              v34 = *(_QWORD *)v19;
              v35 = v20;
              v36 = 0;
              v37 = 8;
              sub_A6F8(59, (int)&v34, 24);
              goto LABEL_49;
            case 5:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Radio On");
              v30 = 1;
              sub_A6F8(23, (int)&v30, 4);
              sleep(2u);
              v14 = 46;
              goto LABEL_45;
            case 7:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Deactivate Data Call");
              v22 = &v33;
              v23 = 41;
              goto LABEL_47;
            case 8:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Dial Call");
              v24 = (int)v5[1];
              v29 = 0;
              if ( (unsigned int)_strlen_chk(v24, -1) < 0x81 )
              {
                v28 = v24;
                sub_A6F8(10, (int)&v28, 12);
              }
              else
              {
                v21 = "Debug port: Error calling Dial";
LABEL_43:
                _android_log_buf_print(1, 6, "RILC", v21);
              }
LABEL_49:
              v18 = nmemb;
              break;
            case 9:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Answer Call");
              v14 = 40;
LABEL_45:
              sub_A6F8(v14, 0, 0);
              goto LABEL_49;
            case 10:
              _android_log_buf_print(1, 4, "RILC", "Debug port: End Call");
              v22 = (const char **)&v32;
              v23 = 12;
LABEL_47:
              sub_A6F8(v23, (int)v22, 4);
              goto LABEL_49;
            default:
              v21 = "Invalid request";
              goto LABEL_43;
          }
        }
        else
        {
          v7 = 0;
          while ( 1 )
          {
            if ( _recvfrom_chk(v3, &v26, 4) != 4 )
            {
              v17 = "error reading on socket: Len of Args: \n";
              goto LABEL_31;
            }
            v8 = v26;
            if ( v26 == 0x7FFFFFFF || v26 <= -1 )
            {
              v17 = "Invalid value of len: \n";
              goto LABEL_31;
            }
            v9 = 1;
            if ( v26 + 1 > v26 )
              v9 = 0;
            if ( v9 )
              goto LABEL_53;
            v10 = (const char *)calloc(v26 + 1, 1u);
            v5[v7] = v10;
            if ( !v10 )
            {
              v17 = "Memory allocation failed for debug args";
              goto LABEL_31;
            }
            v11 = _recvfrom_chk(v3, v10, v8);
            if ( v11 != v26 )
              break;
            v10[v11] = 0;
            v12 = v7 + 1;
            v13 = 1;
            if ( v7 + 1 > v7 )
              v13 = 0;
            if ( v13 )
              goto LABEL_53;
            ++v7;
            if ( v12 >= (signed int)nmemb )
            {
              v6 = *v5;
              goto LABEL_20;
            }
          }
          v17 = "error reading on socket: Args[%d] \n";
LABEL_31:
          _android_log_buf_print(1, 6, "RILC", v17);
          v18 = v7;
        }
        sub_A6C4(v18, v5);
        goto LABEL_51;
      }
      v16 = "Memory allocation failed for debug args";
    }
  }
  else
  {
    v16 = "error reading on socket: number of Args: \n";
  }
  _android_log_buf_print(1, 6, "RILC", v16);
LABEL_51:
  close(v3);
LABEL_52:
  result = _stack_chk_guard - v39;
  if ( _stack_chk_guard != v39 )
LABEL_53:
    abort();
  return result;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3CCC: using guessed type int __cdecl _recvfrom_chk(_DWORD, _DWORD, _DWORD);
// 4FD0: using guessed type void *off_4FD0;
// 4FE0: using guessed type void *off_4FE0;
// 16710: using guessed type int dword_16710;

//----- (000050B0) --------------------------------------------------------
int (__fastcall *__fastcall RIL_register_socket(int (__fastcall *result)(void **, int, int), int a2, int a3, int a4))(void **, int, int)
{
  int v4; // r5

  v4 = a2;
  if ( result )
  {
    result = (int (__fastcall *)(void **, int, int))result(&RilSapSocket::uimRilEnv, a3, a4);
    if ( v4 == 1 )
      result = (int (__fastcall *)(void **, int, int))j_RilSapSocket::initSapSocket(
                                                        "sap_uim_socket1",
                                                        (pthread_mutexattr_t)result);
  }
  return result;
}
// 166C4: using guessed type void *RilSapSocket::uimRilEnv;

//----- (000050E0) --------------------------------------------------------
int __fastcall RIL_onRequestAck(int a1)
{
  int v1; // r4
  signed int v2; // r6
  int v3; // r5
  unsigned int v4; // r0
  int v6; // [sp+0h] [bp-48h]
  int v7; // [sp+34h] [bp-14h]

  v1 = a1;
  if ( sub_519C(a1, 1) )
  {
    if ( !*(_BYTE *)(v1 + 12) )
    {
      v2 = dword_16710;
      android::Parcel::Parcel((android::Parcel *)&v6);
      android::Parcel::writeInt32((android::Parcel *)&v6, 2);
      android::Parcel::writeInt32((android::Parcel *)&v6, *(_DWORD *)v1);
      if ( v2 <= -1 )
        _android_log_buf_print(1, 3, "RILC", "RIL onRequestComplete: Command channel closed");
      v3 = android::Parcel::data((android::Parcel *)&v6);
      v4 = android::Parcel::dataSize((android::Parcel *)&v6);
      sub_A7F8(v3, v4);
      android::Parcel::~Parcel((android::Parcel *)&v6);
    }
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_onRequestAck: invalid RIL_Token");
  }
  return _stack_chk_guard - v7;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 16710: using guessed type int dword_16710;

//----- (0000519C) --------------------------------------------------------
signed int __fastcall sub_519C(int a1, int a2)
{
  int v2; // r4
  int v3; // r5
  int *v4; // r0
  int i; // r1
  const char *v6; // r0
  signed int v7; // r5

  v2 = a1;
  v3 = a2;
  if ( !a1 )
    return 0;
  pthread_mutex_lock((pthread_mutex_t *)&unk_167D0);
  v4 = &dword_167D4;
  for ( i = dword_167D4; ; i = *(_DWORD *)(i + 8) )
  {
    if ( !i )
    {
      v7 = 0;
      goto LABEL_13;
    }
    if ( i == v2 )
      break;
    v4 = (int *)(i + 8);
  }
  if ( v3 == 1 )
  {
    if ( *(_DWORD *)(v2 + 20) == 1 )
    {
      v6 = j_requestToString(**(_DWORD **)(v2 + 4));
      v7 = 1;
      _android_log_buf_print(1, 3, "RILC", "Ack was already sent for %s", v6);
    }
    else
    {
      v7 = 1;
      *(_DWORD *)(v2 + 20) = 1;
    }
  }
  else
  {
    v7 = 1;
    *v4 = *(_DWORD *)(v2 + 8);
  }
LABEL_13:
  pthread_mutex_unlock((pthread_mutex_t *)&unk_167D0);
  return v7;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 167D4: using guessed type int dword_167D4;

//----- (00005224) --------------------------------------------------------
int __fastcall RIL_onRequestComplete(int a1, int a2, int a3, int a4)
{
  int v4; // r4
  int v5; // r7
  int v6; // r5
  int v7; // r6
  const char *v8; // r0
  signed int v9; // r10
  unsigned int v10; // r8
  int v11; // r5
  int v12; // r6
  unsigned int v13; // r0
  char v15; // [sp+8h] [bp-58h]
  int v16; // [sp+3Ch] [bp-24h]

  v4 = a1;
  v5 = a2;
  v6 = a4;
  v7 = a3;
  if ( sub_519C(a1, 0) )
  {
    if ( *(_BYTE *)(v4 + 13) )
    {
      v8 = j_requestToString(**(_DWORD **)(v4 + 4));
      _android_log_buf_print(1, 3, "RILC", "C[locl]< %s", v8);
    }
    else if ( !*(_BYTE *)(v4 + 12) )
    {
      v9 = dword_16710;
      android::Parcel::Parcel((android::Parcel *)&v15);
      if ( android::s_callbacks < 13 || *(_DWORD *)(v4 + 20) != 1 )
      {
        android::Parcel::writeInt32((android::Parcel *)&v15, 0);
      }
      else
      {
        android::Parcel::writeInt32((android::Parcel *)&v15, 3);
        sub_5CE4();
      }
      android::Parcel::writeInt32((android::Parcel *)&v15, *(_DWORD *)v4);
      v10 = android::Parcel::dataPosition((android::Parcel *)&v15);
      android::Parcel::writeInt32((android::Parcel *)&v15, v5);
      if ( v7 )
      {
        v11 = (*(int (__fastcall **)(char *, int, int))(*(_DWORD *)(v4 + 4) + 8))(&v15, v7, v6);
        if ( v11 )
        {
          _android_log_buf_print(1, 6, "RILC", "responseFunction error, ret %d", v11);
          android::Parcel::setDataPosition((android::Parcel *)&v15, v10);
          android::Parcel::writeInt32((android::Parcel *)&v15, v11);
        }
      }
      if ( v9 <= -1 )
        _android_log_buf_print(1, 3, "RILC", "RIL onRequestComplete: Command channel closed");
      v12 = android::Parcel::data((android::Parcel *)&v15);
      v13 = android::Parcel::dataSize((android::Parcel *)&v15);
      sub_A7F8(v12, v13);
      android::Parcel::~Parcel((android::Parcel *)&v15);
    }
    free((void *)v4);
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_onRequestComplete: invalid RIL_Token");
  }
  return _stack_chk_guard - v16;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 166D8: using guessed type int android::s_callbacks;
// 16710: using guessed type int dword_16710;

//----- (00005390) --------------------------------------------------------
const char *__fastcall requestToString(int a1)
{
  int v1; // r1
  const char *result; // r0

  v1 = a1 - 1;
  result = "GET_SIM_STATUS";
  switch ( v1 )
  {
    case 0:
      return result;
    case 1:
      result = "ENTER_SIM_PIN";
      break;
    case 2:
      result = "ENTER_SIM_PUK";
      break;
    case 3:
      result = "ENTER_SIM_PIN2";
      break;
    case 4:
      result = "ENTER_SIM_PUK2";
      break;
    case 5:
      result = "CHANGE_SIM_PIN";
      break;
    case 6:
      result = "CHANGE_SIM_PIN2";
      break;
    case 7:
      result = "ENTER_NETWORK_DEPERSONALIZATION";
      break;
    case 8:
      result = "GET_CURRENT_CALLS";
      break;
    case 9:
      result = "DIAL";
      break;
    case 10:
      result = "GET_IMSI";
      break;
    case 11:
      result = "HANGUP";
      break;
    case 12:
      result = "HANGUP_WAITING_OR_BACKGROUND";
      break;
    case 13:
      result = "HANGUP_FOREGROUND_RESUME_BACKGROUND";
      break;
    case 14:
      result = "SWITCH_WAITING_OR_HOLDING_AND_ACTIVE";
      break;
    case 15:
      result = "CONFERENCE";
      break;
    case 16:
      result = "UDUB";
      break;
    case 17:
      result = "LAST_CALL_FAIL_CAUSE";
      break;
    case 18:
      result = "SIGNAL_STRENGTH";
      break;
    case 19:
      result = "VOICE_REGISTRATION_STATE";
      break;
    case 20:
      result = "DATA_REGISTRATION_STATE";
      break;
    case 21:
      result = "OPERATOR";
      break;
    case 22:
      result = "RADIO_POWER";
      break;
    case 23:
      result = "DTMF";
      break;
    case 24:
      result = "SEND_SMS";
      break;
    case 25:
      result = "SEND_SMS_EXPECT_MORE";
      break;
    case 26:
      result = "SETUP_DATA_CALL";
      break;
    case 27:
      result = "SIM_IO";
      break;
    case 28:
      result = "SEND_USSD";
      break;
    case 29:
      result = "CANCEL_USSD";
      break;
    case 30:
      result = "GET_CLIR";
      break;
    case 31:
      result = "SET_CLIR";
      break;
    case 32:
      result = "QUERY_CALL_FORWARD_STATUS";
      break;
    case 33:
      result = "SET_CALL_FORWARD";
      break;
    case 34:
      result = "QUERY_CALL_WAITING";
      break;
    case 35:
      result = "SET_CALL_WAITING";
      break;
    case 36:
      result = "SMS_ACKNOWLEDGE";
      break;
    case 37:
      result = "GET_IMEI";
      break;
    case 38:
      result = "GET_IMEISV";
      break;
    case 39:
      result = "ANSWER";
      break;
    case 40:
      result = "DEACTIVATE_DATA_CALL";
      break;
    case 41:
      result = "QUERY_FACILITY_LOCK";
      break;
    case 42:
      result = "SET_FACILITY_LOCK";
      break;
    case 43:
      result = "CHANGE_BARRING_PASSWORD";
      break;
    case 44:
      result = "QUERY_NETWORK_SELECTION_MODE";
      break;
    case 45:
      result = "SET_NETWORK_SELECTION_AUTOMATIC";
      break;
    case 46:
      result = "SET_NETWORK_SELECTION_MANUAL";
      break;
    case 47:
      result = "QUERY_AVAILABLE_NETWORKS ";
      break;
    case 48:
      result = "DTMF_START";
      break;
    case 49:
      result = "DTMF_STOP";
      break;
    case 50:
      result = "BASEBAND_VERSION";
      break;
    case 51:
      result = "SEPARATE_CONNECTION";
      break;
    case 52:
      result = "SET_MUTE";
      break;
    case 53:
      result = "GET_MUTE";
      break;
    case 54:
      result = "QUERY_CLIP";
      break;
    case 55:
      result = "LAST_DATA_CALL_FAIL_CAUSE";
      break;
    case 56:
      result = "DATA_CALL_LIST";
      break;
    case 57:
      result = "RESET_RADIO";
      break;
    case 58:
      result = "OEM_HOOK_RAW";
      break;
    case 59:
      result = "OEM_HOOK_STRINGS";
      break;
    case 60:
      result = "SCREEN_STATE";
      break;
    case 61:
    case 63:
    case 90:
    case 117:
    case 118:
    case 119:
    case 131:
    case 132:
    case 133:
    case 134:
LABEL_7:
      result = "<unknown request>";
      break;
    case 62:
      result = "WRITE_SMS_TO_SIM";
      break;
    case 64:
      result = "SET_BAND_MODE";
      break;
    case 65:
      result = "QUERY_AVAILABLE_BAND_MODE";
      break;
    case 66:
      result = "STK_GET_PROFILE";
      break;
    case 67:
      result = "STK_SET_PROFILE";
      break;
    case 68:
      result = "STK_SEND_ENVELOPE_COMMAND";
      break;
    case 69:
      result = "STK_SEND_TERMINAL_RESPONSE";
      break;
    case 70:
      result = "STK_HANDLE_CALL_SETUP_REQUESTED_FROM_SIM";
      break;
    case 71:
      result = "EXPLICIT_CALL_TRANSFER";
      break;
    case 72:
      result = "SET_PREFERRED_NETWORK_TYPE";
      break;
    case 73:
      result = "GET_PREFERRED_NETWORK_TYPE";
      break;
    case 74:
      result = "GET_NEIGHBORING_CELL_IDS";
      break;
    case 75:
      result = "SET_LOCATION_UPDATES";
      break;
    case 76:
      result = "CDMA_SET_SUBSCRIPTION_SOURCE";
      break;
    case 77:
      result = "CDMA_SET_ROAMING_PREFERENCE";
      break;
    case 78:
      result = "CDMA_QUERY_ROAMING_PREFERENCE";
      break;
    case 79:
      result = "SET_TTY_MODE";
      break;
    case 80:
      result = "QUERY_TTY_MODE";
      break;
    case 81:
      result = "CDMA_SET_PREFERRED_VOICE_PRIVACY_MODE";
      break;
    case 82:
      result = "CDMA_QUERY_PREFERRED_VOICE_PRIVACY_MODE";
      break;
    case 83:
      result = "CDMA_FLASH";
      break;
    case 84:
      result = "CDMA_BURST_DTMF";
      break;
    case 85:
      result = "CDMA_VALIDATE_AND_WRITE_AKEY";
      break;
    case 86:
      result = "CDMA_SEND_SMS";
      break;
    case 87:
      result = "CDMA_SMS_ACKNOWLEDGE";
      break;
    case 88:
      result = "GSM_GET_BROADCAST_SMS_CONFIG";
      break;
    case 89:
      result = "GSM_SET_BROADCAST_SMS_CONFIG";
      break;
    case 91:
      result = "CDMA_GET_BROADCAST_SMS_CONFIG";
      break;
    case 92:
      result = "CDMA_SET_BROADCAST_SMS_CONFIG";
      break;
    case 93:
      result = "CDMA_SMS_BROADCAST_ACTIVATION";
      break;
    case 94:
      result = "CDMA_SUBSCRIPTION";
      break;
    case 95:
      result = "CDMA_WRITE_SMS_TO_RUIM";
      break;
    case 96:
      result = "CDMA_DELETE_SMS_ON_RUIM";
      break;
    case 97:
      result = "DEVICE_IDENTITY";
      break;
    case 98:
      result = "EXIT_EMERGENCY_CALLBACK_MODE";
      break;
    case 99:
      result = "GET_SMSC_ADDRESS";
      break;
    case 100:
      result = "SET_SMSC_ADDRESS";
      break;
    case 101:
      result = "REPORT_SMS_MEMORY_STATUS";
      break;
    case 102:
      result = "REPORT_STK_SERVICE_IS_RUNNING";
      break;
    case 103:
      result = "CDMA_GET_SUBSCRIPTION_SOURCE";
      break;
    case 104:
      result = "ISIM_AUTHENTICATION";
      break;
    case 105:
      result = "RIL_REQUEST_ACKNOWLEDGE_INCOMING_GSM_SMS_WITH_PDU";
      break;
    case 106:
      result = "RIL_REQUEST_STK_SEND_ENVELOPE_WITH_STATUS";
      break;
    case 107:
      result = "VOICE_RADIO_TECH";
      break;
    case 108:
      result = "GET_CELL_INFO_LIST";
      break;
    case 109:
      result = "SET_UNSOL_CELL_INFO_LIST_RATE";
      break;
    case 110:
      result = "RIL_REQUEST_SET_INITIAL_ATTACH_APN";
      break;
    case 111:
      result = "IMS_REGISTRATION_STATE";
      break;
    case 112:
      result = "IMS_SEND_SMS";
      break;
    case 113:
      result = "SIM_TRANSMIT_APDU_BASIC";
      break;
    case 114:
      result = "SIM_OPEN_CHANNEL";
      break;
    case 115:
      result = "SIM_CLOSE_CHANNEL";
      break;
    case 116:
      result = "SIM_TRANSMIT_APDU_CHANNEL";
      break;
    case 120:
      result = "NV_RESET_CONFIG";
      break;
    case 121:
      result = "SET_UICC_SUBSCRIPTION";
      break;
    case 122:
      result = "ALLOW_DATA";
      break;
    case 123:
      result = "GET_HARDWARE_CONFIG";
      break;
    case 124:
      result = "SIM_AUTHENTICATION";
      break;
    case 125:
      result = "GET_DC_RT_INFO";
      break;
    case 126:
      result = "SET_DC_RT_INFO_RATE";
      break;
    case 127:
      result = "SET_DATA_PROFILE";
      break;
    case 128:
      result = "SHUTDOWN";
      break;
    case 129:
      result = "RIL_REQUEST_GET_RADIO_CAPABILITY";
      break;
    case 130:
      result = "RIL_REQUEST_SET_RADIO_CAPABILITY";
      break;
    case 135:
      result = "SET_CARRIER_RESTRICTIONS";
      break;
    case 136:
      result = "GET_CARRIER_RESTRICTIONS";
      break;
    case 137:
      result = "SIM_GET_ATR";
      break;
    case 138:
      result = "CAF_SIM_OPEN_CHANNEL_WITH_P2";
      break;
    case 139:
      result = "RIL_REQUEST_GET_ADN_RECORD";
      break;
    case 140:
      result = "RIL_REQUEST_UPDATE_ADN_RECORD";
      break;
    default:
      switch ( (unsigned int)"GET_SIM_STATUS" )
      {
        case 0x3E8u:
          return "UNSOL_RESPONSE_RADIO_STATE_CHANGED";
        case 0x3E9u:
          return "UNSOL_RESPONSE_CALL_STATE_CHANGED";
        case 0x3EAu:
          return "UNSOL_RESPONSE_VOICE_NETWORK_STATE_CHANGED";
        case 0x3EBu:
          return "UNSOL_RESPONSE_NEW_SMS";
        case 0x3ECu:
          return "UNSOL_RESPONSE_NEW_SMS_STATUS_REPORT";
        case 0x3EDu:
          return "UNSOL_RESPONSE_NEW_SMS_ON_SIM";
        case 0x3EEu:
          return "UNSOL_ON_USSD";
        case 0x3EFu:
          return "UNSOL_ON_USSD_REQUEST(obsolete)";
        case 0x3F0u:
          return "UNSOL_NITZ_TIME_RECEIVED";
        case 0x3F1u:
          return "UNSOL_SIGNAL_STRENGTH";
        case 0x3F2u:
          return "UNSOL_DATA_CALL_LIST_CHANGED";
        case 0x3F3u:
          return "UNSOL_SUPP_SVC_NOTIFICATION";
        case 0x3F4u:
          return "UNSOL_STK_SESSION_END";
        case 0x3F5u:
          return "UNSOL_STK_PROACTIVE_COMMAND";
        case 0x3F6u:
          return "UNSOL_STK_EVENT_NOTIFY";
        case 0x3F7u:
          return "UNSOL_STK_CALL_SETUP";
        case 0x3F8u:
          return "UNSOL_SIM_SMS_STORAGE_FUL";
        case 0x3F9u:
          return "UNSOL_SIM_REFRESH";
        case 0x3FAu:
          return "UNSOL_CALL_RING";
        case 0x3FBu:
          return "UNSOL_RESPONSE_SIM_STATUS_CHANGED";
        case 0x3FCu:
          return "UNSOL_NEW_CDMA_SMS";
        case 0x3FDu:
          return "UNSOL_NEW_BROADCAST_SMS";
        case 0x3FEu:
          return "UNSOL_CDMA_RUIM_SMS_STORAGE_FULL";
        case 0x3FFu:
          return "UNSOL_RESTRICTED_STATE_CHANGED";
        case 0x400u:
          return "UNSOL_ENTER_EMERGENCY_CALLBACK_MODE";
        case 0x401u:
          return "UNSOL_CDMA_CALL_WAITING";
        case 0x402u:
          return "UNSOL_CDMA_OTA_PROVISION_STATUS";
        case 0x403u:
          return "UNSOL_CDMA_INFO_REC";
        case 0x404u:
          return "UNSOL_OEM_HOOK_RAW";
        case 0x405u:
          return "UNSOL_RINGBACK_TONE";
        case 0x406u:
          return "UNSOL_RESEND_INCALL_MUTE";
        case 0x407u:
          return "UNSOL_CDMA_SUBSCRIPTION_SOURCE_CHANGED";
        case 0x408u:
          return "UNSOL_CDMA_PRL_CHANGED";
        case 0x409u:
          return "UNSOL_EXIT_EMERGENCY_CALLBACK_MODE";
        case 0x40Au:
          return "UNSOL_RIL_CONNECTED";
        case 0x40Bu:
          return "UNSOL_VOICE_RADIO_TECH_CHANGED";
        case 0x40Cu:
          return "UNSOL_CELL_INFO_LIST";
        case 0x40Du:
          return "RESPONSE_IMS_NETWORK_STATE_CHANGED";
        case 0x40Eu:
          return "UNSOL_UICC_SUBSCRIPTION_STATUS_CHANGED";
        case 0x40Fu:
          return "UNSOL_SRVCC_STATE_NOTIFY";
        case 0x410u:
          return "HARDWARE_CONFIG_CHANGED";
        case 0x411u:
          return "UNSOL_DC_RT_INFO_CHANGED";
        case 0x412u:
          return "RIL_UNSOL_RADIO_CAPABILITY";
        case 0x413u:
        case 0x414u:
        case 0x415u:
          goto LABEL_7;
        case 0x416u:
          return "RIL_UNSOL_PCO_DATA";
        case 0x417u:
          return "RIL_UNSOL_RESPONSE_ADN_INIT_DONE";
        case 0x418u:
          return "RIL_UNSOL_RESPONSE_ADN_RECORDS";
        default:
          if ( "GET_SIM_STATUS" != (char *)&stru_320 )
            goto LABEL_7;
          result = "RIL_RESPONSE_ACKNOWLEDGEMENT";
          break;
      }
      break;
  }
  return result;
}
// 320: using guessed type Elf32_Sym;

//----- (00005CE4) --------------------------------------------------------
int sub_5CE4()
{
  signed int v0; // r4
  int v1; // r0

  if ( android::s_callbacks < 13 )
    return j_acquire_wake_lock(1, (int)"radio-interface");
  pthread_mutex_lock((pthread_mutex_t *)&unk_167DC);
  v0 = 1;
  acquire_wake_lock(1, "radio-interface");
  v1 = RIL_requestTimedCallback_0((int)&loc_6140 + 1, 0, (__int64 *)&unk_13864);
  if ( v1 )
  {
    if ( android::s_wakelock_count + 1 > android::s_wakelock_count )
      v0 = 0;
    if ( v0 )
      abort();
    ++android::s_wakelock_count;
    if ( dword_16798 )
      *(_DWORD *)(dword_16798 + 4) = 1;
    dword_16798 = v1;
  }
  else
  {
    release_wake_lock("radio-interface");
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_167DC);
}
// 3D2C: using guessed type int __fastcall acquire_wake_lock(_DWORD, _DWORD);
// 3D38: using guessed type int __fastcall release_wake_lock(_DWORD);
// 166D8: using guessed type int android::s_callbacks;
// 166F0: using guessed type int android::s_wakelock_count;
// 16798: using guessed type int dword_16798;

//----- (00005D9C) --------------------------------------------------------
int __fastcall RIL_onUnsolicitedResponse(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r6
  int v5; // r11
  android *v6; // r0
  int v7; // r5
  bool v8; // zf
  signed int v9; // r10
  int v10; // r1
  __int64 v11; // r8
  bool v12; // zf
  int v13; // r1
  int v14; // r1
  int v15; // r5
  int v16; // r6
  int v17; // r0
  int v18; // r6
  unsigned int v19; // r0
  signed int v20; // r0
  size_t v21; // r0
  int v22; // r5
  int v23; // r6
  int v24; // r0
  int result; // r0
  char v26; // [sp+4h] [bp-5Ch]
  int v27; // [sp+38h] [bp-28h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !byte_16704 )
  {
    _android_log_buf_print(1, 5, "RILC", "RIL_onUnsolicitedResponse called before RIL_register");
    goto LABEL_52;
  }
  v6 = (android *)(&dword_0 + 1);
  if ( !__OFSUB__(v3, 1000) )
    v6 = 0;
  if ( v6 )
LABEL_53:
    abort();
  v7 = v3 - 1000;
  if ( (unsigned int)(v3 - 1000) >= 0x31 )
  {
    _android_log_buf_print(1, 6, "RILC", "unsupported unsolicited response code %d", v3);
    goto LABEL_52;
  }
  v8 = v7 == 7;
  v9 = 0;
  if ( v7 != 7 )
    v8 = v7 == 9;
  if ( !v8 )
  {
    v6 = (android *)sub_5CE4();
    v9 = 1;
  }
  if ( v3 == 1008 )
  {
    LODWORD(v11) = android::elapsedRealtime(v6);
    HIDWORD(v11) = v10;
  }
  else
  {
    v11 = 0LL;
  }
  android::Parcel::Parcel((android::Parcel *)&v26);
  if ( android::s_callbacks < 13 )
    goto LABEL_56;
  v12 = v7 == 7;
  if ( v7 != 7 )
    v12 = v7 == 9;
  if ( v12 )
LABEL_56:
    v13 = 1;
  else
    v13 = 4;
  android::Parcel::writeInt32((android::Parcel *)&v26, v13);
  android::Parcel::writeInt32((android::Parcel *)&v26, v3);
  if ( ((int (__fastcall *)(char *, int, int))*(&off_1589C + 3 * v7 + 1))(&v26, v4, v5) )
    goto LABEL_49;
  if ( v3 == 1008 )
  {
    android::Parcel::writeInt64((android::Parcel *)&v26, v11);
  }
  else if ( v3 == 1000 )
  {
    v14 = dword_166E0();
    v15 = v14 - 2;
    if ( (unsigned int)(v14 - 2) <= 7 )
    {
      v16 = dword_13890[v15];
      if ( v16 != android::voiceRadioTech )
      {
        android::voiceRadioTech = dword_13890[v15];
        j_RIL_onUnsolicitedResponse(1035, (int)&android::voiceRadioTech, 4);
      }
      if ( (unsigned int)(v16 - 4) <= 9
        && (0x31Fu >> (v16 - 4)) & 1
        && dword_13870[v15] != android::cdmaSubscriptionSource )
      {
        android::cdmaSubscriptionSource = dword_13870[v15];
        j_RIL_onUnsolicitedResponse(1031, (int)&android::cdmaSubscriptionSource, 4);
      }
      if ( dword_138B0[v15] != android::simRuimStatus )
      {
        android::simRuimStatus = dword_138B0[v15];
        j_RIL_onUnsolicitedResponse(1019, 0, 0);
      }
      v14 = 10;
    }
    android::Parcel::writeInt32((android::Parcel *)&v26, v14);
  }
  if ( android::s_callbacks <= 12 && v9 == 1 )
  {
    v17 = RIL_requestTimedCallback_0((int)&loc_6140 + 1, 0, (__int64 *)&unk_13864);
    if ( !v17 )
      goto LABEL_49;
    if ( dword_16798 )
      *(_DWORD *)(dword_16798 + 4) = 1;
    dword_16798 = v17;
  }
  v18 = android::Parcel::data((android::Parcel *)&v26);
  v19 = android::Parcel::dataSize((android::Parcel *)&v26);
  v20 = sub_A7F8(v18, v19);
  if ( v3 != 1008 || !v20 )
    goto LABEL_51;
  if ( dword_1679C )
  {
    free((void *)dword_1679C);
    dword_1679C = 0;
  }
  v21 = android::Parcel::dataSize((android::Parcel *)&v26);
  dword_1679C = (int)calloc(v21, 1u);
  if ( !dword_1679C )
  {
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed in RIL_onUnsolicitedResponse");
LABEL_49:
    if ( v9 == 1 )
      sub_6190();
    goto LABEL_51;
  }
  dword_167A0 = android::Parcel::dataSize((android::Parcel *)&v26);
  v22 = dword_1679C;
  v23 = android::Parcel::data((android::Parcel *)&v26);
  v24 = android::Parcel::dataSize((android::Parcel *)&v26);
  _aeabi_memcpy(v22, v23, v24);
LABEL_51:
  android::Parcel::~Parcel((android::Parcel *)&v26);
LABEL_52:
  result = _stack_chk_guard - v27;
  if ( _stack_chk_guard != v27 )
    goto LABEL_53;
  return result;
}
// 0: using guessed type int dword_0;
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3D5C: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);
// 1589C: using guessed type void *off_1589C;
// 1600C: using guessed type int android::voiceRadioTech;
// 16010: using guessed type int android::cdmaSubscriptionSource;
// 16014: using guessed type int android::simRuimStatus;
// 166D8: using guessed type int android::s_callbacks;
// 166E0: using guessed type int (*dword_166E0)(void);
// 16704: using guessed type char byte_16704;
// 16798: using guessed type int dword_16798;
// 1679C: using guessed type int dword_1679C;
// 167A0: using guessed type int dword_167A0;

//----- (000060A8) --------------------------------------------------------
int __fastcall RIL_requestTimedCallback_0(int a1, int a2, __int64 *a3)
{
  int v3; // r7
  int v4; // r6
  __int64 *v5; // r5
  _DWORD *v6; // r0
  int v7; // r4
  __int64 v8; // r0
  int result; // r0
  __int64 v10; // [sp+8h] [bp-20h]
  int v11; // [sp+10h] [bp-18h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = calloc(1u, 0x30u);
  v7 = (int)v6;
  if ( v6 )
  {
    *v6 = v3;
    v6[1] = v4;
    if ( v5 )
      v8 = *v5;
    else
      v8 = 0LL;
    v10 = v8;
    ril_event_set(v7 + 8, -1, 0, (int)sub_B3E0, v7);
    ril_timer_add((int **)(v7 + 8), &v10);
    sub_A7B4();
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed in internalRequestTimedCallback");
  }
  result = _stack_chk_guard - v11;
  if ( _stack_chk_guard == v11 )
    result = v7;
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00006190) --------------------------------------------------------
int sub_6190()
{
  signed int v0; // r1

  if ( android::s_callbacks < 13 )
    return j_release_wake_lock((int)"radio-interface");
  pthread_mutex_lock((pthread_mutex_t *)&unk_167DC);
  if ( android::s_wakelock_count < 2 )
  {
    android::s_wakelock_count = 0;
    release_wake_lock("radio-interface");
    if ( dword_16798 )
      *(_DWORD *)(dword_16798 + 4) = 1;
  }
  else
  {
    v0 = 1;
    if ( !__OFSUB__(android::s_wakelock_count, 1) )
      v0 = 0;
    if ( v0 )
      abort();
    --android::s_wakelock_count;
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_167DC);
}
// 3D38: using guessed type int __fastcall release_wake_lock(_DWORD);
// 166D8: using guessed type int android::s_callbacks;
// 166F0: using guessed type int android::s_wakelock_count;
// 16798: using guessed type int dword_16798;

//----- (0000622C) --------------------------------------------------------
const char *__fastcall failCauseToString(int a1)
{
  int v1; // r1
  const char *result; // r0

  v1 = a1;
  result = "E_SUCCESS";
  switch ( v1 )
  {
    case 0:
      return result;
    case 1:
      result = "E_RADIO_NOT_AVAILABLE";
      break;
    case 2:
      result = "E_GENERIC_FAILURE";
      break;
    case 3:
      result = "E_PASSWORD_INCORRECT";
      break;
    case 4:
      result = "E_SIM_PIN2";
      break;
    case 5:
      result = "E_SIM_PUK2";
      break;
    case 6:
      result = "E_REQUEST_NOT_SUPPORTED";
      break;
    case 7:
      result = "E_CANCELLED";
      break;
    case 8:
      result = "E_OP_NOT_ALLOWED_DURING_VOICE_CALL";
      break;
    case 9:
      result = "E_OP_NOT_ALLOWED_BEFORE_REG_TO_NW";
      break;
    case 10:
      result = "E_SMS_SEND_FAIL_RETRY";
      break;
    case 11:
      result = "E_SIM_ABSENT";
      break;
    case 12:
    case 13:
    case 28:
    case 29:
    case 30:
    case 31:
    case 32:
    case 33:
    case 34:
    case 35:
def_62D0:
      result = "<unknown error>";
      break;
    case 14:
      result = "E_FDN_CHECK_FAILURE";
      break;
    case 15:
      result = "E_ILLEGAL_SIM_OR_ME";
      break;
    case 16:
      result = "E_MISSING_RESOURCE";
      break;
    case 17:
      result = "E_NO_SUCH_ELEMENT";
      break;
    case 18:
      result = "E_DIAL_MODIFIED_TO_USSD";
      break;
    case 19:
      result = "E_DIAL_MODIFIED_TO_SS";
      break;
    case 20:
      result = "E_DIAL_MODIFIED_TO_DIAL";
      break;
    case 21:
      result = "E_USSD_MODIFIED_TO_DIAL";
      break;
    case 22:
      result = "E_USSD_MODIFIED_TO_SS";
      break;
    case 23:
      result = "E_USSD_MODIFIED_TO_USSD";
      break;
    case 24:
      result = "E_SS_MODIFIED_TO_DIAL";
      break;
    case 25:
      result = "E_SS_MODIFIED_TO_USSD";
      break;
    case 26:
      result = "E_SUBSCRIPTION_NOT_SUPPORTED";
      break;
    case 27:
      result = "E_SS_MODIFIED_TO_SS";
      break;
    case 36:
      result = "E_LCE_NOT_SUPPORTED";
      break;
    case 37:
      result = "E_NO_MEMORY";
      break;
    case 38:
      result = "E_INTERNAL_ERR";
      break;
    case 39:
      result = "E_SYSTEM_ERR";
      break;
    case 40:
      result = "E_MODEM_ERR";
      break;
    case 41:
      result = "E_INVALID_STATE";
      break;
    case 42:
      result = "E_NO_RESOURCES";
      break;
    case 43:
      result = "E_SIM_ERR";
      break;
    case 44:
      result = "E_INVALID_ARGUMENTS";
      break;
    case 45:
      result = "E_INVALID_SIM_STATE";
      break;
    case 46:
      result = "E_INVALID_MODEM_STATE";
      break;
    case 47:
      result = "E_INVALID_CALL_ID";
      break;
    case 48:
      result = "E_NO_SMS_TO_ACK";
      break;
    case 49:
      result = "E_NETWORK_ERR";
      break;
    case 50:
      result = "E_REQUEST_RATE_LIMITED";
      break;
    case 51:
      result = "E_SIM_BUSY";
      break;
    case 52:
      result = "E_SIM_FULL";
      break;
    case 53:
      result = "E_NETWORK_REJECT";
      break;
    case 54:
      result = "E_OPERATION_NOT_ALLOWED";
      break;
    case 55:
    case 56:
      result = "E_INVALID_SMS_FORMAT";
      break;
    case 57:
      result = "E_ENCODING_ERR";
      break;
    case 58:
      result = "E_INVALID_SMSC_ADDRESS";
      break;
    case 59:
      result = "E_NO_SUCH_ENTRY";
      break;
    case 60:
      result = "E_NETWORK_NOT_READY";
      break;
    case 61:
      result = "E_NOT_PROVISIONED";
      break;
    case 62:
      result = "E_NO_SUBSCRIPTION";
      break;
    case 63:
      result = "E_NO_NETWORK_FOUND";
      break;
    case 64:
      result = "E_DEVICE_IN_USE";
      break;
    case 65:
      result = "E_ABORTED";
      break;
    default:
      switch ( v1 )
      {
        case 501:
          result = "E_OEM_ERROR_1";
          break;
        case 502:
          result = "E_OEM_ERROR_2";
          break;
        case 503:
          result = "E_OEM_ERROR_3";
          break;
        case 504:
          result = "E_OEM_ERROR_4";
          break;
        case 505:
          result = "E_OEM_ERROR_5";
          break;
        case 506:
          result = "E_OEM_ERROR_6";
          break;
        case 507:
          result = "E_OEM_ERROR_7";
          break;
        case 508:
          result = "E_OEM_ERROR_8";
          break;
        case 509:
          result = "E_OEM_ERROR_9";
          break;
        case 510:
          result = "E_OEM_ERROR_10";
          break;
        case 511:
          result = "E_OEM_ERROR_11";
          break;
        case 512:
          result = "E_OEM_ERROR_12";
          break;
        case 513:
          result = "E_OEM_ERROR_13";
          break;
        case 514:
          result = "E_OEM_ERROR_14";
          break;
        case 515:
          result = "E_OEM_ERROR_15";
          break;
        case 516:
          result = "E_OEM_ERROR_16";
          break;
        case 517:
          result = "E_OEM_ERROR_17";
          break;
        case 518:
          result = "E_OEM_ERROR_18";
          break;
        case 519:
          result = "E_OEM_ERROR_19";
          break;
        case 520:
          result = "E_OEM_ERROR_20";
          break;
        case 521:
          result = "E_OEM_ERROR_21";
          break;
        case 522:
          result = "E_OEM_ERROR_22";
          break;
        case 523:
          result = "E_OEM_ERROR_23";
          break;
        case 524:
          result = "E_OEM_ERROR_24";
          break;
        case 525:
          result = "E_OEM_ERROR_25";
          break;
        default:
          goto def_62D0;
      }
      break;
  }
  return result;
}

//----- (00006624) --------------------------------------------------------
const char *__fastcall radioStateToString(unsigned int a1)
{
  const char *result; // r0

  if ( a1 > 0xA )
    result = "<unknown state>";
  else
    result = off_15AE8[a1];
  return result;
}
// 15AE8: using guessed type char *off_15AE8[17];

//----- (00006640) --------------------------------------------------------
const char *__fastcall callStateToString(unsigned int a1)
{
  const char *result; // r0

  if ( a1 > 5 )
    result = "<unknown state>";
  else
    result = off_15B14[a1];
  return result;
}
// 15B14: using guessed type char *off_15B14[6];

//----- (0000665C) --------------------------------------------------------
const char *__fastcall rilSocketIdToString(int a1)
{
  const char *v1; // r1

  v1 = "RIL_SOCKET_1";
  if ( a1 )
    v1 = "not a valid RIL";
  return v1;
}

//----- (00006678) --------------------------------------------------------
int __fastcall rilEventAddWakeup_helper(int a1)
{
  ril_event_add(a1);
  return sub_A7B4();
}

//----- (0000668C) --------------------------------------------------------
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3)
{
  _DWORD *v3; // r8
  const char *v4; // r7
  RilSocket *v5; // r4
  int v6; // r0
  RilSocket **v7; // r6
  char *v8; // r0
  char *v9; // r5
  struct passwd *v10; // r0
  const char *v11; // r9
  const char *v12; // r3
  char *v13; // r0
  int result; // r0
  int v15; // r0
  int v16; // r5
  int v17; // r7
  int v18; // r0
  char *v19; // r0
  const char *v20; // r1
  int v21; // r0
  int v22; // r2
  int v23; // r1
  int v24; // r3
  const char *v25; // r1
  socklen_t *optlen; // [sp+0h] [bp-B0h]
  socklen_t v27; // [sp+8h] [bp-A8h]
  char optval; // [sp+Ch] [bp-A4h]
  __uid_t uid; // [sp+10h] [bp-A0h]
  socklen_t addr_len; // [sp+18h] [bp-98h]
  int v31; // [sp+1Ch] [bp-94h]
  struct sockaddr addr; // [sp+20h] [bp-90h]
  int v33; // [sp+90h] [bp-20h]

  v3 = a3;
  v4 = "bluetooth";
  if ( *((_DWORD *)a3 + 8) == 1 )
    v5 = (RilSocket *)*((_DWORD *)a3 + 9);
  else
    v5 = 0;
  addr_len = 110;
  v27 = 12;
  if ( !v5 )
    v4 = "radio";
  v6 = accept(a1, &addr, &addr_len);
  v7 = (RilSocket **)v6;
  v8 = (char *)_errno(v6);
  v9 = v8;
  if ( (signed int)v7 > -1 )
  {
    *(_DWORD *)v8 = 0;
    if ( getsockopt((int)v7, 1, 17, &optval, &v27) || (signed int)v27 < 1 )
    {
      _android_log_buf_print(1, 3, "RILC", "Error on getsockopt() errno: %d", *(_DWORD *)v9);
    }
    else
    {
      *(_DWORD *)v9 = 0;
      v10 = getpwuid(uid);
      if ( v10 )
      {
        v11 = v10->pw_name;
        if ( !strcmp(v10->pw_name, v4) )
          goto LABEL_24;
        optlen = (socklen_t *)v11;
        v12 = "RILD can't accept socket from process %s";
      }
      else
      {
        v12 = "Error on getpwuid() errno: %d";
        optlen = *(socklen_t **)v9;
      }
      _android_log_buf_print(1, 6, "RILC", v12, optlen);
    }
    _android_log_buf_print(1, 6, "RILC", "RILD must accept socket from %s", v4);
    close((int)v7);
    if ( v5 )
    {
      (*(void (__fastcall **)(RilSocket *))(*(_DWORD *)v5 + 8))(v5);
      goto LABEL_19;
    }
    sub_6AAC();
LABEL_21:
    v13 = (char *)v3[5];
    goto LABEL_22;
  }
  _android_log_buf_print(1, 6, "RILC", "Error on accept() errno:%d", *(_DWORD *)v8);
  if ( !v5 )
    goto LABEL_21;
LABEL_19:
  v13 = RilSocket::getListenEvent(v5);
LABEL_22:
  ril_event_add((int)v13);
  sub_A7B4();
  while ( 1 )
  {
    result = _stack_chk_guard - v33;
    if ( _stack_chk_guard == v33 )
      break;
LABEL_24:
    if ( fcntl((int)v7, 4, 2048) <= -1 )
      _android_log_buf_print(1, 6, "RILC", "Error setting O_NONBLOCK errno:%d", *(_DWORD *)v9);
    if ( v5 )
    {
      _android_log_buf_print(1, 4, "RILC", "libril: new connection");
      RilSocket::setCommandFd(v5, (int)v7);
      v15 = RilSocket::getCommandFd(v5);
      v16 = record_stream_new(v15, 0x2000);
      v7 = (RilSocket **)operator new(8u);
      v7[1] = (RilSocket *)v16;
      *v7 = v5;
      v9 = RilSocket::getCallbackEvent(v5);
      v17 = RilSocket::getCommandFd(v5);
      v18 = RilSocket::getCommandCb(v5);
      ril_event_set((int)v9, v17, 1, v18, (int)v7);
      v19 = RilSocket::getCallbackEvent(v5);
      ril_event_add((int)v19);
      sub_A7B4();
      RilSocket::onNewCommandConnect(v5);
    }
    else
    {
      v20 = "not a valid RIL";
      if ( !*v3 )
        v20 = "RIL_SOCKET_1";
      _android_log_buf_print(1, 4, "RILC", "libril: new connection to %s", v20);
      v3[2] = v7;
      v21 = record_stream_new(v7, 0x2000);
      v22 = v3[4];
      v23 = v3[2];
      v24 = v3[6];
      v3[7] = v21;
      ril_event_set(v22, v23, 1, v24, (int)v3);
      ril_event_add(v3[4]);
      sub_A7B4();
      v31 = android::s_callbacks;
      j_RIL_onUnsolicitedResponse(1034, (int)&v31, 4);
      v5 = 0;
      j_RIL_onUnsolicitedResponse(1000, 0, 0);
      if ( dword_1679C )
      {
        sub_A7F8(dword_1679C, dword_167A0);
        v9 = (char *)&dword_1679C;
        free((void *)dword_1679C);
        dword_1679C = 0;
      }
      if ( dword_166EC )
      {
        v5 = (RilSocket *)dword_166EC();
        _android_log_buf_print(1, 4, "RILC", "RIL Daemon version: %s\n", v5);
        v25 = (const char *)v5;
      }
      else
      {
        _android_log_buf_print(1, 4, "RILC", "RIL Daemon version: unavailable\n");
        v25 = "unavailable";
      }
      property_set("gsm.version.ril-impl", v25);
    }
  }
  return result;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3DBC: using guessed type int __fastcall record_stream_new(_DWORD, _DWORD);
// 3DF8: using guessed type int __fastcall property_set(_DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;
// 166EC: using guessed type int (*dword_166EC)(void);
// 1679C: using guessed type int dword_1679C;
// 167A0: using guessed type int dword_167A0;

//----- (000069B4) --------------------------------------------------------
signed int __fastcall sub_69B4(int a1, int a2, unsigned int a3)
{
  unsigned int v3; // r9
  int v4; // r8
  int v5; // r10
  unsigned int v6; // r4
  signed int v7; // r0
  int v8; // r0
  _DWORD *v9; // r5
  bool v10; // zf
  unsigned int v11; // r0
  signed int v12; // r1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0;
  while ( 1 )
  {
    if ( v6 >= v3 )
      return 0;
    v7 = 1;
    if ( v3 >= v6 )
      v7 = 0;
    if ( v7 )
LABEL_16:
      abort();
    v8 = _write_chk(v5, v4 + v6, v3 - v6, -1);
    if ( v8 <= -1 )
      break;
LABEL_13:
    v11 = v8 + v6;
    v12 = 1;
    if ( v11 >= v6 )
      v12 = 0;
    v6 = v11;
    if ( v12 )
      goto LABEL_16;
  }
  v9 = (_DWORD *)_errno(v8);
  while ( 1 )
  {
    v10 = *v9 == 4;
    if ( *v9 != 4 )
      v10 = *v9 == 11;
    if ( !v10 )
      break;
    v8 = _write_chk(v5, v4 + v6, v3 - v6, -1);
    if ( v8 >= 0 )
      goto LABEL_13;
  }
  _android_log_buf_print(1, 6, "RILC", "RIL Response: unexpected error on write errno:%d", *v9);
  close(v5);
  return -1;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3E04: using guessed type int __fastcall _write_chk(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00006A54) --------------------------------------------------------
int sub_6A54()
{
  int v0; // r0
  char v2; // [sp+4h] [bp-24h]
  int v3; // [sp+14h] [bp-14h]

  do
  {
    do
      v0 = _read_chk(dword_167A4, &v2, 16, 16);
    while ( v0 > 0 );
  }
  while ( v0 <= -1 && *(_DWORD *)_errno(v0) == 4 );
  return _stack_chk_guard - v3;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3E10: using guessed type int __fastcall _read_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 167A4: using guessed type int dword_167A4;

//----- (00006AAC) --------------------------------------------------------
int sub_6AAC()
{
  int v0; // r0
  int v1; // r2

  pthread_mutex_lock((pthread_mutex_t *)&unk_167D0);
  v0 = dword_167D4;
  if ( dword_167D4 )
  {
    do
    {
      v1 = *(_DWORD *)(v0 + 8);
      *(_BYTE *)(v0 + 12) = 1;
      v0 = v1;
    }
    while ( v1 );
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_167D0);
}
// 167D4: using guessed type int dword_167D4;

//----- (00006AE4) --------------------------------------------------------
int __fastcall sub_6AE4(int a1, int a2)
{
  return dword_166DC(**(_DWORD **)(a2 + 4), 0, 0);
}
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00006B00) --------------------------------------------------------
int __fastcall sub_6B00(android::Parcel *this, int *a2, unsigned int a3)
{
  android::Parcel *v3; // r5
  int *v4; // r4
  const char *v5; // r3
  char v7; // [sp+8h] [bp-70h]

  v3 = this;
  v4 = a2;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_4:
    _android_log_buf_print(1, 6, "RILC", v5);
    return -1;
  }
  if ( android::s_callbacks > 12 )
  {
    if ( a3 != 412 * (a3 / 0x19C) )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_CardStatus_v6");
      property_get("ro.debuggable", &v7, "0");
      if ( strcmp(&v7, "1") )
        return -1;
    }
  }
  else
  {
    if ( a3 == 408 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(v3, v4[1]);
      android::Parcel::writeInt32(v3, v4[2]);
      android::Parcel::writeInt32(v3, v4[3]);
      sub_A040(v3, v4[4], (int)(v4 + 5));
      android::Parcel::writeInt32(v3, v4[101]);
      _android_log_buf_print(1, 3, "RILC", "FIH_QCRIL_UIM_HOTSWAP_PUK, SIM hotswap state: %d", v4[101]);
      return 0;
    }
    if ( a3 != 412 )
    {
      v5 = "responseSimStatus: A RilCardStatus_v6 or _v5 expected\n";
      goto LABEL_4;
    }
  }
  sub_9FD8(v3, v4);
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3E1C: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;

//----- (00006C40) --------------------------------------------------------
int __fastcall sub_6C40(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r7
  int *v3; // r9
  int v4; // r4
  const char *v5; // r0
  signed int v6; // r6
  signed int v7; // r0
  size_t v8; // r8
  _DWORD *v9; // r4
  int i; // r5
  int v11; // r0
  signed int v12; // r1
  int v13; // r6
  int v14; // r5
  int v15; // r0
  void *v16; // r0
  signed int v17; // r1
  int result; // r0
  const char *v19; // r0
  int v20; // [sp+4h] [bp-34h]
  size_t nmemb; // [sp+Ch] [bp-2Ch]
  unsigned int v22; // [sp+10h] [bp-28h]
  int v23; // [sp+14h] [bp-24h]

  v2 = this;
  v3 = a2;
  if ( android::Parcel::readInt32(this, (int *)&nmemb) )
  {
    v4 = *v3;
    v5 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v4, v5);
  }
  else
  {
    v6 = nmemb;
    if ( nmemb )
    {
      if ( (nmemb & 0x80000000) != 0 )
      {
        v8 = 0;
        v9 = 0;
      }
      else
      {
        v7 = (unsigned __int64)nmemb >> 30;
        v8 = 4 * nmemb;
        if ( !is_mul_ok(4u, nmemb) )
          v7 = 1;
        if ( v7 )
LABEL_29:
          abort();
        v9 = calloc(nmemb, 4u);
        if ( !v9 )
          goto LABEL_32;
        for ( i = 0; i < v6; ++i )
        {
          v11 = android::Parcel::readString16Inplace(v2, &v22);
          v9[i] = strndup16to8(v11, v22);
          v12 = 1;
          if ( i + 1 > i )
            v12 = 0;
          if ( v12 )
            goto LABEL_29;
          v6 = nmemb;
        }
      }
    }
    else
    {
      v9 = calloc(1u, 4u);
      if ( !v9 )
      {
        v19 = j_requestToString(*(_DWORD *)v3[1]);
        goto LABEL_34;
      }
      v8 = 0;
    }
    dword_166DC(*(_DWORD *)v3[1], v9, v8);
    if ( v9 )
    {
      v13 = 0;
      while ( v13 < (signed int)nmemb )
      {
        v14 = v9[v13];
        if ( v14 )
        {
          v15 = _strlen_chk(v9[v13], -1);
          _aeabi_memclr(v14, v15);
          v16 = (void *)v9[v13];
        }
        else
        {
          v16 = 0;
        }
        free(v16);
        v17 = 1;
        if ( v13 + 1 > v13 )
          v17 = 0;
        ++v13;
        if ( v17 )
          goto LABEL_29;
      }
      free(v9);
    }
  }
  while ( 1 )
  {
    result = _stack_chk_guard - v23;
    if ( _stack_chk_guard == v23 )
      break;
LABEL_32:
    v19 = j_requestToString(*(_DWORD *)v3[1]);
LABEL_34:
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v19, v20);
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00006DB8) --------------------------------------------------------
int __fastcall sub_6DB8(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  android::Parcel *v4; // r5
  const char *v5; // r3
  int v7; // r6
  int v8; // r7
  signed int v9; // r1
  int v10; // [sp+0h] [bp-20h]
  signed int v11; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v5, v10, v11);
    return -1;
  }
  if ( a3 & 3 )
  {
    v10 = a3;
    v11 = 4;
    v5 = "responseInts: invalid response length %d expected multiple of %d\n";
    goto LABEL_6;
  }
  v7 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  v8 = 0;
  while ( v8 < v7 )
  {
    android::Parcel::writeInt32(v4, *(_DWORD *)(v3 + 4 * v8));
    v9 = 1;
    if ( v8 + 1 > v8 )
      v9 = 0;
    ++v8;
    if ( v9 )
      abort();
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00006E3C) --------------------------------------------------------
int __fastcall sub_6E3C(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  android::Parcel *v4; // r5
  const char *v5; // r3
  int v7; // r9
  int v8; // r7
  int v9; // r6
  int v10; // r6
  signed int v11; // r1
  int v12; // [sp+0h] [bp-28h]
  signed int v13; // [sp+4h] [bp-24h]

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v5, v12, v13);
    return -1;
  }
  if ( a3 & 3 )
  {
    v12 = a3;
    v13 = 4;
    v5 = "responseCallList: invalid response length %d expected multiple of %d\n";
    goto LABEL_6;
  }
  v7 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  v8 = 0;
  while ( v8 < v7 )
  {
    v9 = *(_DWORD *)(v3 + 4 * v8);
    android::Parcel::writeInt32(v4, *(_DWORD *)v9);
    android::Parcel::writeInt32(v4, *(_DWORD *)(v9 + 4));
    android::Parcel::writeInt32(v4, *(_DWORD *)(v9 + 8));
    android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v9 + 12));
    android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v9 + 13));
    android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v9 + 14));
    android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v9 + 15));
    android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v9 + 16));
    sub_A0F8((int)v4, *(_DWORD *)(v9 + 20));
    android::Parcel::writeInt32(v4, *(_DWORD *)(v9 + 24));
    sub_A0F8((int)v4, *(_DWORD *)(v9 + 28));
    android::Parcel::writeInt32(v4, *(_DWORD *)(v9 + 32));
    if ( android::s_callbacks >= 3 && (v10 = *(_DWORD *)(v9 + 36)) != 0 && *(_DWORD *)(v10 + 12) )
    {
      android::Parcel::writeInt32(v4, 1);
      android::Parcel::writeInt32(v4, *(_DWORD *)v10);
      android::Parcel::writeInt32(v4, *(_DWORD *)(v10 + 4));
      android::Parcel::writeInt32(v4, *(_DWORD *)(v10 + 8));
      android::Parcel::write(v4, *(const void **)(v10 + 12), *(_DWORD *)(v10 + 8));
    }
    else
    {
      android::Parcel::writeInt32(v4, 0);
    }
    v11 = 1;
    if ( v8 + 1 > v8 )
      v11 = 0;
    ++v8;
    if ( v11 )
      abort();
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 166D8: using guessed type int android::s_callbacks;

//----- (00006F70) --------------------------------------------------------
int __fastcall sub_6F70(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r0
  int v5; // r6
  int v6; // r0
  signed int v7; // r2
  int v8; // r5
  const char *v9; // r0
  unsigned int v10; // r0
  unsigned int v11; // r1
  int v12; // r4
  void *v13; // r0
  int v14; // r0
  int v16; // [sp+8h] [bp-40h]
  int v17; // [sp+Ch] [bp-3Ch]
  __int64 v18; // [sp+10h] [bp-38h]
  unsigned __int64 v19; // [sp+18h] [bp-30h]
  __int64 ptr; // [sp+20h] [bp-28h]
  __int64 *v21; // [sp+28h] [bp-20h]
  unsigned int v22; // [sp+2Ch] [bp-1Ch]
  int v23; // [sp+30h] [bp-18h]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchDial");
  ptr = 0LL;
  v21 = 0;
  v4 = android::Parcel::readString16Inplace(v2, &v22);
  v5 = strndup16to8(v4, v22);
  LODWORD(ptr) = v5;
  v6 = android::Parcel::readInt32(v2, &v17);
  HIDWORD(ptr) = v17;
  if ( v6 || !v5 )
    goto LABEL_8;
  if ( android::s_callbacks > 2 )
  {
    if ( !android::Parcel::readInt32(v2, &v16) )
    {
      if ( v16 )
      {
        v18 = 0LL;
        v19 = 0LL;
        android::Parcel::readInt32(v2, &v17);
        LODWORD(v18) = v17;
        android::Parcel::readInt32(v2, &v17);
        HIDWORD(v18) = v17;
        if ( android::Parcel::readInt32(v2, (int *)&v22) )
          goto LABEL_8;
        if ( v22 == -1 )
        {
          v11 = 0;
          v10 = 0;
          v22 = 0;
        }
        else
        {
          v10 = android::Parcel::readInplace(v2, v22);
          v11 = v22;
        }
        v21 = &v18;
        v19 = __PAIR__(v10, v11);
      }
      else
      {
        v21 = 0;
      }
      v7 = 12;
      goto LABEL_15;
    }
LABEL_8:
    v8 = *v3;
    v9 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v8, v9);
    return _stack_chk_guard - v23;
  }
  v7 = 8;
  v16 = 0;
LABEL_15:
  dword_166DC(*(_DWORD *)v3[1], &ptr, v7);
  v12 = ptr;
  v13 = 0;
  if ( (_DWORD)ptr )
  {
    v14 = _strlen_chk(ptr, -1);
    _aeabi_memclr(v12, v14);
    v13 = (void *)ptr;
  }
  free(v13);
  v18 = 0LL;
  ptr = 0LL;
  v19 = 0LL;
  v21 = 0;
  return _stack_chk_guard - v23;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (000070E0) --------------------------------------------------------
int sub_70E0()
{
  return 0;
}

//----- (000070E4) --------------------------------------------------------
int __fastcall sub_70E4(int a1, int a2)
{
  sub_A0F8(a1, a2);
  return 0;
}

//----- (000070F0) --------------------------------------------------------
int __fastcall sub_70F0(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r9
  signed int v4; // r6
  signed int v5; // r0
  size_t v6; // r8
  void *v7; // r7
  int i; // r4
  int v9; // r0
  signed int v10; // r1
  const char *v11; // r0
  int v12; // r4
  const char *v13; // r0
  int v15; // [sp+Ch] [bp-2Ch]
  size_t nmemb; // [sp+10h] [bp-28h]
  int v17; // [sp+14h] [bp-24h]

  v2 = this;
  v3 = a2;
  if ( android::Parcel::readInt32(this, (int *)&nmemb) || (v4 = nmemb, (signed int)nmemb < 1) )
  {
LABEL_18:
    v12 = *v3;
    v13 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v12, v13);
    return _stack_chk_guard - v17;
  }
  v5 = (unsigned __int64)nmemb >> 30;
  v6 = 4 * nmemb;
  if ( !is_mul_ok(4u, nmemb) )
    v5 = 1;
  if ( v5 )
LABEL_14:
    abort();
  v7 = calloc(nmemb, 4u);
  if ( v7 )
  {
    for ( i = 0; ; ++i )
    {
      if ( i >= v4 )
      {
        dword_166DC(*(_DWORD *)v3[1], v7, v6);
        free(v7);
        return _stack_chk_guard - v17;
      }
      v9 = android::Parcel::readInt32(v2, &v15);
      *((_DWORD *)v7 + i) = v15;
      if ( v9 )
        break;
      v10 = 1;
      if ( i + 1 > i )
        v10 = 0;
      if ( v10 )
        goto LABEL_14;
      v4 = nmemb;
    }
    free(v7);
    goto LABEL_18;
  }
  v11 = j_requestToString(*(_DWORD *)v3[1]);
  _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v11);
  return _stack_chk_guard - v17;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (000071F4) --------------------------------------------------------
int __fastcall sub_71F4(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v5; // r3
  int v7; // [sp+0h] [bp-18h]

  v3 = a2;
  v4 = this;
  if ( a2 || !a3 )
  {
    if ( a3 == 8 )
    {
      android::Parcel::writeInt32(this, *a2);
      sub_A0F8((int)v4, v3[1]);
      return 0;
    }
    if ( a3 == 4 )
    {
      android::Parcel::writeInt32(this, *a2);
      return 0;
    }
    v7 = a3;
    v5 = "responseFailCause: invalid response length %d expected an int or RIL_LastCallFailCauseInfo";
  }
  else
  {
    v5 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v5, v7);
  return -1;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007264) --------------------------------------------------------
signed int __fastcall sub_7264(android::Parcel *a1, int *a2, unsigned int a3)
{
  android::Parcel *v3; // r4
  int *v4; // r5
  unsigned int v5; // r6
  const char *v6; // r3
  int v7; // r1
  android::Parcel *v8; // r0
  char v10; // [sp+8h] [bp-70h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_13:
    _android_log_buf_print(1, 6, "RILC", v6);
    return -1;
  }
  if ( android::s_callbacks > 12 )
  {
    if ( a3 & 0x3F )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_SignalStrength_v10");
      property_get("ro.debuggable", &v10, "0");
      if ( strcmp(&v10, "1") )
        return -1;
    }
    sub_A144(v3, v4);
    sub_A184(v3, v4);
    android::Parcel::writeInt32(v3, v4[15]);
    android::Parcel::writeInt32(v3, v4[2]);
    v7 = v4[3];
    v8 = v3;
    goto LABEL_17;
  }
  if ( a3 < 0x24 )
  {
    v6 = "invalid response length";
    goto LABEL_13;
  }
  sub_A144(a1, a2);
  if ( v5 < 0x38 )
  {
    android::Parcel::writeInt32(v3, 99);
    android::Parcel::writeInt32(v3, 0x7FFFFFFF);
    android::Parcel::writeInt32(v3, 0x7FFFFFFF);
    goto LABEL_16;
  }
  sub_A184(v3, v4);
  android::Parcel::writeInt32(v3, 0x7FFFFFFF);
  if ( v5 < 0x40 )
  {
LABEL_16:
    android::Parcel::writeInt32(v3, 0x7FFFFFFF);
    android::Parcel::writeInt32(v3, 0x7FFFFFFF);
    v8 = v3;
    v7 = 0x7FFFFFFF;
LABEL_17:
    android::Parcel::writeInt32(v8, v7);
    return 0;
  }
  android::Parcel::writeInt32(v3, v4[15]);
  android::Parcel::writeInt32(v3, 0x7FFFFFFF);
  android::Parcel::writeInt32(v3, v4[2]);
  android::Parcel::writeInt32(v3, v4[3]);
  _android_log_buf_print(1, 6, "RILC", "FIH_QCRIL_3RP_GMON_PATCH, rssi = %d/ecio = %d", v4[2], v4[3]);
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3E1C: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;

//----- (000073EC) --------------------------------------------------------
int __fastcall sub_73EC(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r5
  android::Parcel *v4; // r4
  const char *v5; // r3
  int v6; // r5
  int v8; // r6
  int v9; // r7
  signed int v10; // r1
  int v11; // [sp+0h] [bp-20h]
  signed int v12; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v5, v11, v12);
    return -1;
  }
  if ( a3 & 3 )
  {
    v11 = a3;
    v12 = 4;
    v5 = "responseStrings: invalid response length %d expected multiple of %d\n";
    goto LABEL_6;
  }
  if ( a2 )
  {
    v8 = a3 >> 2;
    android::Parcel::writeInt32(this, a3 >> 2);
    v9 = 0;
    while ( v9 < v8 )
    {
      sub_A0F8((int)v4, *(_DWORD *)(v3 + 4 * v9));
      v10 = 1;
      if ( v9 + 1 > v9 )
        v10 = 0;
      ++v9;
      if ( v10 )
        abort();
    }
    v6 = 0;
  }
  else
  {
    v6 = 0;
    android::Parcel::writeInt32(this, 0);
  }
  return v6;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007480) --------------------------------------------------------
int __fastcall sub_7480(android::Parcel *a1, int a2)
{
  int v2; // r6
  int v3; // r0
  void *v4; // r4
  int v6; // [sp+0h] [bp-18h]
  int v7; // [sp+4h] [bp-14h]

  v2 = a2;
  v3 = android::Parcel::readString16Inplace(a1, (unsigned int *)&v6);
  v4 = (void *)strndup16to8(v3, v6);
  dword_166DC(**(_DWORD **)(v2 + 4), v4, 4);
  if ( v4 )
    _strlen_chk(v4, -1);
  free(v4);
  return _stack_chk_guard - v7;
}
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (000074E8) --------------------------------------------------------
int __fastcall sub_74E8(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 12 )
    {
      android::Parcel::writeInt32(this, *a2);
      sub_A0F8((int)v4, v3[1]);
      android::Parcel::writeInt32(v4, v3[2]);
      return 0;
    }
    v7 = a3;
    v8 = 12;
    v6 = "invalid response length %d expected %d";
  }
  else
  {
    v6 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007550) --------------------------------------------------------
int __fastcall sub_7550(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r8
  unsigned int v4; // r9
  int v5; // r6
  signed int v6; // r1
  int result; // r0
  int v8; // [sp+0h] [bp-58h]
  char v9; // [sp+4h] [bp-54h]
  int v10; // [sp+38h] [bp-20h]

  v2 = this;
  v3 = a2;
  v4 = android::Parcel::dataPosition(this);
  if ( android::Parcel::readInt32(v2) < 7 || android::s_callbacks > 3 )
  {
    android::Parcel::setDataPosition(v2, v4);
    result = _stack_chk_guard - v10;
    if ( _stack_chk_guard == v10 )
      result = sub_6C40(v2, v3);
  }
  else
  {
    android::Parcel::Parcel((android::Parcel *)&v9);
    v5 = 0;
    android::Parcel::appendFrom((android::Parcel *)&v9, v2, 0, v4);
    android::Parcel::writeInt32((android::Parcel *)&v9, 6);
    while ( v5 <= 5 )
    {
      android::Parcel::readString16((android::Parcel *)&v8);
      android::Parcel::writeString16((android::Parcel *)&v9, (const android::String16 *)&v8);
      android::String16::~String16((android::String16 *)&v8);
      v6 = 1;
      if ( v5 + 1 > v5 )
        v6 = 0;
      ++v5;
      if ( v6 )
        abort();
    }
    android::Parcel::setDataPosition((android::Parcel *)&v9, v4);
    sub_6C40((android::Parcel *)&v9, v3);
    android::Parcel::~Parcel((android::Parcel *)&v9);
    result = _stack_chk_guard - v10;
  }
  return result;
}
// 166D8: using guessed type int android::s_callbacks;

//----- (00007638) --------------------------------------------------------
int __fastcall sub_7638(android::Parcel *this, int a2, unsigned int a3)
{
  android::Parcel *v3; // r6
  int v4; // r5
  unsigned int v5; // r4

  v3 = this;
  v4 = a2;
  v5 = a3;
  if ( android::s_callbacks > 4 )
    return sub_7A54(this, a2, a3);
  android::Parcel::writeInt32(this, android::s_callbacks);
  return sub_73EC(v3, v4, v5);
}
// 166D8: using guessed type int android::s_callbacks;

//----- (00007674) --------------------------------------------------------
int __fastcall sub_7674(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r0
  int v5; // r6
  int v6; // r0
  int v7; // r0
  int v8; // r0
  int v9; // r5
  const char *v10; // r0
  signed int v11; // r2
  int v12; // r4
  int v13; // r0
  void *v14; // r4
  int v15; // r0
  void *v16; // r4
  int v17; // r0
  void *v18; // r4
  int v19; // r0
  int v21; // [sp+Ch] [bp-4h]
  double v22; // [sp+10h] [bp+0h]
  __int64 ptr; // [sp+18h] [bp+8h]
  double v24; // [sp+20h] [bp+10h]
  void *v25[2]; // [sp+28h] [bp+18h]
  void *v26; // [sp+30h] [bp+20h]
  unsigned int v27; // [sp+34h] [bp+24h]
  int v28; // [sp+38h] [bp+28h]

  v2 = this;
  v3 = a2;
  v22 = 0.0;
  ptr = 0LL;
  *(_QWORD *)v25 = 0LL;
  v24 = 0.0;
  android::Parcel::readInt32(this, &v21);
  LODWORD(v22) = v21;
  android::Parcel::readInt32(v2, &v21);
  HIDWORD(v22) = v21;
  v4 = android::Parcel::readString16Inplace(v2, &v27);
  LODWORD(ptr) = strndup16to8(v4, v27);
  android::Parcel::readInt32(v2, &v21);
  HIDWORD(ptr) = v21;
  android::Parcel::readInt32(v2, &v21);
  LODWORD(v24) = v21;
  v5 = android::Parcel::readInt32(v2, &v21);
  HIDWORD(v24) = v21;
  v6 = android::Parcel::readString16Inplace(v2, &v27);
  v25[0] = (void *)strndup16to8(v6, v27);
  v7 = android::Parcel::readString16Inplace(v2, &v27);
  v25[1] = (void *)strndup16to8(v7, v27);
  v8 = android::Parcel::readString16Inplace(v2, &v27);
  v26 = (void *)strndup16to8(v8, v27);
  if ( v5 )
  {
    v9 = *v3;
    v10 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v9, v10);
  }
  else
  {
    v11 = 36;
    if ( android::s_callbacks < 6 )
      v11 = 32;
    dword_166DC(*(_DWORD *)v3[1], &v22, v11);
    v12 = ptr;
    if ( (_DWORD)ptr )
    {
      v13 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v12, v13);
    }
    v14 = v25[0];
    if ( v25[0] )
    {
      v15 = _strlen_chk(v25[0], -1);
      _aeabi_memclr(v14, v15);
    }
    v16 = v25[1];
    if ( v25[1] )
    {
      v17 = _strlen_chk(v25[1], -1);
      _aeabi_memclr(v16, v17);
    }
    v18 = v26;
    if ( v26 )
    {
      v19 = _strlen_chk(v26, -1);
      _aeabi_memclr(v18, v19);
    }
    free((void *)ptr);
    free(v25[0]);
    free(v25[1]);
    free(v26);
    v22 = 0.0;
    ptr = 0LL;
    v24 = 0.0;
    *(_QWORD *)v25 = 0LL;
    v26 = 0;
  }
  return _stack_chk_guard - v28;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00007808) --------------------------------------------------------
int __fastcall sub_7808(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 12 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(v4, v3[1]);
      sub_A0F8((int)v4, v3[2]);
      return 0;
    }
    v7 = a3;
    v8 = 12;
    v6 = "invalid response length was %d expected %d";
  }
  else
  {
    v6 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007870) --------------------------------------------------------
int __fastcall sub_7870(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r8
  int v4; // r0
  _BYTE *v5; // r7
  int v6; // r0
  int v7; // r4
  const char *v8; // r0
  int v9; // r4
  int v10; // r0
  void *v11; // r0
  int v13; // [sp+Ch] [bp-3Ch]
  __int64 v14; // [sp+10h] [bp-38h]
  __int64 v15; // [sp+18h] [bp-30h]
  double v16; // [sp+20h] [bp-28h]
  unsigned int v17; // [sp+28h] [bp-20h]
  int v18; // [sp+2Ch] [bp-1Ch]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchCallForward");
  v14 = 0LL;
  v15 = 0LL;
  LODWORD(v16) = 0;
  android::Parcel::readInt32(v2, &v13);
  LODWORD(v14) = v13;
  android::Parcel::readInt32(v2, &v13);
  HIDWORD(v14) = v13;
  android::Parcel::readInt32(v2, &v13);
  LODWORD(v15) = v13;
  android::Parcel::readInt32(v2, &v13);
  HIDWORD(v15) = v13;
  v4 = android::Parcel::readString16Inplace(v2, &v17);
  v5 = (_BYTE *)strndup16to8(v4, v17);
  LODWORD(v16) = v5;
  v6 = android::Parcel::readInt32(v2, &v13);
  HIDWORD(v16) = v13;
  if ( v6 )
  {
    v7 = *v3;
    v8 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v7, v8);
  }
  else
  {
    if ( v5 && !*v5 )
      LODWORD(v16) = 0;
    dword_166DC(*(_DWORD *)v3[1], &v14, 24);
    v9 = LODWORD(v16);
    if ( LODWORD(v16) )
    {
      v10 = _strlen_chk(LODWORD(v16), -1);
      _aeabi_memclr(v9, v10);
      v11 = (void *)LODWORD(v16);
    }
    else
    {
      v11 = 0;
    }
    free(v11);
    v14 = 0LL;
    v15 = 0LL;
    v16 = 0.0;
  }
  return _stack_chk_guard - v18;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (000079A0) --------------------------------------------------------
int __fastcall sub_79A0(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  android::Parcel *v4; // r5
  const char *v5; // r3
  int v7; // r8
  int v8; // r7
  int *v9; // r6
  signed int v10; // r1
  int v11; // [sp+0h] [bp-20h]
  signed int v12; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v5, v11, v12);
    return -1;
  }
  if ( a3 & 3 )
  {
    v11 = a3;
    v12 = 4;
    v5 = "responseCallForwards: invalid response length %d expected multiple of %d";
    goto LABEL_6;
  }
  v7 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  v8 = 0;
  while ( v8 < v7 )
  {
    v9 = *(int **)(v3 + 4 * v8);
    android::Parcel::writeInt32(v4, *v9);
    android::Parcel::writeInt32(v4, v9[1]);
    android::Parcel::writeInt32(v4, v9[2]);
    android::Parcel::writeInt32(v4, v9[3]);
    sub_A0F8((int)v4, v9[4]);
    android::Parcel::writeInt32(v4, v9[5]);
    v10 = 1;
    if ( v8 + 1 > v8 )
      v10 = 0;
    ++v8;
    if ( v10 )
      abort();
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007A54) --------------------------------------------------------
int __fastcall sub_7A54(android::Parcel *this, int a2, unsigned int a3)
{
  android::Parcel *v3; // r5
  int v4; // r4
  unsigned int v5; // r6
  int result; // r0
  signed int v7; // r8
  signed int v8; // r8
  signed int v9; // r8
  int v10; // r6
  int *v11; // r7
  signed int v12; // r1
  int v13; // r6
  int *v14; // r7
  signed int v15; // r1
  int v16; // r6
  int *v17; // r7
  signed int v18; // r1
  char v19; // [sp+8h] [bp-78h]
  int v20; // [sp+64h] [bp-1Ch]

  v3 = this;
  v4 = a2;
  v5 = a3;
  if ( android::s_callbacks > 12 )
  {
    if ( !(a3 % 0x2C) )
      return sub_A200(v3, v4, v5);
    _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_Data_Call_Response_v11");
    property_get("ro.debuggable", &v19, "0");
    if ( !strcmp(&v19, "1") )
      return sub_A200(v3, v4, v5);
    return -1;
  }
  if ( android::s_callbacks <= 4 )
  {
    _android_log_buf_print(1, 3, "RILC", "responseDataCallList: v4");
    if ( !v4 && v5 )
    {
LABEL_21:
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
      return -1;
    }
    v9 = v5 / 0x14;
    if ( v5 % 0x14 )
    {
      _android_log_buf_print(
        1,
        6,
        "RILC",
        "responseDataCallListV4: invalid response length %d expected multiple of %d",
        v5,
        20);
      return -1;
    }
    android::Parcel::writeInt32(v3, 4);
    android::Parcel::writeInt32(v3, v5 / 0x14);
    v10 = 0;
    while ( v10 < v9 )
    {
      android::Parcel::writeInt32(v3, *(_DWORD *)(v4 + 20 * v10));
      v11 = (int *)(v4 + 20 * v10);
      android::Parcel::writeInt32(v3, v11[1]);
      sub_A0F8((int)v3, v11[2]);
      sub_A0F8((int)v3, v11[4]);
      v12 = 1;
      if ( v10 + 1 > v10 )
        v12 = 0;
      ++v10;
      if ( v12 )
        abort();
    }
    return 0;
  }
  v7 = a3 / 0x24;
  if ( !(a3 % 0x24) )
  {
    if ( !a2 && a3 )
      goto LABEL_21;
    android::Parcel::writeInt32(this, 6);
    android::Parcel::writeInt32(v3, v5 / 0x24);
    v13 = 0;
    while ( v13 < v7 )
    {
      android::Parcel::writeInt32(v3, *(_DWORD *)(v4 + 36 * v13));
      v14 = (int *)(v4 + 36 * v13);
      android::Parcel::writeInt32(v3, v14[1]);
      android::Parcel::writeInt32(v3, v14[2]);
      android::Parcel::writeInt32(v3, v14[3]);
      sub_A0F8((int)v3, v14[4]);
      sub_A0F8((int)v3, v14[5]);
      sub_A0F8((int)v3, v14[6]);
      sub_A0F8((int)v3, v14[7]);
      sub_A0F8((int)v3, v14[8]);
      v15 = 1;
      if ( v13 + 1 > v13 )
        v15 = 0;
      ++v13;
      if ( v15 )
        abort();
    }
    return 0;
  }
  v8 = a3 / 0x28;
  if ( !(a3 % 0x28) )
  {
    if ( !a2 && a3 )
      goto LABEL_21;
    android::Parcel::writeInt32(this, 10);
    android::Parcel::writeInt32(v3, v5 / 0x28);
    v16 = 0;
    while ( v16 < v8 )
    {
      android::Parcel::writeInt32(v3, *(_DWORD *)(v4 + 40 * v16));
      v17 = (int *)(v4 + 40 * v16);
      android::Parcel::writeInt32(v3, v17[1]);
      android::Parcel::writeInt32(v3, v17[2]);
      android::Parcel::writeInt32(v3, v17[3]);
      sub_A0F8((int)v3, v17[4]);
      sub_A0F8((int)v3, v17[5]);
      sub_A0F8((int)v3, v17[6]);
      sub_A0F8((int)v3, v17[7]);
      sub_A0F8((int)v3, v17[8]);
      sub_A0F8((int)v3, v17[9]);
      v18 = 1;
      if ( v16 + 1 > v16 )
        v18 = 0;
      ++v16;
      if ( v18 )
        abort();
    }
    return 0;
  }
  result = _stack_chk_guard - v20;
  if ( _stack_chk_guard == v20 )
    result = sub_A200(v3, a2, a3);
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3E1C: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;

//----- (00007D58) --------------------------------------------------------
int __fastcall sub_7D58(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r5
  const char *v5; // r0
  int v6; // r1
  int v7; // r0
  int v9; // [sp+8h] [bp-18h]
  int v10; // [sp+Ch] [bp-14h]

  v2 = this;
  v3 = a2;
  if ( android::Parcel::readInt32(this, &v9) )
  {
    v4 = *v3;
    v5 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v4, v5);
  }
  else
  {
    v6 = v9;
    if ( v9 == -1 )
    {
      v6 = 0;
      v9 = 0;
    }
    v7 = android::Parcel::readInplace(v2, v6);
    dword_166DC(*(_DWORD *)v3[1], v7, v9);
  }
  return _stack_chk_guard - v10;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00007DE4) --------------------------------------------------------
int __fastcall sub_7DE4(android::Parcel *this, const void *a2, int a3)
{
  const void *v3; // r6
  unsigned int v4; // r4
  android::Parcel *v5; // r5
  int result; // r0

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( a2 || !a3 )
  {
    if ( a2 )
    {
      android::Parcel::writeInt32(this, a3);
      android::Parcel::write(v5, v3, v4);
    }
    else
    {
      android::Parcel::writeInt32(this, -1);
    }
    result = 0;
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL with responselen != 0");
    result = -1;
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007E34) --------------------------------------------------------
int __fastcall sub_7E34(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r6
  int v5; // r0
  int v6; // r0
  int v7; // r0
  int v8; // r0
  _DWORD *v9; // r2
  int v10; // r4
  void *v11; // r0
  int v12; // r0
  int v13; // r5
  const char *v14; // r0
  int v16; // [sp+Ch] [bp-2Ch]
  __int64 v17; // [sp+10h] [bp-28h]
  int v18; // [sp+18h] [bp-20h]
  unsigned int v19; // [sp+20h] [bp-18h]
  int v20; // [sp+24h] [bp-14h]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchSmsWrite");
  v17 = 0LL;
  v18 = 0;
  v4 = android::Parcel::readInt32(v2, &v16);
  LODWORD(v17) = v16;
  v5 = android::Parcel::readString16Inplace(v2, &v19);
  v6 = strndup16to8(v5, v19);
  HIDWORD(v17) = v6;
  if ( v4 || !v6 )
  {
    v13 = *v3;
    v14 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v13, v14);
  }
  else
  {
    v7 = android::Parcel::readString16Inplace(v2, &v19);
    v8 = strndup16to8(v7, v19);
    v9 = (_DWORD *)v3[1];
    v18 = v8;
    dword_166DC(*v9, &v17, 12);
    v10 = HIDWORD(v17);
    v11 = 0;
    if ( HIDWORD(v17) )
    {
      v12 = _strlen_chk(HIDWORD(v17), -1);
      _aeabi_memclr(v10, v12);
      v11 = (void *)HIDWORD(v17);
    }
    free(v11);
    v17 = 0LL;
    v18 = 0;
  }
  return _stack_chk_guard - v20;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00007F28) --------------------------------------------------------
int __fastcall sub_7F28(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r8
  android::Parcel *v4; // r5
  const char *v5; // r3
  int v7; // r6
  int v8; // r7
  int *v9; // r4
  signed int v10; // r1
  int v11; // [sp+0h] [bp-20h]
  signed int v12; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v5, v11, v12);
    return -1;
  }
  if ( a3 & 3 )
  {
    v11 = a3;
    v12 = 4;
    v5 = "responseCellList: invalid response length %d expected multiple of %d\n";
    goto LABEL_6;
  }
  v7 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  v8 = 0;
  while ( v8 < v7 )
  {
    v9 = *(int **)(v3 + 4 * v8);
    android::Parcel::writeInt32(v4, v9[1]);
    sub_A0F8((int)v4, *v9);
    v10 = 1;
    if ( v8 + 1 > v8 )
      v10 = 0;
    ++v8;
    if ( v10 )
      abort();
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007FBC) --------------------------------------------------------
int __fastcall sub_7FBC(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r1
  int v5; // r0
  int v6; // r4
  const char *v7; // r0
  char v9; // [sp+8h] [bp-188h]
  int v10; // [sp+17Ch] [bp-14h]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchCdmaSms");
  v4 = sub_A2F4(v2, (int)&v9);
  v5 = *(_DWORD *)v3[1];
  if ( v4 )
  {
    v6 = *v3;
    v7 = j_requestToString(v5);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v6, v7);
  }
  else
  {
    dword_166DC(v5, &v9, 372);
    _aeabi_memclr8(&v9, 372);
  }
  return _stack_chk_guard - v10;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3EA0: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (0000805C) --------------------------------------------------------
int __fastcall sub_805C(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r1
  int *v5; // r0
  int v6; // r0
  int v7; // r4
  const char *v8; // r0
  int v10; // [sp+Ch] [bp-24h]
  int v11; // [sp+10h] [bp-20h]
  int v12; // [sp+14h] [bp-1Ch]
  int v13; // [sp+18h] [bp-18h]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchCdmaSmsAck");
  v11 = 0;
  v12 = 0;
  android::Parcel::readInt32(v2, &v10);
  v11 = v10;
  v4 = android::Parcel::readInt32(v2, &v10);
  v5 = (int *)v3[1];
  v12 = v10;
  v6 = *v5;
  if ( v4 )
  {
    v7 = *v3;
    v8 = j_requestToString(v6);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v7, v8);
  }
  else
  {
    dword_166DC(v6, &v11, 8);
    v11 = 0;
    v12 = 0;
  }
  return _stack_chk_guard - v13;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (0000810C) --------------------------------------------------------
int __fastcall sub_810C(android::Parcel *a1, int a2, unsigned int a3)
{
  int v3; // r6
  int v4; // r4
  android::Parcel *v5; // r5
  int v6; // r7
  signed int v7; // r1

  v3 = a3 >> 2;
  v4 = a2;
  v5 = a1;
  android::Parcel::writeInt32(a1, a3 >> 2);
  v6 = 0;
  while ( v6 < v3 )
  {
    android::Parcel::writeInt32(v5, **(_DWORD **)(v4 + 4 * v6));
    android::Parcel::writeInt32(v5, *(_DWORD *)(*(_DWORD *)(v4 + 4 * v6) + 4));
    android::Parcel::writeInt32(v5, *(_DWORD *)(*(_DWORD *)(v4 + 4 * v6) + 8));
    android::Parcel::writeInt32(v5, *(_DWORD *)(*(_DWORD *)(v4 + 4 * v6) + 12));
    android::Parcel::writeInt32(v5, *(unsigned __int8 *)(*(_DWORD *)(v4 + 4 * v6) + 16));
    v7 = 1;
    if ( v6 + 1 > v6 )
      v7 = 0;
    ++v6;
    if ( v7 )
      abort();
  }
  return 0;
}

//----- (00008178) --------------------------------------------------------
int __fastcall sub_8178(android::Parcel *this, int a2)
{
  char *v2; // r9
  char *v3; // r11
  android::Parcel *v4; // r4
  int v5; // r5
  int v6; // r1
  int v7; // r0
  int i; // r6
  int v9; // r10
  signed int v10; // r1
  int v11; // r4
  const char *v12; // r0
  int result; // r0
  signed int v14; // r0
  int v15; // r4
  signed int v16; // r0
  signed int v17; // r0
  int v18; // [sp+0h] [bp-28h]
  int *v19; // [sp+4h] [bp-24h]
  int v20; // [sp+8h] [bp-20h]
  int v21; // [sp+Ch] [bp-1Ch]
  int v22; // [sp+10h] [bp-18h]
  int v23; // [sp+14h] [bp-14h]

  v4 = this;
  v5 = a2;
  if ( !android::Parcel::readInt32(this, &v21) )
  {
    v20 = v5;
    v19 = &v18;
    v3 = (char *)&v18 - ((20 * v21 + 7) & 0xFFFFFFF8);
    v6 = v21;
    v2 = (char *)&v18 - ((4 * v21 + 7) & 0xFFFFFFF8);
    v7 = 0;
    for ( i = 0; i < v6; ++i )
    {
      v9 = (int)&v3[20 * i];
      *(_DWORD *)&v2[4 * i] = v9;
      android::Parcel::readInt32(v4, &v22);
      *(_DWORD *)&v3[20 * i] = v22;
      android::Parcel::readInt32(v4, &v22);
      *(_DWORD *)(v9 + 4) = v22;
      android::Parcel::readInt32(v4, &v22);
      *(_DWORD *)(v9 + 8) = v22;
      android::Parcel::readInt32(v4, &v22);
      *(_DWORD *)(v9 + 12) = v22;
      v7 = android::Parcel::readInt32(v4, &v22);
      *(_BYTE *)(v9 + 16) = v22;
      v10 = 1;
      if ( i + 1 > i )
        v10 = 0;
      if ( v10 )
LABEL_8:
        abort();
      v6 = v21;
    }
    if ( !v7 )
      goto LABEL_13;
    v5 = v20;
  }
  v11 = *(_DWORD *)v5;
  v12 = j_requestToString(**(_DWORD **)(v5 + 4));
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v11, v12);
  while ( 1 )
  {
    v6 = v23;
    result = _stack_chk_guard - v23;
    if ( _stack_chk_guard == v23 )
      return result;
LABEL_13:
    v14 = (unsigned __int64)(unsigned int)v6 >> 30;
    if ( !is_mul_ok(4u, v6) )
      v14 = 1;
    if ( v14 )
      goto LABEL_8;
    dword_166DC(**(_DWORD **)(v20 + 4), v2, 4 * v6);
    v15 = v21;
    v16 = 20 * (unsigned __int64)(unsigned int)v21 >> 32;
    if ( !is_mul_ok(0x14u, v21) )
      v16 = 1;
    if ( v16 )
      goto LABEL_8;
    _aeabi_memclr8(v3, 20 * v21);
    v17 = (unsigned __int64)(unsigned int)v15 >> 30;
    if ( !is_mul_ok(4u, v15) )
      v17 = 1;
    if ( v17 )
      goto LABEL_8;
    _aeabi_memclr4(v2, 4 * v15);
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3EA0: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 3EAC: using guessed type int __fastcall _aeabi_memclr4(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00008308) --------------------------------------------------------
int __fastcall sub_8308(android::Parcel *a1, int a2, unsigned int a3)
{
  int v3; // r6
  int v4; // r4
  android::Parcel *v5; // r5
  int v6; // r7
  signed int v7; // r1

  v3 = a3 >> 2;
  v4 = a2;
  v5 = a1;
  android::Parcel::writeInt32(a1, a3 >> 2);
  v6 = 0;
  while ( v6 < v3 )
  {
    android::Parcel::writeInt32(v5, **(_DWORD **)(v4 + 4 * v6));
    android::Parcel::writeInt32(v5, *(_DWORD *)(*(_DWORD *)(v4 + 4 * v6) + 4));
    android::Parcel::writeInt32(v5, *(unsigned __int8 *)(*(_DWORD *)(v4 + 4 * v6) + 8));
    v7 = 1;
    if ( v6 + 1 > v6 )
      v7 = 0;
    ++v6;
    if ( v7 )
      abort();
  }
  return 0;
}

//----- (0000835C) --------------------------------------------------------
int __fastcall sub_835C(android::Parcel *this, int a2)
{
  char *v2; // r9
  char *v3; // r11
  android::Parcel *v4; // r4
  int v5; // r5
  int v6; // r1
  int v7; // r0
  int i; // r6
  int v9; // r8
  signed int v10; // r1
  int v11; // r4
  const char *v12; // r0
  int result; // r0
  signed int v14; // r0
  int v15; // r4
  signed int v16; // r0
  signed int v17; // r0
  int v18; // [sp+0h] [bp-28h]
  int *v19; // [sp+4h] [bp-24h]
  int v20; // [sp+8h] [bp-20h]
  int v21; // [sp+Ch] [bp-1Ch]
  int v22; // [sp+10h] [bp-18h]
  int v23; // [sp+14h] [bp-14h]

  v4 = this;
  v5 = a2;
  if ( !android::Parcel::readInt32(this, &v21) )
  {
    v20 = v5;
    v19 = &v18;
    v3 = (char *)&v18 - ((12 * v21 + 7) & 0xFFFFFFF8);
    v6 = v21;
    v2 = (char *)&v18 - ((4 * v21 + 7) & 0xFFFFFFF8);
    v7 = 0;
    for ( i = 0; i < v6; ++i )
    {
      v9 = (int)&v3[12 * i];
      *(_DWORD *)&v2[4 * i] = v9;
      android::Parcel::readInt32(v4, &v22);
      *(_DWORD *)&v3[12 * i] = v22;
      android::Parcel::readInt32(v4, &v22);
      *(_DWORD *)(v9 + 4) = v22;
      v7 = android::Parcel::readInt32(v4, &v22);
      *(_BYTE *)(v9 + 8) = v22;
      v10 = 1;
      if ( i + 1 > i )
        v10 = 0;
      if ( v10 )
LABEL_8:
        abort();
      v6 = v21;
    }
    if ( !v7 )
      goto LABEL_13;
    v5 = v20;
  }
  v11 = *(_DWORD *)v5;
  v12 = j_requestToString(**(_DWORD **)(v5 + 4));
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v11, v12);
  while ( 1 )
  {
    v6 = v23;
    result = _stack_chk_guard - v23;
    if ( _stack_chk_guard == v23 )
      return result;
LABEL_13:
    v14 = (unsigned __int64)(unsigned int)v6 >> 30;
    if ( !is_mul_ok(4u, v6) )
      v14 = 1;
    if ( v14 )
      goto LABEL_8;
    dword_166DC(**(_DWORD **)(v20 + 4), v2, 4 * v6);
    v15 = v21;
    v16 = 12 * (unsigned __int64)(unsigned int)v21 >> 32;
    if ( !is_mul_ok(0xCu, v21) )
      v16 = 1;
    if ( v16 )
      goto LABEL_8;
    _aeabi_memclr8(v3, 12 * v21);
    v17 = (unsigned __int64)(unsigned int)v15 >> 30;
    if ( !is_mul_ok(4u, v15) )
      v17 = 1;
    if ( v17 )
      goto LABEL_8;
    _aeabi_memclr4(v2, 4 * v15);
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3EA0: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 3EAC: using guessed type int __fastcall _aeabi_memclr4(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (000084CC) --------------------------------------------------------
int __fastcall sub_84CC(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r8
  signed int v4; // r4
  int v5; // r6
  signed int v6; // r1
  signed int v7; // r7
  int v8; // r6
  signed int v9; // r1
  int v10; // r0
  int v11; // r7
  int v12; // r6
  signed int v13; // r2
  int v14; // r4
  const char *v15; // r0
  unsigned __int8 v17; // [sp+Bh] [bp-19Dh]
  int v18; // [sp+Ch] [bp-19Ch]
  int v19; // [sp+10h] [bp-198h]
  int v20; // [sp+14h] [bp-194h]
  unsigned __int8 v21; // [sp+18h] [bp-190h]
  int v22; // [sp+1Ch] [bp-18Ch]
  int v23; // [sp+20h] [bp-188h]
  int v24; // [sp+24h] [bp-184h]
  int v25; // [sp+28h] [bp-180h]
  int v26; // [sp+2Ch] [bp-17Ch]
  unsigned __int8 v27; // [sp+30h] [bp-178h]
  int v28; // [sp+58h] [bp-150h]
  unsigned __int8 v29; // [sp+5Ch] [bp-14Ch]
  unsigned __int8 v30; // [sp+5Dh] [bp-14Bh]
  int v31; // [sp+84h] [bp-124h]
  int v32; // [sp+188h] [bp-20h]

  v2 = a1;
  v3 = a2;
  _aeabi_memclr8(&v19, 376);
  android::Parcel::readInt32(v2, &v18);
  v19 = v18;
  android::Parcel::readInt32(v2, &v18);
  v20 = v18;
  android::Parcel::read(v2, &v17, 1u);
  v21 = v17;
  android::Parcel::readInt32(v2, &v18);
  v22 = v18;
  android::Parcel::readInt32(v2, &v18);
  v23 = v18;
  android::Parcel::readInt32(v2, &v18);
  v24 = v18;
  android::Parcel::readInt32(v2, &v18);
  v25 = v18;
  android::Parcel::readInt32(v2, &v18);
  v26 = v18;
  android::Parcel::read(v2, &v17, 1u);
  v4 = v17;
  v5 = 0;
  v27 = v17;
  if ( v17 >= 0x24u )
    v4 = 36;
  while ( v5 < v4 )
  {
    android::Parcel::read(v2, &v17, 1u);
    *((_BYTE *)&v19 + v5 + 33) = v17;
    v6 = 1;
    if ( v5 + 1 > v5 )
      v6 = 0;
    ++v5;
    if ( v6 )
LABEL_21:
      abort();
  }
  android::Parcel::readInt32(v2, &v18);
  v28 = v18;
  android::Parcel::read(v2, &v17, 1u);
  v29 = v17;
  android::Parcel::read(v2, &v17, 1u);
  v7 = v17;
  v8 = 0;
  v30 = v17;
  if ( v17 >= 0x24u )
    v7 = 36;
  while ( v8 < v7 )
  {
    android::Parcel::read(v2, &v17, 1u);
    *((_BYTE *)&v19 + v8 + 78) = v17;
    v9 = 1;
    if ( v8 + 1 > v8 )
      v9 = 0;
    ++v8;
    if ( v9 )
      goto LABEL_21;
  }
  v10 = android::Parcel::readInt32(v2, &v18);
  v11 = v18;
  v31 = v18;
  v12 = 0;
  if ( v18 >= 255 )
    v11 = 255;
  while ( v12 < v11 )
  {
    v10 = android::Parcel::read(v2, &v17, 1u);
    *((_BYTE *)&v19 + v12 + 120) = v17;
    v13 = 1;
    if ( v12 + 1 > v12 )
      v13 = 0;
    ++v12;
    if ( v13 )
      goto LABEL_21;
  }
  if ( v10 )
  {
    v14 = *v3;
    v15 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v14, v15);
  }
  else
  {
    dword_166DC(*(_DWORD *)v3[1], &v19, 376);
    _aeabi_memclr8(&v19, 376);
  }
  return _stack_chk_guard - v32;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3EA0: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (000086C4) --------------------------------------------------------
int __fastcall sub_86C4(int a1, int a2)
{
  int v2; // r4
  int v3; // r5
  int result; // r0

  v2 = a2;
  v3 = dword_166E0();
  if ( (v3 | 1) == 1 )
    j_RIL_onRequestComplete(v2, 1, 0, 0);
  if ( v3 == 10 )
    return dword_166DC(**(_DWORD **)(v2 + 4), 0, 0);
  if ( (unsigned int)(v3 - 2) >= 8 )
  {
    _android_log_buf_print(1, 3, "RILC", "decodeCdmaSubscriptionSource: Invoked with incorrect RadioState");
    android::cdmaSubscriptionSource = -1;
    result = j_j_RIL_onRequestComplete(v2, 2, 0, 0);
  }
  else
  {
    android::cdmaSubscriptionSource = dword_13870[v3 - 2];
    result = j_j_RIL_onRequestComplete(v2, 0, (int)&android::cdmaSubscriptionSource, 4);
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 16010: using guessed type int android::cdmaSubscriptionSource;
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);
// 166E0: using guessed type int (*dword_166E0)(void);

//----- (00008774) --------------------------------------------------------
int __fastcall sub_8774(int a1, int a2)
{
  int v2; // r4
  int v3; // r0
  unsigned int v5; // r0

  v2 = a2;
  v3 = dword_166E0();
  if ( !v3 || v3 == 10 )
    return dword_166DC(**(_DWORD **)(v2 + 4), 0, 0);
  if ( v3 == 1 )
  {
    j_RIL_onRequestComplete(v2, 1, 0, 0);
  }
  else
  {
    v5 = v3 - 2;
    if ( v5 < 8 )
    {
      android::voiceRadioTech = dword_13890[v5];
      return j_j_RIL_onRequestComplete(v2, 0, (int)&android::voiceRadioTech, 4);
    }
  }
  _android_log_buf_print(1, 3, "RILC", "decodeVoiceRadioTechnology: Invoked with incorrect RadioState");
  android::voiceRadioTech = -1;
  return j_j_RIL_onRequestComplete(v2, 2, 0, 0);
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 1600C: using guessed type int android::voiceRadioTech;
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);
// 166E0: using guessed type int (*dword_166E0)(void);

//----- (00008820) --------------------------------------------------------
int __fastcall sub_8820(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r5
  android::Parcel *v4; // r4
  int v5; // r7
  unsigned int v6; // r6
  const char *v7; // r3
  int result; // r0
  int *v9; // r6
  int v10; // r0
  int v11; // r1
  signed int v12; // r1
  unsigned int v13; // [sp+0h] [bp-80h]
  signed int v14; // [sp+4h] [bp-7Ch]
  char v15; // [sp+Ch] [bp-74h]
  int v16; // [sp+68h] [bp-18h]

  v4 = this;
  v5 = a2;
  v6 = a3;
  if ( android::s_callbacks > 12 )
  {
    if ( !(a3 % 0x48)
      || (_android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_CellInfo_v12"),
          v3 = (int)&v15,
          property_get("ro.debuggable", &v15, "0"),
          !strcmp(&v15, "1")) )
    {
      result = sub_A47C(v4, v5, v6);
      goto LABEL_16;
    }
  }
  else
  {
    if ( android::s_callbacks > 11 )
    {
      _android_log_buf_print(1, 3, "RILC", "responseCellInfoList: v12");
      if ( _stack_chk_guard != v16 )
        goto LABEL_17;
      return sub_A47C(v4, v5, v6);
    }
    _android_log_buf_print(1, 3, "RILC", "responseCellInfoList: v6");
    if ( v5 || !v6 )
    {
      v3 = v6 / 0x48;
      if ( !(v6 % 0x48) )
        goto LABEL_17;
      v13 = v6;
      v14 = 72;
      v7 = "responseCellInfoList: invalid response length %d expected multiple of %d";
    }
    else
    {
      v7 = "invalid response: NULL";
    }
    _android_log_buf_print(1, 6, "RILC", v7, v13, v14);
  }
  result = -1;
LABEL_16:
  while ( _stack_chk_guard != v16 )
  {
LABEL_17:
    android::Parcel::writeInt32(v4, v3);
    v9 = (int *)(v5 + 32);
    v10 = 0;
    while ( 1 )
    {
      v5 = v10;
      if ( v10 >= v3 )
        break;
      android::Parcel::writeInt32(v4, *(v9 - 8));
      android::Parcel::writeInt32(v4, *(v9 - 7));
      android::Parcel::writeInt32(v4, *(v9 - 6));
      android::Parcel::writeInt64(v4, *((_QWORD *)v9 - 2));
      switch ( *(v9 - 8) )
      {
        case 1:
        case 5:
          android::Parcel::writeInt32(v4, *(v9 - 2));
          android::Parcel::writeInt32(v4, *(v9 - 1));
          android::Parcel::writeInt32(v4, *v9);
          android::Parcel::writeInt32(v4, v9[1]);
          android::Parcel::writeInt32(v4, v9[2]);
          v11 = v9[3];
          goto LABEL_24;
        case 2:
          android::Parcel::writeInt32(v4, *(v9 - 2));
          android::Parcel::writeInt32(v4, *(v9 - 1));
          android::Parcel::writeInt32(v4, *v9);
          android::Parcel::writeInt32(v4, v9[1]);
          android::Parcel::writeInt32(v4, v9[2]);
          android::Parcel::writeInt32(v4, v9[3]);
          android::Parcel::writeInt32(v4, v9[4]);
          android::Parcel::writeInt32(v4, v9[5]);
          android::Parcel::writeInt32(v4, v9[6]);
          v11 = v9[7];
          goto LABEL_24;
        case 3:
          android::Parcel::writeInt32(v4, *(v9 - 2));
          android::Parcel::writeInt32(v4, *(v9 - 1));
          android::Parcel::writeInt32(v4, *v9);
          android::Parcel::writeInt32(v4, v9[1]);
          android::Parcel::writeInt32(v4, v9[2]);
          android::Parcel::writeInt32(v4, v9[3]);
          android::Parcel::writeInt32(v4, v9[4]);
          android::Parcel::writeInt32(v4, v9[5]);
          android::Parcel::writeInt32(v4, v9[6]);
          android::Parcel::writeInt32(v4, v9[7]);
          v11 = v9[8];
          goto LABEL_24;
        case 4:
          android::Parcel::writeInt32(v4, *(v9 - 2));
          android::Parcel::writeInt32(v4, *(v9 - 1));
          android::Parcel::writeInt32(v4, *v9);
          android::Parcel::writeInt32(v4, v9[1]);
          android::Parcel::writeInt32(v4, v9[2]);
          android::Parcel::writeInt32(v4, v9[3]);
          v11 = v9[4];
LABEL_24:
          android::Parcel::writeInt32(v4, v11);
          break;
        default:
          break;
      }
      v10 = v5 + 1;
      v9 += 18;
      v12 = 1;
      if ( v5 + 1 > v5 )
        v12 = 0;
      if ( v12 )
        abort();
    }
    result = 0;
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3E1C: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;

//----- (00008AFC) --------------------------------------------------------
int __fastcall sub_8AFC(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r4
  int *v3; // r5
  int v4; // r0
  int v5; // r0
  int v6; // r6
  int v7; // r0
  int v8; // r0
  int v9; // r4
  const char *v10; // r0
  void *v11; // r5
  int v12; // r0
  void *v13; // r5
  int v14; // r0
  int v15; // r5
  int v16; // r0
  void *v17; // r5
  int v18; // r0
  int v20; // [sp+Ch] [bp-4h]
  void *ptr[2]; // [sp+10h] [bp+0h]
  __int64 v22; // [sp+18h] [bp+8h]
  void *v23; // [sp+20h] [bp+10h]
  unsigned int v24; // [sp+24h] [bp+14h]
  int v25; // [sp+28h] [bp+18h]

  v2 = this;
  v3 = a2;
  v22 = 0LL;
  v4 = android::Parcel::readString16Inplace(this, &v24);
  ptr[0] = (void *)strndup16to8(v4, v24);
  v5 = android::Parcel::readString16Inplace(v2, &v24);
  ptr[1] = (void *)strndup16to8(v5, v24);
  v6 = android::Parcel::readInt32(v2, &v20);
  LODWORD(v22) = v20;
  v7 = android::Parcel::readString16Inplace(v2, &v24);
  HIDWORD(v22) = strndup16to8(v7, v24);
  v8 = android::Parcel::readString16Inplace(v2, &v24);
  v23 = (void *)strndup16to8(v8, v24);
  if ( v6 )
  {
    v9 = *v3;
    v10 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v9, v10);
  }
  else
  {
    dword_166DC(*(_DWORD *)v3[1], ptr, 20);
    v11 = ptr[0];
    if ( ptr[0] )
    {
      v12 = _strlen_chk(ptr[0], -1);
      _aeabi_memclr(v11, v12);
    }
    v13 = ptr[1];
    if ( ptr[1] )
    {
      v14 = _strlen_chk(ptr[1], -1);
      _aeabi_memclr(v13, v14);
    }
    v15 = HIDWORD(v22);
    if ( HIDWORD(v22) )
    {
      v16 = _strlen_chk(HIDWORD(v22), -1);
      _aeabi_memclr(v15, v16);
    }
    v17 = v23;
    if ( v23 )
    {
      v18 = _strlen_chk(v23, -1);
      _aeabi_memclr(v17, v18);
    }
    free(ptr[0]);
    free(ptr[1]);
    free((void *)HIDWORD(v22));
    free(v23);
    *(_QWORD *)ptr = 0LL;
    v22 = 0LL;
    v23 = 0;
  }
  return _stack_chk_guard - v25;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00008C48) --------------------------------------------------------
int __fastcall sub_8C48(android::Parcel *this, android::Parcel *a2)
{
  android::Parcel *v2; // r5
  android::Parcel *v3; // r4
  int v4; // r6
  const char *v5; // r3
  int result; // r0
  int v7; // r7
  const char *v8; // r0
  unsigned __int8 v9; // r7
  int v10; // r0
  int *v11; // r1
  signed int v12; // r10
  size_t v13; // r9
  signed int v14; // r0
  int i; // r7
  int v16; // r0
  signed int v17; // r1
  signed int v18; // r0
  int v19; // r7
  int v20; // r0
  void *v21; // r0
  signed int v22; // r1
  const char *v23; // r0
  void *v24; // [sp+0h] [bp-1C0h]
  const char *v25; // [sp+4h] [bp-1BCh]
  int v26; // [sp+8h] [bp-1B8h]
  unsigned __int8 v27; // [sp+Fh] [bp-1B1h]
  int v28; // [sp+10h] [bp-1B0h]
  size_t nmemb; // [sp+14h] [bp-1ACh]
  unsigned int v30[2]; // [sp+18h] [bp-1A8h]
  double v31; // [sp+20h] [bp-1A0h]
  int v32; // [sp+28h] [bp-198h]
  char v33; // [sp+2Ch] [bp-194h]
  __int64 v34; // [sp+30h] [bp-190h]
  int v35; // [sp+19Ch] [bp-24h]

  v2 = this;
  v3 = a2;
  v4 = android::Parcel::readInt32(this, &v28);
  _android_log_buf_print(1, 3, "RILC", "dispatchImsSms");
  if ( !v4 )
  {
    v4 = v28;
    if ( !android::Parcel::read(v2, &v27, 1u) && !android::Parcel::read(v2, &v26, 4u) )
      goto LABEL_7;
  }
  v2 = *(android::Parcel **)v3;
  v24 = *(void **)v3;
  v25 = j_requestToString(**((_DWORD **)v3 + 1));
  v5 = "invalid command block for token %d request %s";
LABEL_5:
  _android_log_buf_print(1, 6, "RILC", v5, v24, v25);
  while ( 1 )
  {
    result = _stack_chk_guard - v35;
    if ( _stack_chk_guard == v35 )
      return result;
LABEL_7:
    if ( v4 == 2 )
    {
      v4 = v26;
      v9 = v27;
      _android_log_buf_print(1, 3, "RILC", "dispatchImsCdmaSms: retry=%d, messageRef=%d", v27, v26);
      v10 = sub_A2F4(v2, (int)&v32);
      v11 = (int *)*((_DWORD *)v3 + 1);
      if ( v10 )
      {
        v3 = *(android::Parcel **)v3;
        v24 = (void *)v3;
        v25 = j_requestToString(*v11);
        v5 = "invalid command block for token %d request %s";
        goto LABEL_5;
      }
      v30[1] = 0;
      v30[0] = 2;
      LOBYTE(v30[1]) = v9;
      v31 = COERCE_DOUBLE(__PAIR__(&v32, v4));
      dword_166DC(*v11, v30, 381);
      _aeabi_memclr8(&v32, 372);
      v31 = 0.0;
      *(_QWORD *)v30 = 0LL;
    }
    else if ( v4 == 1 )
    {
      v7 = v26;
      v4 = v27;
      _android_log_buf_print(1, 3, "RILC", "dispatchImsGsmSms: retry=%d, messageRef=%d", v27, v26);
      if ( android::Parcel::readInt32(v2, (int *)&nmemb) )
      {
        v2 = (android::Parcel *)"RILC";
        _android_log_print(6, "RILC", "dispatchImsGsmSms invalid block");
        v4 = *(_DWORD *)v3;
        v8 = j_requestToString(**((_DWORD **)v3 + 1));
        _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v4, v8);
      }
      else
      {
        v12 = nmemb;
        *(_QWORD *)&v32 = 0LL;
        v34 = 0LL;
        LODWORD(v34) = v7;
        v32 = 1;
        v33 = v4;
        if ( nmemb )
        {
          v13 = 0;
          if ( (nmemb & 0x80000000) != 0 )
          {
            v4 = 0;
          }
          else
          {
            if ( 0 != nmemb >> 29 )
            {
              v5 = "Invalid value of countStrings: \n";
              goto LABEL_5;
            }
            v14 = (unsigned __int64)nmemb >> 30;
            v13 = 4 * nmemb;
            if ( !is_mul_ok(4u, nmemb) )
              v14 = 1;
            if ( v14 )
LABEL_45:
              abort();
            v4 = (int)calloc(nmemb, 4u);
            if ( !v4 )
            {
              v23 = j_requestToString(**((_DWORD **)v3 + 1));
              v5 = "Memory allocation failed for request %s";
              goto LABEL_50;
            }
            for ( i = 0; i < v12; ++i )
            {
              v16 = android::Parcel::readString16Inplace(v2, v30);
              *(_DWORD *)(v4 + 4 * i) = strndup16to8(v16, v30[0]);
              v17 = 1;
              if ( i + 1 > i )
                v17 = 0;
              if ( v17 )
                goto LABEL_45;
              v12 = nmemb;
            }
          }
        }
        else
        {
          v4 = (int)calloc(1u, 4u);
          if ( !v4 )
          {
            v23 = j_requestToString(**((_DWORD **)v3 + 1));
            v5 = "Memory allocation failed for request %s";
LABEL_50:
            v24 = (void *)v23;
            goto LABEL_5;
          }
          v13 = 0;
        }
        v18 = 1;
        HIDWORD(v34) = v4;
        if ( v13 + 9 >= v13 )
          v18 = 0;
        if ( v18 )
          goto LABEL_45;
        dword_166DC(**((_DWORD **)v3 + 1), &v32, v13 + 9);
        if ( v4 )
        {
          v19 = 0;
          while ( v19 < (signed int)nmemb )
          {
            v3 = *(android::Parcel **)(v4 + 4 * v19);
            if ( v3 )
            {
              v20 = _strlen_chk(*(_DWORD *)(v4 + 4 * v19), -1);
              _aeabi_memclr(v3, v20);
              v21 = *(void **)(v4 + 4 * v19);
            }
            else
            {
              v21 = 0;
            }
            free(v21);
            v22 = 1;
            if ( v19 + 1 > v19 )
              v22 = 0;
            ++v19;
            if ( v22 )
              goto LABEL_45;
          }
          free((void *)v4);
        }
        *(_QWORD *)&v32 = 0LL;
        v2 = (android::Parcel *)&v34;
        v34 = 0LL;
      }
    }
    else
    {
      _android_log_print(6, "RILC", "requestImsSendSMS invalid format value =%d", v4);
    }
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 3EA0: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 3ED0: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00008F64) --------------------------------------------------------
int __fastcall sub_8F64(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r6
  int v5; // r0
  int v6; // r5
  const char *v7; // r0
  void *v8; // r4
  void *v9; // r0
  int v10; // r0
  double v12; // [sp+8h] [bp+0h]
  int v13; // [sp+10h] [bp+8h]
  int v14; // [sp+14h] [bp+Ch]
  double v15; // [sp+18h] [bp+10h]
  void *ptr; // [sp+20h] [bp+18h]
  int v17; // [sp+28h] [bp+20h]
  unsigned int v18; // [sp+2Ch] [bp+24h]
  int v19; // [sp+30h] [bp+28h]

  v2 = this;
  v3 = a2;
  android::Parcel::readInt32(this, &v17);
  LODWORD(v12) = v17;
  android::Parcel::readInt32(v2, &v17);
  HIDWORD(v12) = v17;
  android::Parcel::readInt32(v2, &v17);
  v13 = v17;
  android::Parcel::readInt32(v2, &v17);
  v14 = v17;
  android::Parcel::readInt32(v2, &v17);
  LODWORD(v15) = v17;
  v4 = android::Parcel::readInt32(v2, &v17);
  HIDWORD(v15) = v17;
  v5 = android::Parcel::readString16Inplace(v2, &v18);
  ptr = (void *)strndup16to8(v5, v18);
  if ( v4 )
  {
    v6 = *v3;
    v7 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v6, v7, v12, v13, v14, v15);
  }
  else
  {
    dword_166DC(*(_DWORD *)v3[1], &v12, 28);
    v8 = ptr;
    v9 = 0;
    if ( ptr )
    {
      v10 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v8, v10);
      v9 = ptr;
    }
    free(v9);
    v12 = 0.0;
    *(_QWORD *)&v13 = 0LL;
    v15 = 0.0;
    ptr = 0;
  }
  return _stack_chk_guard - v19;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00009074) --------------------------------------------------------
int __fastcall sub_9074(android::Parcel *a1, int *a2)
{
  int *v2; // r4
  int v3; // r1
  int *v4; // r0
  int v5; // r0
  int v6; // r4
  const char *v7; // r0
  int v9; // [sp+Ch] [bp-14h]
  int v10; // [sp+10h] [bp-10h]
  int v11; // [sp+14h] [bp-Ch]

  v2 = a2;
  v3 = android::Parcel::readInt32(a1, &v9);
  v4 = (int *)v2[1];
  v10 = v9;
  v5 = *v4;
  if ( v3 )
  {
    v6 = *v2;
    v7 = j_requestToString(v5);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v6, v7);
  }
  else
  {
    dword_166DC(v5, &v10, 4);
    v10 = 0;
  }
  return _stack_chk_guard - v11;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (000090F4) --------------------------------------------------------
int __fastcall sub_90F4(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r6
  int v5; // r0
  void *v6; // r0
  void *v7; // r4
  void *v8; // r0
  int v9; // r0
  int v10; // r5
  const char *v11; // r0
  int v13; // [sp+Ch] [bp-24h]
  int v14; // [sp+10h] [bp-20h]
  void *ptr; // [sp+14h] [bp-1Ch]
  unsigned int v16; // [sp+18h] [bp-18h]
  int v17; // [sp+1Ch] [bp-14h]

  v2 = this;
  v3 = a2;
  v14 = 0;
  ptr = 0;
  v4 = android::Parcel::readInt32(this, &v13);
  v14 = v13;
  v5 = android::Parcel::readString16Inplace(v2, &v16);
  v6 = (void *)strndup16to8(v5, v16);
  ptr = v6;
  if ( v4 || !v6 )
  {
    v10 = *v3;
    v11 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v10, v11);
  }
  else
  {
    dword_166DC(*(_DWORD *)v3[1], &v14, 8);
    v7 = ptr;
    v8 = 0;
    if ( ptr )
    {
      v9 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v7, v9);
      v8 = ptr;
    }
    free(v8);
    v14 = 0;
    ptr = 0;
  }
  return _stack_chk_guard - v17;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (000091B0) --------------------------------------------------------
int __fastcall sub_91B0(android::Parcel *this, int **a2)
{
  int (__fastcall *v2)(_DWORD, _DWORD, _DWORD); // r7
  int v3; // r8
  android::Parcel *v4; // r6
  int *v5; // r5
  int **v6; // r4
  const char *v7; // r0
  int result; // r0
  int v9; // [sp+Ch] [bp-34h]
  int v10; // [sp+10h] [bp-30h]
  int v11; // [sp+14h] [bp-2Ch]
  __int64 v12; // [sp+18h] [bp-28h]
  int v13; // [sp+24h] [bp-1Ch]

  v4 = this;
  v5 = &v10;
  v6 = a2;
  *(_QWORD *)&v10 = 0LL;
  v12 = 0LL;
  if ( !android::Parcel::readInt32(this, &v9) )
  {
    v2 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD))v9;
    v10 = v9;
    if ( !android::Parcel::readInt32(v4, &v9) )
    {
      v3 = v9;
      v11 = v9;
      if ( !android::Parcel::readInt32(v4, &v9) )
      {
        LODWORD(v12) = v9;
        if ( !android::Parcel::readInt32(v4, &v9) )
          goto LABEL_7;
      }
    }
  }
  v5 = *v6;
  v7 = j_requestToString(*v6[1]);
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v5, v7);
  while ( 1 )
  {
    result = _stack_chk_guard - v13;
    if ( _stack_chk_guard == v13 )
      break;
LABEL_7:
    HIDWORD(v12) = v9;
    _android_log_buf_print(1, 3, "RILC", "dispatchUiccSubscription, slot=%d, app_index=%d, act_status = %d", v2, v3, v9);
    v2 = dword_166DC;
    dword_166DC(*v6[1], v5, 16);
    *(_QWORD *)v5 = 0LL;
    v5 += 2;
    *(_QWORD *)v5 = 0LL;
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (0000929C) --------------------------------------------------------
int __fastcall sub_929C(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  android::Parcel *v4; // r5
  const char *v5; // r3
  signed int v6; // r8
  int v8; // r0
  int v9; // r7
  int v10; // r1
  int *v11; // r6
  int v12; // r6
  signed int v13; // r1
  int v14; // [sp+0h] [bp-20h]
  signed int v15; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v5, v14, v15);
    return -1;
  }
  v6 = a3 / 0x88;
  if ( a3 % 0x88 )
  {
    v14 = a3;
    v15 = 136;
    v5 = "responseHardwareConfig: invalid response length %d expected multiple of %d";
    goto LABEL_6;
  }
  android::Parcel::writeInt32(this, a3 / 0x88);
  v8 = 0;
  while ( 1 )
  {
    v9 = v8;
    if ( v8 >= v6 )
      break;
    v10 = *(_DWORD *)(v3 + 136 * v8);
    if ( v10 == 1 )
    {
      v12 = v3 + 136 * v8;
      sub_A0F8((int)v4, v12 + 4);
      android::Parcel::writeInt32(v4, *(_DWORD *)(v12 + 68));
      sub_A0F8((int)v4, v12 + 72);
    }
    else if ( !v10 )
    {
      v11 = (int *)(v3 + 136 * v8);
      sub_A0F8((int)v4, (int)(v11 + 1));
      android::Parcel::writeInt32(v4, v11[17]);
      android::Parcel::writeInt32(v4, v11[19]);
      android::Parcel::writeInt32(v4, v11[20]);
      android::Parcel::writeInt32(v4, v11[21]);
      android::Parcel::writeInt32(v4, v11[22]);
    }
    v8 = v9 + 1;
    v13 = 1;
    if ( v9 + 1 > v9 )
      v13 = 0;
    if ( v13 )
      abort();
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000938C) --------------------------------------------------------
int __fastcall sub_938C(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r6
  int v5; // r0
  int v6; // r0
  int v7; // r5
  const char *v8; // r0
  void *v9; // r4
  int v10; // r0
  void *v11; // r4
  int v12; // r0
  int v14; // [sp+Ch] [bp-2Ch]
  void *ptr[2]; // [sp+10h] [bp-28h]
  void *v16; // [sp+18h] [bp-20h]
  unsigned int v17; // [sp+20h] [bp-18h]
  int v18; // [sp+24h] [bp-14h]

  v2 = this;
  v3 = a2;
  ptr[0] = 0;
  ptr[1] = 0;
  v4 = android::Parcel::readInt32(this, &v14);
  ptr[0] = (void *)v14;
  v5 = android::Parcel::readString16Inplace(v2, &v17);
  ptr[1] = (void *)strndup16to8(v5, v17);
  v6 = android::Parcel::readString16Inplace(v2, &v17);
  v16 = (void *)strndup16to8(v6, v17);
  if ( v4 )
  {
    v7 = *v3;
    v8 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v7, v8);
  }
  else
  {
    dword_166DC(*(_DWORD *)v3[1], ptr, 12);
    v9 = ptr[1];
    if ( ptr[1] )
    {
      v10 = _strlen_chk(ptr[1], -1);
      _aeabi_memclr(v9, v10);
    }
    v11 = v16;
    if ( v16 )
    {
      v12 = _strlen_chk(v16, -1);
      _aeabi_memclr(v11, v12);
    }
    free(ptr[1]);
    free(v16);
    v16 = 0;
    *(_QWORD *)ptr = 0LL;
  }
  return _stack_chk_guard - v18;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00009478) --------------------------------------------------------
int __fastcall sub_9478(android::Parcel *this, __int64 *a2, int a3)
{
  __int64 *v3; // r5
  android::Parcel *v4; // r4
  int result; // r0

  v3 = a2;
  v4 = this;
  if ( a3 == 16 )
  {
    android::Parcel::writeInt64(this, *a2);
    android::Parcel::writeInt32(v4, *((_DWORD *)v3 + 2));
    result = 0;
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "responseDcRtInfo: invalid response length %d expected multiple of %d", a3, 16);
    result = -1;
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000094C4) --------------------------------------------------------
int __fastcall sub_94C4(android::Parcel *this, int *a2)
{
  _DWORD *v2; // r10
  android::Parcel *v3; // r7
  int *v4; // r5
  signed int v5; // r4
  _DWORD *v6; // r9
  int v7; // r0
  int i; // r8
  _DWORD *v9; // r4
  int v10; // r0
  int v11; // r0
  int v12; // r0
  int v13; // r0
  signed int v14; // r2
  int v15; // r4
  const char *v16; // r0
  const char *v17; // r0
  int result; // r0
  const char *v19; // r0
  signed int v20; // r0
  unsigned int v21; // r4
  signed int v22; // r0
  signed int v23; // r0
  size_t nmemb; // [sp+Ch] [bp-34h]
  int v25; // [sp+10h] [bp-30h]
  int v26; // [sp+14h] [bp-2Ch]
  int v27; // [sp+18h] [bp-28h]

  v3 = this;
  v4 = a2;
  if ( android::Parcel::readInt32(this, (int *)&nmemb) )
    goto LABEL_14;
  v5 = nmemb;
  if ( (nmemb & 0x80000000) != 0 )
    goto LABEL_14;
  v2 = calloc(nmemb, 0x2Cu);
  if ( v2 )
  {
    v6 = calloc(v5, 4u);
    if ( !v6 )
      goto LABEL_17;
    v7 = 0;
    for ( i = 0; i < v5; ++i )
    {
      v9 = &v2[11 * i];
      v6[i] = v9;
      android::Parcel::readInt32(v3, &v25);
      v2[11 * i] = v25;
      v10 = android::Parcel::readString16Inplace(v3, (unsigned int *)&v26);
      v9[1] = strndup16to8(v10, v26);
      v11 = android::Parcel::readString16Inplace(v3, (unsigned int *)&v26);
      v9[2] = strndup16to8(v11, v26);
      android::Parcel::readInt32(v3, &v25);
      v9[3] = v25;
      v12 = android::Parcel::readString16Inplace(v3, (unsigned int *)&v26);
      v9[4] = strndup16to8(v12, v26);
      v13 = android::Parcel::readString16Inplace(v3, (unsigned int *)&v26);
      v9[5] = strndup16to8(v13, v26);
      android::Parcel::readInt32(v3, &v25);
      v9[6] = v25;
      android::Parcel::readInt32(v3, &v25);
      v9[7] = v25;
      android::Parcel::readInt32(v3, &v25);
      v9[8] = v25;
      android::Parcel::readInt32(v3, &v25);
      v9[9] = v25;
      v7 = android::Parcel::readInt32(v3, &v25);
      v14 = 1;
      v9[10] = v25;
      if ( i + 1 > i )
        v14 = 0;
      if ( v14 )
        goto LABEL_11;
      v5 = nmemb;
    }
    if ( v7 )
    {
      free(v2);
      free(v6);
LABEL_14:
      v15 = *v4;
      v16 = j_requestToString(*(_DWORD *)v4[1]);
      _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v15, v16);
      goto LABEL_16;
    }
    v20 = (unsigned __int64)(unsigned int)v5 >> 30;
    if ( !is_mul_ok(4u, v5) )
      v20 = 1;
    if ( v20 )
      goto LABEL_11;
    dword_166DC(*(_DWORD *)v4[1], v6, 4 * v5);
    v21 = nmemb;
    v22 = 44 * (unsigned __int64)nmemb >> 32;
    if ( !is_mul_ok(0x2Cu, nmemb) )
      v22 = 1;
    if ( v22 )
      goto LABEL_11;
    _aeabi_memclr4(v2, 44 * nmemb);
    v23 = (unsigned __int64)v21 >> 30;
    if ( !is_mul_ok(4u, v21) )
      v23 = 1;
    if ( v23 )
LABEL_11:
      abort();
    _aeabi_memclr4(v6, 4 * v21);
    free(v2);
    free(v6);
  }
  else
  {
    v17 = j_requestToString(*(_DWORD *)v4[1]);
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v17);
  }
LABEL_16:
  while ( 1 )
  {
    result = _stack_chk_guard - v27;
    if ( _stack_chk_guard == v27 )
      break;
LABEL_17:
    v19 = j_requestToString(*(_DWORD *)v4[1]);
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v19);
    free(v2);
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3EAC: using guessed type int __fastcall _aeabi_memclr4(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (000096E0) --------------------------------------------------------
int __fastcall sub_96E0(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 84 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(v4, v3[1]);
      android::Parcel::writeInt32(v4, v3[2]);
      android::Parcel::writeInt32(v4, v3[3]);
      sub_A0F8((int)v4, (int)(v3 + 4));
      android::Parcel::writeInt32(v4, v3[20]);
      return 0;
    }
    v7 = a3;
    v8 = 12;
    v6 = "invalid response length was %d expected %d";
  }
  else
  {
    v6 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009764) --------------------------------------------------------
int __fastcall sub_9764(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r0
  int v5; // r0
  int v6; // r0
  int v7; // r0
  int v8; // r7
  int v9; // r0
  unsigned int v10; // r2
  unsigned int v11; // r0
  signed int v12; // r1
  int v13; // r0
  int v14; // r5
  const char *v15; // r0
  int result; // r0
  int v17; // [sp+8h] [bp-78h]
  unsigned int v18; // [sp+Ch] [bp-74h]
  int v19; // [sp+10h] [bp-70h]
  int v20; // [sp+14h] [bp-6Ch]
  int v21; // [sp+18h] [bp-68h]
  int v22; // [sp+1Ch] [bp-64h]
  int v23; // [sp+20h] [bp-60h]
  int v24; // [sp+60h] [bp-20h]
  int v25; // [sp+68h] [bp-18h]

  v2 = a1;
  v3 = a2;
  _aeabi_memclr8(&v19, 84);
  v4 = android::Parcel::readInt32(v2, &v17);
  v19 = v17;
  if ( !v4 )
  {
    v5 = android::Parcel::readInt32(v2, &v17);
    v20 = v17;
    if ( !v5 )
    {
      v6 = android::Parcel::readInt32(v2, &v17);
      v21 = v17;
      if ( !v6 )
      {
        v7 = android::Parcel::readInt32(v2, &v17);
        v22 = v17;
        if ( !v7 )
        {
          v8 = android::Parcel::readString16Inplace(v2, &v18);
          if ( v8 )
          {
            v9 = strnlen16to8();
            v10 = v9;
            v11 = v9 + 1;
            v12 = 1;
            if ( v11 >= v10 )
              v12 = 0;
            if ( v12 )
              abort();
            if ( v11 <= 0x40 )
            {
              if ( strncpy16to8(&v23, v8) )
              {
                v13 = android::Parcel::readInt32(v2, &v17);
                v24 = v17;
                if ( !v13 )
                  goto LABEL_14;
              }
            }
          }
        }
      }
    }
  }
  v14 = *v3;
  v15 = j_requestToString(*(_DWORD *)v3[1]);
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v14, v15);
  while ( 1 )
  {
    result = _stack_chk_guard - v25;
    if ( _stack_chk_guard == v25 )
      break;
LABEL_14:
    dword_166DC(*(_DWORD *)v3[1], &v19, 84);
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3EA0: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 3EDC: using guessed type int strnlen16to8(void);
// 3EE8: using guessed type int __fastcall strncpy16to8(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00009864) --------------------------------------------------------
int __fastcall sub_9864(android::Parcel *this, void *a2, int a3)
{
  _DWORD *v3; // r4
  android::Parcel *v4; // r5
  int result; // r0

  v3 = a2;
  v4 = this;
  if ( a2 && a3 == 8 )
  {
    android::Parcel::write(this, a2, 1u);
    android::Parcel::writeInt32(v4, v3[1]);
    result = 0;
  }
  else
  {
    if ( a2 )
      _android_log_buf_print(1, 6, "RILC", "responseLceStatus: invalid response length %u expecting len: %u", 8, a3);
    else
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    result = -1;
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000098C8) --------------------------------------------------------
int __fastcall sub_98C8(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  int result; // r0

  v3 = a2;
  v4 = this;
  if ( a2 && a3 == 8 )
  {
    android::Parcel::writeInt32(this, *a2);
    android::Parcel::write(v4, v3 + 1, 1u);
    android::Parcel::write(v4, (char *)v3 + 5, 1u);
    result = 0;
  }
  else
  {
    if ( a2 )
      _android_log_buf_print(1, 6, "RILC", "responseLceData: invalid response length %u expecting len: %u", 8, a3);
    else
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    result = -1;
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000993C) --------------------------------------------------------
int __fastcall sub_993C(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r4
  android::Parcel *v4; // r5
  int v5; // r7
  signed int v6; // r1
  int result; // r0

  v3 = a2;
  v4 = this;
  if ( a2 && a3 == 32 )
  {
    android::Parcel::writeInt32(this, *a2);
    android::Parcel::writeInt32(v4, v3[1]);
    v5 = 0;
    while ( v5 < 5 )
    {
      android::Parcel::writeInt32(v4, v3[v5 + 2]);
      v6 = 1;
      if ( v5 + 1 > v5 )
        v6 = 0;
      ++v5;
      if ( v6 )
        abort();
    }
    android::Parcel::writeInt32(v4, v3[7]);
    result = 0;
  }
  else
  {
    if ( a2 )
      _android_log_buf_print(1, 6, "RILC", "responseActivityData: invalid response length %u expecting len: %u", 32, a3);
    else
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    result = -1;
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000099D0) --------------------------------------------------------
int __fastcall sub_99D0(android::Parcel *this, int a2)
{
  android::Parcel *v2; // r7
  int v3; // r4
  _DWORD *v4; // r8
  _DWORD *v5; // r11
  signed int v6; // r6
  int v7; // r5
  const char *v8; // r0
  int result; // r0
  const char *v10; // r0
  size_t v11; // r9
  _DWORD *v12; // r0
  int v13; // r5
  int v14; // r0
  int v15; // r0
  _DWORD *v16; // r6
  int v17; // r0
  int v18; // r0
  signed int v19; // r1
  const char *v20; // r0
  int v21; // r6
  int v22; // r0
  int v23; // r0
  _DWORD *v24; // r5
  int v25; // r0
  int v26; // r0
  signed int v27; // r1
  size_t nmemb; // [sp+Ch] [bp-44h]
  __int64 v29; // [sp+10h] [bp-40h]
  __int64 v30; // [sp+18h] [bp-38h]
  unsigned int v31; // [sp+24h] [bp-2Ch]
  int v32; // [sp+28h] [bp-28h]

  v2 = this;
  v3 = a2;
  v29 = 0LL;
  v30 = 0LL;
  if ( android::s_callbacks <= 13 )
  {
    _android_log_buf_print(1, 6, "RILC", "Unsuppoted RIL version %d, min version expected %d", android::s_callbacks, 14);
    j_RIL_onRequestComplete(v3, 6, 0, 0);
    goto LABEL_13;
  }
  if ( android::Parcel::readInt32(this, (int *)&nmemb) )
  {
    v4 = 0;
    v5 = 0;
  }
  else
  {
    v6 = nmemb;
    v5 = calloc(nmemb, 0x10u);
    if ( !v5 )
      goto LABEL_14;
    LODWORD(v29) = v6;
    LODWORD(v30) = v5;
    if ( !android::Parcel::readInt32(v2, (int *)&nmemb) )
    {
      v11 = nmemb;
      v12 = calloc(nmemb, 0x10u);
      v4 = v12;
      if ( v12 )
      {
        HIDWORD(v29) = v11;
        v13 = 0;
        HIDWORD(v30) = v12;
        while ( v13 < v6 )
        {
          v14 = android::Parcel::readString16Inplace(v2, &v31);
          v5[4 * v13] = strndup16to8(v14, v31);
          v15 = android::Parcel::readString16Inplace(v2, &v31);
          v16 = &v5[4 * v13];
          v16[1] = strndup16to8(v15, v31);
          v17 = android::Parcel::readInt32(v2, (int *)&nmemb);
          v16[2] = nmemb;
          if ( v17 )
            goto LABEL_8;
          v18 = android::Parcel::readString16Inplace(v2, &v31);
          v16[3] = strndup16to8(v18, v31);
          v19 = 1;
          if ( v13 + 1 > v13 )
            v19 = 0;
          if ( v19 )
LABEL_31:
            abort();
          v6 = v29;
          ++v13;
        }
        v21 = 0;
        while ( v21 < SHIDWORD(v29) )
        {
          v22 = android::Parcel::readString16Inplace(v2, &v31);
          v4[4 * v21] = strndup16to8(v22, v31);
          v23 = android::Parcel::readString16Inplace(v2, &v31);
          v24 = &v4[4 * v21];
          v24[1] = strndup16to8(v23, v31);
          v25 = android::Parcel::readInt32(v2, (int *)&nmemb);
          v24[2] = nmemb;
          if ( v25 )
            goto LABEL_8;
          v26 = android::Parcel::readString16Inplace(v2, &v31);
          v24[3] = strndup16to8(v26, v31);
          v27 = 1;
          if ( v21 + 1 > v21 )
            v27 = 0;
          ++v21;
          if ( v27 )
            goto LABEL_31;
        }
        dword_166DC(**(_DWORD **)(v3 + 4), &v29, 16);
      }
      else
      {
        v20 = j_requestToString(**(_DWORD **)(v3 + 4));
        _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v20);
      }
      goto LABEL_9;
    }
    v4 = 0;
  }
LABEL_8:
  v7 = *(_DWORD *)v3;
  v8 = j_requestToString(**(_DWORD **)(v3 + 4));
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v7, v8);
  j_RIL_onRequestComplete(v3, 44, 0, 0);
LABEL_9:
  if ( v5 )
    free(v5);
  if ( v4 )
    free(v4);
LABEL_13:
  while ( 1 )
  {
    result = _stack_chk_guard - v32;
    if ( _stack_chk_guard == v32 )
      break;
LABEL_14:
    v10 = j_requestToString(**(_DWORD **)(v3 + 4));
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v10);
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00009C2C) --------------------------------------------------------
int __fastcall sub_9C2C(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r4
  android::Parcel *v4; // r5
  int v5; // r6
  int v6; // r7
  int *v7; // r7
  signed int v8; // r1
  const char *v9; // r3
  int v11; // r6
  int v12; // r7
  int *v13; // r7
  signed int v14; // r1
  int v15; // [sp+0h] [bp-20h]
  signed int v16; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = this;
  if ( !a2 )
  {
    v9 = "invalid response: NULL";
LABEL_11:
    _android_log_buf_print(1, 6, "RILC", v9, v15, v16);
    return -1;
  }
  if ( a3 != 16 )
  {
    v15 = a3;
    v16 = 16;
    v9 = "responseCarrierRestrictions: invalid response length %u expecting len: %u";
    goto LABEL_11;
  }
  android::Parcel::writeInt32(this, *a2);
  android::Parcel::writeInt32(v4, v3[1]);
  v5 = 0;
  while ( v5 < *v3 )
  {
    v6 = v3[2];
    sub_A0F8((int)v4, *(_DWORD *)(v6 + 16 * v5));
    v7 = (int *)(v6 + 16 * v5);
    sub_A0F8((int)v4, v7[1]);
    android::Parcel::writeInt32(v4, v7[2]);
    sub_A0F8((int)v4, v7[3]);
    v8 = 1;
    if ( v5 + 1 > v5 )
      v8 = 0;
    ++v5;
    if ( v8 )
LABEL_17:
      abort();
  }
  v11 = 0;
  while ( v11 < v3[1] )
  {
    v12 = v3[3];
    sub_A0F8((int)v4, *(_DWORD *)(v12 + 16 * v11));
    v13 = (int *)(v12 + 16 * v11);
    sub_A0F8((int)v4, v13[1]);
    android::Parcel::writeInt32(v4, v13[2]);
    sub_A0F8((int)v4, v13[3]);
    v14 = 1;
    if ( v11 + 1 > v11 )
      v14 = 0;
    ++v11;
    if ( v14 )
      goto LABEL_17;
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009D14) --------------------------------------------------------
int __fastcall sub_9D14(android::Parcel *this, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r6
  int v5; // r0
  void *v6; // r0
  void *v7; // r4
  void *v8; // r0
  int v9; // r0
  int v10; // r5
  const char *v11; // r0
  char v13; // [sp+Fh] [bp-21h]
  int v14; // [sp+10h] [bp-20h]
  void *ptr; // [sp+14h] [bp-1Ch]
  unsigned int v16; // [sp+18h] [bp-18h]
  int v17; // [sp+1Ch] [bp-14h]

  v2 = this;
  v3 = a2;
  v14 = 0;
  ptr = 0;
  v4 = android::Parcel::read(this, &v13, 1u);
  LOBYTE(v14) = v13;
  v5 = android::Parcel::readString16Inplace(v2, &v16);
  v6 = (void *)strndup16to8(v5, v16);
  ptr = v6;
  if ( v4 || !v6 )
  {
    v10 = *v3;
    v11 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v10, v11);
  }
  else
  {
    dword_166DC(*(_DWORD *)v3[1], &v14, 8);
    v7 = ptr;
    v8 = 0;
    if ( ptr )
    {
      v9 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v7, v9);
      v8 = ptr;
    }
    free(v8);
    v14 = 0;
    ptr = 0;
  }
  return _stack_chk_guard - v17;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00009DD8) --------------------------------------------------------
int __fastcall sub_9DD8(android::Parcel *this, int *a2)
{
  void **v2; // r7
  android::Parcel *v3; // r5
  int *v4; // r8
  int v5; // r0
  int v6; // r0
  int v7; // r0
  int v8; // r0
  int v9; // r1
  int i; // r4
  int v11; // r0
  signed int v12; // r1
  int v13; // r0
  int v14; // r1
  int v15; // r4
  const char *v16; // r0
  int result; // r0
  int j; // r4
  int v19; // r0
  signed int v20; // r1
  void *v21; // r4
  int v22; // r0
  void *v23; // r4
  int v24; // r0
  int v25; // r6
  int *v26; // r7
  int v27; // r4
  int v28; // t1
  int v29; // r0
  void *v30; // r0
  signed int v31; // r1
  int v32; // r6
  int *v33; // r7
  int v34; // r4
  int v35; // t1
  int v36; // r0
  void *v37; // r0
  signed int v38; // r1
  int v39; // [sp+8h] [bp-50h]
  unsigned int v40; // [sp+Ch] [bp-4Ch]
  int v41; // [sp+10h] [bp-48h]
  void *ptr; // [sp+14h] [bp-44h]
  void *v43; // [sp+18h] [bp-40h]
  int v44; // [sp+1Ch] [bp-3Ch]
  int v45; // [sp+20h] [bp-38h]
  int v46; // [sp+28h] [bp-30h]
  __int64 v47; // [sp+2Ch] [bp-2Ch]
  __int64 v48; // [sp+34h] [bp-24h]
  int v49; // [sp+3Ch] [bp-1Ch]

  v3 = this;
  v4 = a2;
  v5 = android::Parcel::readInt32(this, &v39);
  v41 = v39;
  if ( !v5 )
  {
    v6 = android::Parcel::readString16Inplace(v3, &v40);
    ptr = (void *)strndup16to8(v6, v40);
    v7 = android::Parcel::readString16Inplace(v3, &v40);
    v43 = (void *)strndup16to8(v7, v40);
    v8 = android::Parcel::readInt32(v3, &v39);
    v9 = v39;
    v44 = v39;
    if ( !v8 )
    {
      v2 = (void **)&v41;
      for ( i = 0; i < v9; ++i )
      {
        v11 = android::Parcel::readString16Inplace(v3, &v40);
        *(&v41 + i + 4) = strndup16to8(v11, v40);
        v12 = 1;
        if ( i + 1 > i )
          v12 = 0;
        if ( v12 )
LABEL_41:
          abort();
        v9 = v44;
      }
      v13 = android::Parcel::readInt32(v3, &v39);
      v14 = v39;
      v46 = v39;
      if ( !v13 )
        goto LABEL_13;
    }
  }
  v15 = *v4;
  v16 = j_requestToString(*(_DWORD *)v4[1]);
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v15, v16);
  while ( 1 )
  {
    v14 = v49;
    result = _stack_chk_guard - v49;
    if ( _stack_chk_guard == v49 )
      return result;
LABEL_13:
    for ( j = 0; j < v14; ++j )
    {
      v19 = android::Parcel::readString16Inplace(v3, &v40);
      v2[j + 7] = (void *)strndup16to8(v19, v40);
      v20 = 1;
      if ( j + 1 > j )
        v20 = 0;
      if ( v20 )
        goto LABEL_41;
      v14 = v46;
    }
    v2 = (void **)dword_166DC;
    dword_166DC(*(_DWORD *)v4[1], &v41, 44);
    v21 = ptr;
    if ( ptr )
    {
      v22 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v21, v22);
    }
    v23 = v43;
    if ( v43 )
    {
      v24 = _strlen_chk(v43, -1);
      _aeabi_memclr(v23, v24);
    }
    free(ptr);
    free(v43);
    v25 = 0;
    while ( v25 < v44 )
    {
      v26 = &v41 + v25;
      v28 = v26[4];
      v2 = (void **)(v26 + 4);
      v27 = v28;
      if ( v28 )
      {
        v29 = _strlen_chk(v27, -1);
        _aeabi_memclr(v27, v29);
        v30 = *v2;
      }
      else
      {
        v30 = 0;
      }
      free(v30);
      v31 = 1;
      if ( v25 + 1 > v25 )
        v31 = 0;
      ++v25;
      if ( v31 )
        goto LABEL_41;
    }
    v32 = 0;
    while ( v32 < v46 )
    {
      v33 = &v41 + v32;
      v35 = v33[7];
      v2 = (void **)(v33 + 7);
      v34 = v35;
      if ( v35 )
      {
        v36 = _strlen_chk(v34, -1);
        _aeabi_memclr(v34, v36);
        v37 = *v2;
      }
      else
      {
        v37 = 0;
      }
      free(v37);
      v38 = 1;
      if ( v32 + 1 > v32 )
        v38 = 0;
      ++v32;
      if ( v38 )
        goto LABEL_41;
    }
    v47 = 0LL;
    v48 = 0LL;
    *(_QWORD *)&v41 = 0LL;
    *(_QWORD *)&v43 = 0LL;
    v3 = (android::Parcel *)&v45;
    *(_QWORD *)&v45 = 0LL;
    *(_QWORD *)&v46 = 0LL;
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C00: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3E34: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);

//----- (00009FD8) --------------------------------------------------------
int __fastcall sub_9FD8(android::Parcel *a1, int *a2)
{
  int *v2; // r4
  android::Parcel *v3; // r5

  v2 = a2;
  v3 = a1;
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(v3, v2[1]);
  android::Parcel::writeInt32(v3, v2[2]);
  android::Parcel::writeInt32(v3, v2[3]);
  android::Parcel::writeInt32(v3, v2[4]);
  sub_A040(v3, v2[5], (int)(v2 + 6));
  android::Parcel::writeInt32(v3, v2[102]);
  return _android_log_buf_print(1, 3, "RILC", "FIH_QCRIL_UIM_HOTSWAP_PUK, SIM hotswap state: %d", v2[102]);
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A040) --------------------------------------------------------
int __fastcall sub_A040(android::Parcel *a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r8
  android::Parcel *v5; // r6
  int result; // r0
  int v7; // r7
  int *v8; // r5
  signed int v9; // r1
  int v10; // r7
  int *v11; // r5
  signed int v12; // r1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  result = android::Parcel::writeInt32(a1, a2);
  v7 = 0;
  while ( v7 < v4 )
  {
    android::Parcel::writeInt32(v5, *(_DWORD *)(v3 + 48 * v7));
    v8 = (int *)(v3 + 48 * v7);
    android::Parcel::writeInt32(v5, v8[1]);
    android::Parcel::writeInt32(v5, v8[2]);
    sub_A0F8((int)v5, v8[3]);
    sub_A0F8((int)v5, v8[4]);
    android::Parcel::writeInt32(v5, v8[5]);
    android::Parcel::writeInt32(v5, v8[6]);
    android::Parcel::writeInt32(v5, v8[7]);
    result = v7 + 1;
    v9 = 1;
    if ( v7 + 1 > v7 )
      v9 = 0;
    ++v7;
    if ( v9 )
LABEL_12:
      abort();
  }
  v10 = 0;
  while ( v10 < v4 )
  {
    v11 = (int *)(v3 + 48 * v10);
    android::Parcel::writeInt32(v5, v11[8]);
    android::Parcel::writeInt32(v5, v11[9]);
    android::Parcel::writeInt32(v5, v11[10]);
    android::Parcel::writeInt32(v5, v11[11]);
    result = v10 + 1;
    v12 = 1;
    if ( v10 + 1 > v10 )
      v12 = 0;
    ++v10;
    if ( v12 )
      goto LABEL_12;
  }
  return result;
}

//----- (0000A0F8) --------------------------------------------------------
int __fastcall sub_A0F8(int a1, int a2)
{
  int v2; // r4
  void *v3; // r5
  int v5; // [sp+0h] [bp-18h]
  int v6; // [sp+4h] [bp-14h]

  v2 = a1;
  v3 = (void *)strdup8to16(a2, &v5);
  android::Parcel::writeString16(v2, v3, v5);
  free(v3);
  return _stack_chk_guard - v6;
}
// 3EF4: using guessed type int __fastcall strdup8to16(_DWORD, _DWORD);
// 3F00: using guessed type int __fastcall android::Parcel::writeString16(_DWORD, _DWORD, _DWORD);

//----- (0000A144) --------------------------------------------------------
int __fastcall sub_A144(android::Parcel *a1, int *a2)
{
  int *v2; // r5
  android::Parcel *v3; // r4

  v2 = a2;
  v3 = a1;
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(v3, v2[1]);
  android::Parcel::writeInt32(v3, v2[4]);
  android::Parcel::writeInt32(v3, v2[5]);
  android::Parcel::writeInt32(v3, v2[6]);
  android::Parcel::writeInt32(v3, v2[7]);
  return android::Parcel::writeInt32(v3, v2[8]);
}

//----- (0000A184) --------------------------------------------------------
int __fastcall sub_A184(android::Parcel *this, _DWORD *a2)
{
  _DWORD *v2; // r5
  android::Parcel *v3; // r4
  int v4; // r1
  signed int v5; // r0
  signed int v6; // r3
  int v7; // r0

  v2 = a2;
  v3 = this;
  v4 = a2[9];
  if ( v4 == -1 )
  {
    v4 = 99;
    v2[9] = 99;
  }
  v5 = v2[10];
  if ( v5 == -1 )
  {
    v7 = 0x7FFFFFFF;
  }
  else
  {
    if ( v5 >= -1 )
      goto LABEL_11;
    v6 = 1;
    if ( !__OFSUB__(0, v5) )
      v6 = 0;
    if ( v6 )
      abort();
    v7 = -v5;
  }
  v2[10] = v7;
LABEL_11:
  if ( v2[11] == -1 )
    v2[11] = 0x7FFFFFFF;
  if ( v2[13] == -1 )
    v2[13] = 0x7FFFFFFF;
  android::Parcel::writeInt32(v3, v4);
  android::Parcel::writeInt32(v3, v2[10]);
  android::Parcel::writeInt32(v3, v2[11]);
  android::Parcel::writeInt32(v3, v2[12]);
  return android::Parcel::writeInt32(v3, v2[13]);
}

//----- (0000A200) --------------------------------------------------------
int __fastcall sub_A200(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  android::Parcel *v4; // r5
  const char *v5; // r3
  int v6; // r9
  int v8; // r7
  int *v9; // r6
  signed int v10; // r1
  int v11; // [sp+0h] [bp-28h]
  signed int v12; // [sp+4h] [bp-24h]

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v5, v11, v12);
    return -1;
  }
  v6 = a3 / 0x2C;
  if ( a3 != 44 * (a3 / 0x2C) )
  {
    v11 = a3;
    v12 = 44;
    v5 = "invalid response length %d expected multiple of %d";
    goto LABEL_6;
  }
  android::Parcel::writeInt32(this, 11);
  android::Parcel::writeInt32(v4, v6);
  v8 = 0;
  while ( v8 < v6 )
  {
    android::Parcel::writeInt32(v4, *(_DWORD *)(v3 + 44 * v8));
    v9 = (int *)(44 * v8 + v3);
    android::Parcel::writeInt32(v4, v9[1]);
    android::Parcel::writeInt32(v4, v9[2]);
    android::Parcel::writeInt32(v4, v9[3]);
    sub_A0F8((int)v4, v9[4]);
    sub_A0F8((int)v4, v9[5]);
    sub_A0F8((int)v4, v9[6]);
    sub_A0F8((int)v4, v9[7]);
    sub_A0F8((int)v4, v9[8]);
    sub_A0F8((int)v4, v9[9]);
    android::Parcel::writeInt32(v4, v9[10]);
    v10 = 1;
    if ( v8 + 1 > v8 )
      v10 = 0;
    ++v8;
    if ( v10 )
      abort();
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A2F4) --------------------------------------------------------
int __fastcall sub_A2F4(android::Parcel *a1, int a2)
{
  android::Parcel *v2; // r5
  int v3; // r4
  signed int v4; // r7
  int v5; // r6
  signed int v6; // r1
  signed int v7; // r7
  int v8; // r6
  signed int v9; // r1
  int result; // r0
  int v11; // r7
  int v12; // r6
  signed int v13; // r2
  unsigned __int8 v14; // [sp+7h] [bp-21h]
  int v15; // [sp+8h] [bp-20h]

  v2 = a1;
  v3 = a2;
  _aeabi_memclr4(a2, 372);
  android::Parcel::readInt32(v2, &v15);
  *(_DWORD *)v3 = v15;
  android::Parcel::read(v2, &v14, 1u);
  *(_BYTE *)(v3 + 4) = v14;
  android::Parcel::readInt32(v2, &v15);
  *(_DWORD *)(v3 + 8) = v15;
  android::Parcel::readInt32(v2, &v15);
  *(_DWORD *)(v3 + 12) = v15;
  android::Parcel::readInt32(v2, &v15);
  *(_DWORD *)(v3 + 16) = v15;
  android::Parcel::readInt32(v2, &v15);
  *(_DWORD *)(v3 + 20) = v15;
  android::Parcel::readInt32(v2, &v15);
  *(_DWORD *)(v3 + 24) = v15;
  android::Parcel::read(v2, &v14, 1u);
  v4 = v14;
  v5 = 0;
  *(_BYTE *)(v3 + 28) = v14;
  if ( (unsigned int)v4 >= 0x24 )
    v4 = 36;
  while ( v5 < v4 )
  {
    android::Parcel::read(v2, &v14, 1u);
    *(_BYTE *)(v3 + v5 + 29) = v14;
    v6 = 1;
    if ( v5 + 1 > v5 )
      v6 = 0;
    ++v5;
    if ( v6 )
LABEL_21:
      abort();
  }
  android::Parcel::readInt32(v2, &v15);
  *(_DWORD *)(v3 + 68) = v15;
  android::Parcel::read(v2, &v14, 1u);
  *(_BYTE *)(v3 + 72) = v14;
  android::Parcel::read(v2, &v14, 1u);
  v7 = v14;
  v8 = 0;
  *(_BYTE *)(v3 + 73) = v14;
  if ( (unsigned int)v7 >= 0x24 )
    v7 = 36;
  while ( v8 < v7 )
  {
    android::Parcel::read(v2, &v14, 1u);
    *(_BYTE *)(v3 + v8 + 74) = v14;
    v9 = 1;
    if ( v8 + 1 > v8 )
      v9 = 0;
    ++v8;
    if ( v9 )
      goto LABEL_21;
  }
  result = android::Parcel::readInt32(v2, &v15);
  v11 = v15;
  *(_DWORD *)(v3 + 112) = v15;
  v12 = 0;
  if ( v11 >= 255 )
    v11 = 255;
  while ( v12 < v11 )
  {
    result = android::Parcel::read(v2, &v14, 1u);
    *(_BYTE *)(v3 + v12 + 116) = v14;
    v13 = 1;
    if ( v12 + 1 > v12 )
      v13 = 0;
    ++v12;
    if ( v13 )
      goto LABEL_21;
  }
  return result;
}
// 3EAC: using guessed type int __fastcall _aeabi_memclr4(_DWORD, _DWORD);

//----- (0000A47C) --------------------------------------------------------
int __fastcall sub_A47C(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r6
  android::Parcel *v4; // r4
  const char *v5; // r3
  signed int v6; // r5
  int *v8; // r6
  int v9; // r0
  int v10; // r7
  int v11; // r1
  signed int v12; // r1
  int v13; // [sp+0h] [bp-20h]
  signed int v14; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v5, v13, v14);
    return -1;
  }
  v6 = a3 / 0x48;
  if ( a3 % 0x48 )
  {
    v13 = a3;
    v14 = 72;
    v5 = "responseCellInfoList: invalid response length %d expected multiple of %d";
    goto LABEL_6;
  }
  android::Parcel::writeInt32(this, a3 / 0x48);
  v8 = (int *)(v3 + 36);
  v9 = 0;
  while ( 1 )
  {
    v10 = v9;
    if ( v9 >= v6 )
      return 0;
    android::Parcel::writeInt32(v4, *(v8 - 9));
    android::Parcel::writeInt32(v4, *(v8 - 8));
    android::Parcel::writeInt32(v4, *(v8 - 7));
    android::Parcel::writeInt64(v4, *(_QWORD *)(v8 - 5));
    switch ( *(v8 - 9) )
    {
      case 1:
        android::Parcel::writeInt32(v4, *(v8 - 3));
        android::Parcel::writeInt32(v4, *(v8 - 2));
        android::Parcel::writeInt32(v4, *(v8 - 1));
        android::Parcel::writeInt32(v4, *v8);
        android::Parcel::writeInt32(v4, v8[1]);
        android::Parcel::writeInt32(v4, *((unsigned __int8 *)v8 + 8));
        android::Parcel::writeInt32(v4, v8[3]);
        android::Parcel::writeInt32(v4, v8[4]);
        v11 = v8[5];
        goto LABEL_15;
      case 2:
        android::Parcel::writeInt32(v4, *(v8 - 3));
        android::Parcel::writeInt32(v4, *(v8 - 2));
        android::Parcel::writeInt32(v4, *(v8 - 1));
        android::Parcel::writeInt32(v4, *v8);
        android::Parcel::writeInt32(v4, v8[1]);
        android::Parcel::writeInt32(v4, v8[2]);
        android::Parcel::writeInt32(v4, v8[3]);
        android::Parcel::writeInt32(v4, v8[4]);
        android::Parcel::writeInt32(v4, v8[5]);
        v11 = v8[6];
        goto LABEL_15;
      case 3:
        android::Parcel::writeInt32(v4, *(v8 - 3));
        android::Parcel::writeInt32(v4, *(v8 - 2));
        android::Parcel::writeInt32(v4, *(v8 - 1));
        android::Parcel::writeInt32(v4, *v8);
        android::Parcel::writeInt32(v4, v8[1]);
        android::Parcel::writeInt32(v4, v8[2]);
        android::Parcel::writeInt32(v4, v8[3]);
        android::Parcel::writeInt32(v4, v8[4]);
        android::Parcel::writeInt32(v4, v8[5]);
        android::Parcel::writeInt32(v4, v8[6]);
        android::Parcel::writeInt32(v4, v8[7]);
        v11 = v8[8];
        goto LABEL_15;
      case 4:
        android::Parcel::writeInt32(v4, *(v8 - 3));
        android::Parcel::writeInt32(v4, *(v8 - 2));
        android::Parcel::writeInt32(v4, *(v8 - 1));
        android::Parcel::writeInt32(v4, *v8);
        android::Parcel::writeInt32(v4, v8[1]);
        android::Parcel::writeInt32(v4, v8[2]);
        android::Parcel::writeInt32(v4, v8[3]);
        v11 = v8[4];
        goto LABEL_15;
      case 5:
        android::Parcel::writeInt32(v4, *(v8 - 3));
        android::Parcel::writeInt32(v4, *(v8 - 2));
        android::Parcel::writeInt32(v4, *(v8 - 1));
        android::Parcel::writeInt32(v4, *v8);
        android::Parcel::writeInt32(v4, v8[1]);
        v11 = v8[2];
LABEL_15:
        android::Parcel::writeInt32(v4, v11);
        break;
      default:
        break;
    }
    v9 = v10 + 1;
    v8 += 18;
    v12 = 1;
    if ( v10 + 1 > v10 )
      v12 = 0;
    if ( v12 )
      abort();
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A6C4) --------------------------------------------------------
void __fastcall sub_A6C4(int a1, _DWORD *a2)
{
  _DWORD *v2; // r4
  int v3; // r5
  int v4; // r6
  void *v5; // r0
  signed int v6; // r1

  v2 = a2;
  v3 = a1;
  v4 = 0;
  while ( v4 < v3 )
  {
    v5 = (void *)v2[v4];
    if ( v5 )
      free(v5);
    v6 = 1;
    if ( v4 + 1 > v4 )
      v6 = 0;
    ++v4;
    if ( v6 )
      abort();
  }
  j_free(v2);
}

//----- (0000A6F8) --------------------------------------------------------
int __fastcall sub_A6F8(int a1, int a2, int a3)
{
  int v3; // r9
  int v4; // r5
  int v5; // r8
  _BYTE *v6; // r0
  int v7; // r7
  int v8; // r1
  const char *v9; // r0
  int result; // r0
  const char *v11; // r0

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = calloc(1u, 0x18u);
  v7 = (int)v6;
  if ( v6 )
  {
    v6[13] = 1;
    *((_DWORD *)v6 + 1) = (char *)&unk_1601C + 12 * v4;
    *(_DWORD *)v6 = -1;
    pthread_mutex_lock((pthread_mutex_t *)&unk_167D0);
    v8 = dword_167D4;
    dword_167D4 = v7;
    *(_DWORD *)(v7 + 8) = v8;
    pthread_mutex_unlock((pthread_mutex_t *)&unk_167D0);
    v9 = j_requestToString(v4);
    _android_log_buf_print(1, 3, "RILC", "C[locl]> %s", v9);
    result = dword_166DC(v4, v3, v5);
  }
  else
  {
    v11 = j_requestToString(v4);
    result = _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v11);
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 166DC: using guessed type int (__fastcall *dword_166DC)(_DWORD, _DWORD, _DWORD);
// 167D4: using guessed type int dword_167D4;

//----- (0000A7B4) --------------------------------------------------------
int sub_A7B4()
{
  pthread_t v0; // r0
  int result; // r0

  v0 = pthread_self();
  result = pthread_equal(v0, dword_166FC);
  if ( !result )
  {
    do
    {
      result = _write_chk(dword_167A8, " ", 1, 2);
      if ( result > -1 )
        break;
      result = *(_DWORD *)_errno(result);
    }
    while ( result == 4 );
  }
  return result;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3E04: using guessed type int __fastcall _write_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 166FC: using guessed type int dword_166FC;
// 167A8: using guessed type int dword_167A8;

//----- (0000A7F8) --------------------------------------------------------
signed int __fastcall sub_A7F8(int a1, unsigned int a2)
{
  int v2; // r6
  unsigned int v3; // r5
  int v4; // r7
  signed int v5; // r4
  unsigned int v7; // [sp+Ch] [bp-1Ch]
  int v8; // [sp+10h] [bp-18h]

  v2 = a1;
  v3 = a2;
  v4 = dword_16710;
  if ( dword_16710 >= 0 )
  {
    if ( a2 <= 0x2000 )
      goto LABEL_7;
    _android_log_buf_print(1, 6, "RILC", "RIL: packet larger than %u (%u)", 0x2000, a2);
  }
  v5 = -1;
  while ( _stack_chk_guard != v8 )
  {
LABEL_7:
    pthread_mutex_lock((pthread_mutex_t *)&unk_167D8);
    v7 = bswap32(v3);
    v5 = sub_69B4(v4, (int)&v7, 4u);
    if ( v5 <= -1 )
    {
      pthread_mutex_unlock((pthread_mutex_t *)&unk_167D8);
    }
    else
    {
      v5 = sub_69B4(v4, v2, v3);
      pthread_mutex_unlock((pthread_mutex_t *)&unk_167D8);
      if ( v5 >= 0 )
        v5 = 0;
    }
  }
  return v5;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 16710: using guessed type int dword_16710;

//----- (0000A8B4) --------------------------------------------------------
int __fastcall sub_A8B4(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 20 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(v4, v3[1]);
      android::Parcel::writeInt32(v4, v3[2]);
      android::Parcel::writeInt32(v4, v3[3]);
      sub_A0F8((int)v4, v3[4]);
      return 0;
    }
    v7 = a3;
    v8 = 20;
    v6 = "invalid response length was %d expected %d";
  }
  else
  {
    v6 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A92C) --------------------------------------------------------
int __fastcall sub_A92C(android::Parcel *this, int *a2, unsigned int a3)
{
  android::Parcel *v3; // r4
  int *v4; // r5
  signed int v5; // r5
  int result; // r0
  int v7; // [sp+0h] [bp-70h]
  int v8; // [sp+5Ch] [bp-14h]

  v3 = this;
  v4 = a2;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "responseSimRefresh: invalid response: NULL");
LABEL_4:
    v5 = -1;
    goto LABEL_11;
  }
  if ( android::s_callbacks > 12 )
  {
    if ( a3 % 0xC )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_SimRefreshResponse_v7");
      property_get("ro.debuggable", &v7, "0");
      if ( strcmp((const char *)&v7, "1") )
        goto LABEL_4;
    }
  }
  else if ( android::s_callbacks < 7 )
  {
    android::Parcel::writeInt32(this, *a2);
    android::Parcel::writeInt32(v3, v4[1]);
    v5 = 0;
    sub_A0F8((int)v3, 0);
    goto LABEL_11;
  }
  sub_B398(v3, v4);
  v5 = 0;
LABEL_11:
  result = _stack_chk_guard - v8;
  if ( _stack_chk_guard == v8 )
    result = v5;
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3E1C: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;

//----- (0000AA18) --------------------------------------------------------
signed int __fastcall sub_AA18(android::Parcel *a1, unsigned __int8 *a2, int a3)
{
  android::Parcel *v3; // r3
  signed int result; // r0

  v3 = a1;
  result = 0;
  if ( a2 && a3 )
  {
    if ( a3 == 4 )
    {
      sub_B3B8(v3, a2);
      result = 0;
    }
    else
    {
      _android_log_buf_print(
        1,
        6,
        "RILC",
        "invalid response length %d expected sizeof (RIL_CDMA_SignalInfoRecord) of %d\n",
        a3,
        4);
      result = -1;
    }
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000AA5C) --------------------------------------------------------
signed int __fastcall sub_AA5C(android::Parcel *a1, int *a2, int a3)
{
  int v3; // r6
  int *v4; // r8
  android::Parcel *v5; // r4
  const char *v6; // r3
  signed int v7; // r6
  int v8; // r5
  signed int v9; // r1
  signed int v11; // r6
  int v12; // r5
  signed int v13; // r1
  signed int v14; // r6
  int v15; // r7
  signed int v16; // r1
  int v17; // [sp+0h] [bp-20h]
  signed int v18; // [sp+4h] [bp-1Ch]

  v3 = a3;
  v4 = a2;
  v5 = a1;
  _android_log_buf_print(1, 3, "RILC", "Inside responseCdmaSms");
  if ( !v4 && v3 )
  {
    v6 = "invalid response: NULL";
LABEL_13:
    _android_log_buf_print(1, 6, "RILC", v6, v17, v18);
    return -1;
  }
  if ( v3 != 372 )
  {
    v17 = v3;
    v18 = 372;
    v6 = "invalid response length was %d expected %d";
    goto LABEL_13;
  }
  android::Parcel::writeInt32(v5, *v4);
  android::Parcel::write(v5, v4 + 1, 1u);
  android::Parcel::writeInt32(v5, v4[2]);
  android::Parcel::writeInt32(v5, v4[3]);
  android::Parcel::writeInt32(v5, v4[4]);
  android::Parcel::writeInt32(v5, v4[5]);
  android::Parcel::writeInt32(v5, v4[6]);
  android::Parcel::write(v5, v4 + 7, 1u);
  v7 = *((unsigned __int8 *)v4 + 28);
  v8 = 0;
  if ( (unsigned int)v7 >= 0x24 )
    v7 = 36;
  while ( v8 < v7 )
  {
    android::Parcel::write(v5, (char *)v4 + v8 + 29, 1u);
    v9 = 1;
    if ( v8 + 1 > v8 )
      v9 = 0;
    ++v8;
    if ( v9 )
LABEL_28:
      abort();
  }
  android::Parcel::writeInt32(v5, v4[17]);
  android::Parcel::write(v5, v4 + 18, 1u);
  android::Parcel::write(v5, (char *)v4 + 73, 1u);
  v11 = *((unsigned __int8 *)v4 + 73);
  v12 = 0;
  if ( (unsigned int)v11 >= 0x24 )
    v11 = 36;
  while ( v12 < v11 )
  {
    android::Parcel::write(v5, (char *)v4 + v12 + 74, 1u);
    v13 = 1;
    if ( v12 + 1 > v12 )
      v13 = 0;
    ++v12;
    if ( v13 )
      goto LABEL_28;
  }
  v14 = v4[28];
  android::Parcel::writeInt32(v5, v4[28]);
  if ( v14 >= 255 )
    v14 = 255;
  v15 = 0;
  while ( v15 < v14 )
  {
    android::Parcel::write(v5, (char *)v4 + v15 + 116, 1u);
    v16 = 1;
    if ( v15 + 1 > v15 )
      v16 = 0;
    ++v15;
    if ( v16 )
      goto LABEL_28;
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000ABE0) --------------------------------------------------------
int __fastcall sub_ABE0(android::Parcel *a1, int a2, unsigned int a3)
{
  android::Parcel *v3; // r4
  int v4; // r5
  unsigned int v5; // r6
  signed int v6; // r5
  int result; // r0
  char v8; // [sp+8h] [bp-70h]
  int v9; // [sp+64h] [bp-14h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
LABEL_4:
    v6 = -1;
    goto LABEL_13;
  }
  if ( a3 <= 0x17 )
    _android_log_buf_print(1, 5, "RILC", "Upgrade to ril version %d\n", 12);
  sub_A0F8((int)v3, *(_DWORD *)v4);
  android::Parcel::writeInt32(v3, *(_DWORD *)(v4 + 4));
  sub_A0F8((int)v3, *(_DWORD *)(v4 + 8));
  sub_B3B8(v3, (unsigned __int8 *)(v4 + 12));
  if ( android::s_callbacks > 12 )
  {
    if ( v5 % 0x18 )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_CDMA_CallWaiting_v6");
      property_get("ro.debuggable", &v8, "0");
      if ( strcmp(&v8, "1") )
        goto LABEL_4;
    }
  }
  else if ( v5 < 0x18 )
  {
    v6 = 0;
    android::Parcel::writeInt32(v3, 0);
    android::Parcel::writeInt32(v3, 0);
    goto LABEL_13;
  }
  android::Parcel::writeInt32(v3, *(_DWORD *)(v4 + 16));
  android::Parcel::writeInt32(v3, *(_DWORD *)(v4 + 20));
  v6 = 0;
LABEL_13:
  result = _stack_chk_guard - v9;
  if ( _stack_chk_guard == v9 )
    result = v6;
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3E1C: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 166D8: using guessed type int android::s_callbacks;

//----- (0000AD10) --------------------------------------------------------
int __fastcall sub_AD10(android::Parcel *this, unsigned __int8 *a2, unsigned int a3)
{
  android::Parcel *v3; // r11
  const char *v4; // r3
  int v5; // r9
  int v6; // r10
  int v7; // r0
  int v8; // r6
  unsigned __int8 *v9; // r4
  unsigned int v10; // r5
  _BYTE *v11; // r7
  int v12; // r0
  int v13; // r1
  bool v14; // vf
  signed int v15; // r0
  bool v16; // zf
  int v17; // r1
  unsigned __int8 *v18; // r4
  int v19; // r5
  unsigned int v20; // r4
  _BYTE *v21; // r7
  int v22; // r0
  int v23; // r1
  signed int v24; // r0
  int v25; // r4
  _BYTE *v26; // r7
  int v27; // r0
  int v28; // r1
  signed int v29; // r0
  int v30; // r4
  unsigned int v31; // r1
  int v32; // r4
  signed int v33; // r1
  unsigned int v35; // [sp+0h] [bp-30h]
  signed int v36; // [sp+4h] [bp-2Ch]

  v3 = this;
  if ( !a2 && a3 )
  {
    v4 = "invalid response: NULL";
    goto LABEL_49;
  }
  if ( a3 != 964 )
  {
    v35 = a3;
    v36 = 4;
    v4 = "responseCdmaInformationRecords: invalid response length %d expected multiple of %d\n";
    goto LABEL_49;
  }
  v6 = (int)(a2 + 4);
  v5 = *a2;
  if ( (unsigned int)v5 >= 0xA )
    v5 = 10;
  android::Parcel::writeInt32(this, v5);
  v7 = 0;
  while ( 2 )
  {
    v8 = v7;
    if ( v7 >= v5 )
      return 0;
    android::Parcel::writeInt32(v3, *(_DWORD *)(v6 + 96 * v7));
    switch ( *(_DWORD *)(v6 + 96 * v8) )
    {
      case 0:
        v19 = v6 + 96 * v8;
        v20 = *(unsigned __int8 *)(v19 + 4);
        if ( v20 >= 0x41 )
        {
          v35 = *(unsigned __int8 *)(v19 + 4);
          v36 = 64;
          v4 = "invalid display info response length %d                           expected not more than %d\n";
          goto LABEL_49;
        }
        v21 = calloc(v20 + 1, 1u);
        if ( !v21 )
          goto LABEL_60;
        v22 = 0;
        while ( v22 < (signed int)v20 )
        {
          v21[v22] = *(_BYTE *)(v19 + v22 + 5);
          v23 = v22 + 1;
          v14 = v22 + 1 <= v22;
          v24 = 1;
          if ( !v14 )
            v24 = 0;
          v16 = v24 == 0;
          v22 = v23;
          if ( !v16 )
            goto LABEL_47;
        }
        v21[v20] = 0;
        sub_A0F8((int)v3, (int)v21);
        free(v21);
        goto LABEL_44;
      case 1:
      case 2:
      case 3:
        v9 = (unsigned __int8 *)(v6 + 96 * v8);
        v10 = v9[4];
        if ( v10 < 0x52 )
        {
          v11 = calloc(v10 + 1, 1u);
          if ( !v11 )
            goto LABEL_60;
          v12 = 0;
          while ( v12 < (signed int)v10 )
          {
            v11[v12] = v9[v12 + 5];
            v13 = v12 + 1;
            v14 = v12 + 1 <= v12;
            v15 = 1;
            if ( !v14 )
              v15 = 0;
            v16 = v15 == 0;
            v12 = v13;
            if ( !v16 )
              goto LABEL_47;
          }
          v11[v10] = 0;
          sub_A0F8((int)v3, (int)v11);
          free(v11);
          android::Parcel::writeInt32(v3, v9[86]);
          android::Parcel::writeInt32(v3, v9[87]);
          android::Parcel::writeInt32(v3, v9[88]);
          v17 = v9[89];
LABEL_43:
          android::Parcel::writeInt32(v3, v17);
          goto LABEL_44;
        }
        v4 = "invalid display info response length %d                           expected not more than %d\n";
        goto LABEL_58;
      case 4:
      case 6:
        v18 = (unsigned __int8 *)(v6 + 96 * v8);
        android::Parcel::writeInt32(v3, v18[4]);
        android::Parcel::writeInt32(v3, v18[5]);
        android::Parcel::writeInt32(v3, v18[6]);
        v17 = v18[7];
        goto LABEL_43;
      case 5:
        v25 = v6 + 96 * v8;
        v10 = *(unsigned __int8 *)(v25 + 4);
        if ( v10 < 0x52 )
        {
          v26 = calloc(v10 + 1, 1u);
          if ( !v26 )
          {
LABEL_60:
            _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for responseCdmaInformationRecords");
            return -12;
          }
          v27 = 0;
          while ( v27 < (signed int)v10 )
          {
            v26[v27] = *(_BYTE *)(v25 + v27 + 5);
            v28 = v27 + 1;
            v14 = v27 + 1 <= v27;
            v29 = 1;
            if ( !v14 )
              v29 = 0;
            v16 = v29 == 0;
            v27 = v28;
            if ( !v16 )
              goto LABEL_47;
          }
          v26[v10] = 0;
          sub_A0F8((int)v3, (int)v26);
          free(v26);
          android::Parcel::writeInt32(v3, *(unsigned __int8 *)(v25 + 86));
          android::Parcel::writeInt32(v3, *(unsigned __int8 *)(v25 + 87));
          android::Parcel::writeInt32(v3, *(unsigned __int8 *)(v25 + 88));
          android::Parcel::writeInt32(v3, *(unsigned __int8 *)(v25 + 89));
          v17 = *(_DWORD *)(v25 + 92);
          goto LABEL_43;
        }
        v4 = "invalid display info response length %d                           expected not more than %d\n";
LABEL_58:
        v35 = v10;
        v36 = 81;
        goto LABEL_49;
      case 7:
        v30 = v6 + 96 * v8;
        v31 = *(unsigned __int8 *)(v30 + 4);
        if ( v31 < 0x41 )
        {
          android::Parcel::writeInt32(v3, v31);
          android::Parcel::write(v3, (const void *)(v30 + 5), *(unsigned __int8 *)(v30 + 4));
LABEL_44:
          v7 = v8 + 1;
          v33 = 1;
          if ( v8 + 1 > v8 )
            v33 = 0;
          if ( v33 )
LABEL_47:
            abort();
          continue;
        }
        v35 = *(unsigned __int8 *)(v30 + 4);
        v36 = 64;
        v4 = "invalid display info response length %d                           expected not more than %d\n";
LABEL_49:
        _android_log_buf_print(1, 6, "RILC", v4, v35, v36);
        return -1;
      case 8:
        v17 = *(unsigned __int8 *)(v6 + 96 * v8 + 4);
        goto LABEL_43;
      case 9:
        v4 = "RIL_CDMA_T53_RELEASE_INFO_REC: return INVALID_RESPONSE";
        goto LABEL_49;
      case 0xA:
        v32 = v6 + 96 * v8;
        android::Parcel::writeInt32(v3, *(unsigned __int8 *)(v32 + 4));
        v17 = *(unsigned __int8 *)(v32 + 5);
        goto LABEL_43;
      default:
        v4 = "Incorrect name value";
        goto LABEL_49;
    }
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B034) --------------------------------------------------------
signed int __fastcall sub_B034(android::Parcel *a1, int *a2, int a3)
{
  int v3; // r6
  int *v4; // r5
  android::Parcel *v5; // r4
  signed int v6; // r0
  const char *v7; // r3
  int v8; // r4
  int v9; // r10
  int v10; // r6
  _DWORD *v11; // r0
  int v12; // r7
  int v13; // r5
  int v14; // r4
  int v15; // r8
  int v16; // r9
  int v17; // ST08_4
  signed int v18; // r1
  int v20; // r6
  int v21; // r7
  signed int v22; // r1
  int v23; // [sp+18h] [bp-30h]
  int *v24; // [sp+1Ch] [bp-2Ch]
  android::Parcel *v25; // [sp+20h] [bp-28h]

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v24 = a2;
  _android_log_buf_print(1, 3, "RILC", "In responseSSData");
  if ( !v4 && v3 )
  {
    v6 = 12;
    v7 = "invalid response length was %d expected %d";
LABEL_16:
    _android_log_buf_print(1, 6, "RILC", v7, v3, v6);
    return -1;
  }
  if ( v3 != 192 )
  {
    v6 = 192;
    v7 = "invalid response length %d, expected %d";
    goto LABEL_16;
  }
  v25 = v5;
  android::Parcel::writeInt32(v5, *v4);
  android::Parcel::writeInt32(v5, v4[1]);
  android::Parcel::writeInt32(v5, v4[2]);
  android::Parcel::writeInt32(v5, v4[3]);
  android::Parcel::writeInt32(v5, v4[4]);
  if ( (unsigned int)*v4 > 5 || v4[1] != 2 )
  {
    android::Parcel::writeInt32(v5, 4);
    v20 = (int)(v4 + 5);
    v21 = 0;
    while ( v21 <= 3 )
    {
      _android_log_buf_print(1, 3, "RILC", "Data: %d", *(_DWORD *)(v20 + 4 * v21));
      android::Parcel::writeInt32(v5, *(_DWORD *)(v20 + 4 * v21));
      v22 = 1;
      if ( v21 + 1 > v21 )
        v22 = 0;
      ++v21;
      if ( v22 )
LABEL_22:
        abort();
    }
  }
  else
  {
    _android_log_buf_print(1, 3, "RILC", "responseSSData CF type, num of Cf elements %d", v4[5]);
    v8 = v4[5];
    if ( v8 >= 8 )
    {
      v8 = 7;
      _android_log_buf_print(
        1,
        6,
        "RILC",
        "numValidIndexes is greater than max value %d, truncating it to max value",
        7);
      v4[5] = 7;
    }
    android::Parcel::writeInt32(v25, v8);
    v9 = 0;
    v23 = (int)(v4 + 6);
    while ( v9 < v4[5] )
    {
      v10 = *(_DWORD *)(v23 + 24 * v9);
      v11 = (_DWORD *)(v23 + 24 * v9);
      v12 = v11[1];
      v13 = v11[2];
      v14 = v11[3];
      v15 = v11[4];
      v16 = v11[5];
      android::Parcel::writeInt32(v25, *(_DWORD *)(v23 + 24 * v9));
      android::Parcel::writeInt32(v25, v12);
      android::Parcel::writeInt32(v25, v13);
      android::Parcel::writeInt32(v25, v14);
      sub_A0F8((int)v25, v15);
      android::Parcel::writeInt32(v25, v16);
      v17 = v13;
      v4 = v24;
      _android_log_buf_print(
        1,
        3,
        "RILC",
        "Data: %d,reason=%d,cls=%d,toa=%d,num=%s,tout=%d],",
        v10,
        v12,
        v17,
        v14,
        v15,
        v16);
      v18 = 1;
      if ( v9 + 1 > v9 )
        v18 = 0;
      ++v9;
      if ( v18 )
        goto LABEL_22;
    }
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B210) --------------------------------------------------------
int __fastcall sub_B210(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 20 )
    {
      android::Parcel::writeInt32(this, *a2);
      sub_A0F8((int)v4, v3[1]);
      android::Parcel::writeInt32(v4, v3[2]);
      android::Parcel::writeInt32(v4, v3[3]);
      android::Parcel::write(v4, (const void *)v3[4], v3[3]);
      return 0;
    }
    v7 = a3;
    v8 = 20;
    v6 = "responsePcoData: invalid response length %u, expecting %u";
  }
  else
  {
    v6 = "responsePcoData: invalid NULL response";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B28C) --------------------------------------------------------
int __fastcall sub_B28C(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r10
  android::Parcel *v4; // r5
  const char *v5; // r3
  int v6; // r8
  int v7; // r10
  int v8; // t1
  int v9; // r11
  int v10; // r4
  signed int v11; // r1
  int v12; // r7
  int *v13; // r7
  int v14; // t1
  int v15; // r6
  signed int v16; // r1
  signed int v17; // r1

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_24:
    _android_log_buf_print(1, 6, "RILC", v5);
    return -1;
  }
  if ( a3 != 444 )
  {
    v5 = "responseAdnRecords: A RIL_AdnRecord_v1 expected\n";
    goto LABEL_24;
  }
  android::Parcel::writeInt32(this, *a2);
  v8 = *v3;
  v7 = (int)(v3 + 1);
  v6 = v8;
  v9 = 0;
  while ( v9 < v6 )
  {
    android::Parcel::writeInt32(v4, *(_DWORD *)(v7 + 44 * v9));
    sub_A0F8((int)v4, *(_DWORD *)(v7 + 44 * v9 + 4));
    sub_A0F8((int)v4, *(_DWORD *)(v7 + 44 * v9 + 8));
    android::Parcel::writeInt32(v4, *(_DWORD *)(v7 + 44 * v9 + 12));
    v10 = 0;
    while ( v10 < *(_DWORD *)(v7 + 44 * v9 + 12) )
    {
      sub_A0F8((int)v4, *(_DWORD *)(v7 + 44 * v9 + 4 * v10 + 16));
      v11 = 1;
      if ( v10 + 1 > v10 )
        v11 = 0;
      ++v10;
      if ( v11 )
        goto LABEL_22;
    }
    v12 = v7 + 44 * v9;
    v14 = *(_DWORD *)(v12 + 24);
    v13 = (int *)(v12 + 24);
    android::Parcel::writeInt32(v4, v14);
    v15 = 0;
    while ( v15 < *v13 )
    {
      sub_A0F8((int)v4, *(_DWORD *)(v7 + 44 * v9 + 4 * v15 + 28));
      v16 = 1;
      if ( v15 + 1 > v15 )
        v16 = 0;
      ++v15;
      if ( v16 )
        goto LABEL_22;
    }
    v17 = 1;
    if ( v9 + 1 > v9 )
      v17 = 0;
    ++v9;
    if ( v17 )
LABEL_22:
      abort();
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B398) --------------------------------------------------------
int __fastcall sub_B398(android::Parcel *a1, int *a2)
{
  int *v2; // r4
  android::Parcel *v3; // r5

  v2 = a2;
  v3 = a1;
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(v3, v2[1]);
  return sub_A0F8((int)v3, v2[2]);
}

//----- (0000B3B8) --------------------------------------------------------
int __fastcall sub_B3B8(android::Parcel *a1, unsigned __int8 *a2)
{
  unsigned __int8 *v2; // r4
  android::Parcel *v3; // r5

  v2 = a2;
  v3 = a1;
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(v3, v2[1]);
  android::Parcel::writeInt32(v3, v2[2]);
  return android::Parcel::writeInt32(v3, v2[3]);
}

//----- (0000B3E0) --------------------------------------------------------
void __fastcall sub_B3E0(int a1, int a2, void (__fastcall **a3)(_DWORD))
{
  void *v3; // r4

  v3 = a3;
  (*a3)(a3[1]);
  if ( dword_16798 && (void *)dword_16798 == v3 )
    dword_16798 = 0;
  j_free(v3);
}
// 16798: using guessed type int dword_16798;

//----- (0000B410) --------------------------------------------------------
void *ril_event_init(void)
{
  unsigned int v0; // r1
  int v1; // r2
  bool v2; // cf
  signed int v3; // r1
  bool v4; // zf
  void *result; // r0

  pthread_mutex_init((pthread_mutex_t *)&unk_167E0, 0);
  v0 = 0;
  while ( v0 <= 0x1F )
  {
    v1 = v0 + 1;
    dword_167E8[v0] = 0;
    v2 = v0 + 1 >= v0;
    v3 = 1;
    if ( v2 )
      v3 = 0;
    v4 = v3 == 0;
    v0 = v1;
    if ( !v4 )
      abort();
  }
  *(_QWORD *)&dword_16870 = 0LL;
  unk_16878 = 0LL;
  unk_16880 = 0LL;
  dword_16888 = 0;
  dword_16870 = -1;
  dword_16868 = (int)&dword_16868;
  dword_1686C = (int)&dword_16868;
  dword_168B0 = 0;
  *(_QWORD *)&dword_16898 = 0LL;
  result = &unk_168A0;
  unk_168D0 = 0LL;
  unk_168C8 = 0LL;
  *(_QWORD *)dword_168B8 = 0LL;
  unk_168A0 = 0LL;
  unk_168A8 = 0LL;
  dword_16898 = -1;
  dword_16890 = (int)&dword_16890;
  dword_16894 = (int)&dword_16890;
  unk_168C0 = 0LL;
  return result;
}
// 16868: using guessed type int dword_16868;
// 1686C: using guessed type int dword_1686C;
// 16870: using guessed type int dword_16870;
// 16888: using guessed type int dword_16888;
// 16890: using guessed type int dword_16890;
// 16894: using guessed type int dword_16894;
// 16898: using guessed type int dword_16898;
// 168B0: using guessed type int dword_168B0;

//----- (0000B4A8) --------------------------------------------------------
int __fastcall ril_event_set(int a1, int fd, int a3, int a4, int a5)
{
  _QWORD *v5; // lr

  *(_QWORD *)(a1 + 24) = 0LL;
  *(_QWORD *)(a1 + 16) = 0LL;
  *(_QWORD *)a1 = 0LL;
  v5 = (_QWORD *)(a1 + 8);
  *v5 = 0LL;
  *(_DWORD *)v5 = fd;
  *(_DWORD *)(a1 + 12) = -1;
  *(_BYTE *)(a1 + 16) = a3;
  *(_DWORD *)(a1 + 32) = a5;
  *(_DWORD *)(a1 + 28) = a4;
  return fcntl(fd, 4, 2048);
}

//----- (0000B4E8) --------------------------------------------------------
int __fastcall ril_event_add(int a1)
{
  int v1; // r4
  int v2; // r2
  int v3; // r1
  bool v4; // vf
  signed int v5; // r2
  bool v6; // zf
  int v7; // r0
  int v8; // r1
  signed int v9; // r2

  v1 = a1;
  pthread_mutex_lock((pthread_mutex_t *)&unk_167E0);
  v2 = 0;
  while ( v2 <= 7 )
  {
    if ( !dword_168B8[v2] )
    {
      dword_168B8[v2] = v1;
      v7 = *(_DWORD *)(v1 + 8);
      *(_DWORD *)(v1 + 12) = v2;
      _FD_SET_chk(v7, dword_167E8, 128);
      v8 = *(_DWORD *)(v1 + 8);
      if ( v8 >= dword_168D8 )
      {
        v9 = 1;
        if ( v8 + 1 > v8 )
          v9 = 0;
        if ( v9 )
LABEL_7:
          abort();
        dword_168D8 = v8 + 1;
      }
      return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_167E0);
    }
    v3 = v2 + 1;
    v4 = v2 + 1 <= v2;
    v5 = 1;
    if ( !v4 )
      v5 = 0;
    v6 = v5 == 0;
    v2 = v3;
    if ( !v6 )
      goto LABEL_7;
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_167E0);
}
// 3F30: using guessed type int __fastcall _FD_SET_chk(_DWORD, _DWORD, _DWORD);
// 168D8: using guessed type int dword_168D8;

//----- (0000B578) --------------------------------------------------------
int __fastcall ril_timer_add(int **a1, _DWORD *a2)
{
  int **v2; // r4
  _DWORD *v3; // r5
  signed int v4; // r7
  int *v5; // r6
  int v6; // r0
  signed int v7; // r1
  int v8; // r1
  int v9; // r3
  int v10; // r1
  signed int v11; // r3
  signed int v12; // r2
  int v13; // r3
  int v14; // r3
  int *v15; // r0
  int result; // r0
  int v17; // [sp+0h] [bp-20h]
  int v18; // [sp+4h] [bp-1Ch]
  int v19; // [sp+8h] [bp-18h]

  v2 = a1;
  v3 = a2;
  pthread_mutex_lock((pthread_mutex_t *)&unk_167E0);
  if ( v3 )
  {
    v4 = 1;
    v5 = (int *)dword_16868;
    v2[2] = (int *)-1;
    clock_gettime(1, (struct timespec *)&v17);
    v6 = *v3 + v17;
    v7 = 1;
    if ( !__OFSUB__(v6, v17) )
      v7 = 0;
    if ( !v7 )
    {
      v8 = v18;
      v2[5] = (int *)v6;
      v9 = v8 / 1000;
      v10 = v8 / 1000 + v3[1];
      if ( !__OFSUB__(v10, v9) )
        v4 = 0;
      if ( !v4 )
      {
        v2[6] = (int *)v10;
        if ( v10 < 1000000 )
          goto LABEL_18;
        v11 = 1;
        v12 = 1;
        if ( !__OFSUB__(v10, 1000000) )
          v11 = 0;
        if ( !v11 )
        {
          v10 -= 1000000;
          v13 = v6 + 1;
          v2[6] = (int *)v10;
          if ( v6 + 1 > v6 )
            v12 = 0;
          if ( !v12 )
          {
            ++v6;
            v2[5] = (int *)v13;
            while ( 1 )
            {
LABEL_18:
              v14 = v5[5];
              if ( v14 == v6 )
              {
                if ( v5 == &dword_16868 || v5[6] >= v10 )
                  goto LABEL_24;
              }
              else if ( v5 == &dword_16868 || v14 >= v6 )
              {
LABEL_24:
                *v2 = v5;
                v15 = (int *)v5[1];
                v2[1] = v15;
                *v15 = (int)v2;
                v5[1] = (int)v2;
                goto LABEL_25;
              }
              v5 = (int *)*v5;
            }
          }
        }
      }
    }
LABEL_26:
    abort();
  }
LABEL_25:
  pthread_mutex_unlock((pthread_mutex_t *)&unk_167E0);
  result = _stack_chk_guard - v19;
  if ( _stack_chk_guard != v19 )
    goto LABEL_26;
  return result;
}
// 16868: using guessed type int dword_16868;

//----- (0000B680) --------------------------------------------------------
int __fastcall ril_event_del(int a1)
{
  int v1; // r4
  unsigned int v2; // r1

  v1 = a1;
  pthread_mutex_lock((pthread_mutex_t *)&unk_167E0);
  v2 = *(_DWORD *)(v1 + 12);
  if ( v2 < 8 )
    sub_B6BC(v1, v2);
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_167E0);
}

//----- (0000B6BC) --------------------------------------------------------
int __fastcall sub_B6BC(int a1, int a2)
{
  int v2; // r4
  int v3; // r0
  int v4; // r1
  signed int v5; // r2
  int result; // r0
  int v7; // r3
  int v8; // r1
  int v9; // r2
  int v10; // r3
  int v11; // r3
  bool v12; // vf
  signed int v13; // r2
  signed int v14; // r2

  v2 = a1;
  dword_168B8[a2] = 0;
  v3 = *(_DWORD *)(a1 + 8);
  *(_DWORD *)(v2 + 12) = -1;
  _FD_CLR_chk(v3, dword_167E8, 128);
  v4 = *(_DWORD *)(v2 + 8);
  v5 = 1;
  result = v4 + 1;
  if ( v4 + 1 > v4 )
    v5 = 0;
  if ( v5 )
    goto LABEL_13;
  if ( result != dword_168D8 )
    return result;
  v7 = 0;
  v8 = 0;
  while ( 1 )
  {
    v9 = v7;
    if ( v7 >= 8 )
      break;
    v10 = dword_168B8[v7];
    if ( v10 )
    {
      v11 = *(_DWORD *)(v10 + 8);
      if ( v11 > v8 )
        v8 = v11;
    }
    v7 = v9 + 1;
    v12 = v9 + 1 <= v9;
    v13 = 1;
    if ( !v12 )
      v13 = 0;
    if ( v13 )
      goto LABEL_13;
  }
  result = v8 + 1;
  v14 = 1;
  if ( v8 + 1 > v8 )
    v14 = 0;
  if ( v14 )
LABEL_13:
    abort();
  dword_168D8 = v8 + 1;
  return result;
}
// 3F48: using guessed type int __fastcall _FD_CLR_chk(_DWORD, _DWORD, _DWORD);
// 168D8: using guessed type int dword_168D8;

//----- (0000B754) --------------------------------------------------------
int ril_event_loop(void)
{
  int *v0; // r4
  int v1; // r1
  int v2; // r2
  bool v3; // zf
  bool v4; // nf
  bool v5; // vf
  int v6; // r3
  signed int v7; // r3
  int v8; // r0
  int v9; // r2
  signed int v10; // r3
  int v11; // r2
  int v12; // r1
  signed int v13; // r2
  signed int v14; // r1
  struct timeval *timeout; // r1
  int v16; // r0
  signed int v17; // r4
  int *v18; // r6
  int v19; // r0
  int v20; // r1
  int v21; // r2
  bool v22; // zf
  bool v23; // nf
  unsigned __int8 v24; // vf
  int v25; // r2
  int v26; // r2
  int **v27; // r3
  int v28; // r0
  int v29; // r6
  int v30; // r7
  int *v31; // r0
  signed int v32; // r0
  signed int v33; // r1
  int *v34; // r1
  int *v35; // r4
  int v36; // r0
  void (__fastcall *v37)(int, _DWORD, int); // r3
  int v38; // r2
  _DWORD *v39; // r0
  int result; // r0
  int v41; // [sp+8h] [bp-8h]
  int v42; // [sp+Ch] [bp-4h]
  int v43; // [sp+10h] [bp+0h]
  int v44; // [sp+14h] [bp+4h]
  int v45; // [sp+18h] [bp+8h]
  int v46; // [sp+98h] [bp+88h]

  do
  {
    while ( 1 )
    {
      _aeabi_memcpy8(&v45, dword_167E8, 128);
      v0 = (int *)dword_16868;
      clock_gettime(1, (struct timespec *)&v43);
      if ( v0 == &dword_16868 )
      {
        timeout = 0;
      }
      else
      {
        v1 = v44 / 1000;
        v2 = v0[5];
        v5 = __OFSUB__(v2, v43);
        v3 = v2 == v43;
        v4 = v2 - v43 < 0;
        if ( v2 == v43 )
        {
          v6 = v0[6];
          v5 = __OFSUB__(v6, v1);
          v3 = v6 == v1;
          v4 = v6 - v1 < 0;
        }
        if ( (unsigned __int8)(v4 ^ v5) | v3 )
        {
          v41 = 0;
          v42 = 0;
        }
        else
        {
          v7 = 1;
          if ( !__OFSUB__(v2, v43) )
            v7 = 0;
          if ( v7 )
            goto LABEL_51;
          v8 = v2 - v43;
          v41 = v2 - v43;
          v9 = v0[6];
          v10 = 1;
          if ( !__OFSUB__(v9, v1) )
            v10 = 0;
          if ( v10 )
LABEL_51:
            abort();
          v11 = v9 - v1;
          v42 = v11;
          if ( v11 <= -1 )
          {
            v12 = v11 + 1000000;
            v5 = v11 + 1000000 <= v11;
            v13 = 1;
            if ( !v5 )
              v13 = 0;
            if ( v13 )
              goto LABEL_51;
            v42 = v12;
            v14 = 1;
            if ( !__OFSUB__(v8, 1) )
              v14 = 0;
            if ( v14 )
              goto LABEL_51;
            v41 = v8 - 1;
          }
        }
        timeout = (struct timeval *)&v41;
      }
      v16 = select(dword_168D8, (fd_set *)&v45, 0, 0, timeout);
      v17 = v16;
      if ( v16 <= -1 )
        break;
      pthread_mutex_lock((pthread_mutex_t *)&unk_167E0);
      v18 = (int *)dword_16868;
      clock_gettime(1, (struct timespec *)&v43);
      if ( v18 != &dword_16868 )
      {
        v19 = v43;
        v20 = v44 / 1000;
        do
        {
          v21 = v18[5];
          v24 = __OFSUB__(v19, v21);
          v22 = v19 == v21;
          v23 = v19 - v21 < 0;
          if ( v19 == v21 )
          {
            v25 = v18[6];
            v24 = __OFSUB__(v20, v25);
            v22 = v20 == v25;
            v23 = v20 - v25 < 0;
          }
          if ( (unsigned __int8)(v23 ^ v24) | v22 )
            break;
          v26 = *v18;
          v3 = *v18 == (_DWORD)&dword_16868;
          *(_DWORD *)(v26 + 4) = v18[1];
          *(_DWORD *)v18[1] = *v18;
          *v18 = (int)&dword_16890;
          v18[1] = 0;
          v27 = (int **)dword_16894;
          v18[1] = dword_16894;
          *v27 = v18;
          dword_16894 = (int)v18;
          v18 = (int *)v26;
        }
        while ( !v3 );
      }
      pthread_mutex_unlock((pthread_mutex_t *)&unk_167E0);
      pthread_mutex_lock((pthread_mutex_t *)&unk_167E0);
      v28 = 0;
      while ( 1 )
      {
        v29 = v28;
        if ( v28 > 7 || v17 < 1 )
          break;
        v30 = dword_168B8[v28];
        if ( v30 && _FD_ISSET_chk(*(_DWORD *)(v30 + 8), &v45, 128) )
        {
          *(_DWORD *)v30 = &dword_16890;
          v31 = (int *)dword_16894;
          *(_DWORD *)(v30 + 4) = dword_16894;
          *v31 = v30;
          dword_16894 = v30;
          if ( !*(_BYTE *)(v30 + 16) )
            sub_B6BC(v30, v29);
          v32 = 1;
          if ( !__OFSUB__(v17, 1) )
            v32 = 0;
          if ( v32 )
            goto LABEL_50;
          --v17;
        }
        v28 = v29 + 1;
        v33 = 1;
        if ( v29 + 1 > v29 )
          v33 = 0;
        if ( v33 )
          goto LABEL_50;
      }
      pthread_mutex_unlock((pthread_mutex_t *)&unk_167E0);
      v34 = (int *)dword_16890;
      if ( (int *)dword_16890 != &dword_16890 )
      {
        do
        {
          v35 = (int *)*v34;
          *(_DWORD *)(*v34 + 4) = v34[1];
          *(_DWORD *)v34[1] = *v34;
          v36 = v34[2];
          v37 = (void (__fastcall *)(int, _DWORD, int))v34[7];
          v38 = v34[8];
          v34[1] = 0;
          *v34 = 0;
          v37(v36, 0, v38);
          v34 = v35;
        }
        while ( v35 != &dword_16890 );
      }
    }
    v39 = (_DWORD *)_errno(v16);
  }
  while ( *v39 == 4 );
  _android_log_buf_print(1, 6, "RILC", "ril_event: select error (%d)", *v39);
  result = _stack_chk_guard - v46;
  if ( _stack_chk_guard != v46 )
LABEL_50:
    abort();
  return result;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3F54: using guessed type int __fastcall _aeabi_memcpy8(_DWORD, _DWORD, _DWORD);
// 3F6C: using guessed type int __fastcall _FD_ISSET_chk(_DWORD, _DWORD, _DWORD);
// 16868: using guessed type int dword_16868;
// 16890: using guessed type int dword_16890;
// 16894: using guessed type int dword_16894;
// 168D8: using guessed type int dword_168D8;

//----- (0000B9B0) --------------------------------------------------------
int __fastcall RilSocket::socketInit(RilSocket *this)
{
  RilSocket *v1; // r4
  int v2; // r3
  int v3; // r0
  char *v4; // r0
  const char *v5; // r5
  _DWORD *v6; // r0
  _DWORD *v7; // r6
  signed int v8; // r0
  int v9; // r0
  int v10; // r5
  int v11; // r1
  int v12; // r3
  int v13; // ST00_4
  int v14; // r4
  int v15; // r6
  int v16; // r4
  int *v17; // r0
  char *v18; // r0
  int result; // r0
  char v20; // [sp+10h] [bp-58h]
  int v21; // [sp+50h] [bp-18h]

  v1 = this;
  v2 = *((_DWORD *)this + 1);
  v3 = _stack_chk_guard;
  *((_DWORD *)v1 + 7) = RilSocket::sSocketRequestsHandler;
  v21 = v3;
  *((_DWORD *)v1 + 6) = RilSocket::sSocketListener;
  _snprintf_chk(&v20, 64, 0, 64, "ANDROID_SOCKET_%s", v2);
  v4 = getenv(&v20);
  v5 = v4;
  if ( !v4 || (v6 = (_DWORD *)_errno(v4), v7 = v6, *v6 = 0, v8 = strtol(v5, 0, 10), *v7) )
    v8 = -1;
  *((_DWORD *)v1 + 3) = v8;
  v9 = listen(v8, 0);
  v10 = v9;
  if ( v9 <= -1 )
  {
    v15 = *((_DWORD *)v1 + 1);
    v16 = *((_DWORD *)v1 + 3);
    v17 = (int *)_errno(v9);
    v18 = strerror(*v17);
    _android_log_buf_print(1, 6, 0, "Failed to listen on %s socket '%d': %s", v15, v16, v18);
  }
  else
  {
    v11 = *((_DWORD *)v1 + 3);
    v12 = *((_DWORD *)v1 + 6);
    v13 = (int)v1;
    v14 = (int)v1 + 32;
    ril_event_set(v14, v11, 0, v12, v13);
    rilEventAddWakeup_helper(v14);
  }
  result = _stack_chk_guard - v21;
  if ( _stack_chk_guard == v21 )
    result = v10;
  return result;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BD0: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000BA88) --------------------------------------------------------
int __fastcall RilSocket::sSocketListener(RilSocket *this, int a2, int a3, void *a4)
{
  char v5; // [sp+4h] [bp-34h]
  int v6; // [sp+24h] [bp-14h]
  int v7; // [sp+28h] [bp-10h]
  int v8; // [sp+2Ch] [bp-Ch]

  v6 = 1;
  v7 = a3;
  listenCallback_helper((int)this, a2, &v5);
  return _stack_chk_guard - v8;
}

//----- (0000BAC0) --------------------------------------------------------
int __fastcall RilSocket::sSocketRequestsHandler(RilSocket *this, int a2, int a3, void *a4)
{
  return j_RilSocket::socketRequestsHandler(*(int **)a3, a2, 0, *(_DWORD *)(a3 + 4));
}

//----- (0000BACC) --------------------------------------------------------
int __fastcall RilSocket::onNewCommandConnect(RilSocket *this)
{
  pthread_t *v1; // r4
  int v2; // r0
  pthread_attr_t attr; // [sp+4h] [bp-2Ch]

  v1 = (pthread_t *)this;
  pthread_attr_init(&attr);
  pthread_attr_setdetachstate(&attr, 1);
  v2 = pthread_create(v1 + 5, &attr, (void *(*)(void *))ril_socket_process_requests_loop, v1);
  if ( v2 <= -1 )
    _android_log_buf_print(1, 6, 0, "pthread_create failed with result:%d", v2);
  _android_log_buf_print(1, 6, 0, "New socket command connected and socket request thread started");
  return _stack_chk_guard - *(&attr.__align + 6);
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000BB4C) --------------------------------------------------------
int __fastcall ril_socket_process_requests_loop(int a1)
{
  (*(void (**)(void))(*(_DWORD *)a1 + 4))();
  return 0;
}

//----- (0000BB58) --------------------------------------------------------
int __fastcall RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4)
{
  int *v4; // r4
  int v5; // r5
  __int64 v6; // r0
  signed int v7; // r3
  signed int v8; // r2
  signed int v9; // r3
  signed int v10; // r1
  const char *v11; // r3
  int *v12; // r0
  bool v13; // zf
  int v15; // [sp+0h] [bp-28h]
  int v16; // [sp+8h] [bp-20h]
  int v17; // [sp+Ch] [bp-1Ch]
  int v18; // [sp+10h] [bp-18h]

  v4 = a1;
  v5 = a4;
  LODWORD(v6) = record_stream_get_next(a4, &v17, &v16);
  HIDWORD(v6) = v17;
  v7 = 0;
  v8 = 0;
  if ( !(_DWORD)v6 )
    v8 = 1;
  if ( !v6 )
    v7 = 1;
  if ( (signed int)v6 >= 0 && !v7 )
  {
    do
    {
      if ( v8 & 1 )
        (*(void (__fastcall **)(int *))*v4)(v4);
      LODWORD(v6) = record_stream_get_next(v5, &v17, &v16);
      HIDWORD(v6) = v17;
      v8 = 0;
      if ( !(_DWORD)v6 )
        v8 = 1;
      v9 = 0;
      if ( !v6 )
        v9 = 1;
    }
    while ( (signed int)v6 >= 0 && v9 != 1 );
  }
  if ( v8 )
  {
    v10 = 5;
    v11 = "EOS.  Closing command socket.";
LABEL_21:
    _android_log_buf_print(1, v10, 0, v11, v15);
    close(v4[4]);
    v4[4] = -1;
    ril_event_del((int)(v4 + 17));
    record_stream_free(v5);
    rilEventAddWakeup_helper((int)(v4 + 8));
    (*(void (__fastcall **)(int *))(*v4 + 8))(v4);
    return _stack_chk_guard - v18;
  }
  v12 = (int *)_errno(v6);
  v13 = *v12 == 11;
  if ( *v12 != 11 )
    v13 = *v12 == 4;
  if ( !v13 )
  {
    v10 = 6;
    v15 = *v12;
    v11 = "error on reading command socket errno:%d\n";
    goto LABEL_21;
  }
  return _stack_chk_guard - v18;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C24: using guessed type int __fastcall record_stream_get_next(_DWORD, _DWORD, _DWORD);
// 3CB4: using guessed type int __fastcall record_stream_free(_DWORD);

//----- (0000BC4C) --------------------------------------------------------
int __fastcall RilSocket::setListenFd(int result, int a2)
{
  *(_DWORD *)(result + 12) = a2;
  return result;
}

//----- (0000BC50) --------------------------------------------------------
int __fastcall RilSocket::setCommandFd(int result, int a2)
{
  *(_DWORD *)(result + 16) = a2;
  return result;
}

//----- (0000BC54) --------------------------------------------------------
int __fastcall RilSocket::getListenFd(RilSocket *this)
{
  return *((_DWORD *)this + 3);
}

//----- (0000BC58) --------------------------------------------------------
int __fastcall RilSocket::getCommandFd(RilSocket *this)
{
  return *((_DWORD *)this + 4);
}

//----- (0000BC5C) --------------------------------------------------------
int __fastcall RilSocket::setListenCb(int result, void (__cdecl *a2)(int, __int16, void *))
{
  *(_DWORD *)(result + 24) = a2;
  return result;
}

//----- (0000BC60) --------------------------------------------------------
int __fastcall RilSocket::setCommandCb(int result, void (__cdecl *a2)(int, __int16, void *))
{
  *(_DWORD *)(result + 28) = a2;
  return result;
}

//----- (0000BC64) --------------------------------------------------------
int __fastcall RilSocket::getListenCb(RilSocket *this)
{
  return *((_DWORD *)this + 6);
}

//----- (0000BC68) --------------------------------------------------------
int __fastcall RilSocket::getCommandCb(RilSocket *this)
{
  return *((_DWORD *)this + 7);
}

//----- (0000BC6C) --------------------------------------------------------
_DWORD *__fastcall RilSocket::setListenEvent(_DWORD *result, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10)
{
  result[8] = a2;
  result[9] = a3;
  result[10] = a4;
  result[11] = a5;
  result[12] = a6;
  result[13] = a7;
  result[14] = a8;
  result[16] = a10;
  result[15] = a9;
  return result;
}

//----- (0000BC94) --------------------------------------------------------
_DWORD *__fastcall RilSocket::setCallbackEvent(_DWORD *result, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10)
{
  result[17] = a2;
  result[18] = a3;
  result[19] = a4;
  result[20] = a5;
  result[21] = a6;
  result[22] = a7;
  result[23] = a8;
  result[25] = a10;
  result[24] = a9;
  return result;
}

//----- (0000BCBC) --------------------------------------------------------
char *__fastcall RilSocket::getListenEvent(RilSocket *this)
{
  return (char *)this + 32;
}

//----- (0000BCC0) --------------------------------------------------------
char *__fastcall RilSocket::getCallbackEvent(RilSocket *this)
{
  return (char *)this + 68;
}

//----- (0000BCC4) --------------------------------------------------------
void __fastcall RilSapSocket::sOnRequestComplete(_DWORD *a1, int a2, int a3, unsigned int a4)
{
  unsigned int v4; // r7
  int v5; // r5
  _DWORD *v6; // r4
  int v7; // r6
  int v8; // r0
  void **v9; // r0

  v4 = a4;
  v5 = a3;
  v6 = a1;
  v7 = a2;
  _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Socket id:%d", a1[3]);
  v8 = RilSapSocket::getSocketById(v6[3]);
  if ( v8 )
  {
    RilSapSocket::onRequestComplete(v8, (int)v6, v7, v5, v4);
  }
  else
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Invalid socket id");
    v9 = (void **)v6[1];
    if ( v9[4] )
    {
      free(v9[4]);
      v9 = (void **)v6[1];
    }
    free(v9);
    j_free(v6);
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000BD3C) --------------------------------------------------------
RilSapSocket *__fastcall RilSapSocket::sOnUnsolicitedResponse(RilSapSocket *this, int a2, const void *a3, unsigned int a4)
{
  RilSapSocket *v4; // r6
  const void *v5; // r4
  void *v6; // r5
  RilSapSocket *result; // r0

  v4 = this;
  v5 = a3;
  v6 = (void *)a2;
  result = (RilSapSocket *)RilSapSocket::getSocketById(0);
  if ( result )
    result = (RilSapSocket *)j_RilSapSocket::onUnsolicitedResponse(result, (int)v4, v6, (unsigned int)v5);
  return result;
}

//----- (0000BD5C) --------------------------------------------------------
int __fastcall RilSapSocket::getSocketById(int a1)
{
  int v1; // r4
  _DWORD *v2; // r5
  RilSapSocket *v3; // r0
  int result; // r0

  v1 = a1;
  v2 = (_DWORD *)dword_168DC;
  v3 = (RilSapSocket *)_android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Entered getSocketById");
  RilSapSocket::printList(v3);
  while ( v2 )
  {
    result = *v2;
    if ( *(_DWORD *)(*v2 + 8) == v1 )
      return result;
    v2 = (_DWORD *)v2[1];
  }
  return 0;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 168DC: using guessed type int dword_168DC;

//----- (0000BD9C) --------------------------------------------------------
int __fastcall RilSapSocket::onRequestComplete(int a1, int a2, int a3, int a4, unsigned int a5)
{
  int v5; // r8
  int v6; // r6
  int *v7; // r4
  __int64 v8; // r0
  signed int v9; // r0
  unsigned int *v10; // r0
  unsigned int *v11; // r5
  int result; // r0
  __int64 v13; // [sp+8h] [bp-30h]
  int v14; // [sp+10h] [bp-28h]
  int v15; // [sp+14h] [bp-24h]
  void *ptr; // [sp+18h] [bp-20h]
  int v17; // [sp+1Ch] [bp-1Ch]

  v5 = a1;
  v6 = a4;
  v7 = *(int **)(a2 + 4);
  HIDWORD(v8) = 2;
  LODWORD(v8) = *v7;
  v13 = v8;
  v14 = v7[2];
  v15 = a3;
  v9 = 1;
  if ( a5 + 8 >= a5 )
    v9 = 0;
  if ( v9 )
    goto LABEL_16;
  v10 = (unsigned int *)calloc(1u, a5 + 8);
  v11 = v10;
  ptr = v10;
  if ( v10 )
  {
    if ( v6 && a5 )
    {
      _aeabi_memcpy(v10 + 1, v6, a5);
      *v11 = a5;
    }
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Token:%d, MessageId:%d", *v7, v7[2], v13, v14, v15);
    RilSapSocket::sendResponse(v5, (int *)&v13);
    free(ptr);
  }
  else
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "onRequestComplete: OOM");
  }
  if ( !Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(v5 + 132, v7[2], *v7) )
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Token:%d, MessageId:%d", *v7, v7[2], v13, v14, v15, ptr);
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "RilSapSocket::onRequestComplete: invalid Token or Message Id");
  }
  free(v7);
  result = _stack_chk_guard - v17;
  if ( _stack_chk_guard != v17 )
LABEL_16:
    abort();
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3D5C: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);

//----- (0000BEA8) --------------------------------------------------------
int __fastcall RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4)
{
  RilSapSocket *v4; // r8
  void *v5; // r7
  unsigned int v6; // r6
  int v7; // r5
  signed int v8; // r0
  unsigned int *v9; // r0
  unsigned int *v10; // r4
  int result; // r0
  int v12; // [sp+0h] [bp-30h]
  int v13; // [sp+4h] [bp-2Ch]
  int v14; // [sp+8h] [bp-28h]
  int v15; // [sp+Ch] [bp-24h]
  unsigned int *v16; // [sp+10h] [bp-20h]
  int v17; // [sp+14h] [bp-1Ch]

  v4 = this;
  v5 = a3;
  v6 = a4;
  v7 = a2;
  if ( a3 && a4 )
  {
    v8 = 1;
    if ( a4 + 8 >= a4 )
      v8 = 0;
    if ( v8 )
LABEL_11:
      abort();
    v9 = (unsigned int *)calloc(1u, a4 + 8);
    v10 = v9;
    if ( v9 )
    {
      _aeabi_memcpy(v9 + 1, v5, v6);
      *v10 = v6;
      v13 = 3;
      v14 = v7;
      v15 = 0;
      v16 = v10;
      RilSapSocket::sendResponse((int)v4, &v12);
      free(v10);
    }
    else
    {
      _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "onUnsolicitedResponse: OOM");
    }
  }
  result = _stack_chk_guard - v17;
  if ( _stack_chk_guard != v17 )
    goto LABEL_11;
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3D5C: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);

//----- (0000BF4C) --------------------------------------------------------
int __fastcall RilSapSocket::printList(RilSapSocket *this)
{
  _DWORD *v1; // r7
  int result; // r0

  v1 = (_DWORD *)dword_168DC;
  for ( result = _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Printing socket list"); v1; v1 = (_DWORD *)v1[1] )
  {
    _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "SocketName:%s", *(_DWORD *)(*v1 + 4));
    result = _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Socket id:%d", *(_DWORD *)(*v1 + 8));
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 168DC: using guessed type int dword_168DC;

//----- (0000BFBC) --------------------------------------------------------
int __fastcall RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2)
{
  pthread_mutexattr_t v2; // r4
  RilSapSocket *v3; // r5
  int result; // r0
  const char *v5; // r1

  v2 = a2;
  v3 = (RilSapSocket *)a1;
  result = strcmp(a1, "sap_uim_socket1");
  if ( !result )
  {
    result = RilSapSocket::SocketExists(v3, v5);
    if ( !result )
      result = j_RilSapSocket::addSocketToList(v3, 0, v2);
  }
  return result;
}

//----- (0000BFE8) --------------------------------------------------------
signed int __fastcall RilSapSocket::SocketExists(RilSapSocket *this, const char *a2)
{
  RilSapSocket *v2; // r4
  _DWORD *i; // r5

  v2 = this;
  for ( i = (_DWORD *)dword_168DC; i; i = (_DWORD *)i[1] )
  {
    if ( !strcmp(*(const char **)(*i + 4), (const char *)v2) )
      return 1;
  }
  return 0;
}
// 168DC: using guessed type int dword_168DC;

//----- (0000C014) --------------------------------------------------------
signed int __fastcall RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3)
{
  pthread_mutexattr_t v3; // r5
  pthread_mutexattr_t v4; // r6
  pthread_mutexattr_t v5; // r7
  signed int result; // r0
  pthread_mutexattr_t *v7; // r4
  _DWORD *v8; // r5
  pthread_mutexattr_t v9; // r0
  int v10; // r0
  int v11; // r1

  v3 = a3;
  v4.__align = (int)a2;
  v5.__align = (int)a1;
  result = RilSapSocket::SocketExists(a1, a2);
  if ( !result )
  {
    v7 = (pthread_mutexattr_t *)operator new(0x94u);
    RilSapSocket::RilSapSocket(v7, v5, v4, v3);
    v8 = malloc(8u);
    if ( v8 )
    {
      v9 = v7[2];
      *v8 = v7;
      v8[1] = 0;
      _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Adding socket with id: %d", v9.__align);
      v10 = dword_168DC;
      if ( dword_168DC )
      {
        do
        {
          v11 = v10;
          v10 = *(_DWORD *)(v10 + 4);
        }
        while ( v10 );
        *(_DWORD *)(v11 + 4) = v8;
      }
      else
      {
        v8[1] = 0;
        dword_168DC = (int)v8;
      }
      result = j_RilSocket::socketInit((RilSocket *)v7);
    }
    else
    {
      result = _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "addSocketToList: OOM");
    }
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 168DC: using guessed type int dword_168DC;

//----- (0000C0B0) --------------------------------------------------------
void __fastcall __noreturn RilSapSocket::processRequestsLoop(RilSapSocket *this)
{
  RilSapSocket *v1; // r4
  _DWORD **v2; // r7

  v1 = this;
  _android_log_buf_print(1, 4, "RIL_UIM_SOCKET", "UIM_SOCKET:Request loop started");
  while ( 1 )
  {
    v2 = (_DWORD **)Ril_queue<RilSapSocket::SapSocketRequest>::dequeue((int)v1 + 116);
    _android_log_buf_print(1, 4, "RIL_UIM_SOCKET", "New request from the dispatch Queue");
    if ( v2 )
    {
      RilSapSocket::dispatchRequest((int)v1, v2[1]);
      free(v2);
    }
    else
    {
      _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Fetched null buffer from queue!");
    }
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000C120) --------------------------------------------------------
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(int a1)
{
  int v1; // r5
  pthread_mutex_t *v2; // r4
  int i; // r6

  v1 = a1;
  v2 = (pthread_mutex_t *)(a1 + 4);
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 4));
  for ( i = *(_DWORD *)(v1 + 12); !i; i = *(_DWORD *)(v1 + 12) )
    pthread_cond_wait((pthread_cond_t *)(v1 + 8), v2);
  *(_DWORD *)(v1 + 12) = *(_DWORD *)(i + 8);
  pthread_mutex_unlock(v2);
  return i;
}

//----- (0000C154) --------------------------------------------------------
void __fastcall RilSapSocket::dispatchRequest(int a1, _DWORD *a2)
{
  int v2; // r6
  _DWORD *v3; // r4
  _DWORD *v4; // r0
  _DWORD *v5; // r5
  int v6; // r0
  int v7; // r1

  v2 = a1;
  v3 = a2;
  v4 = malloc(0x10u);
  v5 = v4;
  if ( v4 )
  {
    v4[1] = v3;
    v6 = *v3;
    v7 = *(_DWORD *)(v2 + 8);
    v5[2] = 0;
    *v5 = v6;
    v5[3] = v7;
    Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(v2 + 132, (int)v5);
    if ( *(_DWORD *)(v2 + 112) )
    {
      _android_log_buf_print(
        1,
        4,
        "RIL_UIM_SOCKET",
        "[%d] > SAP REQUEST type: %d. id: %d. error: %d",
        *v3,
        v3[1],
        v3[2],
        v3[3]);
      (*(void (__fastcall **)(_DWORD, int, _DWORD, _DWORD *))(*(_DWORD *)(v2 + 112) + 4))(
        v3[2],
        v3[4] + 4,
        *(_DWORD *)v3[4],
        v5);
    }
  }
  else
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "dispatchRequest: OOM");
    j_free(v3);
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000C1F0) --------------------------------------------------------
pthread_mutexattr_t *__fastcall RilSapSocket::RilSapSocket(pthread_mutexattr_t *a1, pthread_mutexattr_t a2, pthread_mutexattr_t a3, pthread_mutexattr_t a4)
{
  pthread_mutexattr_t *v4; // r5
  pthread_mutexattr_t v5; // r4
  const pthread_mutexattr_t *v6; // r6

  v4 = a1;
  v5 = a4;
  a1[3].__align = -1;
  v6 = a1 + 29;
  a1[4].__align = -1;
  a1[26].__align = 0;
  a1[1] = a2;
  a1[2] = a3;
  a1->__align = (int)&off_15B34;
  pthread_mutexattr_init(a1 + 29);
  pthread_mutex_init((pthread_mutex_t *)&v4[30], v6);
  v4[32].__align = 0;
  v4[31].__align = 0;
  pthread_mutexattr_init(v4 + 33);
  pthread_mutex_init((pthread_mutex_t *)&v4[34], v4 + 33);
  v4[36].__align = 0;
  v4[35].__align = 0;
  if ( v5.__align )
    v4[28] = v5;
  return v4;
}
// 15B34: using guessed type void *;

//----- (0000C258) --------------------------------------------------------
int __fastcall log_hex(const char *a1, const unsigned __int8 *a2, int a3)
{
  int v3; // r4
  const unsigned __int8 *v4; // r8
  int v5; // r9
  signed int v6; // r5
  int v7; // r10
  int v8; // r0
  signed int v9; // r1
  signed int v10; // r1
  signed int v11; // r11
  int v12; // r1
  signed int v13; // r2
  unsigned int v14; // r3
  int v15; // r6
  int v16; // r2
  signed int v17; // r0
  int v18; // r0
  char v19; // r3
  signed int v20; // r1
  signed int v21; // r2
  signed int v22; // r3
  signed int v23; // r1
  signed int v24; // r0
  int result; // r0
  const char *v26; // [sp+Ch] [bp-4h]
  int v27; // [sp+10h] [bp+0h]
  int v28; // [sp+60h] [bp+50h]

  v26 = a1;
  v3 = a3;
  v4 = a2;
  v5 = 0;
  v6 = 0;
  v7 = 0;
  do
  {
    v8 = _snprintf_chk(&v27, 80, 0, 80, "%8.8s [%8.8x] ", v26, v7) + v6;
    v9 = 1;
    if ( !__OFSUB__(v8, v6) )
      v9 = 0;
    if ( v9 )
      goto LABEL_44;
    while ( v7 < v3 )
    {
      v10 = 1;
      if ( !__OFSUB__(80, v8) )
        v10 = 0;
      if ( !v10 )
      {
        v11 = 1;
        if ( v5 > 15 || 80 - v8 < 4 )
          goto LABEL_32;
        v12 = v8 + 1;
        v13 = 1;
        if ( v8 + 1 > v8 )
          v13 = 0;
        if ( !v13 )
        {
          v14 = v4[v7];
          v15 = (v14 >> 4) | 0x30;
          if ( v14 > 0x9F )
            v15 = (v14 >> 4) + 55;
          v16 = v8 + 2;
          *((_BYTE *)&v27 + v8) = v15;
          v17 = 1;
          if ( v12 + 1 > v12 )
            v17 = 0;
          if ( !v17 )
          {
            v18 = v14 & 0xF;
            v19 = v14 & 0xF | 0x30;
            if ( (unsigned __int8)v18 > 9u )
              v19 = v18 + 55;
            v8 = v12 + 2;
            *((_BYTE *)&v27 + v12) = v19;
            v20 = 1;
            if ( v16 + 1 > v16 )
              v20 = 0;
            if ( !v20 )
            {
              *((_BYTE *)&v27 + v16) = 32;
              v21 = 1;
              if ( v7 + 1 > v7 )
                v21 = 0;
              if ( !v21 )
              {
                v22 = 1;
                if ( v5 + 1 > v5 )
                  v22 = 0;
                ++v5;
                ++v7;
                if ( !v22 )
                  continue;
              }
            }
          }
        }
      }
      goto LABEL_44;
    }
    v11 = 0;
LABEL_32:
    if ( v8 > 79 )
      break;
    if ( v5 == 16 || v7 >= v3 )
    {
      v23 = 1;
      if ( v8 + 1 > v8 )
        v23 = 0;
      if ( v23 )
        goto LABEL_44;
      v5 = 0;
      *((_BYTE *)&v27 + v8) = 0;
      _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "%s\n", &v27);
      v6 = 0;
    }
    else
    {
      v6 = v8;
    }
    v24 = 0;
    if ( v6 < 80 )
      v24 = 1;
  }
  while ( v11 & v24 );
  result = _stack_chk_guard - v28;
  if ( _stack_chk_guard != v28 )
LABEL_44:
    abort();
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BD0: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000C3C8) --------------------------------------------------------
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(int a1, int a2)
{
  int v2; // r5
  pthread_mutex_t *v3; // r4
  int v4; // r6
  int v5; // r0

  v2 = a1;
  v3 = (pthread_mutex_t *)(a1 + 4);
  v4 = a2;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 4));
  v5 = *(_DWORD *)(v2 + 12);
  if ( v5 )
  {
    *(_DWORD *)(v4 + 8) = v5;
    *(_DWORD *)(v2 + 12) = v4;
  }
  else
  {
    *(_DWORD *)(v2 + 12) = v4;
    *(_DWORD *)(v4 + 8) = 0;
  }
  pthread_cond_broadcast((pthread_cond_t *)(v2 + 8));
  return j_pthread_mutex_unlock(v3);
}

//----- (0000C3F8) --------------------------------------------------------
int __fastcall RilSapSocket::sendResponse(int a1, int *a2)
{
  int v2; // r7
  pthread_mutex_t *v3; // r4
  int *v4; // r6
  int v5; // r0
  signed int v6; // r1
  int v7; // r5
  int v8; // r10
  signed int v9; // r0
  unsigned __int8 *v10; // r8
  int v11; // r0
  int *v12; // r0
  const char *v13; // r3
  const char *v14; // r3
  const char *v15; // r0
  int v16; // r7
  int v17; // r6
  signed int v18; // r1
  int result; // r0
  int v20; // [sp+0h] [bp-68h]
  int v21; // [sp+0h] [bp-68h]
  int v22; // [sp+4h] [bp-64h]
  int v23; // [sp+4h] [bp-64h]
  signed int v24; // [sp+8h] [bp-60h]
  int v25; // [sp+8h] [bp-60h]
  int v26; // [sp+Ch] [bp-5Ch]
  const char *v27; // [sp+Ch] [bp-5Ch]
  __int64 v28; // [sp+10h] [bp-58h]
  __int64 v29; // [sp+18h] [bp-50h]
  const char *v30; // [sp+20h] [bp-48h]
  __int64 v31; // [sp+28h] [bp-40h]
  __int64 v32; // [sp+30h] [bp-38h]
  const char *v33; // [sp+38h] [bp-30h]
  unsigned int v34; // [sp+3Ch] [bp-2Ch]
  int v35; // [sp+40h] [bp-28h]
  int v36; // [sp+44h] [bp-24h]

  v2 = a1;
  v3 = (pthread_mutex_t *)(a1 + 104);
  v4 = a2;
  v35 = 0;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 104));
  v5 = j_pb_get_encoded_size(&v35, (unsigned __int8 *)&MsgHeader_fields, v4);
  v6 = *(_DWORD *)(v2 + 16);
  v7 = v35;
  if ( v5 != 1 || v35 < 0 )
    goto LABEL_12;
  if ( v6 == -1 )
  {
    v6 = -1;
LABEL_12:
    v24 = v6;
    v26 = v5;
    v14 = "Not sending response type %d: encoded_size: %zu. commandFd: %d. encoded size result:                %d";
    v20 = v4[1];
    v22 = v35;
LABEL_13:
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", v14, v20, v22, v24, v26);
    goto LABEL_21;
  }
  v8 = v35 + 4;
  v9 = 1;
  if ( v35 + 4 >= (unsigned int)v35 )
    v9 = 0;
  if ( v9 )
LABEL_22:
    abort();
  v10 = (unsigned __int8 *)malloc(v35 + 4);
  if ( !v10 )
  {
    v14 = "sendResponse: OOM";
    goto LABEL_13;
  }
  v34 = bswap32(v7);
  j_pb_ostream_from_buffer(&v28, (int)v10, v8);
  v31 = v28;
  v32 = v29;
  v33 = v30;
  j_pb_write(&v31, (int)&v34, 4);
  if ( j_pb_encode(&v31, (unsigned __int8 *)&MsgHeader_fields, v4) == 1 )
  {
    _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Size: %zu (0x%zx) Size as written: 0x%x", v35, v35, v34);
    log_hex("onRequestComplete", v10 + 4, v35);
    _android_log_buf_print(
      1,
      4,
      "RIL_UIM_SOCKET",
      "[%d] < SAP RESPONSE type: %d. id: %d. error: %d",
      *v4,
      v4[1],
      v4[2],
      v4[3]);
    v11 = blockingWrite_helper(*(_DWORD *)(v2 + 16), v10, v8);
    if ( !v11 )
    {
      v18 = 3;
      v13 = "Write successful";
      goto LABEL_20;
    }
    v12 = (int *)_errno(v11);
    v13 = "Error %d while writing to fd";
    v21 = *v12;
  }
  else
  {
    v15 = "(none)";
    v16 = v4[1];
    v13 = "Error while encoding response of type %d id %d buffer_size: %zu: %s.";
    v17 = v4[2];
    if ( v33 )
      v15 = v33;
    v25 = v8;
    v27 = v15;
    v21 = v16;
    v23 = v17;
  }
  v18 = 6;
LABEL_20:
  _android_log_buf_print(1, v18, "RIL_UIM_SOCKET", v13, v21, v23, v25, v27);
  free(v10);
LABEL_21:
  pthread_mutex_unlock(v3);
  result = _stack_chk_guard - v36;
  if ( _stack_chk_guard != v36 )
    goto LABEL_22;
  return result;
}
// 3A68: using guessed type int __fastcall _errno(_DWORD);
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000C5D0) --------------------------------------------------------
signed int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(int a1, int a2, int a3)
{
  int v3; // r7
  pthread_mutex_t *v4; // r4
  int v5; // r5
  int v6; // r6
  _DWORD *i; // r0
  _DWORD *v8; // r7
  _DWORD *v9; // t1
  signed int v10; // r5

  v3 = a1;
  v4 = (pthread_mutex_t *)(a1 + 4);
  v5 = a3;
  v6 = a2;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 4));
  v9 = *(_DWORD **)(v3 + 12);
  v8 = (_DWORD *)(v3 + 12);
  for ( i = v9; i; i = (_DWORD *)i[2] )
  {
    if ( *i == v5 && *(_DWORD *)(i[1] + 8) == v6 )
    {
      *v8 = i[2];
      free(i);
      v10 = 1;
      goto LABEL_8;
    }
    v8 = i + 2;
  }
  v10 = 0;
LABEL_8:
  pthread_mutex_unlock(v4);
  return v10;
}

//----- (0000C618) --------------------------------------------------------
int __fastcall RilSapSocket::pushRecord(RilSapSocket *this, void *a2, unsigned int a3)
{
  RilSapSocket *v3; // r5
  int v4; // r6
  const unsigned __int8 *v5; // r7
  _QWORD *v6; // r4
  _DWORD *v7; // r1
  int v8; // r0
  int v9; // r2
  const char *v10; // r0
  char v12; // [sp+8h] [bp-28h]
  const char *v13; // [sp+14h] [bp-1Ch]
  int v14; // [sp+18h] [bp-18h]

  v3 = this;
  v4 = a3;
  v5 = (const unsigned __int8 *)a2;
  j_pb_istream_from_buffer(
    (signed int (__fastcall **)(int, char *, int))&v12,
    (signed int (__fastcall *)(int, char *, int))a2,
    (signed int (__fastcall *)(int, char *, int))a3);
  v6 = malloc(0x14u);
  if ( !v6 )
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "pushRecord: OOM");
    return _stack_chk_guard - v14;
  }
  *v6 = 0LL;
  v6[1] = 0LL;
  *((_DWORD *)v6 + 4) = 0;
  log_hex("BtSapTest-Payload", v5, v4);
  if ( !j_pb_decode((int)&v12, (int)&MsgHeader_fields, (int)v6) )
  {
    v10 = "(none)";
    if ( v13 )
      v10 = v13;
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Error decoding protobuf buffer : %s", v10);
    goto LABEL_10;
  }
  v7 = malloc(0x10u);
  if ( !v7 )
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "pushRecord: OOM");
LABEL_10:
    free(v6);
    return _stack_chk_guard - v14;
  }
  v8 = *((_DWORD *)v3 + 2);
  v9 = *(_DWORD *)v6;
  v7[1] = v6;
  *v7 = v9;
  v7[3] = v8;
  Ril_queue<RilSapSocket::SapSocketRequest>::enqueue((int)v3 + 116, (int)v7);
  return _stack_chk_guard - v14;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 65A0: using guessed type char *off_65A0;

//----- (0000C708) --------------------------------------------------------
int __fastcall RilSapSocket::sendDisconnect(RilSapSocket *this)
{
  char *v1; // r6
  RilSapSocket *v2; // r4
  unsigned int v3; // r7
  signed int v4; // r0
  int *v5; // r5
  unsigned int v6; // r7
  signed int v7; // r0
  char *v8; // r0
  _DWORD *v9; // r0
  void *i; // r0
  int result; // r0
  __int64 v12; // [sp+0h] [bp-50h]
  __int64 v13; // [sp+8h] [bp-48h]
  int v14; // [sp+10h] [bp-40h]
  char v15; // [sp+17h] [bp-39h]
  __int64 v16; // [sp+18h] [bp-38h]
  __int64 v17; // [sp+20h] [bp-30h]
  int v18; // [sp+28h] [bp-28h]
  unsigned int v19; // [sp+30h] [bp-20h]
  unsigned int v20; // [sp+34h] [bp-1Ch]
  int v21; // [sp+38h] [bp-18h]

  v2 = this;
  v20 = 0;
  if ( j_pb_get_encoded_size(&v20, (unsigned __int8 *)&RIL_SIM_SAP_DISCONNECT_REQ_fields, (int *)&v15) != 1 )
    goto LABEL_19;
  v3 = v20;
  if ( (v20 & 0x80000000) != 0 )
    goto LABEL_19;
  v1 = (char *)(v20 + 4);
  v4 = 1;
  if ( v20 + 4 >= v20 )
    v4 = 0;
  if ( v4 )
    goto LABEL_21;
  v5 = (int *)malloc(v20 + 4);
  if ( !v5 )
    goto LABEL_18;
  v19 = bswap32(v3);
  j_pb_ostream_from_buffer(&v12, (int)v5, (int)v1);
  v1 = (char *)&v16;
  v16 = v12;
  v17 = v13;
  v18 = v14;
  j_pb_write(&v16, (int)&v19, 4);
  if ( j_pb_encode(&v16, (unsigned __int8 *)&RIL_SIM_SAP_DISCONNECT_REQ_fields, v5) == 1 )
  {
    v6 = v19;
    v7 = 1;
    if ( v19 + 8 >= v19 )
      v7 = 0;
    if ( !v7 )
    {
      v8 = (char *)calloc(1u, v19 + 8);
      v1 = v8;
      if ( v8 )
      {
        _aeabi_memcpy(v8 + 4, v5, v6);
        *(_DWORD *)v1 = v6;
        v9 = malloc(0x14u);
        if ( !v9 )
          goto LABEL_20;
        v9[4] = v1;
        v9[1] = 1;
        v9[3] = 0;
        v9[2] = 2;
        RilSapSocket::dispatchDisconnect((int)v2, (int)v9);
        goto LABEL_16;
      }
LABEL_18:
      _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "sendDisconnect: OOM");
      goto LABEL_19;
    }
LABEL_21:
    abort();
  }
  _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Encode failed in send disconnect!");
LABEL_16:
  for ( i = v5; ; i = v1 )
  {
    free(i);
LABEL_19:
    result = _stack_chk_guard - v21;
    if ( _stack_chk_guard == v21 )
      break;
LABEL_20:
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "sendDisconnect: OOM");
  }
  return result;
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3D5C: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);

//----- (0000C864) --------------------------------------------------------
void __fastcall RilSapSocket::dispatchDisconnect(int a1, int a2)
{
  int v2; // r6
  int v3; // r4
  _DWORD *v4; // r0
  _DWORD *v5; // r5

  v2 = a1;
  v3 = a2;
  v4 = malloc(0x10u);
  v5 = v4;
  if ( v4 )
  {
    *v4 = -1;
    v4[1] = v3;
    v4[3] = 99;
    v4[2] = 0;
    _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Sending disconnect on command close!");
    (*(void (__fastcall **)(_DWORD, int, _DWORD, _DWORD *))(*(_DWORD *)(v2 + 112) + 4))(
      *(_DWORD *)(v3 + 8),
      *(_DWORD *)(v3 + 16) + 4,
      **(_DWORD **)(v3 + 16),
      v5);
  }
  else
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "dispatchDisconnect: OOM");
    free(*(void **)(v3 + 16));
    j_free((void *)v3);
  }
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000C8DC) --------------------------------------------------------
int __fastcall RilSapSocket::onCommandsSocketClosed(RilSapSocket *this)
{
  RilSapSocket::sendDisconnect(this);
  return _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Socket command closed");
}
// 3B1C: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000C900) --------------------------------------------------------
signed int __fastcall pb_read(int a1, int a2, unsigned int a3)
{
  int v3; // r4
  unsigned int v4; // r5
  const char *v6; // r0
  char v7; // [sp+4h] [bp-24h]

  v3 = a1;
  v4 = a3;
  if ( !a2 && *(signed int (__fastcall **)(int, char *, int))a1 != sub_C9A0 )
  {
    if ( a3 < 0x11 )
      return j_pb_read(v3, (int)&v7, v4);
    while ( j_pb_read(v3, (int)&v7, 16) == 1 )
    {
      v4 -= 16;
      if ( v4 <= 0x10 )
        return j_pb_read(v3, (int)&v7, v4);
    }
    return 0;
  }
  if ( *(_DWORD *)(a1 + 8) >= a3 )
  {
    if ( (*(int (__fastcall **)(int))a1)(a1) )
    {
      *(_DWORD *)(v3 + 8) -= v4;
      return 1;
    }
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v6 = "io error";
      goto LABEL_14;
    }
  }
  else if ( !*(_DWORD *)(a1 + 12) )
  {
    v6 = "end-of-stream";
LABEL_14:
    *(_DWORD *)(v3 + 12) = v6;
    return 0;
  }
  return 0;
}

//----- (0000C9A0) --------------------------------------------------------
signed int __fastcall sub_C9A0(int a1, char *a2, int a3)
{
  char *v3; // r3
  unsigned int v4; // r5
  bool v5; // cf
  bool v6; // zf
  char v7; // t1
  int v9; // r5
  int v10; // r0
  __int64 *v11; // r4
  char *v12; // r6
  __int64 v13; // d16
  __int64 v14; // d17
  __int64 v15; // d16
  char *v16; // r6

  v3 = *(char **)(a1 + 4);
  v4 = (unsigned int)&v3[a3];
  *(_DWORD *)(a1 + 4) = &v3[a3];
  if ( !a2 || !a3 )
    return 1;
  if ( v3 > a2 || v3 - a2 > a3 )
  {
    _aeabi_memmove(a2, v3);
    return 1;
  }
  v5 = v4 >= (unsigned int)a2;
  v6 = v4 == (_DWORD)a2;
  if ( v4 > (unsigned int)a2 )
  {
    v5 = &a2[a3] >= v3;
    v6 = &a2[a3] == v3;
  }
  if ( !v6 && v5 )
  {
    do
    {
      v7 = *v3++;
      --a3;
      *a2++ = v7;
    }
    while ( a3 );
    return 1;
  }
  if ( a3 < 1 )
    return 1;
  if ( a3 >= 8 )
  {
    if ( a3 <= 15 )
    {
      v10 = 0;
    }
    else
    {
      v9 = 0;
      v10 = a3 - (a3 & 0xF);
      v11 = (__int64 *)v3;
      v12 = a2;
      do
      {
        v13 = *v11;
        v14 = v11[1];
        v11 += 2;
        v6 = v9 == v10 - 16;
        *(_QWORD *)v12 = v13;
        *((_QWORD *)v12 + 1) = v14;
        v12 += 16;
        v9 += 16;
      }
      while ( !v6 );
      if ( !(a3 & 0xF) )
        return 1;
      if ( (a3 & 0xFu) <= 7 )
        goto LABEL_25;
    }
    v15 = *(_QWORD *)&v3[v10];
    v16 = &a2[v10];
    v10 += 8;
    *(_QWORD *)v16 = v15;
    goto LABEL_26;
  }
  v10 = 0;
  do
  {
LABEL_25:
    a2[v10] = v3[v10];
    ++v10;
LABEL_26:
    ;
  }
  while ( v10 < a3 );
  return 1;
}
// 4128: using guessed type int __fastcall _aeabi_memmove(_DWORD, _DWORD);

//----- (0000CA44) --------------------------------------------------------
signed int (__fastcall **__fastcall pb_istream_from_buffer(signed int (__fastcall **result)(int a1, char *a2, int a3), signed int (__fastcall *a2)(int a1, char *a2, int a3), signed int (__fastcall *a3)(int a1, char *a2, int a3)))(int a1, char *a2, int a3)
{
  result[1] = a2;
  result[2] = a3;
  result[3] = 0;
  *result = sub_C9A0;
  return result;
}

//----- (0000CA58) --------------------------------------------------------
signed int __fastcall pb_decode_varint(int a1, _DWORD *a2)
{
  int v2; // r4
  _DWORD *v3; // r8
  int v4; // r7
  int v5; // r5
  unsigned __int8 v6; // r0
  int v7; // r6
  unsigned int v8; // r2
  unsigned int v9; // r3
  signed int result; // r0
  char v11; // [sp+7h] [bp-21h]

  v2 = a1;
  v3 = a2;
  v4 = 0;
  v5 = 0;
  v6 = 0;
  while ( 1 )
  {
    v7 = v6;
    if ( v6 >= 0x40u )
      break;
    if ( sub_CAF0(v2, (int)&v11) != 1 )
      return 0;
    v8 = v11 & 0x7F;
    v9 = v8 >> (32 - v7);
    if ( v7 - 32 >= 0 )
      v9 = v8 << (v7 - 32);
    v4 |= v8 << v7;
    v5 |= v9;
    v6 = v7 + 7;
    if ( v11 >= 0 )
    {
      result = 1;
      *v3 = v4;
      v3[1] = v5;
      return result;
    }
  }
  if ( !*(_DWORD *)(v2 + 12) )
    *(_DWORD *)(v2 + 12) = "varint overflow";
  return 0;
}

//----- (0000CAF0) --------------------------------------------------------
signed int __fastcall sub_CAF0(int a1, int a2)
{
  int v2; // r4
  const char *v4; // r0

  v2 = a1;
  if ( *(_DWORD *)(a1 + 8) )
  {
    if ( (*(int (__fastcall **)(int, int, signed int))a1)(a1, a2, 1) )
    {
      --*(_DWORD *)(v2 + 8);
      return 1;
    }
    if ( !*(_DWORD *)(v2 + 12) )
    {
      v4 = "io error";
      goto LABEL_8;
    }
  }
  else if ( !*(_DWORD *)(a1 + 12) )
  {
    v4 = "end-of-stream";
LABEL_8:
    *(_DWORD *)(v2 + 12) = v4;
    return 0;
  }
  return 0;
}

//----- (0000CB2C) --------------------------------------------------------
signed int __fastcall pb_decode_tag(int a1, int *a2, unsigned int *a3, _BYTE *a4)
{
  int v4; // r7
  int *v5; // r5
  _BYTE *v6; // r4
  unsigned int *v7; // r6
  char v8; // r0
  unsigned int v10; // [sp+4h] [bp-1Ch]

  v4 = a1;
  v5 = a2;
  v6 = a4;
  v7 = a3;
  *a4 = 0;
  *a2 = 0;
  *a3 = 0;
  if ( sub_CB90(a1, (int *)&v10) )
  {
    v8 = v10;
    if ( v10 )
    {
      *v7 = v10 >> 3;
      *v5 = v8 & 7;
      return 1;
    }
    goto LABEL_5;
  }
  if ( !*(_DWORD *)(v4 + 8) )
LABEL_5:
    *v6 = 1;
  return 0;
}

//----- (0000CB90) --------------------------------------------------------
signed int __fastcall sub_CB90(int a1, int *a2)
{
  int v2; // r4
  int *v3; // r8
  int v4; // r7
  unsigned __int8 v5; // r0
  unsigned __int8 v6; // r5
  signed int result; // r0
  unsigned __int8 v8; // [sp+3h] [bp-1Dh]

  v2 = a1;
  v3 = a2;
  if ( sub_CAF0(a1, (int)&v8) == 1 )
  {
    v4 = v8;
    if ( (char)v8 > -1 )
    {
LABEL_7:
      result = 1;
      *v3 = v4;
      return result;
    }
    v4 = v8 & 0x7F;
    v5 = 7;
    while ( 1 )
    {
      v6 = v5;
      if ( v5 >= 0x20u )
        break;
      if ( sub_CAF0(v2, (int)&v8) != 1 )
        return 0;
      v4 |= (v8 & 0x7F) << v6;
      v5 = v6 + 7;
      if ( (v8 & 0x80u) == 0 )
        goto LABEL_7;
    }
    if ( !*(_DWORD *)(v2 + 12) )
      *(_DWORD *)(v2 + 12) = "varint overflow";
  }
  return 0;
}

//----- (0000CC2C) --------------------------------------------------------
int __fastcall pb_skip_field(int a1, int a2)
{
  int v2; // r4
  int result; // r0
  char v4; // [sp+7h] [bp-19h]
  int v5; // [sp+8h] [bp-18h]

  v2 = a1;
  switch ( a2 )
  {
    case 0:
      do
      {
        if ( j_pb_read(v2, (int)&v4, 1) != 1 )
          goto LABEL_10;
      }
      while ( v4 < 0 );
      result = 1;
      break;
    case 1:
      result = j_pb_read(a1, 0, 8);
      break;
    case 2:
      if ( sub_CB90(a1, &v5) != 1 )
        goto LABEL_10;
      result = j_pb_read(v2, 0, v5);
      break;
    case 5:
      result = j_pb_read(a1, 0, 4);
      break;
    default:
      if ( !*(_DWORD *)(a1 + 12) )
        *(_DWORD *)(a1 + 12) = "invalid wire_type";
LABEL_10:
      result = 0;
      break;
  }
  return result;
}

//----- (0000CCC8) --------------------------------------------------------
signed int __fastcall pb_make_string_substream(int a1, _QWORD *a2)
{
  int v2; // r4
  _QWORD *v3; // r5
  __int64 v4; // d17
  unsigned int v5; // r0
  unsigned int v7; // [sp+0h] [bp-18h]

  v2 = a1;
  v3 = a2;
  if ( sub_CB90(a1, (int *)&v7) != 1 )
    return 0;
  v4 = *(_QWORD *)(v2 + 8);
  v5 = v7;
  *v3 = *(_QWORD *)v2;
  v3[1] = v4;
  if ( *((_DWORD *)v3 + 2) < v5 )
  {
    if ( !*(_DWORD *)(v2 + 12) )
      *(_DWORD *)(v2 + 12) = "parent stream too short";
    return 0;
  }
  *((_DWORD *)v3 + 2) = v5;
  *(_DWORD *)(v2 + 8) -= v5;
  return 1;
}

//----- (0000CD30) --------------------------------------------------------
int __fastcall pb_close_string_substream(int result, int a2)
{
  *(_DWORD *)(result + 4) = *(_DWORD *)(a2 + 4);
  *(_DWORD *)(result + 12) = *(_DWORD *)(a2 + 12);
  return result;
}

//----- (0000CD3C) --------------------------------------------------------
int __fastcall pb_decode_noinit(int a1, unsigned __int8 *a2, int a3)
{
  int v3; // r10
  int v4; // r11
  unsigned int v5; // r8
  int v6; // r0
  int v7; // r3
  int v8; // r7
  unsigned int v9; // r5
  unsigned int v10; // r4
  int v11; // r9
  int v12; // r7
  int v13; // r0
  int (__fastcall *v14)(int, int, unsigned int, int); // r4
  unsigned __int8 *v15; // r0
  signed int v16; // r4
  int v17; // r4
  unsigned int v18; // r4
  unsigned __int8 v19; // r5
  unsigned int v20; // r2
  unsigned int v21; // r0
  int *v22; // r3
  int result; // r0
  int v24; // [sp+8h] [bp-70h]
  unsigned __int8 *v25; // [sp+Ch] [bp-6Ch]
  unsigned __int8 *v26; // [sp+10h] [bp-68h]
  int v27; // [sp+14h] [bp-64h]
  unsigned int v28; // [sp+18h] [bp-60h]
  int v29; // [sp+1Ch] [bp-5Ch]
  int *v30; // [sp+20h] [bp-58h]
  int v31; // [sp+24h] [bp-54h]
  int v32; // [sp+28h] [bp-50h]
  int v33; // [sp+2Ch] [bp-4Ch]
  unsigned int v34; // [sp+34h] [bp-44h]
  unsigned __int8 *v35; // [sp+38h] [bp-40h]
  int v36; // [sp+3Ch] [bp-3Ch]
  int v37; // [sp+40h] [bp-38h]
  int v38; // [sp+44h] [bp-34h]
  int v39; // [sp+48h] [bp-30h]
  int v40; // [sp+4Ch] [bp-2Ch]
  int v41; // [sp+50h] [bp-28h]

  v3 = a1;
  v4 = 0;
  v5 = 0;
  v32 = 0;
  v33 = 0;
  v6 = (char)a2[3];
  v29 = a3;
  v25 = a2;
  v27 = 0;
  v28 = 0;
  v7 = a2[2];
  v26 = a2;
  v30 = (int *)(a3 + v7);
  v31 = v6 + a3 + v7;
LABEL_30:
  while ( 2 )
  {
    v17 = v4;
    if ( *(_DWORD *)(v3 + 8) )
    {
      if ( sub_CB90(v3, (int *)&v34) )
      {
        if ( v34 )
        {
          v8 = v34 & 7;
          v9 = v34 >> 3;
          while ( *v26 != v9 || (v26[1] & 0xF) == 8 )
          {
            sub_D344((int *)&v25);
            v4 = v27;
            if ( v27 == v17 )
            {
              v4 = v17;
              if ( v9 < v5 )
              {
                v4 = v17;
                goto LABEL_18;
              }
              while ( (v26[1] & 0xF) != 8 )
              {
                sub_D344((int *)&v25);
                v4 = v27;
                if ( v27 == v17 )
                {
                  v5 = -1;
                  v4 = v17;
                  goto LABEL_17;
                }
              }
              v5 = *v26;
LABEL_17:
              if ( v9 >= v5 )
              {
                v11 = *(_DWORD *)(v3 + 8);
                v24 = v8;
                v12 = *v30;
                v13 = *(_DWORD *)(v3 + 8);
                if ( *v30 )
                {
                  while ( v11 == v13 )
                  {
                    v14 = **(int (__fastcall ***)(int, int, unsigned int, int))v12;
                    if ( v14 )
                    {
                      if ( !v14(v3, v12, v9, v24) )
                        goto LABEL_49;
                    }
                    else
                    {
                      v15 = *(unsigned __int8 **)(*(_DWORD *)v12 + 8);
                      if ( *v15 == v9 )
                      {
                        v16 = 0;
                        v34 = *(_DWORD *)(*(_DWORD *)v12 + 8);
                        v35 = v15;
                        v36 = 0;
                        v37 = 0;
                        v38 = *(_DWORD *)(v12 + 4);
                        v39 = v38;
                        v40 = v12 + 12;
                        if ( sub_CF3C(v3, v24, &v34) != 1 )
                          goto LABEL_50;
                      }
                    }
                    v12 = *(_DWORD *)(v12 + 8);
                    v13 = *(_DWORD *)(v3 + 8);
                    if ( !v12 )
                      break;
                  }
                }
                v10 = v5;
                v8 = v24;
                if ( v11 != v13 )
                  goto LABEL_30;
              }
              else
              {
LABEL_18:
                v10 = v5;
              }
              v5 = v10;
              if ( j_pb_skip_field(v3, v8) )
                goto LABEL_30;
              goto LABEL_49;
            }
          }
          if ( !(v26[1] & 0x30) && v28 <= 0x3F )
            *((_BYTE *)&v32 + (v28 >> 3)) |= 1 << (v28 & 7);
          if ( sub_CF3C(v3, v8, &v25) )
            continue;
          goto LABEL_49;
        }
      }
      else if ( *(_DWORD *)(v3 + 8) )
      {
        goto LABEL_49;
      }
    }
    break;
  }
  do
  {
    v18 = v28;
    v19 = v26[1];
  }
  while ( sub_D344((int *)&v25) );
  if ( !(v19 & 0x30) && *v26 )
    ++v18;
  v20 = 0;
  v21 = v18 >> 3;
  if ( v18 >> 3 )
  {
    v22 = &v32;
    while ( *(unsigned __int8 *)v22 == 255 )
    {
      ++v20;
      v22 = (int *)((char *)v22 + 1);
      if ( v20 >= v21 )
        goto LABEL_43;
    }
    if ( *(_DWORD *)(v3 + 12) )
      goto LABEL_49;
    goto LABEL_48;
  }
LABEL_43:
  if ( *((unsigned __int8 *)&v32 + v21) == 0xFFu >> (8 - (v18 & 7)) )
  {
    v16 = 1;
    goto LABEL_50;
  }
  if ( !*(_DWORD *)(v3 + 12) )
LABEL_48:
    *(_DWORD *)(v3 + 12) = "missing required field";
LABEL_49:
  v16 = 0;
LABEL_50:
  result = _stack_chk_guard - v41;
  if ( _stack_chk_guard == v41 )
    result = v16;
  return result;
}

//----- (0000CF3C) --------------------------------------------------------
int __fastcall sub_CF3C(int a1, int a2, _DWORD *a3)
{
  int v3; // r11
  _DWORD *v4; // r5
  int v5; // r2
  _BYTE *v6; // r1
  char v7; // r0
  unsigned int v8; // r3
  int v9; // r0
  int (__fastcall *v10)(_DWORD); // r4
  const char *v11; // r0
  unsigned int v12; // r3
  int v13; // r0
  int (__fastcall *v14)(int, _BYTE *, _DWORD *); // r9
  _DWORD *v15; // r2
  int (__fastcall **v16)(_DWORD, int, int); // r8
  int *v17; // r6
  int v18; // r6
  int v19; // t1
  const char *v20; // r0
  int result; // r0
  int v22; // r7
  int v23; // r4
  int v24; // r0
  unsigned int *v25; // r7
  int v26; // r2
  unsigned int v27; // r0
  int v28; // r1
  int v29; // r2
  int v30; // r2
  int *v31; // r10
  unsigned int v32; // r6
  int v33; // r1
  int v34; // r0
  void **v35; // r4
  void *v36; // r0
  int v37; // r1
  _DWORD *v38; // r7
  int v39; // r0
  void **v40; // r4
  void *v41; // r0
  int v42; // r0
  _DWORD *v43; // r1
  int v44; // r2
  unsigned int v45; // r0
  int v46; // r1
  int v47; // r2
  void **v48; // r4
  void *v49; // r0
  int v50; // r0
  _DWORD *v51; // r7
  int v52; // r1
  int v53; // r1
  const char *v54; // r1
  const char *v55; // r1
  signed int (__fastcall *v56)(int, char *, int); // [sp+4h] [bp-44h]
  char *v57; // [sp+8h] [bp-40h]
  int v58; // [sp+Ch] [bp-3Ch]
  const char *v59; // [sp+10h] [bp-38h]
  char v60[10]; // [sp+16h] [bp-32h]
  int v61; // [sp+20h] [bp-28h]

  v3 = a1;
  v4 = a3;
  v5 = a2;
  v6 = (_BYTE *)v4[1];
  v7 = v6[1];
  if ( (v7 & 0xC0) == 128 )
  {
    v12 = v7 & 0xF;
    v13 = v7 & 0x30;
    v14 = (int (__fastcall *)(int, _BYTE *, _DWORD *))*(&off_15B48 + v12);
    if ( v13 )
    {
      if ( v13 == 32 )
      {
        v31 = (int *)v4[6];
        v32 = *v31;
        if ( v5 == 2 && v12 <= 4 )
        {
          if ( j_pb_make_string_substream(v3, &v56) == 1 )
          {
            v33 = v58;
            if ( v58 )
            {
              v34 = *v31;
              do
              {
                if ( v34 + 1 > v32 )
                {
                  v35 = (void **)v4[5];
                  v32 += (v33 - 1) / (unsigned int)*(unsigned __int8 *)(v4[1] + 4) + 1;
                  v36 = realloc(*v35, v32 * *(unsigned __int8 *)(v4[1] + 4));
                  if ( !v36 )
                    goto LABEL_97;
                  *v35 = v36;
                  v34 = *v31;
                }
                v37 = v4[1];
                v38 = (_DWORD *)(*(_DWORD *)v4[5] + *(unsigned __int8 *)(v37 + 4) * v34);
                v39 = *(_BYTE *)(v37 + 1) & 0xF;
                if ( (unsigned int)(v39 - 5) >= 2 )
                {
                  if ( v39 == 7 )
                    sub_D3EC(*(_DWORD *)(v37 + 6), (int)v38);
                }
                else
                {
                  *v38 = 0;
                }
                if ( v14((int)&v56, (_BYTE *)v4[1], v38) != 1 )
                  goto LABEL_99;
                v34 = *v31 + 1;
                *v31 = v34;
                v33 = v58;
              }
              while ( v58 );
            }
            result = 1;
            goto LABEL_100;
          }
          goto LABEL_95;
        }
        *v31 = v32 + 1;
        v48 = (void **)v4[5];
        v49 = realloc(*v48, *(unsigned __int8 *)(v4[1] + 4) * (v32 + 1));
        if ( !v49 )
        {
          if ( !*(_DWORD *)(v3 + 12) )
          {
            v11 = "realloc failed";
            goto LABEL_94;
          }
          goto LABEL_95;
        }
        *v48 = v49;
        v50 = v4[1];
        v51 = (_DWORD *)(*(_DWORD *)v4[5] + (*v31 - 1) * *(unsigned __int8 *)(v50 + 4));
        v52 = *(_BYTE *)(v50 + 1) & 0xF;
        if ( (unsigned int)(v52 - 5) >= 2 )
        {
          if ( v52 == 7 )
            sub_D3EC(*(_DWORD *)(v50 + 6), (int)v51);
        }
        else
        {
          *v51 = 0;
        }
        result = v14(v3, (_BYTE *)v4[1], v51);
        goto LABEL_96;
      }
      if ( v13 != 16 )
      {
        if ( !*(_DWORD *)(v3 + 12) )
        {
          v11 = "invalid field type";
          goto LABEL_94;
        }
        goto LABEL_95;
      }
    }
    if ( v12 - 5 > 1 )
    {
      v40 = (void **)v4[5];
      v41 = realloc(*v40, (unsigned __int8)v6[4]);
      if ( !v41 )
      {
        if ( !*(_DWORD *)(v3 + 12) )
        {
          v11 = "realloc failed";
          goto LABEL_94;
        }
        goto LABEL_95;
      }
      *v40 = v41;
      v42 = v4[1];
      v43 = *(_DWORD **)v4[5];
      v44 = *(_BYTE *)(v42 + 1) & 0xF;
      if ( (unsigned int)(v44 - 5) >= 2 )
      {
        if ( v44 == 7 )
          sub_D3EC(*(_DWORD *)(v42 + 6), (int)v43);
      }
      else
      {
        *v43 = 0;
      }
      v6 = (_BYTE *)v4[1];
      v15 = *(_DWORD **)v4[5];
    }
    else
    {
      v15 = (_DWORD *)v4[5];
    }
    result = v14(v3, v6, v15);
    goto LABEL_96;
  }
  if ( (v7 & 0xC0) == 64 )
  {
    v16 = (int (__fastcall **)(_DWORD, int, int))v4[5];
    v17 = (int *)v4[5];
    v19 = *v17;
    v18 = (int)(v17 + 1);
    if ( !v19 )
    {
      result = j_pb_skip_field(v3, v5);
      goto LABEL_96;
    }
    switch ( v5 )
    {
      case 2:
        if ( j_pb_make_string_substream(v3, &v56) != 1 )
          goto LABEL_95;
        while ( (*v16)(&v56, v4[1], v18) )
        {
          if ( !v58 )
          {
            v20 = v59;
            *(_DWORD *)(v3 + 4) = v57;
            *(_DWORD *)(v3 + 12) = v20;
            result = 1;
            goto LABEL_96;
          }
        }
        if ( *(_DWORD *)(v3 + 12) )
          goto LABEL_95;
        v11 = "callback failed";
        goto LABEL_94;
      case 5:
        v23 = 4;
        if ( !j_pb_read(v3, (int)v60, 4) )
          goto LABEL_95;
        break;
      case 1:
        v23 = 8;
        if ( j_pb_read(v3, (int)v60, 8) != 1 )
          goto LABEL_95;
        break;
      case 0:
        v22 = 0;
        while ( 1 )
        {
          v23 = v22 + 1;
          if ( (unsigned int)(v22 + 1) > 0xA || j_pb_read(v3, (int)&v60[v22], 1) != 1 )
            goto LABEL_95;
          v24 = v60[v22++];
          if ( v24 >= 0 )
            goto LABEL_75;
        }
      default:
        if ( !*(_DWORD *)(v3 + 12) )
        {
          v11 = "invalid wire_type";
          goto LABEL_94;
        }
        goto LABEL_95;
    }
LABEL_75:
    v57 = v60;
    v59 = 0;
    v53 = v4[1];
    v58 = v23;
    v56 = sub_C9A0;
    result = (*v16)(&v56, v53, v18);
    goto LABEL_96;
  }
  if ( v7 & 0xC0 )
  {
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v11 = "invalid field type";
      goto LABEL_94;
    }
LABEL_95:
    result = 0;
    goto LABEL_96;
  }
  v8 = v7 & 0xF;
  v9 = v7 & 0x30;
  v10 = (int (__fastcall *)(_DWORD))*(&off_15B48 + v8);
  if ( v9 != 32 )
  {
    if ( v9 == 16 )
    {
      *(_BYTE *)v4[6] = 1;
      v6 = (_BYTE *)v4[1];
    }
    else if ( v9 )
    {
      if ( !*(_DWORD *)(v3 + 12) )
      {
        v11 = "invalid field type";
LABEL_94:
        *(_DWORD *)(v3 + 12) = v11;
        goto LABEL_95;
      }
      goto LABEL_95;
    }
    v30 = v4[5];
LABEL_42:
    result = ((int (__fastcall *)(int, _BYTE *, int))v10)(v3, v6, v30);
    goto LABEL_96;
  }
  v25 = (unsigned int *)v4[6];
  if ( v5 != 2 || v8 > 4 )
  {
    v45 = *v25;
    if ( *v25 >= (unsigned __int8)v6[5] )
    {
      if ( !*(_DWORD *)(v3 + 12) )
      {
        v11 = "array overflow";
        goto LABEL_94;
      }
      goto LABEL_95;
    }
    v46 = (unsigned __int8)v6[4];
    v47 = v4[5];
    *v25 = v45 + 1;
    v30 = v47 + v46 * v45;
    v6 = (_BYTE *)v4[1];
    goto LABEL_42;
  }
  if ( j_pb_make_string_substream(v3, &v56) != 1 )
    goto LABEL_95;
  v26 = v58;
  if ( v58 )
  {
    v27 = *v25;
    while ( 1 )
    {
      v28 = v4[1];
      if ( v27 >= *(unsigned __int8 *)(v28 + 5) )
      {
        result = 1;
        goto LABEL_91;
      }
      v29 = v4[5] + *(unsigned __int8 *)(v28 + 4) * v27;
      if ( !v10(&v56) )
        break;
      v27 = *v25 + 1;
      *v25 = v27;
      v26 = v58;
      if ( !v58 )
        goto LABEL_39;
    }
    v26 = v58;
    result = 0;
  }
  else
  {
LABEL_39:
    result = 1;
    v26 = 0;
  }
LABEL_91:
  v54 = v59;
  *(_DWORD *)(v3 + 4) = v57;
  *(_DWORD *)(v3 + 12) = v54;
  if ( v26 )
  {
    if ( !v54 )
    {
      v11 = "array overflow";
      goto LABEL_94;
    }
    goto LABEL_95;
  }
LABEL_96:
  while ( _stack_chk_guard != v61 )
  {
LABEL_97:
    if ( !v59 )
      v59 = "realloc failed";
LABEL_99:
    result = 0;
LABEL_100:
    v55 = v59;
    *(_DWORD *)(v3 + 4) = v57;
    *(_DWORD *)(v3 + 12) = v55;
  }
  return result;
}
// 15B48: using guessed type void *off_15B48;
// CF3C: using guessed type char var_32[10];

//----- (0000D344) --------------------------------------------------------
signed int __fastcall sub_D344(int *a1)
{
  _BYTE *v1; // r1
  char v2; // r3
  int v3; // lr
  int v4; // r2
  int v5; // r3
  int v6; // r12
  signed int v7; // r4
  int v8; // r1

  v1 = (_BYTE *)a1[1];
  v2 = v1[1];
  v3 = (unsigned __int8)v1[4];
  if ( (v2 & 0xF0) == 32 )
  {
    v3 = (unsigned __int8)v1[5] * (unsigned __int8)v1[4];
  }
  else if ( (v2 & 0xC0) == 128 )
  {
    v3 = 4;
  }
  if ( !*v1 )
    return 0;
  if ( !(v1[1] & 0x30) )
    ++a1[3];
  v4 = a1[2];
  v5 = (int)(v1 + 10);
  a1[1] = (int)(v1 + 10);
  a1[2] = v4 + 1;
  if ( v1[10] )
  {
    v6 = a1[5];
    v7 = 1;
  }
  else
  {
    v6 = a1[4];
    v7 = 0;
    v5 = *a1;
    v3 = 0;
    a1[2] = 0;
    a1[3] = 0;
    a1[1] = v5;
    a1[5] = v6;
  }
  v8 = v6 + v3 + *(unsigned __int8 *)(v5 + 2);
  a1[5] = v8;
  a1[6] = v8 + *(char *)(v5 + 3);
  return v7;
}

//----- (0000D3C2) --------------------------------------------------------
int __fastcall pb_decode(int a1, int a2, int a3)
{
  int v3; // r4
  unsigned __int8 *v4; // r5
  int v5; // r6
  int v6; // r6

  v3 = a3;
  v4 = (unsigned __int8 *)a2;
  v5 = a1;
  sub_D3EC(a2, a3);
  v6 = j_pb_decode_noinit(v5, v4, v3);
  if ( !v6 )
    j_pb_release((int)v4, v3);
  return v6;
}

//----- (0000D3EC) --------------------------------------------------------
int __fastcall sub_D3EC(int a1, int a2)
{
  int v2; // r4
  int v3; // r3
  char v4; // r1
  int v5; // r3
  int v6; // r2
  int v8; // [sp+0h] [bp-30h]
  int v9; // [sp+4h] [bp-2Ch]
  int v10; // [sp+8h] [bp-28h]
  int v11; // [sp+Ch] [bp-24h]
  int v12; // [sp+10h] [bp-20h]
  _DWORD *v13; // [sp+14h] [bp-1Ch]
  _DWORD *v14; // [sp+18h] [bp-18h]
  int v15; // [sp+1Ch] [bp-14h]

  v8 = a1;
  v2 = *(unsigned __int8 *)(a1 + 2);
  v3 = *(char *)(a1 + 3);
  v10 = 0;
  v11 = 0;
  v13 = (_DWORD *)(a2 + v2);
  v14 = (_DWORD *)(a2 + v2 + v3);
  v9 = a1;
  v12 = a2;
  while ( 1 )
  {
    if ( !*(_BYTE *)a1 )
      goto LABEL_16;
    v4 = *(_BYTE *)(a1 + 1);
    if ( (v4 & 0xC0) == 128 )
    {
      *v13 = 0;
      if ( (v4 & 0x30) != 32 )
        goto LABEL_16;
LABEL_12:
      *v14 = 0;
      goto LABEL_16;
    }
    if ( *(_BYTE *)(a1 + 1) & 0xC0 )
      goto LABEL_16;
    if ( (v4 & 0x30) == 32 )
      goto LABEL_12;
    if ( (v4 & 0x30) == 16 )
    {
      *(_BYTE *)v14 = 0;
      v4 = *(_BYTE *)(a1 + 1);
    }
    v5 = *(_DWORD *)(a1 + 6);
    if ( (v4 & 0xF) == 7 )
    {
      sub_D3EC(*(_DWORD *)(a1 + 6), v13);
    }
    else
    {
      v6 = *(unsigned __int8 *)(a1 + 4);
      if ( v5 )
        _aeabi_memcpy(v13, v5, v6);
      else
        _aeabi_memclr(v13, v6);
    }
LABEL_16:
    if ( sub_D344(&v8) != 1 )
      return _stack_chk_guard - v15;
    a1 = v9;
  }
}
// 3D5C: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);
// 3E40: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);

//----- (0000D4A4) --------------------------------------------------------
int __fastcall pb_release(int a1, int a2)
{
  int v2; // r5
  int v3; // r3
  int v4; // r2
  char v5; // r1
  signed int v6; // r4
  void **v7; // r5
  char *v8; // r6
  signed int v9; // r4
  void **v10; // r4
  int v12; // [sp+0h] [bp-38h]
  int v13; // [sp+4h] [bp-34h]
  int v14; // [sp+8h] [bp-30h]
  int v15; // [sp+Ch] [bp-2Ch]
  int v16; // [sp+10h] [bp-28h]
  void **v17; // [sp+14h] [bp-24h]
  signed int *v18; // [sp+18h] [bp-20h]
  int v19; // [sp+1Ch] [bp-1Ch]

  v2 = a1;
  v12 = a1;
  v3 = *(unsigned __int8 *)(a1 + 2);
  v4 = *(char *)(a1 + 3);
  v14 = 0;
  v15 = 0;
  v17 = (void **)(a2 + v3);
  v18 = (signed int *)(a2 + v3 + v4);
  v13 = a1;
  v16 = a2;
  while ( 1 )
  {
    if ( *(_BYTE *)v2 )
    {
      v5 = *(_BYTE *)(v2 + 1);
      if ( (v5 & 0xC0) == 128 )
      {
        if ( (v5 & 0x30) != 32 || (v5 & 0xFu) - 5 > 1 )
        {
          if ( (v5 & 0xF) == 7 )
          {
            v8 = (char *)*v17;
            v9 = (signed int)*v17;
            if ( *v17 )
              v9 = 1;
            if ( (v5 & 0x30) == 32 )
              v9 = *v18;
            for ( ; v9; v8 += *(unsigned __int8 *)(v2 + 4) )
            {
              j_pb_release(*(_DWORD *)(v2 + 6), (int)v8);
              --v9;
            }
          }
        }
        else
        {
          v6 = *v18;
          if ( *v18 )
          {
            v7 = (void **)*v17;
            do
            {
              free(*v7);
              *v7 = 0;
              ++v7;
              --v6;
            }
            while ( v6 );
          }
        }
        v10 = v17;
        free(*v17);
        *v10 = 0;
      }
    }
    if ( sub_D344(&v12) != 1 )
      break;
    v2 = v13;
  }
  return _stack_chk_guard - v19;
}

//----- (0000D574) --------------------------------------------------------
int __fastcall pb_decode_delimited(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r6
  int v5; // r5
  int result; // r0
  int v7; // r2
  char v8; // [sp+4h] [bp-24h]
  int v9; // [sp+8h] [bp-20h]
  int v10; // [sp+10h] [bp-18h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( j_pb_make_string_substream(a1, &v8) != 1 )
    return 0;
  result = j_pb_decode((int)&v8, v4, v5);
  v7 = v9;
  *(_DWORD *)(v3 + 12) = v10;
  *(_DWORD *)(v3 + 4) = v7;
  return result;
}

//----- (0000D5C8) --------------------------------------------------------
signed int __fastcall pb_decode_svarint(int a1, int *a2)
{
  int *v2; // r4
  int v3; // t2
  int v4; // r0
  int v6; // [sp+0h] [bp-18h]
  unsigned int v7; // [sp+4h] [bp-14h]

  v2 = a2;
  if ( j_pb_decode_varint(a1, &v6) != 1 )
    return 0;
  v3 = __RCR__(v6, 1);
  v4 = v3 ^ (v6 << 31 >> 31);
  v2[1] = (v7 >> 1) ^ (v6 << 31 >> 31);
  *v2 = v4;
  return 1;
}

//----- (0000D624) --------------------------------------------------------
int __fastcall pb_decode_fixed32(int a1, int a2)
{
  return j_j_pb_read(a1, a2, 4);
}

//----- (0000D62A) --------------------------------------------------------
int __fastcall pb_decode_fixed64(int a1, int a2)
{
  return j_j_pb_read(a1, a2, 8);
}

//----- (0000D630) --------------------------------------------------------
signed int __fastcall sub_D630(int a1, int a2, int a3)
{
  int v3; // r5
  int v4; // r6
  int v5; // r4
  int v7; // r0
  int v8; // [sp+0h] [bp-20h]
  int v9; // [sp+4h] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( j_pb_decode_varint(a1, &v8) != 1 )
    return 0;
  switch ( *(unsigned __int8 *)(v4 + 4) )
  {
    case 1u:
      *(_BYTE *)v5 = v8;
      return 1;
    case 2u:
      *(_WORD *)v5 = v8;
      return 1;
    case 4u:
      v7 = v8;
      break;
    case 8u:
      v7 = v8;
      *(_DWORD *)(v5 + 4) = v9;
      break;
    default:
      if ( !*(_DWORD *)(v3 + 12) )
        *(_DWORD *)(v3 + 12) = "invalid data_size";
      return 0;
  }
  *(_DWORD *)v5 = v7;
  return 1;
}

//----- (0000D6B8) --------------------------------------------------------
signed int __fastcall sub_D6B8(int a1, int a2, int *a3)
{
  int v3; // r5
  int v4; // r6
  int *v5; // r4
  int v6; // r0
  int v7; // r0
  int v9; // [sp+0h] [bp-20h]
  int v10; // [sp+4h] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( j_pb_decode_varint(a1, &v9) == 1 )
  {
    v6 = *(unsigned __int8 *)(v4 + 4);
    if ( v6 == 8 )
    {
      v7 = v9;
      v5[1] = v10;
      goto LABEL_6;
    }
    if ( v6 == 4 )
    {
      v7 = v9;
LABEL_6:
      *v5 = v7;
      return 1;
    }
    if ( !*(_DWORD *)(v3 + 12) )
      *(_DWORD *)(v3 + 12) = "invalid data_size";
  }
  return 0;
}

//----- (0000D720) --------------------------------------------------------
signed int __fastcall sub_D720(int a1, int a2, int *a3)
{
  int v3; // r5
  int v4; // r6
  int *v5; // r4
  int v6; // r1
  unsigned int v7; // r2
  int v8; // r3
  int v9; // t2
  int v10; // r0
  int v12; // [sp+0h] [bp-20h]
  unsigned int v13; // [sp+4h] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( j_pb_decode_varint(a1, &v12) == 1 )
  {
    v6 = *(unsigned __int8 *)(v4 + 4);
    v7 = v13 >> 1;
    v8 = v12 << 31;
    v9 = __RCR__(v12, 1);
    v10 = v9 ^ (v12 << 31 >> 31);
    if ( v6 == 8 )
    {
      *v5 = v10;
      v5[1] = v7 ^ (v8 >> 31);
      return 1;
    }
    if ( v6 == 4 )
    {
      *v5 = v10;
      return 1;
    }
    if ( !*(_DWORD *)(v3 + 12) )
      *(_DWORD *)(v3 + 12) = "invalid data_size";
  }
  return 0;
}

//----- (0000D7A0) --------------------------------------------------------
int __fastcall sub_D7A0(int a1, int a2, int a3)
{
  return j_j_pb_read(a1, a3, 4);
}

//----- (0000D7A8) --------------------------------------------------------
int __fastcall sub_D7A8(int a1, int a2, int a3)
{
  return j_j_pb_read(a1, a3, 8);
}

//----- (0000D7B0) --------------------------------------------------------
int __fastcall sub_D7B0(int a1, int a2, void **a3)
{
  int v3; // r4
  int v4; // r7
  void **v5; // r5
  int v6; // r6
  size_t v7; // r1
  void *v8; // r0
  const char *v9; // r0
  int v11; // [sp+4h] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( sub_CB90(a1, &v11) != 1 )
    return 0;
  v6 = v11;
  v7 = v11 + 4;
  if ( (*(_BYTE *)(v4 + 1) & 0xC0) == 128 )
  {
    v8 = realloc(*v5, v7);
    if ( v8 )
    {
      *v5 = v8;
      v5 = (void **)v8;
LABEL_8:
      *v5 = (void *)v6;
      return j_pb_read(v3, (int)(v5 + 1), v6);
    }
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v9 = "realloc failed";
      goto LABEL_11;
    }
  }
  else
  {
    if ( v7 <= *(unsigned __int8 *)(v4 + 4) )
      goto LABEL_8;
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v9 = "bytes overflow";
LABEL_11:
      *(_DWORD *)(v3 + 12) = v9;
      return 0;
    }
  }
  return 0;
}

//----- (0000D840) --------------------------------------------------------
int __fastcall sub_D840(int a1, int a2, void **a3)
{
  int v3; // r4
  int v4; // r7
  void **v5; // r5
  int v6; // r6
  size_t v7; // r1
  void *v8; // r0
  const char *v9; // r0
  int result; // r0
  int v11; // [sp+4h] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( sub_CB90(a1, &v11) != 1 )
    return 0;
  v6 = v11;
  v7 = v11 + 1;
  if ( (*(_BYTE *)(v4 + 1) & 0xC0) == 128 )
  {
    v8 = realloc(*v5, v7);
    if ( v8 )
    {
      *v5 = v8;
      v5 = (void **)v8;
LABEL_8:
      result = j_pb_read(v3, (int)v5, v6);
      *((_BYTE *)v5 + v6) = 0;
      return result;
    }
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v9 = "realloc failed";
      goto LABEL_11;
    }
  }
  else
  {
    if ( v7 <= *(unsigned __int8 *)(v4 + 4) )
      goto LABEL_8;
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v9 = "string overflow";
LABEL_11:
      *(_DWORD *)(v3 + 12) = v9;
      return 0;
    }
  }
  return 0;
}

//----- (0000D8D0) --------------------------------------------------------
int __fastcall sub_D8D0(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r7
  int v5; // r5
  unsigned __int8 *v6; // r6
  int result; // r0
  int v8; // r1
  int v9; // [sp+0h] [bp-28h]
  int v10; // [sp+4h] [bp-24h]
  int v11; // [sp+Ch] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = *(unsigned __int8 **)(a2 + 6);
  if ( j_pb_make_string_substream(a1, &v9) != 1 )
    return 0;
  if ( !*(_DWORD *)(v4 + 6) )
  {
    if ( !*(_DWORD *)(v3 + 12) )
      *(_DWORD *)(v3 + 12) = "invalid field descriptor";
    return 0;
  }
  if ( (*(_BYTE *)(v4 + 1) & 0x30) == 32 )
    result = j_pb_decode((int)&v9, (int)v6, v5);
  else
    result = j_pb_decode_noinit((int)&v9, v6, v5);
  v8 = v11;
  *(_DWORD *)(v3 + 4) = v10;
  *(_DWORD *)(v3 + 12) = v8;
  return result;
}

//----- (0000D954) --------------------------------------------------------
_DWORD *__fastcall pb_ostream_from_buffer(_DWORD *result, int a2, int a3)
{
  result[1] = a2;
  result[2] = a3;
  result[3] = 0;
  result[4] = 0;
  *result = sub_D96C;
  return result;
}

//----- (0000D96C) --------------------------------------------------------
signed int __fastcall sub_D96C(int a1, char *a2, int a3)
{
  int v3; // r3
  char *v4; // r0
  unsigned int v5; // r12
  bool v6; // cf
  bool v7; // zf
  char v8; // t1
  int v10; // r5
  int v11; // r3
  __int64 *v12; // r4
  char *v13; // r6
  __int64 v14; // d16
  __int64 v15; // d17
  __int64 v16; // d16
  char *v17; // r6

  v3 = a1;
  v4 = *(char **)(a1 + 4);
  v5 = (unsigned int)&v4[a3];
  *(_DWORD *)(v3 + 4) = &v4[a3];
  if ( !a3 )
    return 1;
  if ( v4 < a2 || a2 - v4 > a3 )
  {
    _aeabi_memmove(v4, a2);
    return 1;
  }
  v6 = &a2[a3] >= v4;
  v7 = &a2[a3] == v4;
  if ( &a2[a3] > v4 )
  {
    v6 = v5 >= (unsigned int)a2;
    v7 = v5 == (_DWORD)a2;
  }
  if ( !v7 && v6 )
  {
    do
    {
      v8 = *a2++;
      --a3;
      *v4++ = v8;
    }
    while ( a3 );
    return 1;
  }
  if ( a3 < 1 )
    return 1;
  if ( a3 >= 8 )
  {
    if ( a3 <= 15 )
    {
      v11 = 0;
    }
    else
    {
      v10 = 0;
      v11 = a3 - (a3 & 0xF);
      v12 = (__int64 *)a2;
      v13 = v4;
      do
      {
        v14 = *v12;
        v15 = v12[1];
        v12 += 2;
        v7 = v10 == v11 - 16;
        *(_QWORD *)v13 = v14;
        *((_QWORD *)v13 + 1) = v15;
        v13 += 16;
        v10 += 16;
      }
      while ( !v7 );
      if ( !(a3 & 0xF) )
        return 1;
      if ( (a3 & 0xFu) <= 7 )
        goto LABEL_24;
    }
    v16 = *(_QWORD *)&a2[v11];
    v17 = &v4[v11];
    v11 += 8;
    *(_QWORD *)v17 = v16;
    goto LABEL_25;
  }
  v11 = 0;
  do
  {
LABEL_24:
    v4[v11] = a2[v11];
    ++v11;
LABEL_25:
    ;
  }
  while ( v11 < a3 );
  return 1;
}
// 4128: using guessed type int __fastcall _aeabi_memmove(_DWORD, _DWORD);

//----- (0000DA0C) --------------------------------------------------------
signed int __fastcall pb_write(_DWORD *a1, int a2, int a3)
{
  _DWORD *v3; // r4
  int v4; // r5
  const char *v5; // r0

  v3 = a1;
  v4 = a3;
  if ( !*a1 )
    goto LABEL_13;
  if ( (unsigned int)(a1[3] + a3) > a1[2] )
  {
    if ( !a1[4] )
    {
      v5 = "stream full";
LABEL_9:
      v3[4] = v5;
      return 0;
    }
    return 0;
  }
  if ( ((int (__fastcall *)(_DWORD *, int, int))*a1)(a1, a2, a3) )
  {
LABEL_13:
    v3[3] += v4;
    return 1;
  }
  if ( !v3[4] )
  {
    v5 = "io error";
    goto LABEL_9;
  }
  return 0;
}

//----- (0000DA54) --------------------------------------------------------
signed int __fastcall pb_encode(__int64 *a1, unsigned __int8 *a2, int *a3)
{
  unsigned __int8 *v3; // r4
  __int64 *v4; // r5
  int *v5; // r6
  int v6; // r8
  unsigned __int8 v7; // r0
  int v8; // r2
  int i; // r7
  int (__fastcall *v10)(__int64 *, int); // r2
  int v11; // t1

  v3 = a2;
  v4 = a1;
  v5 = a3;
  if ( !*a2 )
    return 1;
  v6 = 0;
  while ( 1 )
  {
    v7 = v3[1];
    v8 = (int)v5 + v6;
    if ( (v7 & 0xC0) == 128 )
      v6 = 4;
    else
      v6 = v3[4];
    v5 = (int *)(v8 + v3[2]);
    if ( (v7 & 0xF0) == 32 )
      v6 = v3[5] * (signed __int16)v6;
    if ( (v7 & 0xF) == 8 )
    {
      for ( i = *v5; i; i = *(_DWORD *)(i + 8) )
      {
        v10 = *(int (__fastcall **)(__int64 *, int))(*(_DWORD *)i + 4);
        if ( v10 )
        {
          if ( !v10(v4, i) )
            return 0;
        }
        else if ( sub_DAE4(v4, *(unsigned __int8 **)(*(_DWORD *)i + 8), *(int (__fastcall **)(__int64 *))(i + 4)) != 1 )
        {
          return 0;
        }
      }
      goto LABEL_18;
    }
    if ( sub_DAE4(v4, v3, (int (__fastcall *)(__int64 *))(v8 + v3[2])) != 1 )
      return 0;
LABEL_18:
    v11 = v3[10];
    v3 += 10;
    if ( !v11 )
      return 1;
  }
}

//----- (0000DAE4) --------------------------------------------------------
signed int __fastcall sub_DAE4(__int64 *a1, unsigned __int8 *a2, int (__fastcall *a3)(__int64 *))
{
  unsigned int v3; // r4
  __int64 *v4; // r11
  unsigned __int8 *v5; // r6
  int (__fastcall *v6)(__int64 *); // r8
  unsigned __int8 v7; // r2
  int v8; // r0
  unsigned int v9; // r1
  char *v10; // r3
  char v11; // r5
  int (__fastcall *v12)(__int64 *, unsigned __int8 *, int (__fastcall *)(__int64 *)); // r9
  int v13; // r2
  const char *v14; // r0
  unsigned int v15; // r10
  signed int v16; // r7
  int v17; // r1
  int v18; // r0
  unsigned int v19; // r7
  unsigned __int8 v20; // r0
  int (__fastcall *v21)(__int64 *); // r7
  char v23; // [sp+7h] [bp-41h]
  __int64 v24; // [sp+8h] [bp-40h]
  __int64 v25; // [sp+10h] [bp-38h]
  int v26; // [sp+18h] [bp-30h]
  int v27; // [sp+20h] [bp-28h]

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a2[1];
  v8 = v7 & 0xC0;
  if ( v8 != 128 )
  {
    if ( v8 == 64 )
    {
      if ( *(_DWORD *)v6 && !(*(int (__fastcall **)(__int64 *))v6)(v4) )
      {
        if ( !*((_DWORD *)v4 + 4) )
        {
          v14 = "callback error";
          goto LABEL_33;
        }
LABEL_34:
        v16 = 0;
        goto LABEL_60;
      }
      goto LABEL_59;
    }
    if ( v7 & 0xC0 )
    {
      if ( !*((_DWORD *)v4 + 4) )
      {
        v14 = "invalid field type";
        goto LABEL_33;
      }
      goto LABEL_34;
    }
  }
  v23 = 1;
  v9 = v7 & 0xF;
  v3 = v5[3];
  v10 = &v23;
  if ( v5[3] )
    v10 = (char *)v6 + (char)v3;
  if ( v8 == 128 )
  {
    v6 = *(int (__fastcall **)(__int64 *))v6;
    v11 = (char)v6;
    if ( v6 )
      v11 = 1;
    v23 = v11;
  }
  v12 = (int (__fastcall *)(__int64 *, unsigned __int8 *, _DWORD *))*(&off_15B6C + v9);
  v13 = v7 & 0x30;
  if ( v13 != 32 )
  {
    if ( v13 != 16 )
    {
      if ( v13 )
      {
        if ( !*((_DWORD *)v4 + 4) )
        {
          v14 = "invalid field type";
          goto LABEL_33;
        }
        goto LABEL_34;
      }
      if ( !v6 )
      {
        if ( !*((_DWORD *)v4 + 4) )
        {
          v14 = "missing required field";
LABEL_33:
          *((_DWORD *)v4 + 4) = v14;
          goto LABEL_34;
        }
        goto LABEL_34;
      }
      goto LABEL_28;
    }
    if ( *v10 )
    {
LABEL_28:
      if ( j_pb_encode_tag_for_field(v4, v5) != 1 || !v12(v4, v5, v6) )
        goto LABEL_34;
    }
LABEL_59:
    v16 = 1;
    goto LABEL_60;
  }
  v15 = *(_DWORD *)v10;
  if ( !*(_DWORD *)v10 )
    goto LABEL_59;
  if ( v8 != 128 && v5[5] < v15 )
  {
    if ( !*((_DWORD *)v4 + 4) )
    {
      v14 = "array max size exceeded";
      goto LABEL_33;
    }
    goto LABEL_34;
  }
  if ( v9 >= 5 )
  {
    v19 = 0;
    while ( j_pb_encode_tag_for_field(v4, v5) == 1 )
    {
      v20 = v5[1];
      if ( (v20 & 0xC0) != 128 || (v20 & 0xFu) - 5 > 1 )
      {
        if ( v12(v4, v5, v6) != 1 )
          goto LABEL_34;
      }
      else if ( !v12(v4, v5, *(_DWORD **)v6) )
      {
        goto LABEL_34;
      }
      ++v19;
      v6 = (int (__fastcall *)(__int64 *))((char *)v6 + v5[4]);
      if ( v19 >= v15 )
        goto LABEL_59;
    }
    goto LABEL_34;
  }
  v16 = 0;
  if ( j_pb_encode_varint(v4, 2, 8 * (unsigned int)*v5 | 2LL) == 1 )
  {
    v18 = v5[1] & 0xF;
    if ( v18 == 4 )
    {
      v3 = 8 * v15;
    }
    else
    {
      if ( v18 != 3 )
      {
        v3 = 0;
        v21 = v6;
        v24 = 0LL;
        v25 = 0LL;
        v26 = 0;
        while ( v12(&v24, v5, v21) == 1 )
        {
          ++v3;
          v21 = (int (__fastcall *)(__int64 *))((char *)v21 + v5[4]);
          if ( v3 >= v15 )
          {
            v3 = HIDWORD(v25);
            goto LABEL_54;
          }
        }
        goto LABEL_34;
      }
      v3 = 4 * v15;
    }
LABEL_54:
    v16 = 0;
    if ( j_pb_encode_varint(v4, v17, v3) == 1 )
    {
      if ( !*(_DWORD *)v4 )
        goto LABEL_62;
      v3 = 0;
      while ( v12(v4, v5, v6) == 1 )
      {
        ++v3;
        v6 = (int (__fastcall *)(__int64 *))((char *)v6 + v5[4]);
        if ( v3 >= v15 )
          goto LABEL_59;
      }
      goto LABEL_34;
    }
  }
LABEL_60:
  while ( _stack_chk_guard != v27 )
  {
LABEL_62:
    v16 = 0;
    if ( j_pb_write(v4, 0, v3) )
      v16 = 1;
  }
  return v16;
}
// DAE4: too many cbuild loops
// 15B6C: using guessed type void *off_15B6C;

//----- (0000DD18) --------------------------------------------------------
signed int __fastcall pb_encode_submessage(_DWORD *a1, unsigned __int8 *a2, int *a3)
{
  int v3; // r8
  _DWORD *v4; // r4
  unsigned __int8 *v5; // r6
  int *v6; // r5
  int v7; // r1
  signed int v8; // r7
  const char *v9; // r0
  int v11; // r1
  __int64 v12; // kr00_8
  int v13; // r3
  __int64 v14; // [sp+0h] [bp-30h]
  __int64 v15; // [sp+8h] [bp-28h]
  const char *v16; // [sp+10h] [bp-20h]
  int v17; // [sp+14h] [bp-1Ch]

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v14 = 0LL;
  v15 = 0LL;
  v16 = 0;
  if ( !j_pb_encode(&v14, a2, a3) )
  {
    v9 = v16;
    goto LABEL_8;
  }
  v3 = HIDWORD(v15);
  v8 = 0;
  if ( j_pb_encode_varint(v4, v7, HIDWORD(v15)) != 1 )
    goto LABEL_10;
  if ( !*v4 )
    goto LABEL_12;
  if ( (unsigned int)(v4[3] + v3) > v4[2] )
  {
    if ( v4[4] )
    {
LABEL_9:
      v8 = 0;
      goto LABEL_10;
    }
    v9 = "stream full";
LABEL_8:
    v4[4] = v9;
    goto LABEL_9;
  }
  LODWORD(v14) = *v4;
  v11 = v4[1];
  *(__int64 *)((char *)&v15 + 4) = 0LL;
  HIDWORD(v14) = v11;
  LODWORD(v15) = v3;
  v8 = j_pb_encode(&v14, v5, v6);
  v12 = *(__int64 *)((char *)&v15 + 4);
  v13 = HIDWORD(v14);
  v4[3] += HIDWORD(v15);
  v4[1] = v13;
  v4[4] = HIDWORD(v12);
  if ( (_DWORD)v12 != v3 )
  {
    if ( HIDWORD(v12) )
      goto LABEL_9;
    v9 = "submsg size changed";
    goto LABEL_8;
  }
LABEL_10:
  while ( _stack_chk_guard != v17 )
LABEL_12:
    v8 = j_pb_write(v4, 0, v3);
  return v8;
}

//----- (0000DDEC) --------------------------------------------------------
int __fastcall pb_get_encoded_size(_DWORD *a1, unsigned __int8 *a2, int *a3)
{
  _DWORD *v3; // r5
  signed int v4; // r4
  int result; // r0
  __int64 v6; // [sp+0h] [bp-28h]
  __int64 v7; // [sp+8h] [bp-20h]
  int v8; // [sp+10h] [bp-18h]
  int v9; // [sp+14h] [bp-14h]

  v3 = a1;
  v4 = 0;
  v6 = 0LL;
  v7 = 0LL;
  v8 = 0;
  if ( j_pb_encode(&v6, a2, a3) == 1 )
  {
    *v3 = HIDWORD(v7);
    v4 = 1;
  }
  result = _stack_chk_guard - v9;
  if ( _stack_chk_guard == v9 )
    result = v4;
  return result;
}

//----- (0000DE3C) --------------------------------------------------------
signed int __fastcall pb_encode_varint(_DWORD *a1, int a2, __int64 a3)
{
  int v3; // r12
  _BYTE *v4; // r1
  char v5; // lr
  int v6; // r4
  __int64 *v7; // r1
  int v8; // r2
  __int64 v10; // [sp+0h] [bp-20h]
  _BYTE v11[3]; // [sp+9h] [bp-17h]

  v10 = a3;
  if ( a3 )
  {
    v3 = 0;
    v4 = v11;
    do
    {
      v5 = a3 | 0x80;
      LODWORD(a3) = a3 >> 7;
      (v4++)[1] = v5;
      ++v3;
      v6 = a3 | (HIDWORD(a3) >> 7);
      HIDWORD(a3) >>= 7;
    }
    while ( v6 );
    v10 = 0LL;
    *v4 = v5 & 0x7F;
    v7 = (__int64 *)&v11[1];
    v8 = v3;
  }
  else
  {
    v7 = &v10;
    v8 = 1;
  }
  return j_pb_write(a1, (int)v7, v8);
}

//----- (0000DEB4) --------------------------------------------------------
signed int __fastcall pb_encode_svarint(_DWORD *a1, int a2, int a3, int a4)
{
  unsigned __int8 v4; // cf
  __int64 v5; // r2
  int v6; // r1

  v4 = __CFADD__(a3, a3);
  LODWORD(v5) = 2 * a3 ^ (a4 >> 31);
  v6 = a4 + v4 + a4;
  HIDWORD(v5) = v6 ^ (a4 >> 31);
  return j_j_pb_encode_varint(a1, v6, v5);
}

//----- (0000DEC6) --------------------------------------------------------
signed int __fastcall pb_encode_fixed32(_DWORD *a1, int a2)
{
  return j_j_pb_write(a1, a2, 4);
}

//----- (0000DECC) --------------------------------------------------------
signed int __fastcall pb_encode_fixed64(_DWORD *a1, int a2)
{
  return j_j_pb_write(a1, a2, 8);
}

//----- (0000DED2) --------------------------------------------------------
signed int __fastcall pb_encode_tag(_DWORD *a1, int a2, unsigned int a3)
{
  __int64 v3; // r2

  HIDWORD(v3) = a3 >> 29;
  LODWORD(v3) = a2 | 8 * a3;
  return j_j_pb_encode_varint(a1, v3, v3);
}

//----- (0000DEE0) --------------------------------------------------------
signed int __fastcall pb_encode_tag_for_field(_DWORD *a1, unsigned __int8 *a2)
{
  unsigned int v2; // r2

  v2 = a2[1] & 0xF;
  if ( v2 < 8 )
    return j_pb_encode_varint(a1, *a2, dword_138D0[v2] | (unsigned __int64)(8 * (unsigned int)*a2));
  if ( !a1[4] )
    a1[4] = "invalid field type";
  return 0;
}

//----- (0000DF18) --------------------------------------------------------
signed int __fastcall pb_encode_string(_DWORD *a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r5
  _DWORD *v5; // r7
  signed int v6; // r6

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0;
  if ( j_pb_encode_varint(a1, a2, (unsigned int)a3) == 1 )
    v6 = j_pb_write(v5, v4, v3);
  return v6;
}

//----- (0000DF40) --------------------------------------------------------
signed int __fastcall sub_DF40(_DWORD *a1, int a2, _DWORD *a3)
{
  _DWORD *v3; // r3
  int v4; // r1
  __int64 v5; // r2
  signed int result; // r0

  v3 = a3;
  v4 = *(unsigned __int8 *)(a2 + 4) - 1;
  switch ( v4 )
  {
    case 0:
      LODWORD(v5) = *(char *)a3;
      goto LABEL_8;
    case 1:
      LODWORD(v5) = *(signed __int16 *)a3;
      goto LABEL_8;
    case 3:
      LODWORD(v5) = *a3;
LABEL_8:
      v5 = (signed int)v5;
      goto LABEL_10;
    case 7:
      LODWORD(v5) = *a3;
      HIDWORD(v5) = v3[1];
LABEL_10:
      result = j_pb_encode_varint(a1, v4, v5);
      break;
    default:
      if ( !a1[4] )
        a1[4] = "invalid data_size";
      result = 0;
      break;
  }
  return result;
}

//----- (0000DF88) --------------------------------------------------------
signed int __fastcall sub_DF88(_DWORD *a1, int a2, _DWORD *a3)
{
  int v3; // r1
  _DWORD *v4; // r3
  __int64 v5; // r2

  v3 = *(unsigned __int8 *)(a2 + 4);
  v4 = a3;
  if ( v3 == 8 )
  {
    LODWORD(v5) = *a3;
    HIDWORD(v5) = v4[1];
    return j_pb_encode_varint(a1, v3, v5);
  }
  if ( v3 == 4 )
  {
    v5 = (unsigned int)*a3;
    return j_pb_encode_varint(a1, v3, v5);
  }
  if ( !a1[4] )
    a1[4] = "invalid data_size";
  return 0;
}

//----- (0000DFB8) --------------------------------------------------------
signed int __fastcall sub_DFB8(_DWORD *a1, int a2, int *a3)
{
  int v3; // r1
  int v4; // r3
  int v5; // r1
  __int64 v6; // r2

  v3 = *(unsigned __int8 *)(a2 + 4);
  if ( v3 == 8 )
  {
    v4 = *a3;
    v5 = a3[1];
    goto LABEL_5;
  }
  if ( v3 == 4 )
  {
    v4 = *a3;
    v5 = *a3 >> 31;
LABEL_5:
    LODWORD(v6) = 2 * v4 ^ (v5 >> 31);
    HIDWORD(v6) = (v5 + __CFADD__(v4, v4) + v5) ^ (v5 >> 31);
    return j_pb_encode_varint(a1, v5, v6);
  }
  if ( !a1[4] )
    a1[4] = "invalid data_size";
  return 0;
}

//----- (0000DFF4) --------------------------------------------------------
signed int __fastcall sub_DFF4(_DWORD *a1, int a2, int a3)
{
  return j_j_pb_write(a1, a3, 4);
}

//----- (0000DFFC) --------------------------------------------------------
signed int __fastcall sub_DFFC(_DWORD *a1, int a2, int a3)
{
  return j_j_pb_write(a1, a3, 8);
}

//----- (0000E004) --------------------------------------------------------
int __fastcall sub_E004(_DWORD *a1, int a2, int *a3)
{
  _DWORD *v3; // r4
  int v4; // r5
  signed int v5; // r0
  int result; // r0
  int v7; // [sp+0h] [bp-20h]
  int v8; // [sp+4h] [bp-1Ch]
  int v9; // [sp+Ch] [bp-14h]

  v3 = a1;
  if ( !a3 )
  {
    v4 = 0;
    v7 = 0;
    v8 = 0;
    if ( j_pb_write(a1, (int)&v7, 1) != 1 )
      goto LABEL_11;
    v5 = j_pb_write(v3, 0, 0);
    goto LABEL_10;
  }
  if ( *(unsigned __int8 *)(a2 + 1) > 0x3Fu || *a3 + 4 <= (unsigned int)*(unsigned __int8 *)(a2 + 4) )
  {
    v5 = j_pb_encode_string(a1, (int)(a3 + 1), *a3);
LABEL_10:
    v4 = v5;
    goto LABEL_11;
  }
  if ( !a1[4] )
    a1[4] = "bytes size exceeded";
  v4 = 0;
LABEL_11:
  result = _stack_chk_guard - v9;
  if ( _stack_chk_guard == v9 )
    result = v4;
  return result;
}

//----- (0000E088) --------------------------------------------------------
signed int __fastcall sub_E088(_DWORD *a1, int a2, int a3)
{
  unsigned int v3; // lr
  unsigned int v4; // r12
  _BYTE *v5; // r1

  v3 = 0;
  v4 = *(unsigned __int8 *)(a2 + 4);
  if ( (*(_BYTE *)(a2 + 1) & 0xC0) == 128 )
    v4 = -1;
  if ( a3 && v4 )
  {
    v5 = (_BYTE *)a3;
    do
    {
      if ( !*v5 )
        break;
      ++v3;
      ++v5;
    }
    while ( v3 < v4 );
  }
  return j_j_pb_encode_string(a1, a3, v3);
}

//----- (0000E0C4) --------------------------------------------------------
signed int __fastcall sub_E0C4(_DWORD *a1, int a2, int *a3)
{
  unsigned __int8 *v3; // r1

  v3 = *(unsigned __int8 **)(a2 + 6);
  if ( v3 )
    return j_pb_encode_submessage(a1, v3, a3);
  if ( !a1[4] )
    a1[4] = "invalid field descriptor";
  return 0;
}

//----- (0000E0E4) --------------------------------------------------------
unsigned int *__fastcall sub_E0E4(unsigned int *result, signed int *a2, _DWORD *a3)
{
  unsigned int v3; // r3
  unsigned int v4; // t1
  int v5; // r12
  bool v6; // zf
  signed int v7; // r2

  v3 = *result;
  if ( (*result & 0x80000000) == 0 )
  {
    *a2 = 1;
    v4 = result[1];
    ++result;
    *a3 = 4 * (v4 >> 24) + 4;
    return result;
  }
  v5 = (v3 >> 24) & 0xF;
  v6 = v5 == 3;
  if ( v5 != 3 )
    v6 = v5 == 1;
  if ( v6 )
  {
    *a3 = 4 * ((v3 >> 16) & 0xFF) + 4;
    v7 = 2;
  }
  else
  {
    if ( v5 )
      return 0;
    *a3 = 4;
    v7 = 1;
  }
  *a2 = v7;
  return result;
}

//----- (0000E134) --------------------------------------------------------
signed int __fastcall sub_E134(int a1, int a2, unsigned int a3, unsigned int a4)
{
  int v4; // r4
  unsigned int v5; // r11
  unsigned int v6; // r7
  int v7; // r5
  signed int v8; // r6
  unsigned int v9; // r9
  int v10; // r10
  int v11; // r0
  int v12; // r2
  int v13; // r2
  signed int result; // r0
  int v15; // r3
  int v16; // r2
  int v17; // r0
  int v18; // r1
  int v19; // r2
  int v20; // r0
  int v21; // r1
  int v22; // r3
  signed int v23; // r9
  int v24; // r6
  char v25; // r0
  int v26; // r1
  int v28; // r0
  unsigned int v34; // r2
  unsigned int v35; // r0
  unsigned int v36; // r0
  int v37; // [sp+4h] [bp-2Ch]

  v4 = a1;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  if ( a3 >= a4 )
  {
LABEL_59:
    sub_EA30(v4, 14, &v37);
    sub_EA5E(v4, 15, v37);
    return 8;
  }
  v8 = 0;
  do
  {
    v9 = v6 + 1;
    v10 = *(unsigned __int8 *)(v7 + (v6 ^ 3));
    if ( (v10 & 0x80u) == 0 )
    {
      sub_EA30(v4, 13, &v37);
      v11 = 4 * v10 + 4;
      if ( v10 & 0x40 )
        v11 = -4 - (unsigned __int8)(4 * v10);
      v12 = v37 + v11;
      v37 += v11;
LABEL_7:
      sub_EA5E(v4, 13, v12);
LABEL_34:
      ++v6;
      continue;
    }
    v13 = v10 & 0xF0;
    result = 9;
    if ( v13 > 175 )
    {
      if ( v13 != 176 )
      {
        if ( v13 == 192 )
        {
          switch ( v10 )
          {
            case 192:
            case 193:
            case 194:
            case 195:
            case 196:
            case 197:
              v18 = 3;
              v16 = ((v10 & 7) + 1) | 0xA0000;
              v17 = v4;
              goto LABEL_32;
            case 198:
              v36 = *(unsigned __int8 *)(v7 + (v9 ^ 3));
              if ( (v36 & 0xF) + (v36 >> 4) > 0xF )
                return 9;
              v19 = ((v36 & 0xF) + 1) | (v36 >> 4 << 16);
              v20 = v4;
              v21 = 3;
              goto LABEL_52;
            case 199:
              if ( !*(_BYTE *)(v7 + (v9 ^ 3)) || *(unsigned __int8 *)(v7 + (v9 ^ 3)) >= 0x10u )
                return 9;
              goto LABEL_54;
            case 200:
            case 201:
              v34 = *(unsigned __int8 *)(v7 + (v9 ^ 3));
              v35 = v34 >> 4;
              if ( (unsigned __int8)v10 == 200 )
                v35 = (v34 >> 4) | 0x10;
              if ( v35 + (v34 & 0xF) > 0x1F )
                return 9;
              v19 = ((v34 & 0xF) + 1) | (v35 << 16);
              v20 = v4;
              v21 = 1;
LABEL_52:
              v22 = 5;
              goto LABEL_53;
            default:
              return 9;
          }
          return 9;
        }
        if ( v13 != 208 )
          return result;
        if ( v10 & 8 )
          return 9;
        v18 = 1;
        v16 = ((v10 & 7) + 1) | 0x80000;
        v17 = v4;
LABEL_32:
        v15 = 5;
        goto LABEL_33;
      }
      result = 9;
      switch ( v10 )
      {
        case 176:
          goto LABEL_58;
        case 177:
          if ( v9 >= v5 )
            return 9;
          v19 = *(unsigned __int8 *)(v7 + (v9 ^ 3));
          result = 9;
          if ( !*(_BYTE *)(v7 + (v9 ^ 3)) || v19 & 0xF0 )
            return result;
          v20 = v4;
          v21 = 0;
          v22 = 0;
          goto LABEL_53;
        case 178:
          if ( v9 >= v5 )
            return 9;
          v23 = v8;
          v6 += 2;
          v24 = 0;
          v25 = 0;
          break;
        case 179:
          v22 = 1;
          v28 = *(unsigned __int8 *)(v7 + (v9 ^ 3));
          _R1 = v28 << 12;
          __asm { UXTB16.W        R1, R1 }
          v19 = ((v28 & 0xF) + 1) | _R1;
          v20 = v4;
          v21 = 1;
LABEL_53:
          sub_E524(v20, v21, v19, v22);
LABEL_54:
          v6 += 2;
          continue;
        case 180:
        case 181:
        case 182:
        case 183:
          return result;
        default:
          v18 = 1;
          v15 = 1;
          v16 = ((v10 & 7) + 1) | 0x80000;
          v17 = v4;
          goto LABEL_33;
      }
      while ( 1 )
      {
        v26 = *(char *)(v7 + ((v6 - 1) ^ 3));
        v24 |= (v26 & 0x7F) << v25;
        if ( v26 >= 0 )
          break;
        v25 += 7;
        _CF = v6++ >= v5;
        if ( _CF )
          return 9;
      }
      sub_EA30(v4, 13, &v37);
      v37 += 4 * v24 + 516;
      sub_EA5E(v4, 13, v37);
      v8 = v23;
    }
    else
    {
      if ( v13 != 128 )
      {
        if ( v13 == 144 )
        {
          if ( (v10 & 0xF | 2) == 15 )
            return 9;
          sub_EA30(v4, v10 & 0xF, &v37);
          v12 = v37;
          goto LABEL_7;
        }
        if ( v13 != 160 )
          return result;
        v15 = 0;
        v16 = ((16 << ((*(_BYTE *)(v7 + (v6 ^ 3)) & 7) + 1)) - 16) | (*(unsigned __int8 *)(v7 + (v6 ^ 3)) << 11) & 0x4000;
        v17 = v4;
        v18 = 0;
LABEL_33:
        sub_E524(v17, v18, v16, v15);
        goto LABEL_34;
      }
      if ( v9 >= v5 || !((unsigned __int16)((_WORD)v10 << 12) | 16 * *(unsigned __int8 *)(v7 + ((v6 + 1) ^ 3))) )
        return 9;
      sub_E524(v4, 0, (unsigned __int16)((_WORD)v10 << 12) | 16 * *(unsigned __int8 *)(v7 + (v9 ^ 3)), 0);
      if ( (((_WORD)v10 << 12) & 0x8000u) != 0 )
        v8 = 1;
      v6 += 2;
    }
  }
  while ( v6 < v5 );
LABEL_58:
  if ( !(v8 & 1) )
    goto LABEL_59;
  return 8;
}

//----- (0000E488) --------------------------------------------------------
signed int __fastcall sub_E488(int a1, int a2, unsigned int a3, int a4, int *a5)
{
  int v5; // r5
  int v6; // r4
  signed int result; // r0
  int v8; // r2
  int v9; // r0
  int v10; // r1
  int v11; // r2
  int v12; // r1
  int v13; // r3

  v5 = a3;
  v6 = a1;
  switch ( a2 )
  {
    case 0:
      result = 2;
      if ( a3 > 0xF || a4 )
        return result;
      v8 = *a5;
      v9 = v6;
      v10 = v5;
      goto LABEL_11;
    case 1:
      if ( a4 == 5 )
      {
        if ( a3 <= 0x1F )
          goto LABEL_19;
        return 2;
      }
      if ( a4 != 1 || a3 > 0xF )
        return 2;
      sub_EB40(a1);
LABEL_19:
      v11 = *a5;
      v12 = v5 + 256;
      v13 = a5[1];
LABEL_20:
      result = sub_EAD2(v6, v12, v11, v13);
LABEL_21:
      if ( result )
        result = 2;
      return result;
    case 3:
      result = 2;
      if ( a3 > 0x1F || a4 != 5 )
        return result;
      v11 = *a5;
      v12 = v5 + 112;
      v13 = a5[1];
      goto LABEL_20;
    case 4:
      result = 2;
      if ( a3 > 3 || a4 )
        return result;
      v8 = *a5;
      v10 = v5 + 192;
      v9 = v6;
LABEL_11:
      result = sub_EA5E(v9, v10, v8);
      goto LABEL_21;
    default:
      sub_E894(
        (int)"_Unwind_VRS_Result _Unwind_VRS_Set(_Unwind_Context *, _Unwind_VRS_RegClass, uint32_t, _Unwind_VRS_DataRepre"
             "sentation, void *)",
        837,
        (int)"unsupported register class");
      return result;
  }
}

//----- (0000E524) --------------------------------------------------------
signed int __fastcall sub_E524(int a1, int a2, unsigned int a3, int a4)
{
  int v4; // r8
  int v5; // r5
  int v6; // r7
  unsigned int v7; // r6
  signed int v8; // r4
  unsigned int v9; // r7
  int *v10; // r0
  signed int v11; // r0
  int v12; // r2
  unsigned int v13; // r4
  unsigned int v14; // r6
  int *v15; // r0
  int v16; // r2
  int v17; // r0
  signed int result; // r0
  int *v19; // [sp+8h] [bp-30h]
  int v20; // [sp+Ch] [bp-2Ch]
  int *v21; // [sp+10h] [bp-28h]
  int v22; // [sp+14h] [bp-24h]

  v4 = a1;
  v5 = a2;
  v6 = a4;
  v7 = a3;
  switch ( a2 )
  {
    case 0:
    case 4:
      if ( a4 || sub_EA30(a1, 13, &v19) )
        goto LABEL_22;
      v8 = 0;
      v9 = 0;
      do
      {
        if ( (1 << v9) & v7 )
        {
          v10 = v19;
          ++v19;
          v21 = (int *)*v10;
          if ( sub_E488(v4, v5, v9, 0, (int *)&v21) )
            goto LABEL_22;
          v11 = v8;
          if ( v9 == 13 )
            v11 = 1;
          if ( !v5 )
            v8 = v11;
        }
        ++v9;
      }
      while ( v9 < 0x10 );
      if ( v8 & 1 )
      {
        result = 0;
        goto LABEL_23;
      }
      v12 = (int)v19;
      break;
    case 1:
    case 3:
      if ( (a4 | 4) != 5 || sub_EA30(a1, 13, &v21) )
        goto LABEL_22;
      if ( !(_WORD)v7 )
        goto LABEL_20;
      v13 = v7 >> 16;
      v14 = (v7 >> 16) + (unsigned __int16)v7;
      do
      {
        v15 = v21;
        ++v21;
        v16 = *v15;
        v21 = v15 + 2;
        v17 = v15[1];
        v19 = (int *)v16;
        v20 = v17;
        if ( sub_E488(v4, v5, v13, v6, (int *)&v19) )
        {
LABEL_22:
          result = 2;
          goto LABEL_23;
        }
        ++v13;
      }
      while ( v13 < v14 );
LABEL_20:
      if ( v6 != 1 )
        goto LABEL_24;
      v12 = (int)(v21 + 1);
      ++v21;
      break;
    default:
      sub_E894(
        (int)"_Unwind_VRS_Result _Unwind_VRS_Pop(_Unwind_Context *, _Unwind_VRS_RegClass, uint32_t, _Unwind_VRS_DataRepresentation)",
        971,
        (int)"unsupported register class");
      return result;
  }
  while ( 1 )
  {
    result = sub_EA5E(v4, 13, v12);
    if ( result )
      result = 2;
LABEL_23:
    if ( _stack_chk_guard == v22 )
      break;
LABEL_24:
    v12 = (int)v21;
  }
  return result;
}

//----- (0000E658) --------------------------------------------------------
signed int __fastcall sub_E658(int a1, int a2, int a3)
{
  return sub_E660(a2, a3);
}

//----- (0000E660) --------------------------------------------------------
signed int __fastcall sub_E660(int a1, int a2)
{
  int v2; // r5
  int v3; // r4
  signed int result; // r0
  int v5; // r1
  char v6; // [sp+4h] [bp-3Ch]
  _DWORD *v7; // [sp+Ch] [bp-34h]

  v2 = a1;
  v3 = a2;
  sub_EB10(a2, (int)&v6);
  if ( !(*(_BYTE *)(v2 + 80) & 1) && *v7 )
    return 9;
  v5 = sub_EB0A(v3);
  result = 8;
  if ( v5 != 1 )
    result = 9;
  return result;
}

//----- (0000E6BC) --------------------------------------------------------
signed int __fastcall sub_E6BC(int a1, int a2, int a3)
{
  return sub_E660(a2, a3);
}

//----- (0000E6C4) --------------------------------------------------------
signed int __fastcall sub_E6C4(int a1, int a2, int a3)
{
  return sub_E660(a2, a3);
}

//----- (0000E778) --------------------------------------------------------
int __fastcall sub_E778(int a1, int *a2, char a3)
{
  int *v3; // r4
  char v4; // r10
  int i; // r7
  int v6; // r6
  int (__fastcall *v7)(int, int *, char *); // r3
  int v8; // r1
  int v9; // r0
  int v11; // [sp+0h] [bp-4B8h]
  int v12; // [sp+4h] [bp-4B4h]
  int (__fastcall *v13)(int, int *, char *); // [sp+10h] [bp-4A8h]
  int v14; // [sp+18h] [bp-4A0h]
  int v15; // [sp+24h] [bp-494h]
  int v16; // [sp+2Ch] [bp-48Ch]
  char v17; // [sp+30h] [bp-488h]
  int v18; // [sp+494h] [bp-24h]

  v3 = a2;
  v4 = a3;
  sub_E9E8((int)&v17, a1);
  for ( i = 0; ; ++i )
  {
    v6 = v4 & 1;
    if ( i == 1 && v4 & 1 )
    {
      sub_EA5E((int)&v17, -1, v3[4]);
      v4 = 0;
    }
    sub_EA30((int)&v17, -2, &v16);
    if ( sub_EB10((int)&v17, (int)&v12) )
      break;
    v7 = v13;
    if ( v13 )
    {
      v8 = v15;
      v3[18] = v12;
      v3[19] = v8;
      v3[20] = v14;
      v9 = v7(v6 + 1, v3, &v17);
      if ( v9 == 7 )
      {
        sub_EA30((int)&v17, -1, &v11);
        v3[4] = v11;
        sub_EB2E((int)&v17);
        return _stack_chk_guard - v18;
      }
      if ( v9 != 8 )
      {
        if ( v9 == 9 )
          abort();
        return _stack_chk_guard - v18;
      }
      if ( v16 == v3[8] )
        sub_E894(
          (int)"_Unwind_Reason_Code unwind_phase2(unw_context_t *, _Unwind_Exception *, bool)",
          653,
          (int)"during phase1 personality function said it would stop here, but now in phase2 it did not stop here");
    }
  }
  return _stack_chk_guard - v18;
}

//----- (0000E894) --------------------------------------------------------
void __fastcall __noreturn sub_E894(int a1, int a2, int a3)
{
  fprintf((FILE *)stderr, "libunwind: %s %s:%d - %s\n", a1, "external/libunwind_llvm/src/Unwind-EHABI.cpp", a2, a3);
  abort();
}

//----- (0000E960) --------------------------------------------------------
int __fastcall sub_E960(_DWORD *a1, int a2, int a3, int a4, int a5)
{
  int v5; // r4
  int v6; // r5
  int v7; // r6
  int v8; // r7
  int v9; // r8
  int v10; // r9
  int v11; // r10
  int v12; // r11
  int v13; // r12
  int v14; // lr

  *a1 = a1;
  a1[1] = a2;
  a1[2] = a3;
  a1[3] = a4;
  a1[4] = v5;
  a1[5] = v6;
  a1[6] = v7;
  a1[7] = v8;
  a1[8] = v9;
  a1[9] = v10;
  a1[10] = v11;
  a1[11] = v12;
  a1[12] = v13;
  a1[13] = &a5;
  a1[14] = v14;
  a1[15] = v14;
  return 0;
}

//----- (0000E978) --------------------------------------------------------
_QWORD *__fastcall sub_E978(_QWORD *result)
{
  __int64 v1; // d0
  __int64 v2; // d1
  __int64 v3; // d2
  __int64 v4; // d3
  __int64 v5; // d4
  __int64 v6; // d5
  __int64 v7; // d6
  __int64 v8; // d7
  __int64 v9; // d8
  __int64 v10; // d9
  __int64 v11; // d10
  __int64 v12; // d11
  __int64 v13; // d12
  __int64 v14; // d13
  __int64 v15; // d14
  __int64 v16; // d15

  *result = v1;
  result[1] = v2;
  result[2] = v3;
  result[3] = v4;
  result[4] = v5;
  result[5] = v6;
  result[6] = v7;
  result[7] = v8;
  result[8] = v9;
  result[9] = v10;
  result[10] = v11;
  result[11] = v12;
  result[12] = v13;
  result[13] = v14;
  result[14] = v15;
  result[15] = v16;
  return result;
}

//----- (0000E980) --------------------------------------------------------
_QWORD *__fastcall sub_E980(_QWORD *result)
{
  __int64 v1; // d0
  __int64 v2; // d1
  __int64 v3; // d2
  __int64 v4; // d3
  __int64 v5; // d4
  __int64 v6; // d5
  __int64 v7; // d6
  __int64 v8; // d7
  __int64 v9; // d8
  __int64 v10; // d9
  __int64 v11; // d10
  __int64 v12; // d11
  __int64 v13; // d12
  __int64 v14; // d13
  __int64 v15; // d14
  __int64 v16; // d15

  *result = v1;
  result[1] = v2;
  result[2] = v3;
  result[3] = v4;
  result[4] = v5;
  result[5] = v6;
  result[6] = v7;
  result[7] = v8;
  result[8] = v9;
  result[9] = v10;
  result[10] = v11;
  result[11] = v12;
  result[12] = v13;
  result[13] = v14;
  result[14] = v15;
  result[15] = v16;
  return result;
}

//----- (0000E988) --------------------------------------------------------
_QWORD *__fastcall sub_E988(_QWORD *result)
{
  __int64 v1; // d16
  __int64 v2; // d17
  __int64 v3; // d18
  __int64 v4; // d19
  __int64 v5; // d20
  __int64 v6; // d21
  __int64 v7; // d22
  __int64 v8; // d23
  __int64 v9; // d24
  __int64 v10; // d25
  __int64 v11; // d26
  __int64 v12; // d27
  __int64 v13; // d28
  __int64 v14; // d29
  __int64 v15; // d30
  __int64 v16; // d31

  *result = v1;
  result[1] = v2;
  result[2] = v3;
  result[3] = v4;
  result[4] = v5;
  result[5] = v6;
  result[6] = v7;
  result[7] = v8;
  result[8] = v9;
  result[9] = v10;
  result[10] = v11;
  result[11] = v12;
  result[12] = v13;
  result[13] = v14;
  result[14] = v15;
  result[15] = v16;
  return result;
}

//----- (0000E990) --------------------------------------------------------
void sub_E990()
{
  __asm
  {
    STCL            p1, c0, [R0],#8
    STCL            p1, c1, [R0],#8
    STCL            p1, c2, [R0],#8
    STCL            p1, c3, [R0],#8
    STCL            p1, c4, [R0],#8
    STCL            p1, c5, [R0],#8
    STCL            p1, c6, [R0],#8
    STCL            p1, c7, [R0],#8
    STCL            p1, c8, [R0],#8
    STCL            p1, c9, [R0],#8
    STCL            p1, c10, [R0],#8
    STCL            p1, c11, [R0],#8
    STCL            p1, c12, [R0],#8
    STCL            p1, c13, [R0],#8
    STCL            p1, c14, [R0],#8
    STCL            p1, c15, [R0],#8
  }
}

//----- (0000E9D4) --------------------------------------------------------
void sub_E9D4()
{
  __asm
  {
    STC2            p1, c8, [R0],#4
    STC2            p1, c9, [R0],#4
    STC2            p1, c10, [R0],#4
    STC2            p1, c11, [R0],#4
  }
}

//----- (0000E9E8) --------------------------------------------------------
int __fastcall sub_E9E8(int a1, int a2)
{
  int v2; // r4

  v2 = a1;
  *(_BYTE *)(a1 + 76) = 0;
  *(_DWORD *)(a1 + 72) = 0;
  *(_DWORD *)(a1 + 4) = &unk_168E0;
  *(_DWORD *)a1 = &off_15B98;
  _aeabi_memcpy(a1 + 8, a2, 64);
  _aeabi_memclr8(v2 + 80, 450);
  sub_EEFC(v2, 0);
  return 0;
}
// 3D5C: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);
// 3EA0: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 15B98: using guessed type void *;

//----- (0000EA30) --------------------------------------------------------
signed int __fastcall sub_EA30(int a1, int a2, _DWORD *a3)
{
  int v3; // r6
  _DWORD *v4; // r4
  int v5; // r5

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 8))(a1) != 1 )
    return -6542;
  *v4 = (*(int (__fastcall **)(int, int))(*(_DWORD *)v3 + 12))(v3, v5);
  return 0;
}

//----- (0000EA5E) --------------------------------------------------------
signed int __fastcall sub_EA5E(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r6
  int v5; // r5
  int v6; // r5

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 8))(a1) != 1 )
    return -6542;
  (*(void (__fastcall **)(int, int, int))(*(_DWORD *)v3 + 16))(v3, v5, v4);
  if ( v5 != -1 )
    return 0;
  v6 = 0;
  (*(void (__fastcall **)(int, _DWORD))(*(_DWORD *)v3 + 52))(v3, 0);
  return v6;
}

//----- (0000EAA2) --------------------------------------------------------
signed int __fastcall sub_EAA2(int a1, int a2, int *a3)
{
  int v3; // r6
  int *v4; // r4
  int v5; // r5
  int v6; // r0
  int v7; // r1

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 20))(a1) != 1 )
    return -6542;
  v6 = (*(int (__fastcall **)(int, int))(*(_DWORD *)v3 + 24))(v3, v5);
  v4[1] = v7;
  *v4 = v6;
  return 0;
}

//----- (0000EAD2) --------------------------------------------------------
signed int __fastcall sub_EAD2(int a1, int a2, int a3, int a4)
{
  int v4; // r7
  int v5; // r5
  int v6; // r8
  int v7; // r6

  v4 = a1;
  v5 = a3;
  v6 = a4;
  v7 = a2;
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 20))(a1) != 1 )
    return -6542;
  (*(void (__fastcall **)(int, int, int, int))(*(_DWORD *)v4 + 28))(v4, v7, v5, v6);
  return 0;
}

//----- (0000EB0A) --------------------------------------------------------
int __fastcall sub_EB0A(int a1)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 32))();
}

//----- (0000EB10) --------------------------------------------------------
signed int __fastcall sub_EB10(int a1, int a2)
{
  int v2; // r4
  signed int result; // r0

  v2 = a2;
  (*(void (**)(void))(*(_DWORD *)a1 + 36))();
  result = 0;
  if ( !*(_DWORD *)(v2 + 4) )
    result = -6549;
  return result;
}

//----- (0000EB2E) --------------------------------------------------------
signed int __fastcall sub_EB2E(int a1)
{
  (*(void (**)(void))(*(_DWORD *)a1 + 40))();
  return -6540;
}

//----- (0000EB40) --------------------------------------------------------
int __fastcall sub_EB40(int a1)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 60))();
}

//----- (0000EB46) --------------------------------------------------------
signed int __fastcall sub_EB46(int a1, int a2)
{
  signed int result; // r0

  result = 1;
  if ( (unsigned int)(a2 - 16) <= 0xFFFFFFED && (a2 & 0xFFFFFFFC) != 192 )
    result = 0;
  return result;
}

//----- (0000EB60) --------------------------------------------------------
int __fastcall sub_EB60(int a1, signed int a2)
{
  signed int v2; // r5
  int v3; // r4
  int v4; // r0

  v2 = a2;
  v3 = a1;
  if ( a2 > 12 )
  {
    if ( a2 != 15 )
    {
      if ( a2 == 14 )
      {
        v4 = a1 + 64;
        return *(_DWORD *)v4;
      }
      if ( a2 != 13 )
        goto LABEL_11;
LABEL_9:
      v4 = a1 + 60;
      return *(_DWORD *)v4;
    }
    goto LABEL_8;
  }
  if ( a2 == -2 )
    goto LABEL_9;
  if ( a2 == -1 )
  {
LABEL_8:
    v4 = a1 + 68;
    return *(_DWORD *)v4;
  }
LABEL_11:
  if ( (unsigned int)a2 > 0xC )
  {
    if ( (a2 & 0xFFFFFFFC) != 192 )
      sub_EF7C(
        (int)"uint32_t libunwind::Registers_arm::getRegister(int)",
        (int)"external/libunwind_llvm/src/Registers.hpp",
        1452,
        (int)"unsupported arm register");
    if ( !*(_BYTE *)(a1 + 76) )
    {
      *(_BYTE *)(a1 + 76) = 1;
      sub_E9D4();
    }
    v4 = v3 + 4 * v2 - 296;
  }
  else
  {
    v4 = a1 + 4 * a2 + 8;
  }
  return *(_DWORD *)v4;
}

//----- (0000EBEC) --------------------------------------------------------
int __fastcall sub_EBEC(int result, signed int a2, int a3)
{
  signed int v3; // r6
  int v4; // r4
  int v5; // r5

  v3 = a2;
  v4 = a3;
  v5 = result;
  if ( a2 > 12 )
  {
    if ( a2 != 15 )
    {
      if ( a2 == 14 )
      {
        *(_DWORD *)(result + 64) = a3;
        return result;
      }
      if ( a2 != 13 )
        goto LABEL_11;
LABEL_10:
      *(_DWORD *)(result + 60) = a3;
      return result;
    }
    goto LABEL_9;
  }
  if ( a2 == -2 )
    goto LABEL_10;
  if ( a2 == -1 )
  {
LABEL_9:
    *(_DWORD *)(result + 68) = a3;
    return result;
  }
LABEL_11:
  if ( (unsigned int)a2 > 0xC )
  {
    if ( (a2 & 0xFFFFFFFC) != 192 )
      sub_EF7C(
        (int)"void libunwind::Registers_arm::setRegister(int, uint32_t)",
        (int)"external/libunwind_llvm/src/Registers.hpp",
        1471,
        (int)"unsupported arm register");
    if ( !*(_BYTE *)(result + 76) )
    {
      *(_BYTE *)(result + 76) = 1;
      sub_E9D4();
    }
    result = v5 + 4 * v3;
    *(_DWORD *)(result - 296) = v4;
  }
  else
  {
    result += 4 * a2;
    *(_DWORD *)(result + 8) = a3;
  }
  return result;
}

//----- (0000EC78) --------------------------------------------------------
int __fastcall sub_EC78(int a1, int a2)
{
  signed int v2; // r2
  bool v3; // zf
  signed int v4; // r0
  unsigned int v5; // r1

  v2 = 0;
  v3 = (a2 & 0xFFFFFFF0) == 112;
  v4 = 0;
  v5 = a2 & 0xFFFFFFE0;
  if ( v3 )
    v4 = 1;
  if ( v5 == 256 )
    v2 = 1;
  return v4 | v2;
}

//----- (0000EC98) --------------------------------------------------------
__int64 __fastcall sub_EC98(int a1, int a2)
{
  int v2; // r4
  int v3; // r5
  unsigned int v4; // r0
  _QWORD *v5; // r0
  int v6; // r1

  v2 = a2;
  v3 = a1;
  v4 = a2 & 0xFFFFFFF0;
  if ( (a2 & 0xFFFFFFF0) == 112 )
  {
    if ( !*(_BYTE *)(v3 + 75) )
    {
      *(_BYTE *)(v3 + 75) = 1;
      sub_E990();
    }
    v6 = v3 + 8 * v2 - 552;
  }
  else if ( v4 == 272 )
  {
    if ( !*(_BYTE *)(v3 + 74) )
    {
      *(_BYTE *)(v3 + 74) = 1;
      sub_E988((_QWORD *)(v3 + 216));
    }
    v6 = v3 + 8 * v2 - 1960;
  }
  else
  {
    if ( v4 != 256 )
      sub_EF7C(
        (int)"unw_fpreg_t libunwind::Registers_arm::getFloatRegister(int)",
        (int)"external/libunwind_llvm/src/Registers.hpp",
        1673,
        (int)"Unknown ARM float register");
    if ( !*(_BYTE *)(v3 + 73) )
    {
      *(_BYTE *)(v3 + 73) = 1;
      v5 = (_QWORD *)(v3 + 80);
      if ( *(_BYTE *)(v3 + 72) )
        sub_E980(v5);
      else
        sub_E978(v5);
    }
    v6 = v3 + 8 * v2 - 1968;
  }
  return *(_QWORD *)v6;
}

//----- (0000ED3C) --------------------------------------------------------
int __fastcall sub_ED3C(int a1, int a2, int a3, int a4)
{
  int v4; // r6
  int v5; // r7
  unsigned int v6; // r0
  int v7; // r5
  int v8; // r4
  _QWORD *v9; // r0
  int result; // r0
  int v11; // r1

  v4 = a2;
  v5 = a1;
  v6 = a2 & 0xFFFFFFF0;
  v7 = a4;
  v8 = a3;
  if ( (a2 & 0xFFFFFFF0) == 112 )
  {
    if ( !*(_BYTE *)(v5 + 75) )
    {
      *(_BYTE *)(v5 + 75) = 1;
      sub_E990();
    }
    result = v5 + 8 * v4;
    *(_DWORD *)(result - 548) = v7;
    LOWORD(v11) = -552;
  }
  else if ( v6 == 272 )
  {
    if ( !*(_BYTE *)(v5 + 74) )
    {
      *(_BYTE *)(v5 + 74) = 1;
      sub_E988((_QWORD *)(v5 + 216));
    }
    result = v5 + 8 * v4;
    *(_DWORD *)(result - 1956) = v7;
    LOWORD(v11) = -1960;
  }
  else
  {
    if ( v6 != 256 )
      sub_EF7C(
        (int)"void libunwind::Registers_arm::setFloatRegister(int, unw_fpreg_t)",
        (int)"external/libunwind_llvm/src/Registers.hpp",
        1700,
        (int)"Unknown ARM float register");
    if ( !*(_BYTE *)(v5 + 73) )
    {
      *(_BYTE *)(v5 + 73) = 1;
      v9 = (_QWORD *)(v5 + 80);
      if ( *(_BYTE *)(v5 + 72) )
        sub_E980(v9);
      else
        sub_E978(v9);
    }
    result = v5 + 8 * v4;
    *(_DWORD *)(result - 1964) = v7;
    LOWORD(v11) = -1968;
  }
  HIWORD(v11) = -1;
  *(_DWORD *)(result + v11) = v8;
  return result;
}

//----- (0000EE08) --------------------------------------------------------
int __fastcall sub_EE08(int a1)
{
  _DWORD *v1; // r4
  int result; // r0
  void (__fastcall *v3)(_DWORD *, signed int, int); // r5
  int v4; // r0

  v1 = (_DWORD *)a1;
  if ( *(_BYTE *)(a1 + 528) )
    return 0;
  result = sub_EFA8(a1);
  if ( result != 1 )
    return result;
  (*(void (__fastcall **)(_DWORD *, signed int))(*v1 + 52))(v1, 1);
  if ( *((_BYTE *)v1 + 528) )
    return 0;
  if ( v1[126] )
  {
    v3 = *(void (__fastcall **)(_DWORD *, signed int, int))(*v1 + 16);
    v4 = (*(int (__fastcall **)(_DWORD *, signed int))(*v1 + 12))(v1, -2);
    v3(v1, -2, v1[126] + v4);
  }
  return 1;
}

//----- (0000EE58) --------------------------------------------------------
_DWORD *__fastcall sub_EE58(int a1, _DWORD *a2)
{
  int *v2; // r0
  _DWORD *result; // r0
  int v4; // r2
  int v5; // r3
  int v6; // r4
  int v7; // r12
  int v8; // lr
  _DWORD *v9; // r1
  int v10; // r3
  int v11; // r4
  int v12; // r12
  int v13; // lr

  v2 = (int *)(a1 + 488);
  v4 = *v2;
  v5 = v2[1];
  v6 = v2[2];
  v7 = v2[3];
  v8 = v2[4];
  result = v2 + 5;
  *a2 = v4;
  a2[1] = v5;
  a2[2] = v6;
  a2[3] = v7;
  a2[4] = v8;
  v9 = a2 + 5;
  v10 = result[1];
  v11 = result[2];
  v12 = result[3];
  v13 = result[4];
  *v9 = *result;
  v9[1] = v10;
  v9[2] = v11;
  v9[3] = v12;
  v9[4] = v13;
  return result;
}

//----- (0000EE70) --------------------------------------------------------
void __fastcall sub_EE70(int a1)
{
  sub_EFFC(a1 + 8);
  sub_F914();
}

//----- (0000EE86) --------------------------------------------------------
int __fastcall sub_EE86(int a1)
{
  return *(unsigned __int8 *)(a1 + 529);
}

//----- (0000EE8C) --------------------------------------------------------
signed int __fastcall sub_EE8C(int a1, int a2, int a3, _DWORD *a4)
{
  int v4; // r6
  int v5; // r5
  _DWORD *v6; // r4
  int v7; // r7
  int v9; // [sp+10h] [bp-20h]
  int v10; // [sp+14h] [bp-1Ch]

  v4 = a2;
  v5 = a3;
  v6 = a4;
  v7 = (*(int (**)(void))(*(_DWORD *)a1 + 12))();
  if ( !dladdr() || !v9 )
    return 0;
  _snprintf_chk(v4, v5, 0, -1, "%s", v9);
  *v6 = v7 - v10;
  return 1;
}
// 3BD0: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);
// 41C4: using guessed type int dladdr(void);

//----- (0000EEFC) --------------------------------------------------------
int __fastcall sub_EEFC(int a1, int a2)
{
  int v2; // r4
  int v3; // r6
  int v4; // r5
  __int64 v5; // r0
  __int64 v7; // [sp+0h] [bp-20h]
  int v8; // [sp+8h] [bp-18h]
  int v9; // [sp+Ch] [bp-14h]

  v2 = a1;
  v3 = a2;
  v4 = (*(int (__fastcall **)(int, signed int))(*(_DWORD *)a1 + 12))(a1, -1) & 0xFFFFFFFE;
  v8 = 0;
  if ( v3 )
    --v4;
  LODWORD(v5) = _gnu_Unwind_Find_exidx(v4, &v8);
  HIDWORD(v5) = v8;
  v7 = v5;
  if ( !(_DWORD)v5 || !v8 || !sub_F054((_DWORD *)v2, v4, &v7) )
    *(_BYTE *)(v2 + 528) = 1;
  return _stack_chk_guard - v9;
}
// 41D0: using guessed type int __fastcall _gnu_Unwind_Find_exidx(_DWORD, _DWORD);

//----- (0000EF6C) --------------------------------------------------------
const char *__fastcall sub_EF6C(int a1, int a2)
{
  const char *result; // r0

  result = "pc";
  switch ( a2 + 2 )
  {
    case 0:
    case 15:
      result = "sp";
      break;
    case 1:
    case 17:
      return result;
    case 2:
      result = "r0";
      break;
    case 3:
      result = "r1";
      break;
    case 4:
      result = "r2";
      break;
    case 5:
      result = "r3";
      break;
    case 6:
      result = "r4";
      break;
    case 7:
      result = "r5";
      break;
    case 8:
      result = "r6";
      break;
    case 9:
      result = "r7";
      break;
    case 10:
      result = "r8";
      break;
    case 11:
      result = "r9";
      break;
    case 12:
      result = "r10";
      break;
    case 13:
      result = "r11";
      break;
    case 14:
      result = "r12";
      break;
    case 16:
      result = "lr";
      break;
    case 18:
    case 19:
    case 20:
    case 21:
    case 22:
    case 23:
    case 24:
    case 25:
    case 26:
    case 27:
    case 28:
    case 29:
    case 30:
    case 31:
    case 32:
    case 33:
    case 34:
    case 35:
    case 36:
    case 37:
    case 38:
    case 39:
    case 40:
    case 41:
    case 42:
    case 43:
    case 44:
    case 45:
    case 46:
    case 47:
    case 48:
    case 49:
    case 50:
    case 51:
    case 52:
    case 53:
    case 54:
    case 55:
    case 56:
    case 57:
    case 58:
    case 59:
    case 60:
    case 61:
    case 62:
    case 63:
    case 64:
    case 65:
def_F336:
      result = "unknown register";
      break;
    case 66:
      result = "s0";
      break;
    case 67:
      result = "s1";
      break;
    case 68:
      result = "s2";
      break;
    case 69:
      result = "s3";
      break;
    case 70:
      result = "s4";
      break;
    case 71:
      result = "s5";
      break;
    case 72:
      result = "s6";
      break;
    case 73:
      result = "s7";
      break;
    case 74:
      result = "s8";
      break;
    case 75:
      result = "s9";
      break;
    case 76:
      result = "s10";
      break;
    case 77:
      result = "s11";
      break;
    case 78:
      result = "s12";
      break;
    case 79:
      result = "s13";
      break;
    case 80:
      result = "s14";
      break;
    case 81:
      result = "s15";
      break;
    case 82:
      result = "s16";
      break;
    case 83:
      result = "s17";
      break;
    case 84:
      result = "s18";
      break;
    case 85:
      result = "s19";
      break;
    case 86:
      result = "s20";
      break;
    case 87:
      result = "s21";
      break;
    case 88:
      result = "s22";
      break;
    case 89:
      result = "s23";
      break;
    case 90:
      result = "s24";
      break;
    case 91:
      result = "s25";
      break;
    case 92:
      result = "s26";
      break;
    case 93:
      result = "s27";
      break;
    case 94:
      result = "s28";
      break;
    case 95:
      result = "s29";
      break;
    case 96:
      result = "s30";
      break;
    case 97:
      result = "s31";
      break;
    default:
      switch ( a2 )
      {
        case 256:
          result = "d0";
          break;
        case 257:
          result = "d1";
          break;
        case 258:
          result = "d2";
          break;
        case 259:
          result = "d3";
          break;
        case 260:
          result = "d4";
          break;
        case 261:
          result = "d5";
          break;
        case 262:
          result = "d6";
          break;
        case 263:
          result = "d7";
          break;
        case 264:
          result = "d8";
          break;
        case 265:
          result = "d9";
          break;
        case 266:
          result = "d10";
          break;
        case 267:
          result = "d11";
          break;
        case 268:
          result = "d12";
          break;
        case 269:
          result = "d13";
          break;
        case 270:
          result = "d14";
          break;
        case 271:
          result = "d15";
          break;
        case 272:
          result = "d16";
          break;
        case 273:
          result = "d17";
          break;
        case 274:
          result = "d18";
          break;
        case 275:
          result = "d19";
          break;
        case 276:
          result = "d20";
          break;
        case 277:
          result = "d21";
          break;
        case 278:
          result = "d22";
          break;
        case 279:
          result = "d23";
          break;
        case 280:
          result = "d24";
          break;
        case 281:
          result = "d25";
          break;
        case 282:
          result = "d26";
          break;
        case 283:
          result = "d27";
          break;
        case 284:
          result = "d28";
          break;
        case 285:
          result = "d29";
          break;
        case 286:
          result = "d30";
          break;
        case 287:
          result = "d31";
          break;
        default:
          goto def_F336;
      }
      break;
  }
  return result;
}

//----- (0000EF72) --------------------------------------------------------
int __fastcall sub_EF72(int result)
{
  *(_BYTE *)(result + 72) = 1;
  return result;
}

//----- (0000EF7C) --------------------------------------------------------
void __fastcall __noreturn sub_EF7C(int a1, int a2, int a3, int a4)
{
  fprintf((FILE *)stderr, "libunwind: %s %s:%d - %s\n", a1, a2, a3, a4);
  abort();
}

//----- (0000EFA8) --------------------------------------------------------
int __fastcall sub_EFA8(int a1)
{
  int v1; // r5
  signed int v2; // r4
  unsigned int *v3; // r0
  unsigned int *v4; // r0
  int result; // r0
  unsigned int v6; // [sp+4h] [bp-1Ch]
  unsigned int v7; // [sp+8h] [bp-18h]
  int v8; // [sp+Ch] [bp-14h]

  v1 = a1;
  v2 = 0;
  v3 = *(unsigned int **)(a1 + 520);
  v6 = 0;
  v7 = 0;
  v4 = sub_E0E4(v3, (signed int *)&v6, &v7);
  if ( sub_E134(v1, (int)v4, v6, v7) == 8 )
    v2 = 1;
  result = _stack_chk_guard - v8;
  if ( _stack_chk_guard == v8 )
    result = v2;
  return result;
}

//----- (0000EFFC) --------------------------------------------------------
int __fastcall sub_EFFC(int a1)
{
  int v1; // r4
  __int64 *v2; // r0
  unsigned int v3; // r0
  unsigned int v4; // r0
  int result; // r0

  v1 = a1;
  if ( *(_BYTE *)(a1 + 65) )
  {
    v2 = (__int64 *)(a1 + 72);
    if ( *(_BYTE *)(v1 + 64) )
      sub_F6B4(v2);
    else
      sub_F6AC(v2);
  }
  v3 = *(unsigned __int16 *)(v1 + 66);
  if ( (_BYTE)v3 )
  {
    sub_F6BC((__int64 *)(v1 + 208));
    v4 = *(unsigned __int8 *)(v1 + 67);
  }
  else
  {
    v4 = v3 >> 8;
  }
  if ( v4 )
    sub_F6C4((int *)(v1 + 336));
  result = *(unsigned __int8 *)(v1 + 68);
  if ( *(_BYTE *)(v1 + 68) )
    result = sub_F924((int *)(v1 + 464));
  return result;
}

//----- (0000F054) --------------------------------------------------------
signed int __fastcall sub_F054(_DWORD *a1, int a2, _DWORD *a3)
{
  _DWORD *v3; // r4
  _DWORD *v4; // r3
  int v5; // r2
  int v6; // r6
  signed int v7; // r5
  int v8; // r5
  int *v9; // r0
  signed int *v10; // r0
  int v11; // r1
  int v12; // t1
  signed int v13; // r6
  unsigned int v14; // r6
  int v15; // r7
  signed int (__fastcall *v16)(int, int, int); // r8
  signed int v17; // r12
  int v18; // r6
  int v19; // r3
  char v20; // r9
  int v21; // r3
  int v22; // r0
  int v24; // [sp+14h] [bp-34h]
  _DWORD *v25; // [sp+1Ch] [bp-2Ch]
  int v26; // [sp+20h] [bp-28h]
  int v27; // [sp+28h] [bp-20h]

  v3 = a1;
  v4 = a3;
  v5 = a1[1];
  v6 = v4[1];
  v7 = 0;
  v26 = a2;
  sub_F200(&v24, 0, v5, v4, v6, v5, (int)v4, &v26);
  if ( !v24 || v24 == v6 )
    goto LABEL_25;
  v8 = *v25 + 8 * v24;
  v9 = (int *)(*v25 + 8 * v24);
  v12 = *v9;
  v10 = v9 - 1;
  v11 = v12;
  if ( !v10 || (v13 = *v10, *v10 == 1) )
  {
    v7 = 0;
    goto LABEL_25;
  }
  if ( v13 < 0 )
  {
    v17 = 1;
    goto LABEL_11;
  }
  v14 = v13 | 2 * v13 & 0x80000000;
  v15 = (int)v10 + v14;
  v13 = *(signed int *)((char *)v10 + v14);
  if ( v13 <= -1 )
  {
    v17 = 0;
    v10 = (signed int *)v15;
LABEL_11:
    v19 = ((unsigned int)v13 >> 24) & 0xF;
    if ( v19 == 2 )
    {
      v20 = 2;
      v16 = sub_E6C4;
    }
    else
    {
      if ( v19 != 1 )
      {
        if ( v19 )
          goto LABEL_27;
        v18 = (int)(v10 + 1);
        if ( v17 )
          v18 = 0;
        v16 = sub_E658;
        goto LABEL_17;
      }
      v20 = 0;
      v16 = sub_E6BC;
    }
    v21 = ((unsigned int)v13 >> 16) & 0xFF;
    if ( ((v21 != 0) & (unsigned __int8)v17) == 1 )
      sub_EF7C(
        (int)"bool libunwind::UnwindCursor<libunwind::LocalAddressSpace, libunwind::Registers_arm>::getInfoFromEHABISecti"
             "on(pint_t, const libunwind::UnwindInfoSections &) [A = libunwind::LocalAddressSpace, R = libunwind::Registers_arm]",
        (int)"external/libunwind_llvm/src/UnwindCursor.hpp",
        783,
        (int)"index inlined table detected but pr function requires extra words");
    v18 = (int)&v10[v21 + 1];
    goto LABEL_22;
  }
  v16 = (signed int (__fastcall *)(int, int, int))((2 * v13 & 0x80000000 | v13) + v15);
  v17 = 0;
  v18 = v15 + 4 + 4 * (*(_DWORD *)(v15 + 4) >> 24) + 4;
  v10 = (signed int *)v15;
LABEL_17:
  v20 = 0;
LABEL_22:
  v3[122] = v8 - 8 + (2 * *(_DWORD *)(v8 - 8) & 0x80000000 | *(_DWORD *)(v8 - 8));
  v3[123] = (v11 | 2 * v11 & 0x80000000) + v8;
  v7 = 1;
  v3[125] = v16;
  v3[130] = v10;
  v22 = v20 & 2;
  v3[124] = v18;
  if ( v17 )
    v22 = 1;
  v3[127] = v22;
LABEL_25:
  if ( _stack_chk_guard != v27 )
LABEL_27:
    sub_EF7C(
      (int)"bool libunwind::UnwindCursor<libunwind::LocalAddressSpace, libunwind::Registers_arm>::getInfoFromEHABISection"
           "(pint_t, const libunwind::UnwindInfoSections &) [A = libunwind::LocalAddressSpace, R = libunwind::Registers_arm]",
      (int)"external/libunwind_llvm/src/UnwindCursor.hpp",
      776,
      (int)"unknown personality routine");
  return v7;
}

//----- (0000F200) --------------------------------------------------------
int *__fastcall sub_F200(int *result, int a2, int a3, _DWORD *a4, int a5, int a6, int a7, _DWORD *a8)
{
  unsigned int v8; // r5
  int v9; // r6
  int v10; // r4

  if ( a5 != a2 )
  {
    v8 = a5 - a2;
    do
    {
      v9 = a2 + (v8 >> 1);
      v10 = v8 - 1 - (v8 >> 1);
      if ( *a8 < (2 * *(_DWORD *)(*a4 + 8 * v9) & 0x80000000 | *(_DWORD *)(*a4 + 8 * v9)) + *a4 + 8 * v9 )
        v10 = v8 >> 1;
      else
        a2 = v9 + 1;
      v8 = v10;
    }
    while ( v10 );
  }
  *result = a2;
  result[2] = (int)a4;
  result[1] = a3;
  return result;
}

//----- (0000F6AC) --------------------------------------------------------
__int64 *__fastcall sub_F6AC(__int64 *result)
{
  __int64 v1; // d0

  v1 = *result;
  return result;
}

//----- (0000F6B4) --------------------------------------------------------
__int64 *__fastcall sub_F6B4(__int64 *result)
{
  __int64 v1; // d0

  v1 = *result;
  return result;
}

//----- (0000F6BC) --------------------------------------------------------
__int64 *__fastcall sub_F6BC(__int64 *result)
{
  __int64 v1; // d16

  v1 = *result;
  return result;
}

//----- (0000F6C4) --------------------------------------------------------
int __fastcall sub_F6C4(int *a1)
{
  int *v5; // r0
  int result; // r0

  _T1 = *a1;
  v5 = a1 + 2;
  __asm { LDCL            p1, c0, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c1, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c2, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c3, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c4, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c5, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c6, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c7, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c8, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c9, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c10, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c11, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c12, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c13, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c14, [R0],#8 }
  _T1 = *v5;
  result = (int)(v5 + 2);
  __asm { LDCL            p1, c15, [R0],#8 }
  return result;
}

//----- (0000F708) --------------------------------------------------------
int __fastcall sub_F708(int *a1)
{
  int *v5; // r0
  int result; // r0

  _T1 = *a1;
  v5 = a1 + 1;
  __asm { LDC2            p1, c8, [R0],#4 }
  _T1 = *v5;
  ++v5;
  __asm { LDC2            p1, c9, [R0],#4 }
  _T1 = *v5;
  ++v5;
  __asm { LDC2            p1, c10, [R0],#4 }
  _T1 = *v5;
  result = (int)(v5 + 1);
  __asm { LDC2            p1, c11, [R0],#4 }
  return result;
}

//----- (0000F7E4) --------------------------------------------------------
int _aeabi_ldiv0()
{
  return raise(8);
}

//----- (0000F7F4) --------------------------------------------------------
char *__fastcall j_strncpy(char *dest, const char *src, size_t n)
{
  return strncpy(dest, src, n);
}

//----- (0000F804) --------------------------------------------------------
int __fastcall j_RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2)
{
  return RilSapSocket::initSapSocket(a1, a2);
}

//----- (0000F814) --------------------------------------------------------
int __fastcall j_acquire_wake_lock(int a1, int a2)
{
  return acquire_wake_lock(a1, a2);
}
// 3D2C: using guessed type int __fastcall acquire_wake_lock(_DWORD, _DWORD);

//----- (0000F824) --------------------------------------------------------
int __fastcall j_pthread_mutex_unlock(pthread_mutex_t *mutex)
{
  return pthread_mutex_unlock(mutex);
}

//----- (0000F834) --------------------------------------------------------
int __fastcall j_release_wake_lock(int a1)
{
  return release_wake_lock(a1);
}
// 3D38: using guessed type int __fastcall release_wake_lock(_DWORD);

//----- (0000F844) --------------------------------------------------------
int __fastcall j_j_RIL_onRequestComplete(int a1, int a2, int a3, int a4)
{
  return j_RIL_onRequestComplete(a1, a2, a3, a4);
}

//----- (0000F854) --------------------------------------------------------
int __fastcall android::Parcel::writeInt32(android::Parcel *this, int a2)
{
  return android::Parcel::writeInt32(this, a2);
}

//----- (0000F864) --------------------------------------------------------
void __fastcall j_free(void *ptr)
{
  free(ptr);
}

//----- (0000F874) --------------------------------------------------------
int __fastcall j_RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4)
{
  return RilSocket::socketRequestsHandler(a1, a2, a3, a4);
}

//----- (0000F884) --------------------------------------------------------
int __fastcall j_RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4)
{
  return RilSapSocket::onUnsolicitedResponse(this, a2, a3, a4);
}

//----- (0000F894) --------------------------------------------------------
signed int __fastcall j_RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3)
{
  return RilSapSocket::addSocketToList(a1, a2, a3);
}

//----- (0000F8A4) --------------------------------------------------------
int __fastcall j_RilSocket::socketInit(RilSocket *this)
{
  return RilSocket::socketInit(this);
}

//----- (0000F8B4) --------------------------------------------------------
void __fastcall operator delete(void *a1)
{
  operator delete(a1);
}

//----- (0000F8C4) --------------------------------------------------------
int __fastcall j_j_pb_read(int a1, int a2, int a3)
{
  return j_pb_read(a1, a2, a3);
}

//----- (0000F8D4) --------------------------------------------------------
signed int __fastcall j_j_pb_encode_submessage(_DWORD *a1, unsigned __int8 *a2, int *a3)
{
  return j_pb_encode_submessage(a1, a2, a3);
}

//----- (0000F8E4) --------------------------------------------------------
signed int __fastcall j_j_pb_encode_varint(_DWORD *a1, int a2, __int64 a3)
{
  return j_pb_encode_varint(a1, a2, a3);
}

//----- (0000F8F4) --------------------------------------------------------
signed int __fastcall j_j_pb_write(_DWORD *a1, int a2, int a3)
{
  return j_pb_write(a1, a2, a3);
}

//----- (0000F904) --------------------------------------------------------
signed int __fastcall j_j_pb_encode_string(_DWORD *a1, int a2, int a3)
{
  return j_pb_encode_string(a1, a2, a3);
}

//----- (0000F914) --------------------------------------------------------
void sub_F914()
{
  JUMPOUT(sub_F698);
}
// F698: using guessed type int sub_F698();

//----- (0000F924) --------------------------------------------------------
int __fastcall sub_F924(int *a1)
{
  return sub_F708(a1);
}

// ALL OK, 334 function(s) have been successfully decompiled
