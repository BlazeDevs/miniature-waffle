/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2017 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __fastcall _cxa_finalize(_DWORD); weak
// char *strncpy(char *dest, const char *src, size_t n);
// int pthread_mutex_lock(pthread_mutex_t *mutex);
// int pthread_attr_init(pthread_attr_t *attr);
// int pthread_attr_setdetachstate(pthread_attr_t *attr, int detachstate);
// int pthread_create(pthread_t *newthread, const pthread_attr_t *attr, void *(*start_routine)(void *), void *arg);
// char *strerror(int errnum);
// int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...); weak
// int pthread_cond_wait(pthread_cond_t *cond, pthread_mutex_t *mutex);
// int pthread_mutex_unlock(pthread_mutex_t *mutex);
signed int ril_event_init(void);
// int pthread_cond_broadcast(pthread_cond_t *cond);
// int pipe(int pipedes[2]);
// int fcntl(int fd, int cmd, ...);
int __fastcall ril_event_set(int, int fd, int, int, int); // idb
int __fastcall ril_event_add(int a1);
int ril_event_loop(void);
// int __fastcall _errno(_DWORD); weak
// int kill(__pid_t pid, int sig);
int j_RIL_startEventLoop();
// int __fastcall _strncpy_chk2(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...); weak
// char *getenv(const char *name);
// int strtol(const char *nptr, char **endptr, int base);
// int listen(int fd, int n);
// int __fastcall _strlen_chk(_DWORD, _DWORD); weak
// int __fastcall _strlcat_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// void abort(void);
// void exit(int status);
// int __fastcall record_stream_get_next(_DWORD, _DWORD, _DWORD); weak
// _DWORD android::Parcel::Parcel(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::setData(android::Parcel *this, const unsigned __int8 *, unsigned int); idb
// _DWORD __cdecl android::Parcel::readInt32(android::Parcel *this, int *); idb
// _DWORD __cdecl android::Parcel::writeInt32(android::Parcel *this, int); idb
// _DWORD android::Parcel::data(android::Parcel *this); idb
// _DWORD android::Parcel::dataSize(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::~Parcel(android::Parcel *this); idb
// void *calloc(size_t nmemb, size_t size);
const char *__fastcall j_requestToString(int a1);
// int close(int fd);
int __fastcall ril_event_del(int a1);
// int __fastcall record_stream_free(_DWORD); weak
// int accept(int fd, struct sockaddr *addr, socklen_t *addr_len);
// int __cdecl _recvfrom_chk(_DWORD, _DWORD, _DWORD); weak
// int atoi(const char *nptr);
int __fastcall j_RIL_onUnsolicitedResponse(int a1, int a2, int a3);
// unsigned int sleep(unsigned int seconds);
int __fastcall RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2);
// _DWORD android::Parcel::dataPosition(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::setDataPosition(android::Parcel *this, unsigned int); idb
// void free(void *ptr);
// int __fastcall acquire_wake_lock(_DWORD, _DWORD); weak
// int __fastcall release_wake_lock(_DWORD); weak
// _DWORD android::elapsedRealtime(android *this); idb
// _DWORD __cdecl android::Parcel::writeInt64(android::Parcel *this, __int64); idb
// int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD); weak
int __fastcall ril_timer_add(int **a1, _DWORD *a2);
// int getsockopt(int fd, int level, int optname, void *optval, socklen_t *optlen);
// struct passwd *getpwuid(__uid_t uid);
// int strcmp(const char *s1, const char *s2);
char *__fastcall RilSocket::getListenEvent(RilSocket *this);
int __fastcall RilSocket::setCommandFd(RilSocket *this, int a2);
int __fastcall RilSocket::getCommandFd(RilSocket *this);
// int __fastcall record_stream_new(_DWORD, _DWORD); weak
// _DWORD __cdecl operator new(unsigned int); idb
char *__fastcall RilSocket::getCallbackEvent(RilSocket *this);
int __fastcall RilSocket::getCommandCb(RilSocket *this);
int __fastcall RilSocket::onNewCommandConnect(RilSocket *this);
// int __fastcall property_set(_DWORD, _DWORD); weak
// int __fastcall _write_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall _read_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall property_get(_DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl android::Parcel::readString16Inplace(android::Parcel *this, unsigned int *); idb
// int __fastcall strndup16to8(_DWORD, _DWORD); weak
// int __fastcall _aeabi_memclr(_DWORD, _DWORD); weak
// _DWORD __cdecl android::Parcel::write(android::Parcel *this, const void *, unsigned int); idb
// _DWORD __cdecl android::Parcel::readInplace(android::Parcel *this, unsigned int); idb
// _DWORD android::Parcel::readInt32(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::appendFrom(android::Parcel *this, const android::Parcel *, unsigned int, unsigned int); idb
// _DWORD android::Parcel::readString16(android::Parcel *this); idb
// _DWORD __cdecl android::Parcel::writeString16(android::Parcel *this, const android::String16 *); idb
// _DWORD __cdecl android::String16::~String16(android::String16 *this); idb
// int __fastcall _aeabi_memclr8(_DWORD, _DWORD); weak
// int __fastcall _aeabi_memclr4(_DWORD, _DWORD); weak
// _DWORD __cdecl android::Parcel::read(android::Parcel *this, void *, unsigned int); idb
int __fastcall j_RIL_onRequestComplete(int a1, int a2, int a3, int a4);
// int _android_log_print(_DWORD, _DWORD, const char *, ...); weak
// int strnlen16to8(void); weak
// int __fastcall strncpy16to8(_DWORD, _DWORD); weak
// int __fastcall strdup8to16(_DWORD, _DWORD); weak
// int __fastcall android::Parcel::writeString16(_DWORD, _DWORD, _DWORD); weak
// pthread_t pthread_self(void);
// int pthread_equal(pthread_t thread1, pthread_t thread2);
// int pthread_mutex_init(pthread_mutex_t *mutex, const pthread_mutexattr_t *mutexattr);
// int __fastcall _FD_SET_chk(_DWORD, _DWORD, _DWORD); weak
// int clock_gettime(clockid_t clock_id, struct timespec *tp);
// int __fastcall _FD_CLR_chk(_DWORD, _DWORD, _DWORD); weak
// int __fastcall _aeabi_memcpy8(_DWORD, _DWORD, _DWORD); weak
// int select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout);
// int __fastcall _FD_ISSET_chk(_DWORD, _DWORD, _DWORD); weak
int __fastcall rilEventAddWakeup_helper(int a1);
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3);
int __fastcall RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4);
int __fastcall RilSapSocket::getSocketById(int a1);
int __fastcall RilSapSocket::onRequestComplete(int a1, int a2, int a3, int a4, unsigned int a5);
int __fastcall RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4);
int __fastcall RilSapSocket::printList(RilSapSocket *this);
int __fastcall RilSapSocket::sendResponse(int a1, int *a2);
signed int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(int a1, int a2, int a3);
signed int __fastcall RilSapSocket::SocketExists(RilSapSocket *this, const char *a2);
signed int __fastcall RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3);
pthread_mutexattr_t *__fastcall RilSapSocket::RilSapSocket(pthread_mutexattr_t *a1, pthread_mutexattr_t a2, pthread_mutexattr_t a3, pthread_mutexattr_t a4);
// void *malloc(size_t size);
int __fastcall RilSocket::socketInit(RilSocket *this);
void __fastcall RilSapSocket::dispatchRequest(int a1, _DWORD *a2);
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(int a1);
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(int a1, int a2);
// int pthread_mutexattr_init(pthread_mutexattr_t *attr);
int __fastcall j_pb_get_encoded_size(_DWORD *a1, unsigned __int8 *a2, int *a3);
int __fastcall j_pb_ostream_from_buffer(int result, int a2, unsigned int a3);
signed int __fastcall j_pb_write(int a1, int a2, int a3);
signed int __fastcall j_pb_encode(__int64 *a1, unsigned __int8 *a2, int *a3);
int __fastcall log_hex(const char *a1, const unsigned __int8 *a2, int a3);
int __fastcall blockingWrite_helper(int a1, void *a2, unsigned int a3);
_DWORD *__fastcall j_pb_istream_from_buffer(_DWORD *result, int a2, int a3);
int __fastcall j_pb_decode(int a1, int a2, int a3);
void __fastcall RilSapSocket::dispatchDisconnect(int a1, int a2);
int __fastcall RilSapSocket::sendDisconnect(RilSapSocket *this);
// void __cdecl operator delete(void *); idb
void __fastcall RilSapSocket::sOnRequestComplete(_DWORD *a1, int a2, int a3, unsigned int a4);
RilSapSocket *__fastcall RilSapSocket::sOnUnsolicitedResponse(RilSapSocket *this, int a2, const void *a3, unsigned int a4);
int j_RIL_requestTimedCallback();
int __fastcall RilSapSocket::pushRecord(RilSapSocket *this, void *a2, unsigned int a3);
void __fastcall __noreturn RilSapSocket::processRequestsLoop(RilSapSocket *this);
int __fastcall RilSapSocket::onCommandsSocketClosed(RilSapSocket *this);
int __fastcall j_pb_read(int a1, int a2, int a3);
int __fastcall j_pb_skip_field(int a1, int a2);
signed int __fastcall j_pb_make_string_substream(int a1, _QWORD *a2);
// void *realloc(void *ptr, size_t size);
int __fastcall j_pb_decode_noinit(int a1, unsigned __int8 *a2, int a3);
int __fastcall j_pb_release(int a1, int a2);
signed int __fastcall j_pb_decode_varint(int a1, _DWORD *a2);
signed int __fastcall j_pb_encode_tag_for_field(int a1, unsigned __int8 *a2);
signed int __fastcall j_pb_encode_varint(int a1, int a2, __int64 a3);
signed int __fastcall j_pb_encode_submessage(int a1, unsigned __int8 *a2, int *a3);
signed int __fastcall j_pb_encode_string(int a1, int a2, int a3);
// int fprintf(FILE *stream, const char *format, ...);
// int dladdr(void); weak
// int __fastcall _gnu_Unwind_Find_exidx(_DWORD, _DWORD); weak
int sub_3F80();
int (*__fastcall sub_3FA0(int (*result)(void)))(void);
char *__fastcall RIL_setRilSocketName(const char *a1);
int RIL_startEventLoop();
int sub_4144(); // weak
__int64 *__fastcall RIL_setcallbacks(__int64 *a1);
int __fastcall RIL_register(_DWORD *a1);
int __fastcall sub_4628(int a1, int a2, int *a3);
int __fastcall sub_4870(int a1);
int (__fastcall *__fastcall RIL_register_socket(int (__fastcall *result)(void **, int, int), int a2, int a3, int a4))(void **, int, int);
int __fastcall RIL_onRequestAck(int a1);
signed int __fastcall sub_4D8C(int a1, int a2);
int __fastcall RIL_onRequestComplete(int a1, int a2, int a3, int a4);
const char *__fastcall requestToString(int a1);
int sub_58D4();
int __fastcall RIL_onUnsolicitedResponse(int a1, int a2, int a3);
int __fastcall RIL_requestTimedCallback_0(int a1, int a2, __int64 *a3);
int sub_5D7C();
int RIL_requestTimedCallback(void); // weak
const char *__fastcall failCauseToString(int a1);
const char *__fastcall radioStateToString(unsigned int a1);
const char *__fastcall callStateToString(unsigned int a1);
const char *__fastcall rilSocketIdToString(int a1);
int __fastcall rilEventAddWakeup_helper(int a1);
_DWORD __fastcall listenCallback_helper(int, __int16, void *); // idb
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3);
_DWORD __fastcall blockingWrite_helper(int, void *, unsigned int); // idb
unsigned int __fastcall sub_659C(int a1, int a2, unsigned int a3);
int sub_6630();
int sub_6688();
int __fastcall sub_66C0(int a1, int a2);
int __fastcall sub_66DC(android::Parcel *this, int *a2, unsigned int a3);
int __fastcall sub_67F4(android::Parcel *this, __int64 *a2);
int __fastcall sub_6968(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_69F8(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_6B2C(android::Parcel *a1, unsigned __int64 *a2);
int sub_6C88();
int __fastcall sub_6C8C(int a1, int a2);
int __fastcall sub_6C98(android::Parcel *this, __int64 *a2);
int __fastcall sub_6D98(android::Parcel *this, int *a2, int a3);
signed int __fastcall sub_6E08(android::Parcel *a1, int *a2, unsigned int a3);
int __fastcall sub_6F48(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_6FE0(android::Parcel *a1, int a2);
int __fastcall sub_7048(android::Parcel *this, int *a2, int a3);
int __fastcall sub_70B0(android::Parcel *this, __int64 *a2);
int __fastcall sub_7198(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_71D4(android::Parcel *this, unsigned __int64 *a2);
int __fastcall sub_7368(android::Parcel *this, int *a2, int a3);
int __fastcall sub_73D0(android::Parcel *a1, unsigned __int64 *a2);
int __fastcall sub_74FC(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_75B0(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_78D0(android::Parcel *this, unsigned __int64 *a2);
int __fastcall sub_795C(android::Parcel *this, const void *a2, int a3);
int __fastcall sub_79AC(android::Parcel *a1, unsigned __int64 *a2);
int __fastcall sub_7A94(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_7B28(android::Parcel *a1, int *a2);
int __fastcall sub_7BC8(android::Parcel *a1, int *a2);
int __fastcall sub_7C78(android::Parcel *a1, int a2, unsigned int a3);
int __fastcall sub_7CEC(android::Parcel *this, _QWORD *a2);
int __fastcall sub_7E78(android::Parcel *a1, int a2, unsigned int a3);
int __fastcall sub_7ED4(android::Parcel *this, _QWORD *a2);
int __fastcall sub_8040(android::Parcel *a1, int *a2);
int __fastcall sub_824C(int a1, int a2);
int __fastcall sub_82FC(int a1, int a2);
int __fastcall sub_83A8(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_8684(android::Parcel *this, unsigned __int64 *a2);
int __fastcall sub_87D4(android::Parcel *this, int **a2);
int __fastcall sub_8AE4(android::Parcel *this, unsigned __int64 *a2);
int __fastcall sub_8BFC(android::Parcel *a1, int *a2);
int __fastcall sub_8C7C(android::Parcel *this, unsigned __int64 *a2);
int __fastcall sub_8D38(android::Parcel *this, int a2);
int __fastcall sub_8E1C(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_8F0C(android::Parcel *this, unsigned __int64 *a2);
int __fastcall sub_8FF4(android::Parcel *this, __int64 *a2, int a3);
int __fastcall sub_9040(android::Parcel *this, int a2);
int __fastcall sub_9258(android::Parcel *this, int *a2, int a3);
int __fastcall sub_92DC(android::Parcel *a1, unsigned __int64 *a2);
int __fastcall sub_93DC(android::Parcel *this, void *a2, int a3);
int __fastcall sub_9440(android::Parcel *this, int *a2, int a3);
int __fastcall sub_94B4(android::Parcel *this, int *a2, int a3);
int __fastcall sub_9544(android::Parcel *this, int a2);
int __fastcall sub_97A8(android::Parcel *this, int *a2, int a3);
int __fastcall sub_9898(android::Parcel *this, unsigned __int64 *a2);
int __fastcall sub_995C(android::Parcel *this, unsigned __int64 *a2);
int __fastcall sub_9B64(android::Parcel *a1, int *a2);
int __fastcall sub_9BCC(android::Parcel *a1, int a2, int a3);
int __fastcall sub_9C8C(int a1, int a2);
int __fastcall sub_9CD8(android::Parcel *a1, int *a2);
int __fastcall sub_9D18(android::Parcel *this, _DWORD *a2);
int __fastcall sub_9D94(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_9E8C(android::Parcel *a1, int a2);
int __fastcall sub_A024(android::Parcel *this, int a2, unsigned int a3);
void __fastcall sub_A268(int a1, _DWORD *a2);
int __fastcall sub_A2A0(int a1, int a2, int a3);
int sub_A35C();
int __fastcall sub_A3A0(int a1, unsigned int a2);
int __fastcall sub_A458(android::Parcel *this, int *a2, int a3);
int __fastcall sub_A4D0(android::Parcel *this, int *a2, unsigned int a3);
signed int __fastcall sub_A5BC(android::Parcel *a1, unsigned __int8 *a2, int a3);
signed int __fastcall sub_A600(android::Parcel *a1, int *a2, int a3);
int __fastcall sub_A78C(android::Parcel *a1, int a2, unsigned int a3);
int __fastcall sub_A8BC(android::Parcel *this, unsigned __int8 *a2, unsigned int a3);
signed int __fastcall sub_ABEC(android::Parcel *a1, int *a2, int a3);
int __fastcall sub_ADC8(android::Parcel *this, int *a2, int a3);
int __fastcall sub_AE44(android::Parcel *this, int *a2, int a3);
int __fastcall sub_AF58(android::Parcel *a1, int *a2);
int __fastcall sub_AF78(android::Parcel *a1, unsigned __int8 *a2);
void __fastcall sub_AFA0(int a1, int a2, _QWORD *a3);
signed int ril_event_init(void);
int __fastcall ril_event_set(int, int fd, int, int, int); // idb
int __fastcall ril_event_add(int a1);
int __fastcall ril_timer_add(int **a1, _DWORD *a2);
int __fastcall ril_event_del(int a1);
int *__fastcall sub_B260(int a1, int a2);
int ril_event_loop(void);
int __fastcall RilSocket::socketInit(RilSocket *this);
int __fastcall RilSocket::sSocketListener(RilSocket *this, int a2, int a3, void *a4);
int __fastcall RilSocket::sSocketRequestsHandler(RilSocket *this, int a2, int a3, void *a4);
int __fastcall RilSocket::onNewCommandConnect(RilSocket *this);
int __fastcall ril_socket_process_requests_loop(int a1);
int __fastcall RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4);
int __fastcall RilSocket::setListenFd(int result, int a2);
int __fastcall RilSocket::setCommandFd(int result, int a2);
int __fastcall RilSocket::getListenFd(RilSocket *this);
int __fastcall RilSocket::getCommandFd(RilSocket *this);
int __fastcall RilSocket::setListenCb(int result, void (__cdecl *a2)(int, __int16, void *));
int __fastcall RilSocket::setCommandCb(int result, void (__cdecl *a2)(int, __int16, void *));
int __fastcall RilSocket::getListenCb(RilSocket *this);
int __fastcall RilSocket::getCommandCb(RilSocket *this);
int __fastcall RilSocket::setListenEvent(_DWORD *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10);
int __fastcall RilSocket::setCallbackEvent(_DWORD *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10);
char *__fastcall RilSocket::getListenEvent(RilSocket *this);
char *__fastcall RilSocket::getCallbackEvent(RilSocket *this);
void __fastcall RilSapSocket::sOnRequestComplete(_DWORD *a1, int a2, int a3, unsigned int a4);
RilSapSocket *__fastcall RilSapSocket::sOnUnsolicitedResponse(RilSapSocket *this, int a2, const void *a3, unsigned int a4);
int __fastcall RilSapSocket::getSocketById(int a1);
int __fastcall RilSapSocket::onRequestComplete(int a1, int a2, int a3, int a4, unsigned int a5);
int __fastcall RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4);
int __fastcall RilSapSocket::printList(RilSapSocket *this);
int __fastcall RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2);
signed int __fastcall RilSapSocket::SocketExists(RilSapSocket *this, const char *a2);
signed int __fastcall RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3);
void __fastcall __noreturn RilSapSocket::processRequestsLoop(RilSapSocket *this);
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(int a1);
void __fastcall RilSapSocket::dispatchRequest(int a1, _DWORD *a2);
pthread_mutexattr_t *__fastcall RilSapSocket::RilSapSocket(pthread_mutexattr_t *a1, pthread_mutexattr_t a2, pthread_mutexattr_t a3, pthread_mutexattr_t a4);
int __fastcall log_hex(const char *a1, const unsigned __int8 *a2, int a3);
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(int a1, int a2);
int __fastcall RilSapSocket::sendResponse(int a1, int *a2);
signed int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(int a1, int a2, int a3);
int __fastcall RilSapSocket::pushRecord(RilSapSocket *this, void *a2, unsigned int a3);
int __fastcall RilSapSocket::sendDisconnect(RilSapSocket *this);
void __fastcall RilSapSocket::dispatchDisconnect(int a1, int a2);
int __fastcall RilSapSocket::onCommandsSocketClosed(RilSapSocket *this);
signed int __fastcall pb_read(int a1, int a2, unsigned int a3);
int sub_C54C(); // weak
_DWORD *__fastcall pb_istream_from_buffer(_DWORD *result, int a2, int a3);
signed int __fastcall pb_decode_varint(int a1, _DWORD *a2);
signed int __fastcall sub_C618(int a1, int a2);
signed int __fastcall pb_decode_tag(int a1, int *a2, unsigned int *a3, _BYTE *a4);
signed int __fastcall sub_C6B8(int a1, int *a2);
int __fastcall pb_skip_field(int a1, int a2);
signed int __fastcall pb_make_string_substream(int a1, _QWORD *a2);
int __fastcall pb_close_string_substream(int result, int a2);
int __fastcall pb_decode_noinit(int a1, unsigned __int8 *a2, int a3);
int __fastcall sub_CA94(int a1, int a2, _DWORD *a3);
signed int __fastcall sub_CE80(int *a1);
int __fastcall pb_decode(int a1, int a2, int a3);
int __fastcall sub_CF28(int a1, int a2);
int __fastcall pb_release(int a1, int a2);
int __fastcall pb_decode_delimited(int a1, int a2, int a3);
signed int __fastcall pb_decode_svarint(int a1, _QWORD *a2);
int __fastcall pb_decode_fixed32(int a1, int a2);
int __fastcall pb_decode_fixed64(int a1, int a2);
signed int __fastcall sub_D168(int a1, int a2, _BYTE *a3);
signed int __fastcall sub_D1F4(int a1, int a2, _QWORD *a3);
signed int __fastcall sub_D260(int a1, int a2, _QWORD *a3);
int __fastcall sub_D2DC(int a1, int a2, int a3);
int __fastcall sub_D2E4(int a1, int a2, int a3);
int __fastcall sub_D2EC(int a1, int a2, void **a3);
int __fastcall sub_D37C(int a1, int a2, void **a3);
int __fastcall sub_D40C(int a1, int a2, int a3);
int __fastcall pb_ostream_from_buffer(int result, int a2, unsigned int a3);
int sub_D4A8(); // weak
signed int __fastcall pb_write(int a1, int a2, int a3);
signed int __fastcall pb_encode(__int64 *a1, unsigned __int8 *a2, int *a3);
signed int __fastcall sub_D5A0(__int64 *a1, unsigned __int8 *a2, int (__fastcall *a3)(__int64 *));
signed int __fastcall pb_encode_submessage(int a1, unsigned __int8 *a2, int *a3);
int __fastcall pb_get_encoded_size(_DWORD *a1, unsigned __int8 *a2, int *a3);
signed int __fastcall pb_encode_varint(int a1, int a2, __int64 a3);
signed int __fastcall pb_encode_svarint(int a1, int a2, int a3, int a4);
signed int __fastcall pb_encode_fixed32(int a1, int a2);
signed int __fastcall pb_encode_fixed64(int a1, int a2);
signed int __fastcall pb_encode_tag(int a1, int a2, unsigned int a3);
signed int __fastcall pb_encode_tag_for_field(int a1, unsigned __int8 *a2);
signed int __fastcall pb_encode_string(int a1, int a2, int a3);
signed int __fastcall sub_D9FC(int a1, int a2, _DWORD *a3);
signed int __fastcall sub_DA40(int a1, int a2, __int64 *a3);
signed int __fastcall sub_DA70(int a1, int a2, _QWORD *a3);
signed int __fastcall sub_DAAC(int a1, int a2, int a3);
signed int __fastcall sub_DAB4(int a1, int a2, int a3);
int __fastcall sub_DABC(int a1, int a2, int *a3);
signed int __fastcall sub_DB40(int a1, int a2, int a3);
signed int __fastcall sub_DB70(int a1, int a2, int *a3);
unsigned int *__fastcall sub_DB90(unsigned int *result, signed int *a2, int *a3);
signed int __fastcall sub_DBE4(int a1, int a2, unsigned int a3, unsigned int a4);
signed int __fastcall sub_DF28(int a1, int a2, unsigned int a3, int a4, int *a5);
signed int __fastcall sub_DFC4(int a1, int a2, unsigned int a3, int a4);
signed int __fastcall sub_E104(int a1, int a2, int a3);
signed int __fastcall sub_E10C(int a1, int a2);
signed int __fastcall sub_E168(int a1, int a2, int a3);
signed int __fastcall sub_E170(int a1, int a2, int a3);
int __fastcall sub_E224(int a1, int *a2, char a3);
void __fastcall __noreturn sub_E344(int a1, int a2, int a3);
int __fastcall sub_E410(_DWORD *a1, int a2, int a3, int a4, int a5);
_QWORD *__fastcall sub_E428(_QWORD *result);
_QWORD *__fastcall sub_E430(_QWORD *result);
_QWORD *__fastcall sub_E438(_QWORD *result);
void sub_E440();
void sub_E484();
int __fastcall sub_E498(int a1, int a2);
signed int __fastcall sub_E4DC(int a1, int a2, _DWORD *a3);
signed int __fastcall sub_E50A(int a1, int a2, int a3);
signed int __fastcall sub_E54E(int a1, int a2, _QWORD *a3);
signed int __fastcall sub_E57E(int a1, int a2, int a3, int a4);
int __fastcall sub_E5B6(int a1);
signed int __fastcall sub_E5BC(int a1, int a2);
signed int __fastcall sub_E5DA(int a1);
int __fastcall sub_E5EC(int a1);
int __fastcall sub_E5F2(int a1, int a2);
int __fastcall sub_E614(int a1, signed int a2);
int __fastcall sub_E6A0(int result, signed int a2, int a3);
int __fastcall sub_E72C(int a1, int a2);
__int64 __fastcall sub_E74C(int a1, int a2);
int __fastcall sub_E7F0(int a1, int a2, int a3, int a4);
int __fastcall sub_E8BC(int a1);
_DWORD *__fastcall sub_E90C(int a1, _DWORD *a2);
void __fastcall sub_E924(int a1);
int __fastcall sub_E93A(int a1);
signed int __fastcall sub_E940(int a1, int a2, int a3, _DWORD *a4);
int __fastcall sub_E9B0(int a1, int a2);
const char *__fastcall sub_EA20(int a1, int a2);
int __fastcall sub_EA26(int result);
void __fastcall __noreturn sub_EA30(int a1, int a2, int a3, int a4);
int __fastcall sub_EA5C(int a1);
int __fastcall sub_EAB0(int a1);
signed int __fastcall sub_EB08(_DWORD *a1, int a2, _DWORD *a3);
int __fastcall sub_ECAC(int *a1, int a2, int a3, _DWORD *a4, int a5, int a6, int a7, _DWORD *a8);
int sub_F138(); // weak
__int64 *__fastcall sub_F14C(__int64 *result);
__int64 *__fastcall sub_F154(__int64 *result);
__int64 *__fastcall sub_F15C(__int64 *result);
int __fastcall sub_F164(int *a1);
int __fastcall sub_F1A8(int *a1);
char *__fastcall j_strncpy(char *dest, const char *src, size_t n);
int __fastcall j_RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2);
int __fastcall j_acquire_wake_lock(int a1, int a2);
int __fastcall j_pthread_mutex_unlock(pthread_mutex_t *mutex);
int __fastcall j_release_wake_lock(int a1);
int __fastcall j_j_RIL_onRequestComplete(int a1, int a2, int a3, int a4);
int __fastcall android::Parcel::writeInt32(android::Parcel *this, int a2);
void __fastcall j_free(void *ptr);
int __fastcall j_RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4);
int __fastcall j_RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4);
signed int __fastcall j_RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3);
int __fastcall j_RilSocket::socketInit(RilSocket *this);
void __fastcall operator delete(void *a1);
int __fastcall j_j_pb_read(int a1, int a2, int a3);
signed int __fastcall j_j_pb_encode_submessage(int a1, unsigned __int8 *a2, int *a3);
signed int __fastcall j_j_pb_encode_varint(int a1, int a2, __int64 a3);
signed int __fastcall j_j_pb_write(int a1, int a2, int a3);
signed int __fastcall j_j_pb_encode_string(int a1, int a2, int a3);
void sub_F2DC();
int __fastcall sub_F2EC(int *a1);

//-------------------------------------------------------------------------
// Data declarations

int dword_0 = 1179403647; // weak
char byte_4 = '\x01'; // weak
Elf32_Sym stru_320 = { 1660u, 0u, 0u, 18u, 0u, 0u }; // weak
void *off_4BC0 = (void *)0x10000; // weak
void *off_4BD0 = (void *)0x10000; // weak
_UNKNOWN loc_5D2C; // weak
_UNKNOWN unk_131E4; // weak
_DWORD dword_131F0[8] = { 0, 0, 0, 0, 0, 0, 1, 1 }; // idb
_DWORD dword_13210[8] = { 3, 3, 3, 6, 6, 6, 6, 6 }; // idb
_DWORD dword_13230[8] = { 4294967295, 3, 4, 4294967295, 6, 7, 4294967295, 4294967295 }; // idb
unsigned int dword_13250[8] = { 0u, 0u, 0u, 5u, 1u, 2u, 2u, 2u }; // idb
void *off_148D0 = (void *)0x3E8; // weak
char *off_14B20[11] =
{
  "RADIO_OFF",
  "RADIO_UNAVAILABLE",
  "RADIO_SIM_NOT_READY",
  "RADIO_SIM_LOCKED_OR_ABSENT",
  "RADIO_SIM_READY",
  "RADIO_RUIM_NOT_READY",
  "RADIO_RUIM_READY",
  "RADIO_RUIM_LOCKED_OR_ABSENT",
  "RADIO_NV_NOT_READY",
  "RADIO_NV_READY",
  "RADIO_ON"
}; // weak
char *off_14B50[6] = { "ACTIVE", "HOLDING", "DIALING", "ALERTING", "INCOMING", "WAITING" }; // weak
void *off_14B70 = (void *)0xC1C5; // weak
void *off_14B84 = (void *)0xD169; // weak
void *off_14BA8 = (void *)0xD9FD; // weak
void *off_14BD4 = (void *)0x4075; // weak
void *off_15000 = &off_15000; // weak
char rild[5] = "rild"; // weak
int android::voiceRadioTech = 4294967295; // weak
int android::cdmaSubscriptionSource = 4294967295; // weak
int android::simRuimStatus = 4294967295; // weak
int dword_15018 = 4294967295; // weak
_UNKNOWN unk_1501C; // weak
void *RilSapSocket::uimRilEnv = (void *)0xB865; // weak
int android::s_callbacks; // weak
int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD); // weak
int (*dword_156E0)(void); // weak
_UNKNOWN unk_156E8; // weak
int (*dword_156EC)(void); // weak
int android::s_wakelock_count; // weak
char byte_156F4; // weak
_UNKNOWN unk_156F8; // weak
int dword_156FC; // weak
_UNKNOWN unk_15700; // weak
char byte_15704; // weak
int dword_15708; // weak
int dword_1570C; // weak
int dword_15710; // weak
_UNKNOWN unk_15714; // weak
_UNKNOWN unk_15718; // weak
int dword_1571C; // weak
_UNKNOWN unk_15720; // weak
_UNKNOWN unk_15724; // weak
_UNKNOWN unk_15728; // weak
_UNKNOWN unk_1572C; // weak
_UNKNOWN unk_15750; // weak
_UNKNOWN unk_15774; // weak
int dword_15798; // weak
int dword_1579C; // weak
int dword_157A0; // weak
int dword_157A4; // weak
int dword_157A8; // weak
_UNKNOWN unk_157AC; // weak
_UNKNOWN unk_157D0; // weak
int dword_157D4; // weak
_UNKNOWN unk_157D8; // weak
_UNKNOWN unk_157DC; // weak
_UNKNOWN unk_157E0; // weak
_DWORD dword_157E8[32]; // idb
int dword_15868; // weak
char algn_1586C[4]; // weak
int dword_15870; // weak
_UNKNOWN unk_15878; // weak
_UNKNOWN unk_15880; // weak
int dword_15888; // weak
int dword_15890; // weak
int dword_15894; // weak
int dword_15898; // weak
_UNKNOWN unk_158A0; // weak
_UNKNOWN unk_158A8; // weak
int dword_158B0; // weak
_DWORD dword_158B8[2]; // idb
_UNKNOWN unk_158C0; // weak
_UNKNOWN unk_158C8; // weak
_UNKNOWN unk_158D0; // weak
int dword_158D8; // weak
int dword_158DC; // weak
_UNKNOWN unk_158E0; // weak
// extern _UNKNOWN _stack_chk_guard; weak
// extern _UNKNOWN MsgHeader_fields; weak
// extern _UNKNOWN RIL_SIM_SAP_DISCONNECT_REQ_fields; weak
// extern struct _IO_FILE *stderr;


//----- (000038FC) --------------------------------------------------------
signed int ril_event_init(void)
{
  return ril_event_init();
}

//----- (0000392C) --------------------------------------------------------
int __fastcall ril_event_set(int a1, int fd, int a3, int a4, int a5)
{
  return ril_event_set(a1, fd, a3, a4, a5);
}

//----- (00003938) --------------------------------------------------------
int __fastcall ril_event_add(int a1)
{
  return ril_event_add(a1);
}

//----- (00003944) --------------------------------------------------------
int ril_event_loop(void)
{
  return ril_event_loop();
}

//----- (00003968) --------------------------------------------------------
int j_RIL_startEventLoop()
{
  return RIL_startEventLoop();
}

//----- (00003A4C) --------------------------------------------------------
const char *__fastcall j_requestToString(int a1)
{
  return requestToString(a1);
}

//----- (00003A64) --------------------------------------------------------
int __fastcall ril_event_del(int a1)
{
  return ril_event_del(a1);
}

//----- (00003AA0) --------------------------------------------------------
int __fastcall j_RIL_onUnsolicitedResponse(int a1, int a2, int a3)
{
  return RIL_onUnsolicitedResponse(a1, a2, a3);
}

//----- (00003AB8) --------------------------------------------------------
int __fastcall RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2)
{
  return RilSapSocket::initSapSocket(a1, a2);
}

//----- (00003B24) --------------------------------------------------------
int __fastcall ril_timer_add(int **a1, _DWORD *a2)
{
  return ril_timer_add(a1, a2);
}

//----- (00003B54) --------------------------------------------------------
char *__fastcall RilSocket::getListenEvent(RilSocket *this)
{
  return RilSocket::getListenEvent(this);
}

//----- (00003B60) --------------------------------------------------------
int __fastcall RilSocket::setCommandFd(RilSocket *this, int a2)
{
  return RilSocket::setCommandFd((int)this, a2);
}

//----- (00003B6C) --------------------------------------------------------
int __fastcall RilSocket::getCommandFd(RilSocket *this)
{
  return RilSocket::getCommandFd(this);
}

//----- (00003B90) --------------------------------------------------------
char *__fastcall RilSocket::getCallbackEvent(RilSocket *this)
{
  return RilSocket::getCallbackEvent(this);
}

//----- (00003B9C) --------------------------------------------------------
int __fastcall RilSocket::getCommandCb(RilSocket *this)
{
  return RilSocket::getCommandCb(this);
}

//----- (00003BA8) --------------------------------------------------------
int __fastcall RilSocket::onNewCommandConnect(RilSocket *this)
{
  return RilSocket::onNewCommandConnect(this);
}

//----- (00003C80) --------------------------------------------------------
int __fastcall j_RIL_onRequestComplete(int a1, int a2, int a3, int a4)
{
  return RIL_onRequestComplete(a1, a2, a3, a4);
}

//----- (00003D34) --------------------------------------------------------
int __fastcall rilEventAddWakeup_helper(int a1)
{
  return rilEventAddWakeup_helper(a1);
}

//----- (00003D40) --------------------------------------------------------
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3)
{
  return listenCallback_helper(a1, a2, a3);
}

//----- (00003D4C) --------------------------------------------------------
int __fastcall RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4)
{
  return RilSocket::socketRequestsHandler(a1, a2, a3, a4);
}

//----- (00003D58) --------------------------------------------------------
int __fastcall RilSapSocket::getSocketById(int a1)
{
  return RilSapSocket::getSocketById(a1);
}

//----- (00003D64) --------------------------------------------------------
int __fastcall RilSapSocket::onRequestComplete(int a1, int a2, int a3, int a4, unsigned int a5)
{
  return RilSapSocket::onRequestComplete(a1, a2, a3, a4, a5);
}

//----- (00003D70) --------------------------------------------------------
int __fastcall RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4)
{
  return RilSapSocket::onUnsolicitedResponse(this, a2, a3, a4);
}

//----- (00003D7C) --------------------------------------------------------
int __fastcall RilSapSocket::printList(RilSapSocket *this)
{
  return RilSapSocket::printList(this);
}

//----- (00003D88) --------------------------------------------------------
int __fastcall RilSapSocket::sendResponse(int a1, int *a2)
{
  return RilSapSocket::sendResponse(a1, a2);
}

//----- (00003D94) --------------------------------------------------------
signed int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(int a1, int a2, int a3)
{
  return Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(a1, a2, a3);
}

//----- (00003DA0) --------------------------------------------------------
signed int __fastcall RilSapSocket::SocketExists(RilSapSocket *this, const char *a2)
{
  return RilSapSocket::SocketExists(this, a2);
}

//----- (00003DAC) --------------------------------------------------------
signed int __fastcall RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3)
{
  return RilSapSocket::addSocketToList(a1, a2, a3);
}

//----- (00003DB8) --------------------------------------------------------
pthread_mutexattr_t *__fastcall RilSapSocket::RilSapSocket(pthread_mutexattr_t *a1, pthread_mutexattr_t a2, pthread_mutexattr_t a3, pthread_mutexattr_t a4)
{
  return RilSapSocket::RilSapSocket(a1, a2, a3, a4);
}

//----- (00003DD0) --------------------------------------------------------
int __fastcall RilSocket::socketInit(RilSocket *this)
{
  return RilSocket::socketInit(this);
}

//----- (00003DDC) --------------------------------------------------------
void __fastcall RilSapSocket::dispatchRequest(int a1, _DWORD *a2)
{
  RilSapSocket::dispatchRequest(a1, a2);
}

//----- (00003DE8) --------------------------------------------------------
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(int a1)
{
  return Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(a1);
}

//----- (00003DF4) --------------------------------------------------------
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(int a1, int a2)
{
  return Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(a1, a2);
}

//----- (00003E0C) --------------------------------------------------------
int __fastcall j_pb_get_encoded_size(_DWORD *a1, unsigned __int8 *a2, int *a3)
{
  return pb_get_encoded_size(a1, a2, a3);
}

//----- (00003E18) --------------------------------------------------------
int __fastcall j_pb_ostream_from_buffer(int result, int a2, unsigned int a3)
{
  return pb_ostream_from_buffer(result, a2, a3);
}

//----- (00003E24) --------------------------------------------------------
signed int __fastcall j_pb_write(int a1, int a2, int a3)
{
  return pb_write(a1, a2, a3);
}

//----- (00003E30) --------------------------------------------------------
signed int __fastcall j_pb_encode(__int64 *a1, unsigned __int8 *a2, int *a3)
{
  return pb_encode(a1, a2, a3);
}

//----- (00003E3C) --------------------------------------------------------
int __fastcall log_hex(const char *a1, const unsigned __int8 *a2, int a3)
{
  return log_hex(a1, a2, a3);
}

//----- (00003E48) --------------------------------------------------------
int __fastcall blockingWrite_helper(int a1, void *a2, unsigned int a3)
{
  return blockingWrite_helper(a1, a2, a3);
}

//----- (00003E54) --------------------------------------------------------
_DWORD *__fastcall j_pb_istream_from_buffer(_DWORD *result, int a2, int a3)
{
  return pb_istream_from_buffer(result, a2, a3);
}

//----- (00003E60) --------------------------------------------------------
int __fastcall j_pb_decode(int a1, int a2, int a3)
{
  return pb_decode(a1, a2, a3);
}

//----- (00003E6C) --------------------------------------------------------
void __fastcall RilSapSocket::dispatchDisconnect(int a1, int a2)
{
  RilSapSocket::dispatchDisconnect(a1, a2);
}

//----- (00003E78) --------------------------------------------------------
int __fastcall RilSapSocket::sendDisconnect(RilSapSocket *this)
{
  return RilSapSocket::sendDisconnect(this);
}

//----- (00003E90) --------------------------------------------------------
void __fastcall RilSapSocket::sOnRequestComplete(_DWORD *a1, int a2, int a3, unsigned int a4)
{
  RilSapSocket::sOnRequestComplete(a1, a2, a3, a4);
}

//----- (00003E9C) --------------------------------------------------------
RilSapSocket *__fastcall RilSapSocket::sOnUnsolicitedResponse(RilSapSocket *this, int a2, const void *a3, unsigned int a4)
{
  return RilSapSocket::sOnUnsolicitedResponse(this, a2, a3, a4);
}

//----- (00003EA8) --------------------------------------------------------
int j_RIL_requestTimedCallback()
{
  return RIL_requestTimedCallback();
}
// 5E14: using guessed type int RIL_requestTimedCallback(void);

//----- (00003EB4) --------------------------------------------------------
int __fastcall RilSapSocket::pushRecord(RilSapSocket *this, void *a2, unsigned int a3)
{
  return RilSapSocket::pushRecord(this, a2, a3);
}

//----- (00003EC0) --------------------------------------------------------
void __fastcall __noreturn RilSapSocket::processRequestsLoop(RilSapSocket *this)
{
  RilSapSocket::processRequestsLoop(this);
}

//----- (00003ECC) --------------------------------------------------------
int __fastcall RilSapSocket::onCommandsSocketClosed(RilSapSocket *this)
{
  return RilSapSocket::onCommandsSocketClosed(this);
}

//----- (00003ED8) --------------------------------------------------------
int __fastcall j_pb_read(int a1, int a2, int a3)
{
  return pb_read(a1, a2, a3);
}

//----- (00003EE4) --------------------------------------------------------
int __fastcall j_pb_skip_field(int a1, int a2)
{
  return pb_skip_field(a1, a2);
}

//----- (00003EF0) --------------------------------------------------------
signed int __fastcall j_pb_make_string_substream(int a1, _QWORD *a2)
{
  return pb_make_string_substream(a1, a2);
}

//----- (00003F08) --------------------------------------------------------
int __fastcall j_pb_decode_noinit(int a1, unsigned __int8 *a2, int a3)
{
  return pb_decode_noinit(a1, a2, a3);
}

//----- (00003F14) --------------------------------------------------------
int __fastcall j_pb_release(int a1, int a2)
{
  return pb_release(a1, a2);
}

//----- (00003F20) --------------------------------------------------------
signed int __fastcall j_pb_decode_varint(int a1, _DWORD *a2)
{
  return pb_decode_varint(a1, a2);
}

//----- (00003F2C) --------------------------------------------------------
signed int __fastcall j_pb_encode_tag_for_field(int a1, unsigned __int8 *a2)
{
  return pb_encode_tag_for_field(a1, a2);
}

//----- (00003F38) --------------------------------------------------------
signed int __fastcall j_pb_encode_varint(int a1, int a2, __int64 a3)
{
  return pb_encode_varint(a1, a2, a3);
}

//----- (00003F44) --------------------------------------------------------
signed int __fastcall j_pb_encode_submessage(int a1, unsigned __int8 *a2, int *a3)
{
  return pb_encode_submessage(a1, a2, a3);
}

//----- (00003F50) --------------------------------------------------------
signed int __fastcall j_pb_encode_string(int a1, int a2, int a3)
{
  return pb_encode_string(a1, a2, a3);
}

//----- (00003F80) --------------------------------------------------------
int sub_3F80()
{
  return _cxa_finalize(&off_15000);
}
// 3860: using guessed type int __fastcall _cxa_finalize(_DWORD);
// 15000: using guessed type void *off_15000;

//----- (00003FA0) --------------------------------------------------------
int (*__fastcall sub_3FA0(int (*result)(void)))(void)
{
  if ( result )
    result = (int (*)(void))result();
  return result;
}

//----- (00004060) --------------------------------------------------------
char *__fastcall RIL_setRilSocketName(const char *a1)
{
  return j_strncpy(rild, a1, 6u);
}

//----- (00004078) --------------------------------------------------------
int RIL_startEventLoop()
{
  int v0; // r0
  char *v1; // r0
  pthread_attr_t attr; // [sp+4h] [bp-2Ch]

  byte_156F4 = 0;
  pthread_mutex_lock((pthread_mutex_t *)&unk_156F8);
  pthread_attr_init(&attr);
  pthread_attr_setdetachstate(&attr, 1);
  v0 = pthread_create((pthread_t *)&dword_156FC, &attr, (void *(*)(void *))sub_4144, 0);
  if ( v0 )
  {
    v1 = strerror(v0);
    _android_log_buf_print(1, 6, "RILC", "Failed to create dispatch thread: %s", v1);
  }
  else if ( !byte_156F4 )
  {
    do
      pthread_cond_wait((pthread_cond_t *)&unk_15700, (pthread_mutex_t *)&unk_156F8);
    while ( byte_156F4 != 1 );
  }
  pthread_mutex_unlock((pthread_mutex_t *)&unk_156F8);
  return _stack_chk_guard - *(&attr.__align + 6);
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 4144: using guessed type int sub_4144();
// 156F4: using guessed type char byte_156F4;
// 156FC: using guessed type int dword_156FC;

//----- (00004144) --------------------------------------------------------
int sub_4144()
{
  int v0; // r0
  _DWORD *v1; // r0
  _DWORD *v2; // r0
  int result; // r0
  int pipedes[2]; // [sp+4h] [bp-1Ch]
  int v5; // [sp+Ch] [bp-14h]

  ril_event_init();
  pthread_mutex_lock((pthread_mutex_t *)&unk_156F8);
  byte_156F4 = 1;
  pthread_cond_broadcast((pthread_cond_t *)&unk_15700);
  pthread_mutex_unlock((pthread_mutex_t *)&unk_156F8);
  if ( pipe(pipedes) <= -1 )
  {
    v2 = (_DWORD *)((int (*)(void))_errno)();
    _android_log_buf_print(1, 6, "RILC", "Error in pipe() errno:%d", *v2);
  }
  else
  {
    dword_157A8 = pipedes[1];
    dword_157A4 = pipedes[0];
    fcntl(pipedes[0], 4, 2048);
    ril_event_set((int)&unk_157AC, dword_157A4, 1, (int)sub_6630, 0);
    ril_event_add((int)&unk_157AC);
    sub_A35C();
    v0 = ril_event_loop();
    v1 = (_DWORD *)_errno(v0);
    _android_log_buf_print(1, 6, "RILC", "error in event_loop_base errno:%d", *v1);
    kill(0, 9);
  }
  result = _stack_chk_guard - v5;
  if ( _stack_chk_guard == v5 )
    result = 0;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 4144: using guessed type int sub_4144();
// 156F4: using guessed type char byte_156F4;
// 157A4: using guessed type int dword_157A4;
// 157A8: using guessed type int dword_157A8;

//----- (00004248) --------------------------------------------------------
__int64 *__fastcall RIL_setcallbacks(__int64 *a1)
{
  __int64 *result; // r0
  __int64 v2; // d16
  __int64 v3; // d17
  __int64 v4; // d18

  v2 = *a1;
  v3 = a1[1];
  result = a1 + 2;
  v4 = *result;
  *(_QWORD *)&android::s_callbacks = v2;
  *(_QWORD *)&dword_156E0 = v3;
  unk_156E8 = v4;
  return result;
}
// 156D8: using guessed type int android::s_callbacks;
// 156E0: using guessed type int (*dword_156E0)(void);

//----- (00004264) --------------------------------------------------------
int __fastcall RIL_register(_DWORD *a1)
{
  _DWORD *v1; // r4
  __int64 v2; // d16
  __int64 v3; // d17
  __int64 v4; // d18
  int v5; // r4
  int v6; // r0
  signed int v7; // r1
  int v8; // r1
  int v9; // r0
  bool v10; // vf
  signed int v11; // r1
  double *v12; // r4
  char *v13; // r0
  const char *v14; // r6
  int *v15; // r5
  signed int v16; // r6
  unsigned int v17; // r0
  char *v18; // r0
  signed int v19; // r0
  int v20; // r0
  int result; // r0
  char *v22; // r0
  const char *v23; // r3
  int v24; // [sp+0h] [bp-70h]
  int v25; // [sp+4h] [bp-6Ch]
  double v26; // [sp+8h] [bp-68h]
  int v27; // [sp+10h] [bp-60h]
  char v28; // [sp+14h] [bp-5Ch]
  int v29; // [sp+54h] [bp-1Ch]

  v1 = a1;
  _android_log_buf_print(1, 4, "RILC", "SIM_COUNT: %d", 1);
  if ( !v1 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register: RIL_RadioFunctions * null");
    goto LABEL_30;
  }
  if ( *v1 <= 5 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register: version %d is to old, min version is %d", *v1, 6);
    goto LABEL_30;
  }
  _android_log_buf_print(1, 6, "RILC", "RIL_register: RIL version %d", *v1);
  if ( byte_15704 == 1 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register has been called more than once. Subsequent call ignored");
    goto LABEL_30;
  }
  v2 = *(_QWORD *)v1;
  v3 = *((_QWORD *)v1 + 1);
  v4 = *((_QWORD *)v1 + 2);
  v5 = 0;
  *(_QWORD *)&android::s_callbacks = v2;
  *(_QWORD *)&dword_156E0 = v3;
  unk_156E8 = v4;
  dword_15708 = 0;
  dword_1570C = -1;
  dword_15710 = -1;
  unk_15714 = "radio";
  unk_15718 = &unk_1572C;
  dword_1571C = (int)&unk_15750;
  unk_15720 = sub_4628;
  unk_15724 = 0;
  unk_15728 = 0;
  byte_15704 = 1;
  _android_log_buf_print(1, 4, "RILC", "s_registerCalled flag set, %d", (unsigned __int8)byte_156F4);
  do
  {
    v6 = v5 + 1;
    v7 = 1;
    if ( v5 + 1 > v5 )
      v7 = 0;
    if ( v7 )
      goto LABEL_31;
    ++v5;
  }
  while ( v6 < 142 );
  v8 = 0;
  do
  {
    v9 = v8 + 1;
    v10 = v8 + 1 <= v8;
    v11 = 1;
    if ( !v10 )
      v11 = 0;
    if ( v11 )
      goto LABEL_31;
    v8 = v9;
  }
  while ( v9 < 49 );
  if ( !byte_156F4 )
    j_RIL_startEventLoop();
  v26 = 0.0;
  v12 = &v26;
  LOWORD(v27) = 0;
  _strncpy_chk2(&v26, rild, 9, 10, 6);
  _android_log_buf_print(1, 4, "RILC", "Start to listen %s", "RIL_SOCKET_1");
  _snprintf_chk(&v28, 64, 0, 64, "ANDROID_SOCKET_%s", &v26);
  v13 = getenv(&v28);
  v14 = v13;
  if ( !v13 || (v15 = (int *)_errno(v13), *v15 = 0, v16 = strtol(v14, 0, 10), *v15) || v16 <= -1 )
  {
    _android_log_buf_print(1, 6, "RILC", "Failed to get socket %s", &v26, v25);
    goto LABEL_39;
  }
  if ( listen(v16, 4) <= -1 )
  {
    v22 = strerror(*v15);
    v24 = v16;
    v23 = "Failed to listen on control socket '%d': %s";
LABEL_38:
    _android_log_buf_print(1, 6, "RILC", v23, v24, v22);
LABEL_39:
    exit(-1);
  }
  dword_1570C = v16;
  ril_event_set(dword_1571C, v16, 0, (int)listenCallback_helper, (int)&dword_15708);
  ril_event_add(dword_1571C);
  sub_A35C();
  v17 = _strlen_chk(rild, 6);
  v27 = 26485;
  v26 = *(double *)"rild-debug";
  if ( v17 >= 4 )
    _strlcat_chk(&v26, &rild[4], 12, 12);
  _snprintf_chk(&v28, 64, 0, 64, "ANDROID_SOCKET_%s", &v26, v26, v27);
  v18 = getenv(&v28);
  if ( !v18 || (*v15 = 0, v19 = strtol(v18, 0, 10), *v15) )
  {
    dword_15018 = -1;
    goto LABEL_34;
  }
  dword_15018 = v19;
  if ( v19 <= -1 )
  {
LABEL_34:
    v22 = (char *)*v15;
    v23 = "Failed to get socket : %s errno:%d";
LABEL_37:
    v24 = (int)v12;
    goto LABEL_38;
  }
  v20 = listen(v19, 4);
  v12 = (double *)dword_15018;
  if ( v20 <= -1 )
  {
    v22 = strerror(*v15);
    v23 = "Failed to listen on ril debug socket '%d': %s";
    goto LABEL_37;
  }
  ril_event_set((int)&unk_15774, dword_15018, 1, (int)sub_4870, 0);
  ril_event_add((int)&unk_15774);
  sub_A35C();
LABEL_30:
  result = _stack_chk_guard - v29;
  if ( _stack_chk_guard != v29 )
LABEL_31:
    abort();
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 3980: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 39BC: using guessed type int __fastcall _strlcat_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 15018: using guessed type int dword_15018;
// 156D8: using guessed type int android::s_callbacks;
// 156E0: using guessed type int (*dword_156E0)(void);
// 156F4: using guessed type char byte_156F4;
// 15704: using guessed type char byte_15704;
// 15708: using guessed type int dword_15708;
// 1570C: using guessed type int dword_1570C;
// 15710: using guessed type int dword_15710;
// 1571C: using guessed type int dword_1571C;

//----- (00004628) --------------------------------------------------------
int __fastcall sub_4628(int a1, int a2, int *a3)
{
  int v3; // r10
  int v4; // r0
  const unsigned __int8 *v5; // r11
  signed int v6; // r2
  signed int v7; // r1
  const char *v8; // r6
  unsigned int v9; // r5
  int v10; // r9
  int v11; // r5
  const char *v12; // r11
  int v13; // r5
  unsigned int v14; // r0
  _DWORD *v15; // r6
  __int64 v16; // r0
  const char *v17; // r0
  signed int v18; // r2
  signed int v19; // r1
  const char *v20; // r3
  int *v21; // r0
  bool v22; // zf
  int v24; // [sp+0h] [bp-C0h]
  int fd; // [sp+18h] [bp-A8h]
  int *v26; // [sp+1Ch] [bp-A4h]
  char v27; // [sp+20h] [bp-A0h]
  const unsigned __int8 *v28; // [sp+24h] [bp-9Ch]
  char v29; // [sp+28h] [bp-98h]
  int v30; // [sp+5Ch] [bp-64h]
  int v31; // [sp+60h] [bp-60h]
  char v32; // [sp+64h] [bp-5Ch]
  int v33; // [sp+98h] [bp-28h]

  fd = a1;
  v26 = a3;
  v3 = a3[7];
  v4 = record_stream_get_next(v3, &v28, &v27);
  v5 = v28;
  v6 = 0;
  v7 = 0;
  if ( !v4 )
    v7 = 1;
  if ( !(v4 | (unsigned int)v28) )
    v6 = 1;
  if ( v4 >= 0 && !v6 )
  {
    v8 = "RILC";
    do
    {
      if ( v7 & 1 )
      {
        v9 = *(_DWORD *)&v27;
        v10 = *v26;
        android::Parcel::Parcel((android::Parcel *)&v32);
        android::Parcel::setData((android::Parcel *)&v32, v5, v9);
        android::Parcel::readInt32((android::Parcel *)&v32, &v31);
        if ( android::Parcel::readInt32((android::Parcel *)&v32, &v30) )
        {
          _android_log_buf_print(1, 6, v8, "invalid request block");
        }
        else
        {
          v11 = v31;
          if ( v31 == 800 )
          {
            sub_5D7C();
          }
          else
          {
            v12 = v8;
            if ( (unsigned int)(v31 - 1) < 0x8D )
            {
              v15 = calloc(1u, 0x18u);
              if ( v15 )
              {
                LODWORD(v16) = v30;
                HIDWORD(v16) = (char *)&unk_1501C + 12 * v11;
                v15[4] = v10;
                *(_QWORD *)v15 = v16;
                pthread_mutex_lock((pthread_mutex_t *)&unk_157D0);
                v15[2] = dword_157D4;
                dword_157D4 = (int)v15;
                pthread_mutex_unlock((pthread_mutex_t *)&unk_157D0);
                (*(void (__fastcall **)(char *, _DWORD *))(v15[1] + 4))(&v32, v15);
                v8 = v12;
              }
              else
              {
                v17 = j_requestToString(v11);
                v8 = v12;
                _android_log_buf_print(1, 6, v12, "Memory allocation failed for request %s", v17);
              }
            }
            else
            {
              android::Parcel::Parcel((android::Parcel *)&v29);
              _android_log_buf_print(1, 6, v8, "unsupported request code %d token %d", v31, v30);
              android::Parcel::writeInt32((android::Parcel *)&v29, 0);
              android::Parcel::writeInt32((android::Parcel *)&v29, v30);
              android::Parcel::writeInt32((android::Parcel *)&v29, 2);
              v13 = android::Parcel::data((android::Parcel *)&v29);
              v14 = android::Parcel::dataSize((android::Parcel *)&v29);
              sub_A3A0(v13, v14);
              android::Parcel::~Parcel((android::Parcel *)&v29);
            }
          }
        }
        android::Parcel::~Parcel((android::Parcel *)&v32);
      }
      v4 = record_stream_get_next(v3, &v28, &v27);
      v5 = v28;
      v7 = 0;
      if ( !v4 )
        v7 = 1;
      v18 = 0;
      if ( !(v4 | (unsigned int)v28) )
        v18 = 1;
    }
    while ( v4 >= 0 && v18 != 1 );
  }
  if ( v7 )
  {
    v19 = 5;
    v20 = "EOS.  Closing command socket.";
LABEL_31:
    _android_log_buf_print(1, v19, "RILC", v20, v24);
    close(fd);
    v26[2] = -1;
    ril_event_del(v26[4]);
    record_stream_free(v3);
    ril_event_add((int)&unk_15750);
    sub_A35C();
    sub_6688();
    return _stack_chk_guard - v33;
  }
  v21 = (int *)_errno(v4);
  v22 = *v21 == 11;
  if ( *v21 != 11 )
    v22 = *v21 == 4;
  if ( !v22 )
  {
    v19 = 6;
    v24 = *v21;
    v20 = "error on reading command socket errno:%d\n";
    goto LABEL_31;
  }
  return _stack_chk_guard - v33;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 39E0: using guessed type int __fastcall record_stream_get_next(_DWORD, _DWORD, _DWORD);
// 3A70: using guessed type int __fastcall record_stream_free(_DWORD);
// 157D4: using guessed type int dword_157D4;

//----- (00004870) --------------------------------------------------------
int __fastcall sub_4870(int a1)
{
  int v1; // r4
  int v2; // r0
  int v3; // r10
  signed int v4; // r4
  const char **v5; // r8
  const char *v6; // r7
  int v7; // r6
  int v8; // r5
  signed int v9; // r1
  const char *v10; // r4
  int v11; // r0
  int v12; // r0
  signed int v13; // r1
  int v14; // r0
  _DWORD *v15; // r0
  const char *v16; // r3
  const char *v17; // r3
  int v18; // r0
  void **v19; // r0
  __int64 v20; // d17
  int v21; // r4
  int *v22; // r1
  int v23; // r0
  int result; // r0
  int v25; // [sp+10h] [bp-D8h]
  size_t nmemb; // [sp+14h] [bp-D4h]
  const char *v27; // [sp+18h] [bp-D0h]
  int v28; // [sp+1Ch] [bp-CCh]
  int v29; // [sp+24h] [bp-C4h]
  socklen_t addr_len; // [sp+28h] [bp-C0h]
  int v31; // [sp+2Ch] [bp-BCh]
  int v32; // [sp+30h] [bp-B8h]
  const char *v33; // [sp+34h] [bp-B4h]
  __int64 v34; // [sp+38h] [bp-B0h]
  __int64 v35; // [sp+40h] [bp-A8h]
  int v36; // [sp+48h] [bp-A0h]
  int v37; // [sp+4Ch] [bp-9Ch]
  struct sockaddr addr; // [sp+50h] [bp-98h]
  int v39; // [sp+C0h] [bp-28h]

  v1 = a1;
  addr_len = 110;
  v33 = "1";
  v31 = 1;
  _android_log_buf_print(1, 4, "RILC", "debugCallback for socket %s", "RIL_SOCKET_1");
  v2 = accept(v1, &addr, &addr_len);
  v3 = v2;
  if ( v2 <= -1 )
  {
    v15 = (_DWORD *)_errno(v2);
    _android_log_buf_print(1, 6, "RILC", "error accepting on debug port: %d\n", *v15);
    goto LABEL_50;
  }
  if ( _recvfrom_chk(v2, &nmemb, 4) == 4 )
  {
    v4 = nmemb;
    if ( (signed int)nmemb <= -1 )
    {
      v16 = "Invalid number of arguments: \n";
    }
    else
    {
      v5 = (const char **)calloc(nmemb, 4u);
      if ( v5 )
      {
        v6 = 0;
        if ( v4 < 1 )
        {
LABEL_20:
          switch ( atoi(v6) )
          {
            case 0:
              _android_log_buf_print(1, 4, "RILC", "Connection on debug port: issuing reset.");
              v14 = 58;
              goto LABEL_44;
            case 1:
              _android_log_buf_print(1, 4, "RILC", "Connection on debug port: issuing radio power off.");
              v29 = 0;
              sub_A2A0(23, (int)&v29, 4);
              if ( dword_15710 >= 1 )
              {
                close(dword_15710);
                dword_15710 = -1;
              }
              break;
            case 2:
              _android_log_buf_print(1, 4, "RILC", "Debug port: issuing unsolicited voice network change.");
              j_RIL_onUnsolicitedResponse(1002, 0, 0);
              break;
            case 3:
              _android_log_buf_print(1, 4, "RILC", "Debug port: QXDM log enable.");
              v19 = &off_4BD0;
              goto LABEL_38;
            case 4:
              _android_log_buf_print(1, 4, "RILC", "Debug port: QXDM log disable.");
              v19 = &off_4BC0;
LABEL_38:
              v20 = *((_QWORD *)v19 + 1);
              v34 = *(_QWORD *)v19;
              v35 = v20;
              v36 = 0;
              v37 = 8;
              sub_A2A0(59, (int)&v34, 24);
              break;
            case 5:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Radio On");
              v29 = 1;
              sub_A2A0(23, (int)&v29, 4);
              sleep(2u);
              v14 = 46;
              goto LABEL_44;
            case 6:
              v21 = (int)v5[1];
              _android_log_buf_print(1, 4, "RILC", "Debug port: Setup Data Call, Apn :%s\n", v5[1]);
              v32 = v21;
              v22 = &v32;
              v23 = 27;
              goto LABEL_46;
            case 7:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Deactivate Data Call");
              v22 = (int *)&v33;
              v23 = 41;
              goto LABEL_46;
            case 8:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Dial Call");
              v28 = 0;
              v27 = v5[1];
              sub_A2A0(10, (int)&v27, 12);
              break;
            case 9:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Answer Call");
              v14 = 40;
LABEL_44:
              sub_A2A0(v14, 0, 0);
              break;
            case 10:
              _android_log_buf_print(1, 4, "RILC", "Debug port: End Call");
              v22 = &v31;
              v23 = 12;
LABEL_46:
              sub_A2A0(v23, (int)v22, 4);
              break;
            default:
              _android_log_buf_print(1, 6, "RILC", "Invalid request");
              break;
          }
          v18 = nmemb;
        }
        else
        {
          v7 = 0;
          while ( 1 )
          {
            if ( _recvfrom_chk(v3, &v25, 4) != 4 )
            {
              v17 = "error reading on socket: Len of Args: \n";
              goto LABEL_31;
            }
            v8 = v25;
            if ( v25 == 0x7FFFFFFF || v25 <= -1 )
            {
              v17 = "Invalid value of len: \n";
              goto LABEL_31;
            }
            v9 = 1;
            if ( v25 + 1 > v25 )
              v9 = 0;
            if ( v9 )
              goto LABEL_51;
            v10 = (const char *)calloc(v25 + 1, 1u);
            v5[v7] = v10;
            if ( !v10 )
            {
              v17 = "Memory allocation failed for debug args";
              goto LABEL_31;
            }
            v11 = _recvfrom_chk(v3, v10, v8);
            if ( v11 != v25 )
              break;
            v10[v11] = 0;
            v12 = v7 + 1;
            v13 = 1;
            if ( v7 + 1 > v7 )
              v13 = 0;
            if ( v13 )
              goto LABEL_51;
            ++v7;
            if ( v12 >= (signed int)nmemb )
            {
              v6 = *v5;
              goto LABEL_20;
            }
          }
          v17 = "error reading on socket: Args[%d] \n";
LABEL_31:
          _android_log_buf_print(1, 6, "RILC", v17);
          v18 = v7;
        }
        sub_A268(v18, v5);
        goto LABEL_49;
      }
      v16 = "Memory allocation failed for debug args";
    }
  }
  else
  {
    v16 = "error reading on socket: number of Args: \n";
  }
  _android_log_buf_print(1, 6, "RILC", v16);
LABEL_49:
  close(v3);
LABEL_50:
  result = _stack_chk_guard - v39;
  if ( _stack_chk_guard != v39 )
LABEL_51:
    abort();
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 3A88: using guessed type int __cdecl _recvfrom_chk(_DWORD, _DWORD, _DWORD);
// 4BC0: using guessed type void *off_4BC0;
// 4BD0: using guessed type void *off_4BD0;
// 15710: using guessed type int dword_15710;

//----- (00004CA0) --------------------------------------------------------
int (__fastcall *__fastcall RIL_register_socket(int (__fastcall *result)(void **, int, int), int a2, int a3, int a4))(void **, int, int)
{
  int v4; // r5

  v4 = a2;
  if ( result )
  {
    result = (int (__fastcall *)(void **, int, int))result(&RilSapSocket::uimRilEnv, a3, a4);
    if ( v4 == 1 )
      result = (int (__fastcall *)(void **, int, int))j_RilSapSocket::initSapSocket(
                                                        "sap_uim_socket1",
                                                        (pthread_mutexattr_t)result);
  }
  return result;
}
// 156C4: using guessed type void *RilSapSocket::uimRilEnv;

//----- (00004CD0) --------------------------------------------------------
int __fastcall RIL_onRequestAck(int a1)
{
  int v1; // r4
  signed int v2; // r6
  int v3; // r5
  unsigned int v4; // r0
  int v6; // [sp+0h] [bp-48h]
  int v7; // [sp+34h] [bp-14h]

  v1 = a1;
  if ( sub_4D8C(a1, 1) )
  {
    if ( !*(_BYTE *)(v1 + 12) )
    {
      v2 = dword_15710;
      android::Parcel::Parcel((android::Parcel *)&v6);
      android::Parcel::writeInt32((android::Parcel *)&v6, 2);
      android::Parcel::writeInt32((android::Parcel *)&v6, *(_DWORD *)v1);
      if ( v2 <= -1 )
        _android_log_buf_print(1, 3, "RILC", "RIL onRequestComplete: Command channel closed");
      v3 = android::Parcel::data((android::Parcel *)&v6);
      v4 = android::Parcel::dataSize((android::Parcel *)&v6);
      sub_A3A0(v3, v4);
      android::Parcel::~Parcel((android::Parcel *)&v6);
    }
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_onRequestAck: invalid RIL_Token");
  }
  return _stack_chk_guard - v7;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 15710: using guessed type int dword_15710;

//----- (00004D8C) --------------------------------------------------------
signed int __fastcall sub_4D8C(int a1, int a2)
{
  int v2; // r4
  int v3; // r5
  int *v4; // r0
  int i; // r1
  const char *v6; // r0
  signed int v7; // r5

  v2 = a1;
  v3 = a2;
  if ( !a1 )
    return 0;
  pthread_mutex_lock((pthread_mutex_t *)&unk_157D0);
  v4 = &dword_157D4;
  for ( i = dword_157D4; ; i = *(_DWORD *)(i + 8) )
  {
    if ( !i )
    {
      v7 = 0;
      goto LABEL_13;
    }
    if ( i == v2 )
      break;
    v4 = (int *)(i + 8);
  }
  if ( v3 == 1 )
  {
    if ( *(_DWORD *)(v2 + 20) == 1 )
    {
      v6 = j_requestToString(**(_DWORD **)(v2 + 4));
      v7 = 1;
      _android_log_buf_print(1, 3, "RILC", "Ack was already sent for %s", v6);
    }
    else
    {
      v7 = 1;
      *(_DWORD *)(v2 + 20) = 1;
    }
  }
  else
  {
    v7 = 1;
    *v4 = *(_DWORD *)(v2 + 8);
  }
LABEL_13:
  pthread_mutex_unlock((pthread_mutex_t *)&unk_157D0);
  return v7;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 157D4: using guessed type int dword_157D4;

//----- (00004E14) --------------------------------------------------------
int __fastcall RIL_onRequestComplete(int a1, int a2, int a3, int a4)
{
  int v4; // r4
  int v5; // r7
  int v6; // r5
  int v7; // r6
  const char *v8; // r0
  signed int v9; // r10
  unsigned int v10; // r8
  int v11; // r5
  int v12; // r6
  unsigned int v13; // r0
  char v15; // [sp+8h] [bp-58h]
  int v16; // [sp+3Ch] [bp-24h]

  v4 = a1;
  v5 = a2;
  v6 = a4;
  v7 = a3;
  if ( sub_4D8C(a1, 0) )
  {
    if ( *(_BYTE *)(v4 + 13) )
    {
      v8 = j_requestToString(**(_DWORD **)(v4 + 4));
      _android_log_buf_print(1, 3, "RILC", "C[locl]< %s", v8);
    }
    else if ( !*(_BYTE *)(v4 + 12) )
    {
      v9 = dword_15710;
      android::Parcel::Parcel((android::Parcel *)&v15);
      if ( android::s_callbacks < 13 || *(_DWORD *)(v4 + 20) != 1 )
      {
        android::Parcel::writeInt32((android::Parcel *)&v15, 0);
      }
      else
      {
        android::Parcel::writeInt32((android::Parcel *)&v15, 3);
        sub_58D4();
      }
      android::Parcel::writeInt32((android::Parcel *)&v15, *(_DWORD *)v4);
      v10 = android::Parcel::dataPosition((android::Parcel *)&v15);
      android::Parcel::writeInt32((android::Parcel *)&v15, v5);
      if ( v7 )
      {
        v11 = (*(int (__fastcall **)(char *, int, int))(*(_DWORD *)(v4 + 4) + 8))(&v15, v7, v6);
        if ( v11 )
        {
          _android_log_buf_print(1, 6, "RILC", "responseFunction error, ret %d", v11);
          android::Parcel::setDataPosition((android::Parcel *)&v15, v10);
          android::Parcel::writeInt32((android::Parcel *)&v15, v11);
        }
      }
      if ( v9 <= -1 )
        _android_log_buf_print(1, 3, "RILC", "RIL onRequestComplete: Command channel closed");
      v12 = android::Parcel::data((android::Parcel *)&v15);
      v13 = android::Parcel::dataSize((android::Parcel *)&v15);
      sub_A3A0(v12, v13);
      android::Parcel::~Parcel((android::Parcel *)&v15);
    }
    free((void *)v4);
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_onRequestComplete: invalid RIL_Token");
  }
  return _stack_chk_guard - v16;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 156D8: using guessed type int android::s_callbacks;
// 15710: using guessed type int dword_15710;

//----- (00004F80) --------------------------------------------------------
const char *__fastcall requestToString(int a1)
{
  int v1; // r1
  const char *result; // r0

  v1 = a1 - 1;
  result = "GET_SIM_STATUS";
  switch ( v1 )
  {
    case 0:
      return result;
    case 1:
      result = "ENTER_SIM_PIN";
      break;
    case 2:
      result = "ENTER_SIM_PUK";
      break;
    case 3:
      result = "ENTER_SIM_PIN2";
      break;
    case 4:
      result = "ENTER_SIM_PUK2";
      break;
    case 5:
      result = "CHANGE_SIM_PIN";
      break;
    case 6:
      result = "CHANGE_SIM_PIN2";
      break;
    case 7:
      result = "ENTER_NETWORK_DEPERSONALIZATION";
      break;
    case 8:
      result = "GET_CURRENT_CALLS";
      break;
    case 9:
      result = "DIAL";
      break;
    case 10:
      result = "GET_IMSI";
      break;
    case 11:
      result = "HANGUP";
      break;
    case 12:
      result = "HANGUP_WAITING_OR_BACKGROUND";
      break;
    case 13:
      result = "HANGUP_FOREGROUND_RESUME_BACKGROUND";
      break;
    case 14:
      result = "SWITCH_WAITING_OR_HOLDING_AND_ACTIVE";
      break;
    case 15:
      result = "CONFERENCE";
      break;
    case 16:
      result = "UDUB";
      break;
    case 17:
      result = "LAST_CALL_FAIL_CAUSE";
      break;
    case 18:
      result = "SIGNAL_STRENGTH";
      break;
    case 19:
      result = "VOICE_REGISTRATION_STATE";
      break;
    case 20:
      result = "DATA_REGISTRATION_STATE";
      break;
    case 21:
      result = "OPERATOR";
      break;
    case 22:
      result = "RADIO_POWER";
      break;
    case 23:
      result = "DTMF";
      break;
    case 24:
      result = "SEND_SMS";
      break;
    case 25:
      result = "SEND_SMS_EXPECT_MORE";
      break;
    case 26:
      result = "SETUP_DATA_CALL";
      break;
    case 27:
      result = "SIM_IO";
      break;
    case 28:
      result = "SEND_USSD";
      break;
    case 29:
      result = "CANCEL_USSD";
      break;
    case 30:
      result = "GET_CLIR";
      break;
    case 31:
      result = "SET_CLIR";
      break;
    case 32:
      result = "QUERY_CALL_FORWARD_STATUS";
      break;
    case 33:
      result = "SET_CALL_FORWARD";
      break;
    case 34:
      result = "QUERY_CALL_WAITING";
      break;
    case 35:
      result = "SET_CALL_WAITING";
      break;
    case 36:
      result = "SMS_ACKNOWLEDGE";
      break;
    case 37:
      result = "GET_IMEI";
      break;
    case 38:
      result = "GET_IMEISV";
      break;
    case 39:
      result = "ANSWER";
      break;
    case 40:
      result = "DEACTIVATE_DATA_CALL";
      break;
    case 41:
      result = "QUERY_FACILITY_LOCK";
      break;
    case 42:
      result = "SET_FACILITY_LOCK";
      break;
    case 43:
      result = "CHANGE_BARRING_PASSWORD";
      break;
    case 44:
      result = "QUERY_NETWORK_SELECTION_MODE";
      break;
    case 45:
      result = "SET_NETWORK_SELECTION_AUTOMATIC";
      break;
    case 46:
      result = "SET_NETWORK_SELECTION_MANUAL";
      break;
    case 47:
      result = "QUERY_AVAILABLE_NETWORKS ";
      break;
    case 48:
      result = "DTMF_START";
      break;
    case 49:
      result = "DTMF_STOP";
      break;
    case 50:
      result = "BASEBAND_VERSION";
      break;
    case 51:
      result = "SEPARATE_CONNECTION";
      break;
    case 52:
      result = "SET_MUTE";
      break;
    case 53:
      result = "GET_MUTE";
      break;
    case 54:
      result = "QUERY_CLIP";
      break;
    case 55:
      result = "LAST_DATA_CALL_FAIL_CAUSE";
      break;
    case 56:
      result = "DATA_CALL_LIST";
      break;
    case 57:
      result = "RESET_RADIO";
      break;
    case 58:
      result = "OEM_HOOK_RAW";
      break;
    case 59:
      result = "OEM_HOOK_STRINGS";
      break;
    case 60:
      result = "SCREEN_STATE";
      break;
    case 61:
    case 63:
    case 90:
    case 117:
    case 118:
    case 119:
    case 131:
    case 132:
    case 133:
    case 134:
LABEL_7:
      result = "<unknown request>";
      break;
    case 62:
      result = "WRITE_SMS_TO_SIM";
      break;
    case 64:
      result = "SET_BAND_MODE";
      break;
    case 65:
      result = "QUERY_AVAILABLE_BAND_MODE";
      break;
    case 66:
      result = "STK_GET_PROFILE";
      break;
    case 67:
      result = "STK_SET_PROFILE";
      break;
    case 68:
      result = "STK_SEND_ENVELOPE_COMMAND";
      break;
    case 69:
      result = "STK_SEND_TERMINAL_RESPONSE";
      break;
    case 70:
      result = "STK_HANDLE_CALL_SETUP_REQUESTED_FROM_SIM";
      break;
    case 71:
      result = "EXPLICIT_CALL_TRANSFER";
      break;
    case 72:
      result = "SET_PREFERRED_NETWORK_TYPE";
      break;
    case 73:
      result = "GET_PREFERRED_NETWORK_TYPE";
      break;
    case 74:
      result = "GET_NEIGHBORING_CELL_IDS";
      break;
    case 75:
      result = "SET_LOCATION_UPDATES";
      break;
    case 76:
      result = "CDMA_SET_SUBSCRIPTION_SOURCE";
      break;
    case 77:
      result = "CDMA_SET_ROAMING_PREFERENCE";
      break;
    case 78:
      result = "CDMA_QUERY_ROAMING_PREFERENCE";
      break;
    case 79:
      result = "SET_TTY_MODE";
      break;
    case 80:
      result = "QUERY_TTY_MODE";
      break;
    case 81:
      result = "CDMA_SET_PREFERRED_VOICE_PRIVACY_MODE";
      break;
    case 82:
      result = "CDMA_QUERY_PREFERRED_VOICE_PRIVACY_MODE";
      break;
    case 83:
      result = "CDMA_FLASH";
      break;
    case 84:
      result = "CDMA_BURST_DTMF";
      break;
    case 85:
      result = "CDMA_VALIDATE_AND_WRITE_AKEY";
      break;
    case 86:
      result = "CDMA_SEND_SMS";
      break;
    case 87:
      result = "CDMA_SMS_ACKNOWLEDGE";
      break;
    case 88:
      result = "GSM_GET_BROADCAST_SMS_CONFIG";
      break;
    case 89:
      result = "GSM_SET_BROADCAST_SMS_CONFIG";
      break;
    case 91:
      result = "CDMA_GET_BROADCAST_SMS_CONFIG";
      break;
    case 92:
      result = "CDMA_SET_BROADCAST_SMS_CONFIG";
      break;
    case 93:
      result = "CDMA_SMS_BROADCAST_ACTIVATION";
      break;
    case 94:
      result = "CDMA_SUBSCRIPTION";
      break;
    case 95:
      result = "CDMA_WRITE_SMS_TO_RUIM";
      break;
    case 96:
      result = "CDMA_DELETE_SMS_ON_RUIM";
      break;
    case 97:
      result = "DEVICE_IDENTITY";
      break;
    case 98:
      result = "EXIT_EMERGENCY_CALLBACK_MODE";
      break;
    case 99:
      result = "GET_SMSC_ADDRESS";
      break;
    case 100:
      result = "SET_SMSC_ADDRESS";
      break;
    case 101:
      result = "REPORT_SMS_MEMORY_STATUS";
      break;
    case 102:
      result = "REPORT_STK_SERVICE_IS_RUNNING";
      break;
    case 103:
      result = "CDMA_GET_SUBSCRIPTION_SOURCE";
      break;
    case 104:
      result = "ISIM_AUTHENTICATION";
      break;
    case 105:
      result = "RIL_REQUEST_ACKNOWLEDGE_INCOMING_GSM_SMS_WITH_PDU";
      break;
    case 106:
      result = "RIL_REQUEST_STK_SEND_ENVELOPE_WITH_STATUS";
      break;
    case 107:
      result = "VOICE_RADIO_TECH";
      break;
    case 108:
      result = "GET_CELL_INFO_LIST";
      break;
    case 109:
      result = "SET_UNSOL_CELL_INFO_LIST_RATE";
      break;
    case 110:
      result = "RIL_REQUEST_SET_INITIAL_ATTACH_APN";
      break;
    case 111:
      result = "IMS_REGISTRATION_STATE";
      break;
    case 112:
      result = "IMS_SEND_SMS";
      break;
    case 113:
      result = "SIM_TRANSMIT_APDU_BASIC";
      break;
    case 114:
      result = "SIM_OPEN_CHANNEL";
      break;
    case 115:
      result = "SIM_CLOSE_CHANNEL";
      break;
    case 116:
      result = "SIM_TRANSMIT_APDU_CHANNEL";
      break;
    case 120:
      result = "NV_RESET_CONFIG";
      break;
    case 121:
      result = "SET_UICC_SUBSCRIPTION";
      break;
    case 122:
      result = "ALLOW_DATA";
      break;
    case 123:
      result = "GET_HARDWARE_CONFIG";
      break;
    case 124:
      result = "SIM_AUTHENTICATION";
      break;
    case 125:
      result = "GET_DC_RT_INFO";
      break;
    case 126:
      result = "SET_DC_RT_INFO_RATE";
      break;
    case 127:
      result = "SET_DATA_PROFILE";
      break;
    case 128:
      result = "SHUTDOWN";
      break;
    case 129:
      result = "RIL_REQUEST_GET_RADIO_CAPABILITY";
      break;
    case 130:
      result = "RIL_REQUEST_SET_RADIO_CAPABILITY";
      break;
    case 135:
      result = "SET_CARRIER_RESTRICTIONS";
      break;
    case 136:
      result = "GET_CARRIER_RESTRICTIONS";
      break;
    case 137:
      result = "SIM_GET_ATR";
      break;
    case 138:
      result = "CAF_SIM_OPEN_CHANNEL_WITH_P2";
      break;
    case 139:
      result = "RIL_REQUEST_GET_ADN_RECORD";
      break;
    case 140:
      result = "RIL_REQUEST_UPDATE_ADN_RECORD";
      break;
    default:
      switch ( (unsigned int)"GET_SIM_STATUS" )
      {
        case 0x3E8u:
          return "UNSOL_RESPONSE_RADIO_STATE_CHANGED";
        case 0x3E9u:
          return "UNSOL_RESPONSE_CALL_STATE_CHANGED";
        case 0x3EAu:
          return "UNSOL_RESPONSE_VOICE_NETWORK_STATE_CHANGED";
        case 0x3EBu:
          return "UNSOL_RESPONSE_NEW_SMS";
        case 0x3ECu:
          return "UNSOL_RESPONSE_NEW_SMS_STATUS_REPORT";
        case 0x3EDu:
          return "UNSOL_RESPONSE_NEW_SMS_ON_SIM";
        case 0x3EEu:
          return "UNSOL_ON_USSD";
        case 0x3EFu:
          return "UNSOL_ON_USSD_REQUEST(obsolete)";
        case 0x3F0u:
          return "UNSOL_NITZ_TIME_RECEIVED";
        case 0x3F1u:
          return "UNSOL_SIGNAL_STRENGTH";
        case 0x3F2u:
          return "UNSOL_DATA_CALL_LIST_CHANGED";
        case 0x3F3u:
          return "UNSOL_SUPP_SVC_NOTIFICATION";
        case 0x3F4u:
          return "UNSOL_STK_SESSION_END";
        case 0x3F5u:
          return "UNSOL_STK_PROACTIVE_COMMAND";
        case 0x3F6u:
          return "UNSOL_STK_EVENT_NOTIFY";
        case 0x3F7u:
          return "UNSOL_STK_CALL_SETUP";
        case 0x3F8u:
          return "UNSOL_SIM_SMS_STORAGE_FUL";
        case 0x3F9u:
          return "UNSOL_SIM_REFRESH";
        case 0x3FAu:
          return "UNSOL_CALL_RING";
        case 0x3FBu:
          return "UNSOL_RESPONSE_SIM_STATUS_CHANGED";
        case 0x3FCu:
          return "UNSOL_NEW_CDMA_SMS";
        case 0x3FDu:
          return "UNSOL_NEW_BROADCAST_SMS";
        case 0x3FEu:
          return "UNSOL_CDMA_RUIM_SMS_STORAGE_FULL";
        case 0x3FFu:
          return "UNSOL_RESTRICTED_STATE_CHANGED";
        case 0x400u:
          return "UNSOL_ENTER_EMERGENCY_CALLBACK_MODE";
        case 0x401u:
          return "UNSOL_CDMA_CALL_WAITING";
        case 0x402u:
          return "UNSOL_CDMA_OTA_PROVISION_STATUS";
        case 0x403u:
          return "UNSOL_CDMA_INFO_REC";
        case 0x404u:
          return "UNSOL_OEM_HOOK_RAW";
        case 0x405u:
          return "UNSOL_RINGBACK_TONE";
        case 0x406u:
          return "UNSOL_RESEND_INCALL_MUTE";
        case 0x407u:
          return "UNSOL_CDMA_SUBSCRIPTION_SOURCE_CHANGED";
        case 0x408u:
          return "UNSOL_CDMA_PRL_CHANGED";
        case 0x409u:
          return "UNSOL_EXIT_EMERGENCY_CALLBACK_MODE";
        case 0x40Au:
          return "UNSOL_RIL_CONNECTED";
        case 0x40Bu:
          return "UNSOL_VOICE_RADIO_TECH_CHANGED";
        case 0x40Cu:
          return "UNSOL_CELL_INFO_LIST";
        case 0x40Du:
          return "RESPONSE_IMS_NETWORK_STATE_CHANGED";
        case 0x40Eu:
          return "UNSOL_UICC_SUBSCRIPTION_STATUS_CHANGED";
        case 0x40Fu:
          return "UNSOL_SRVCC_STATE_NOTIFY";
        case 0x410u:
          return "HARDWARE_CONFIG_CHANGED";
        case 0x411u:
          return "UNSOL_DC_RT_INFO_CHANGED";
        case 0x412u:
          return "RIL_UNSOL_RADIO_CAPABILITY";
        case 0x413u:
        case 0x414u:
        case 0x415u:
          goto LABEL_7;
        case 0x416u:
          return "RIL_UNSOL_PCO_DATA";
        case 0x417u:
          return "RIL_UNSOL_RESPONSE_ADN_INIT_DONE";
        case 0x418u:
          return "RIL_UNSOL_RESPONSE_ADN_RECORDS";
        default:
          if ( "GET_SIM_STATUS" != (char *)&stru_320 )
            goto LABEL_7;
          result = "RIL_RESPONSE_ACKNOWLEDGEMENT";
          break;
      }
      break;
  }
  return result;
}
// 320: using guessed type Elf32_Sym;

//----- (000058D4) --------------------------------------------------------
int sub_58D4()
{
  signed int v0; // r4
  int v1; // r0

  if ( android::s_callbacks < 13 )
    return j_acquire_wake_lock(1, (int)"radio-interface");
  pthread_mutex_lock((pthread_mutex_t *)&unk_157DC);
  v0 = 1;
  acquire_wake_lock(1, "radio-interface");
  v1 = RIL_requestTimedCallback_0((int)&loc_5D2C + 1, 0, (__int64 *)&unk_131E4);
  if ( v1 )
  {
    if ( android::s_wakelock_count + 1 > android::s_wakelock_count )
      v0 = 0;
    if ( v0 )
      abort();
    ++android::s_wakelock_count;
    if ( dword_15798 )
      *(_DWORD *)(dword_15798 + 4) = 1;
    dword_15798 = v1;
  }
  else
  {
    release_wake_lock("radio-interface");
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_157DC);
}
// 3AE8: using guessed type int __fastcall acquire_wake_lock(_DWORD, _DWORD);
// 3AF4: using guessed type int __fastcall release_wake_lock(_DWORD);
// 156D8: using guessed type int android::s_callbacks;
// 156F0: using guessed type int android::s_wakelock_count;
// 15798: using guessed type int dword_15798;

//----- (0000598C) --------------------------------------------------------
int __fastcall RIL_onUnsolicitedResponse(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r6
  int v5; // r11
  android *v6; // r0
  int v7; // r5
  bool v8; // zf
  signed int v9; // r10
  int v10; // r1
  __int64 v11; // r8
  bool v12; // zf
  int v13; // r1
  int v14; // r1
  int v15; // r5
  int v16; // r6
  int v17; // r0
  int v18; // r6
  unsigned int v19; // r0
  int v20; // r0
  size_t v21; // r0
  int v22; // r5
  int v23; // r6
  int v24; // r0
  int result; // r0
  char v26; // [sp+4h] [bp-5Ch]
  int v27; // [sp+38h] [bp-28h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !byte_15704 )
  {
    _android_log_buf_print(1, 5, "RILC", "RIL_onUnsolicitedResponse called before RIL_register");
    goto LABEL_52;
  }
  v6 = (android *)(&dword_0 + 1);
  if ( !__OFSUB__(v3, 1000) )
    v6 = 0;
  if ( v6 )
LABEL_53:
    abort();
  v7 = v3 - 1000;
  if ( (unsigned int)(v3 - 1000) >= 0x31 )
  {
    _android_log_buf_print(1, 6, "RILC", "unsupported unsolicited response code %d", v3);
    goto LABEL_52;
  }
  v8 = v7 == 7;
  v9 = 0;
  if ( v7 != 7 )
    v8 = v7 == 9;
  if ( !v8 )
  {
    v6 = (android *)sub_58D4();
    v9 = 1;
  }
  if ( v3 == 1008 )
  {
    LODWORD(v11) = android::elapsedRealtime(v6);
    HIDWORD(v11) = v10;
  }
  else
  {
    v11 = 0LL;
  }
  android::Parcel::Parcel((android::Parcel *)&v26);
  if ( android::s_callbacks < 13 )
    goto LABEL_56;
  v12 = v7 == 7;
  if ( v7 != 7 )
    v12 = v7 == 9;
  if ( v12 )
LABEL_56:
    v13 = 1;
  else
    v13 = 4;
  android::Parcel::writeInt32((android::Parcel *)&v26, v13);
  android::Parcel::writeInt32((android::Parcel *)&v26, v3);
  if ( ((int (__fastcall *)(char *, int, int))*(&off_148D0 + 3 * v7 + 1))(&v26, v4, v5) )
    goto LABEL_49;
  if ( v3 == 1008 )
  {
    android::Parcel::writeInt64((android::Parcel *)&v26, v11);
  }
  else if ( v3 == 1000 )
  {
    v14 = dword_156E0();
    v15 = v14 - 2;
    if ( (unsigned int)(v14 - 2) <= 7 )
    {
      v16 = dword_13210[v15];
      if ( v16 != android::voiceRadioTech )
      {
        android::voiceRadioTech = dword_13210[v15];
        j_RIL_onUnsolicitedResponse(1035, (int)&android::voiceRadioTech, 4);
      }
      if ( (unsigned int)(v16 - 4) <= 9
        && (0x31Fu >> (v16 - 4)) & 1
        && dword_131F0[v15] != android::cdmaSubscriptionSource )
      {
        android::cdmaSubscriptionSource = dword_131F0[v15];
        j_RIL_onUnsolicitedResponse(1031, (int)&android::cdmaSubscriptionSource, 4);
      }
      if ( dword_13230[v15] != android::simRuimStatus )
      {
        android::simRuimStatus = dword_13230[v15];
        j_RIL_onUnsolicitedResponse(1019, 0, 0);
      }
      v14 = 10;
    }
    android::Parcel::writeInt32((android::Parcel *)&v26, v14);
  }
  if ( android::s_callbacks <= 12 && v9 == 1 )
  {
    v17 = RIL_requestTimedCallback_0((int)&loc_5D2C + 1, 0, (__int64 *)&unk_131E4);
    if ( !v17 )
      goto LABEL_49;
    if ( dword_15798 )
      *(_DWORD *)(dword_15798 + 4) = 1;
    dword_15798 = v17;
  }
  v18 = android::Parcel::data((android::Parcel *)&v26);
  v19 = android::Parcel::dataSize((android::Parcel *)&v26);
  v20 = sub_A3A0(v18, v19);
  if ( v3 != 1008 || !v20 )
    goto LABEL_51;
  if ( dword_1579C )
  {
    free((void *)dword_1579C);
    dword_1579C = 0;
  }
  v21 = android::Parcel::dataSize((android::Parcel *)&v26);
  dword_1579C = (int)calloc(v21, 1u);
  if ( !dword_1579C )
  {
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed in RIL_onUnsolicitedResponse");
LABEL_49:
    if ( v9 == 1 )
      sub_5D7C();
    goto LABEL_51;
  }
  dword_157A0 = android::Parcel::dataSize((android::Parcel *)&v26);
  v22 = dword_1579C;
  v23 = android::Parcel::data((android::Parcel *)&v26);
  v24 = android::Parcel::dataSize((android::Parcel *)&v26);
  _aeabi_memcpy(v22, v23, v24);
LABEL_51:
  android::Parcel::~Parcel((android::Parcel *)&v26);
LABEL_52:
  result = _stack_chk_guard - v27;
  if ( _stack_chk_guard != v27 )
    goto LABEL_53;
  return result;
}
// 0: using guessed type int dword_0;
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3B18: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);
// 148D0: using guessed type void *off_148D0;
// 1500C: using guessed type int android::voiceRadioTech;
// 15010: using guessed type int android::cdmaSubscriptionSource;
// 15014: using guessed type int android::simRuimStatus;
// 156D8: using guessed type int android::s_callbacks;
// 156E0: using guessed type int (*dword_156E0)(void);
// 15704: using guessed type char byte_15704;
// 15798: using guessed type int dword_15798;
// 1579C: using guessed type int dword_1579C;
// 157A0: using guessed type int dword_157A0;

//----- (00005C98) --------------------------------------------------------
int __fastcall RIL_requestTimedCallback_0(int a1, int a2, __int64 *a3)
{
  int v3; // r7
  int v4; // r6
  __int64 *v5; // r5
  _DWORD *v6; // r0
  int v7; // r4
  __int64 v8; // r0
  int result; // r0
  __int64 v10; // [sp+8h] [bp-20h]
  int v11; // [sp+10h] [bp-18h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = calloc(1u, 0x30u);
  v7 = (int)v6;
  if ( v6 )
  {
    *v6 = v3;
    v6[1] = v4;
    if ( v5 )
      v8 = *v5;
    else
      v8 = 0LL;
    v10 = v8;
    ril_event_set(v7 + 8, -1, 0, (int)sub_AFA0, v7);
    ril_timer_add((int **)(v7 + 8), &v10);
    sub_A35C();
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed in internalRequestTimedCallback");
  }
  result = _stack_chk_guard - v11;
  if ( _stack_chk_guard == v11 )
    result = v7;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00005D7C) --------------------------------------------------------
int sub_5D7C()
{
  signed int v0; // r1

  if ( android::s_callbacks < 13 )
    return j_release_wake_lock((int)"radio-interface");
  pthread_mutex_lock((pthread_mutex_t *)&unk_157DC);
  if ( android::s_wakelock_count < 2 )
  {
    android::s_wakelock_count = 0;
    release_wake_lock("radio-interface");
    if ( dword_15798 )
      *(_DWORD *)(dword_15798 + 4) = 1;
  }
  else
  {
    v0 = 1;
    if ( !__OFSUB__(android::s_wakelock_count, 1) )
      v0 = 0;
    if ( v0 )
      abort();
    --android::s_wakelock_count;
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_157DC);
}
// 3AF4: using guessed type int __fastcall release_wake_lock(_DWORD);
// 156D8: using guessed type int android::s_callbacks;
// 156F0: using guessed type int android::s_wakelock_count;
// 15798: using guessed type int dword_15798;

//----- (00005E18) --------------------------------------------------------
const char *__fastcall failCauseToString(int a1)
{
  int v1; // r1
  const char *result; // r0

  v1 = a1;
  result = "E_SUCCESS";
  switch ( v1 )
  {
    case 0:
      return result;
    case 1:
      result = "E_RADIO_NOT_AVAILABLE";
      break;
    case 2:
      result = "E_GENERIC_FAILURE";
      break;
    case 3:
      result = "E_PASSWORD_INCORRECT";
      break;
    case 4:
      result = "E_SIM_PIN2";
      break;
    case 5:
      result = "E_SIM_PUK2";
      break;
    case 6:
      result = "E_REQUEST_NOT_SUPPORTED";
      break;
    case 7:
      result = "E_CANCELLED";
      break;
    case 8:
      result = "E_OP_NOT_ALLOWED_DURING_VOICE_CALL";
      break;
    case 9:
      result = "E_OP_NOT_ALLOWED_BEFORE_REG_TO_NW";
      break;
    case 10:
      result = "E_SMS_SEND_FAIL_RETRY";
      break;
    case 11:
      result = "E_SIM_ABSENT";
      break;
    case 12:
    case 13:
    case 28:
    case 29:
    case 30:
    case 31:
    case 32:
    case 33:
    case 34:
    case 35:
def_5EBC:
      result = "<unknown error>";
      break;
    case 14:
      result = "E_FDN_CHECK_FAILURE";
      break;
    case 15:
      result = "E_ILLEGAL_SIM_OR_ME";
      break;
    case 16:
      result = "E_MISSING_RESOURCE";
      break;
    case 17:
      result = "E_NO_SUCH_ELEMENT";
      break;
    case 18:
      result = "E_DIAL_MODIFIED_TO_USSD";
      break;
    case 19:
      result = "E_DIAL_MODIFIED_TO_SS";
      break;
    case 20:
      result = "E_DIAL_MODIFIED_TO_DIAL";
      break;
    case 21:
      result = "E_USSD_MODIFIED_TO_DIAL";
      break;
    case 22:
      result = "E_USSD_MODIFIED_TO_SS";
      break;
    case 23:
      result = "E_USSD_MODIFIED_TO_USSD";
      break;
    case 24:
      result = "E_SS_MODIFIED_TO_DIAL";
      break;
    case 25:
      result = "E_SS_MODIFIED_TO_USSD";
      break;
    case 26:
      result = "E_SUBSCRIPTION_NOT_SUPPORTED";
      break;
    case 27:
      result = "E_SS_MODIFIED_TO_SS";
      break;
    case 36:
      result = "E_LCE_NOT_SUPPORTED";
      break;
    case 37:
      result = "E_NO_MEMORY";
      break;
    case 38:
      result = "E_INTERNAL_ERR";
      break;
    case 39:
      result = "E_SYSTEM_ERR";
      break;
    case 40:
      result = "E_MODEM_ERR";
      break;
    case 41:
      result = "E_INVALID_STATE";
      break;
    case 42:
      result = "E_NO_RESOURCES";
      break;
    case 43:
      result = "E_SIM_ERR";
      break;
    case 44:
      result = "E_INVALID_ARGUMENTS";
      break;
    case 45:
      result = "E_INVALID_SIM_STATE";
      break;
    case 46:
      result = "E_INVALID_MODEM_STATE";
      break;
    case 47:
      result = "E_INVALID_CALL_ID";
      break;
    case 48:
      result = "E_NO_SMS_TO_ACK";
      break;
    case 49:
      result = "E_NETWORK_ERR";
      break;
    case 50:
      result = "E_REQUEST_RATE_LIMITED";
      break;
    case 51:
      result = "E_SIM_BUSY";
      break;
    case 52:
      result = "E_SIM_FULL";
      break;
    case 53:
      result = "E_NETWORK_REJECT";
      break;
    case 54:
      result = "E_OPERATION_NOT_ALLOWED";
      break;
    case 55:
    case 56:
      result = "E_INVALID_SMS_FORMAT";
      break;
    case 57:
      result = "E_ENCODING_ERR";
      break;
    case 58:
      result = "E_INVALID_SMSC_ADDRESS";
      break;
    case 59:
      result = "E_NO_SUCH_ENTRY";
      break;
    case 60:
      result = "E_NETWORK_NOT_READY";
      break;
    case 61:
      result = "E_NOT_PROVISIONED";
      break;
    case 62:
      result = "E_NO_SUBSCRIPTION";
      break;
    case 63:
      result = "E_NO_NETWORK_FOUND";
      break;
    case 64:
      result = "E_DEVICE_IN_USE";
      break;
    case 65:
      result = "E_ABORTED";
      break;
    default:
      switch ( v1 )
      {
        case 501:
          result = "E_OEM_ERROR_1";
          break;
        case 502:
          result = "E_OEM_ERROR_2";
          break;
        case 503:
          result = "E_OEM_ERROR_3";
          break;
        case 504:
          result = "E_OEM_ERROR_4";
          break;
        case 505:
          result = "E_OEM_ERROR_5";
          break;
        case 506:
          result = "E_OEM_ERROR_6";
          break;
        case 507:
          result = "E_OEM_ERROR_7";
          break;
        case 508:
          result = "E_OEM_ERROR_8";
          break;
        case 509:
          result = "E_OEM_ERROR_9";
          break;
        case 510:
          result = "E_OEM_ERROR_10";
          break;
        case 511:
          result = "E_OEM_ERROR_11";
          break;
        case 512:
          result = "E_OEM_ERROR_12";
          break;
        case 513:
          result = "E_OEM_ERROR_13";
          break;
        case 514:
          result = "E_OEM_ERROR_14";
          break;
        case 515:
          result = "E_OEM_ERROR_15";
          break;
        case 516:
          result = "E_OEM_ERROR_16";
          break;
        case 517:
          result = "E_OEM_ERROR_17";
          break;
        case 518:
          result = "E_OEM_ERROR_18";
          break;
        case 519:
          result = "E_OEM_ERROR_19";
          break;
        case 520:
          result = "E_OEM_ERROR_20";
          break;
        case 521:
          result = "E_OEM_ERROR_21";
          break;
        case 522:
          result = "E_OEM_ERROR_22";
          break;
        case 523:
          result = "E_OEM_ERROR_23";
          break;
        case 524:
          result = "E_OEM_ERROR_24";
          break;
        case 525:
          result = "E_OEM_ERROR_25";
          break;
        default:
          goto def_5EBC;
      }
      break;
  }
  return result;
}

//----- (00006210) --------------------------------------------------------
const char *__fastcall radioStateToString(unsigned int a1)
{
  const char *result; // r0

  if ( a1 > 0xA )
    result = "<unknown state>";
  else
    result = off_14B20[a1];
  return result;
}
// 14B20: using guessed type char *off_14B20[11];

//----- (0000622C) --------------------------------------------------------
const char *__fastcall callStateToString(unsigned int a1)
{
  const char *result; // r0

  if ( a1 > 5 )
    result = "<unknown state>";
  else
    result = off_14B50[a1];
  return result;
}
// 14B50: using guessed type char *off_14B50[6];

//----- (00006248) --------------------------------------------------------
const char *__fastcall rilSocketIdToString(int a1)
{
  const char *v1; // r1

  v1 = "RIL_SOCKET_1";
  if ( a1 )
    v1 = "not a valid RIL";
  return v1;
}

//----- (00006264) --------------------------------------------------------
int __fastcall rilEventAddWakeup_helper(int a1)
{
  ril_event_add(a1);
  return sub_A35C();
}

//----- (00006278) --------------------------------------------------------
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3)
{
  _DWORD *v3; // r8
  const char *v4; // r7
  __int64 v5; // r4
  int v6; // r0
  _QWORD *v7; // r6
  char *v8; // r0
  char *v9; // r5
  struct passwd *v10; // r0
  const char *v11; // r9
  const char *v12; // r3
  char *v13; // r0
  int result; // r0
  int v15; // r0
  int v16; // r7
  int v17; // r0
  char *v18; // r0
  const char *v19; // r1
  const char *v20; // r1
  socklen_t *optlen; // [sp+0h] [bp-B0h]
  socklen_t v22; // [sp+8h] [bp-A8h]
  char optval; // [sp+Ch] [bp-A4h]
  __uid_t uid; // [sp+10h] [bp-A0h]
  socklen_t addr_len; // [sp+18h] [bp-98h]
  int v26; // [sp+1Ch] [bp-94h]
  struct sockaddr addr; // [sp+20h] [bp-90h]
  int v28; // [sp+90h] [bp-20h]

  v3 = a3;
  v4 = "bluetooth";
  if ( *((_DWORD *)a3 + 8) == 1 )
    LODWORD(v5) = *((_DWORD *)a3 + 9);
  else
    LODWORD(v5) = 0;
  addr_len = 110;
  v22 = 12;
  if ( !(_DWORD)v5 )
    v4 = "radio";
  v6 = accept(a1, &addr, &addr_len);
  v7 = (_QWORD *)v6;
  v8 = (char *)_errno(v6);
  v9 = v8;
  if ( (signed int)v7 > -1 )
  {
    *(_DWORD *)v8 = 0;
    if ( getsockopt((int)v7, 1, 17, &optval, &v22) || (signed int)v22 < 1 )
    {
      _android_log_buf_print(1, 3, "RILC", "Error on getsockopt() errno: %d", *(_DWORD *)v9);
    }
    else
    {
      *(_DWORD *)v9 = 0;
      v10 = getpwuid(uid);
      if ( v10 )
      {
        v11 = v10->pw_name;
        if ( !strcmp(v10->pw_name, v4) )
          goto LABEL_24;
        optlen = (socklen_t *)v11;
        v12 = "RILD can't accept socket from process %s";
      }
      else
      {
        v12 = "Error on getpwuid() errno: %d";
        optlen = *(socklen_t **)v9;
      }
      _android_log_buf_print(1, 6, "RILC", v12, optlen);
    }
    _android_log_buf_print(1, 6, "RILC", "RILD must accept socket from %s", v4);
    close((int)v7);
    if ( (_DWORD)v5 )
    {
      (*(void (__fastcall **)(_DWORD))(*(_DWORD *)v5 + 8))(v5);
      goto LABEL_19;
    }
    sub_6688();
LABEL_21:
    v13 = (char *)v3[5];
    goto LABEL_22;
  }
  _android_log_buf_print(1, 6, "RILC", "Error on accept() errno:%d", *(_DWORD *)v8);
  if ( !(_DWORD)v5 )
    goto LABEL_21;
LABEL_19:
  v13 = RilSocket::getListenEvent((RilSocket *)v5);
LABEL_22:
  ril_event_add((int)v13);
  sub_A35C();
  while ( 1 )
  {
    result = _stack_chk_guard - v28;
    if ( _stack_chk_guard == v28 )
      break;
LABEL_24:
    if ( fcntl((int)v7, 4, 2048) <= -1 )
      _android_log_buf_print(1, 6, "RILC", "Error setting O_NONBLOCK errno:%d", *(_DWORD *)v9);
    if ( (_DWORD)v5 )
    {
      _android_log_buf_print(1, 4, "RILC", "libril: new connection");
      RilSocket::setCommandFd((RilSocket *)v5, (int)v7);
      v15 = RilSocket::getCommandFd((RilSocket *)v5);
      HIDWORD(v5) = record_stream_new(v15, 0x2000);
      v7 = (_QWORD *)operator new(8u);
      *v7 = v5;
      v9 = RilSocket::getCallbackEvent((RilSocket *)v5);
      v16 = RilSocket::getCommandFd((RilSocket *)v5);
      v17 = RilSocket::getCommandCb((RilSocket *)v5);
      ril_event_set((int)v9, v16, 1, v17, (int)v7);
      v18 = RilSocket::getCallbackEvent((RilSocket *)v5);
      ril_event_add((int)v18);
      sub_A35C();
      RilSocket::onNewCommandConnect((RilSocket *)v5);
    }
    else
    {
      v19 = "not a valid RIL";
      if ( !*v3 )
        v19 = "RIL_SOCKET_1";
      _android_log_buf_print(1, 4, "RILC", "libril: new connection to %s", v19);
      v3[2] = v7;
      v3[7] = record_stream_new(v7, 0x2000);
      ril_event_set(v3[4], v3[2], 1, v3[6], (int)v3);
      ril_event_add(v3[4]);
      sub_A35C();
      v26 = android::s_callbacks;
      j_RIL_onUnsolicitedResponse(1034, (int)&v26, 4);
      LODWORD(v5) = 0;
      j_RIL_onUnsolicitedResponse(1000, 0, 0);
      if ( dword_1579C )
      {
        sub_A3A0(dword_1579C, dword_157A0);
        v9 = (char *)&dword_1579C;
        free((void *)dword_1579C);
        dword_1579C = 0;
      }
      if ( dword_156EC )
      {
        LODWORD(v5) = dword_156EC();
        _android_log_buf_print(1, 4, "RILC", "RIL Daemon version: %s\n", (_DWORD)v5);
        v20 = (const char *)v5;
      }
      else
      {
        _android_log_buf_print(1, 4, "RILC", "RIL Daemon version: unavailable\n");
        v20 = "unavailable";
      }
      property_set("gsm.version.ril-impl", v20);
    }
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 3B78: using guessed type int __fastcall record_stream_new(_DWORD, _DWORD);
// 3BB4: using guessed type int __fastcall property_set(_DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;
// 156EC: using guessed type int (*dword_156EC)(void);
// 1579C: using guessed type int dword_1579C;
// 157A0: using guessed type int dword_157A0;

//----- (0000659C) --------------------------------------------------------
unsigned int __fastcall sub_659C(int a1, int a2, unsigned int a3)
{
  unsigned int v3; // r9
  int v4; // r8
  int v5; // r4
  unsigned int v6; // r7
  signed int v7; // r0
  int v8; // r0
  _DWORD *v9; // r0
  bool v10; // zf
  unsigned int v11; // r0
  signed int v12; // r1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0;
  if ( a3 )
  {
    while ( 1 )
    {
      v7 = 1;
      if ( v3 >= v6 )
        v7 = 0;
      if ( v7 )
        break;
      while ( 1 )
      {
        v8 = _write_chk(v5, v4 + v6, v3 - v6, -1);
        if ( v8 >= 0 )
          break;
        v9 = (_DWORD *)_errno(v8);
        v10 = *v9 == 4;
        if ( *v9 != 4 )
          v10 = *v9 == 11;
        if ( !v10 )
        {
          _android_log_buf_print(1, 6, "RILC", "RIL Response: unexpected error on write errno:%d", *v9);
          close(v5);
          return -1;
        }
      }
      v11 = v8 + v6;
      v12 = 1;
      if ( v11 >= v6 )
        v12 = 0;
      if ( v12 )
        break;
      v6 = v11;
      if ( v11 >= v3 )
        return 0;
    }
    abort();
  }
  return v6;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 3BC0: using guessed type int __fastcall _write_chk(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00006630) --------------------------------------------------------
int sub_6630()
{
  int v0; // r0
  char v2; // [sp+4h] [bp-24h]
  int v3; // [sp+14h] [bp-14h]

  do
  {
    do
      v0 = _read_chk(dword_157A4, &v2, 16, 16);
    while ( v0 > 0 );
  }
  while ( v0 <= -1 && *(_DWORD *)_errno(v0) == 4 );
  return _stack_chk_guard - v3;
}
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 3BCC: using guessed type int __fastcall _read_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 157A4: using guessed type int dword_157A4;

//----- (00006688) --------------------------------------------------------
int sub_6688()
{
  int i; // r0

  pthread_mutex_lock((pthread_mutex_t *)&unk_157D0);
  for ( i = dword_157D4; i; i = *(_DWORD *)(i + 8) )
    *(_BYTE *)(i + 12) = 1;
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_157D0);
}
// 157D4: using guessed type int dword_157D4;

//----- (000066C0) --------------------------------------------------------
int __fastcall sub_66C0(int a1, int a2)
{
  return dword_156DC(**(_DWORD **)(a2 + 4), 0, 0);
}
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (000066DC) --------------------------------------------------------
int __fastcall sub_66DC(android::Parcel *this, int *a2, unsigned int a3)
{
  android::Parcel *v3; // r5
  int *v4; // r4
  const char *v5; // r3
  int v7; // [sp+0h] [bp-70h]

  v3 = this;
  v4 = a2;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_4:
    _android_log_buf_print(1, 6, "RILC", v5);
    return -1;
  }
  if ( android::s_callbacks > 12 )
  {
    if ( a3 != 412 * (a3 / 0x19C) )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_CardStatus_v6");
      property_get("ro.debuggable", &v7, "0");
      if ( strcmp((const char *)&v7, "1") )
        return -1;
    }
  }
  else
  {
    if ( a3 == 404 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(v3, v4[1]);
      android::Parcel::writeInt32(v3, v4[2]);
      android::Parcel::writeInt32(v3, v4[3]);
      sub_9BCC(v3, v4[4], (int)(v4 + 5));
      return 0;
    }
    if ( a3 != 412 )
    {
      v5 = "responseSimStatus: A RilCardStatus_v6 or _v5 expected\n";
      goto LABEL_4;
    }
  }
  sub_9B64(v3, v4);
  return 0;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BD8: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;

//----- (000067F4) --------------------------------------------------------
int __fastcall sub_67F4(android::Parcel *this, __int64 *a2)
{
  android::Parcel *v2; // r6
  __int64 *v3; // r9
  __int64 v4; // kr00_8
  const char *v5; // r0
  signed int v6; // r1
  size_t v7; // r8
  _DWORD *v8; // r4
  int v9; // r5
  int v10; // r0
  int v11; // r0
  signed int v12; // r1
  int v13; // r6
  int v14; // r5
  int v15; // r0
  void *v16; // r0
  int v17; // r0
  signed int v18; // r1
  int result; // r0
  const char *v20; // r0
  int v21; // [sp+4h] [bp-2Ch]
  size_t nmemb; // [sp+8h] [bp-28h]
  unsigned int v23; // [sp+Ch] [bp-24h]
  int v24; // [sp+10h] [bp-20h]

  v2 = this;
  v3 = a2;
  if ( !android::Parcel::readInt32(this, (int *)&nmemb) )
  {
    if ( nmemb )
    {
      if ( (nmemb & 0x80000000) == 0 )
      {
        v6 = (unsigned __int64)nmemb >> 30;
        v7 = 4 * nmemb;
        if ( !is_mul_ok(4u, nmemb) )
          v6 = 1;
        if ( !v6 )
        {
          v8 = calloc(nmemb, 4u);
          if ( !v8 )
            goto LABEL_31;
          v9 = 0;
          while ( 1 )
          {
            v10 = android::Parcel::readString16Inplace(v2, &v23);
            v8[v9] = strndup16to8(v10, v23);
            v11 = v9 + 1;
            v12 = 1;
            if ( v9 + 1 > v9 )
              v12 = 0;
            if ( v12 )
              break;
            ++v9;
            if ( v11 >= (signed int)nmemb )
              goto LABEL_19;
          }
        }
        goto LABEL_34;
      }
      v7 = 0;
      v8 = 0;
    }
    else
    {
      v8 = calloc(1u, 4u);
      if ( !v8 )
      {
        v20 = j_requestToString(**((_DWORD **)v3 + 1));
        goto LABEL_33;
      }
      v7 = 0;
    }
LABEL_19:
    dword_156DC(**((_DWORD **)v3 + 1), v8, v7);
    if ( !v8 )
      goto LABEL_30;
    if ( (signed int)nmemb <= 0 )
    {
LABEL_29:
      free(v8);
      goto LABEL_30;
    }
    v13 = 0;
    while ( 1 )
    {
      v14 = v8[v13];
      if ( v14 )
      {
        v15 = _strlen_chk(v8[v13], -1);
        _aeabi_memclr(v14, v15);
        v16 = (void *)v8[v13];
      }
      else
      {
        v16 = 0;
      }
      free(v16);
      v17 = v13 + 1;
      v18 = 1;
      if ( v13 + 1 > v13 )
        v18 = 0;
      if ( v18 )
        break;
      ++v13;
      if ( v17 >= (signed int)nmemb )
        goto LABEL_29;
    }
LABEL_34:
    abort();
  }
  v4 = *v3;
  v5 = j_requestToString(*(_DWORD *)((unsigned __int64)*v3 >> 32));
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v4, v5);
LABEL_30:
  while ( 1 )
  {
    result = _stack_chk_guard - v24;
    if ( _stack_chk_guard == v24 )
      break;
LABEL_31:
    v20 = j_requestToString(**((_DWORD **)v3 + 1));
LABEL_33:
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v20, v21);
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00006968) --------------------------------------------------------
int __fastcall sub_6968(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  unsigned int v4; // r8
  android::Parcel *v5; // r5
  const char *v6; // r3
  int v7; // r6
  int v9; // r7
  int v10; // r0
  signed int v11; // r1
  int v12; // [sp+0h] [bp-20h]
  signed int v13; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v6, v12, v13);
    return -1;
  }
  if ( a3 & 3 )
  {
    v12 = a3;
    v13 = 4;
    v6 = "responseInts: invalid response length %d expected multiple of %d\n";
    goto LABEL_6;
  }
  v9 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  v7 = 0;
  if ( v4 >> 2 )
  {
    do
    {
      android::Parcel::writeInt32(v5, *(_DWORD *)(v3 + 4 * v7));
      v10 = v7 + 1;
      v11 = 1;
      if ( v7 + 1 > v7 )
        v11 = 0;
      if ( v11 )
        abort();
      ++v7;
    }
    while ( v10 < v9 );
    v7 = 0;
  }
  return v7;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000069F8) --------------------------------------------------------
int __fastcall sub_69F8(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  unsigned int v4; // r7
  android::Parcel *v5; // r5
  const char *v6; // r3
  int result; // r0
  int v8; // r8
  int v9; // r6
  int v10; // r7
  int *v11; // r7
  int v12; // r0
  signed int v13; // r1
  int v14; // [sp+0h] [bp-28h]
  signed int v15; // [sp+4h] [bp-24h]

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v6, v14, v15);
    return -1;
  }
  if ( a3 & 3 )
  {
    v14 = a3;
    v15 = 4;
    v6 = "responseCallList: invalid response length %d expected multiple of %d\n";
    goto LABEL_6;
  }
  v8 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  result = 0;
  if ( v4 >> 2 )
  {
    v9 = 0;
    do
    {
      v10 = *(_DWORD *)(v3 + 4 * v9);
      android::Parcel::writeInt32(v5, *(_DWORD *)v10);
      android::Parcel::writeInt32(v5, *(_DWORD *)(v10 + 4));
      android::Parcel::writeInt32(v5, *(_DWORD *)(v10 + 8));
      android::Parcel::writeInt32(v5, *(unsigned __int8 *)(v10 + 12));
      android::Parcel::writeInt32(v5, *(unsigned __int8 *)(v10 + 13));
      android::Parcel::writeInt32(v5, *(unsigned __int8 *)(v10 + 14));
      android::Parcel::writeInt32(v5, *(unsigned __int8 *)(v10 + 15));
      android::Parcel::writeInt32(v5, *(unsigned __int8 *)(v10 + 16));
      sub_9C8C((int)v5, *(_DWORD *)(v10 + 20));
      android::Parcel::writeInt32(v5, *(_DWORD *)(v10 + 24));
      sub_9C8C((int)v5, *(_DWORD *)(v10 + 28));
      android::Parcel::writeInt32(v5, *(_DWORD *)(v10 + 32));
      if ( android::s_callbacks >= 3 && (v11 = *(int **)(v10 + 36)) != 0 && v11[3] )
      {
        android::Parcel::writeInt32(v5, 1);
        android::Parcel::writeInt32(v5, *v11);
        android::Parcel::writeInt32(v5, v11[1]);
        android::Parcel::writeInt32(v5, v11[2]);
        android::Parcel::write(v5, (const void *)(*((_QWORD *)v11 + 1) >> 32), *((_QWORD *)v11 + 1));
      }
      else
      {
        android::Parcel::writeInt32(v5, 0);
      }
      v12 = v9 + 1;
      v13 = 1;
      if ( v9 + 1 > v9 )
        v13 = 0;
      if ( v13 )
        abort();
      ++v9;
    }
    while ( v12 < v8 );
    result = 0;
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 156D8: using guessed type int android::s_callbacks;

//----- (00006B2C) --------------------------------------------------------
int __fastcall sub_6B2C(android::Parcel *a1, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r4
  int v4; // r0
  void *v5; // r6
  int v6; // r0
  signed int v7; // r2
  unsigned __int64 v8; // kr00_8
  const char *v9; // r0
  unsigned int v10; // r0
  unsigned int v11; // r1
  void *v12; // r4
  void *v13; // r0
  int v14; // r0
  int v16; // [sp+8h] [bp-40h]
  int v17; // [sp+Ch] [bp-3Ch]
  __int64 v18; // [sp+10h] [bp-38h]
  unsigned __int64 v19; // [sp+18h] [bp-30h]
  void *ptr; // [sp+20h] [bp-28h]
  int v21; // [sp+24h] [bp-24h]
  __int64 *v22; // [sp+28h] [bp-20h]
  unsigned int v23; // [sp+2Ch] [bp-1Ch]
  int v24; // [sp+30h] [bp-18h]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchDial");
  v21 = 0;
  v22 = 0;
  v4 = android::Parcel::readString16Inplace(v2, &v23);
  v5 = (void *)strndup16to8(v4, v23);
  ptr = v5;
  v6 = android::Parcel::readInt32(v2, &v17);
  v21 = v17;
  if ( v6 || !v5 )
    goto LABEL_8;
  if ( android::s_callbacks > 2 )
  {
    if ( !android::Parcel::readInt32(v2, &v16) )
    {
      if ( v16 )
      {
        v18 = 0LL;
        v19 = 0LL;
        android::Parcel::readInt32(v2, &v17);
        LODWORD(v18) = v17;
        android::Parcel::readInt32(v2, &v17);
        HIDWORD(v18) = v17;
        if ( android::Parcel::readInt32(v2, (int *)&v23) )
          goto LABEL_8;
        if ( v23 == -1 )
        {
          v11 = 0;
          v10 = 0;
          v23 = 0;
        }
        else
        {
          v10 = android::Parcel::readInplace(v2, v23);
          v11 = v23;
        }
        v19 = __PAIR__(v10, v11);
        v22 = &v18;
      }
      else
      {
        v22 = 0;
      }
      v7 = 12;
      goto LABEL_15;
    }
LABEL_8:
    v8 = *v3;
    v9 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v8, v9);
    return _stack_chk_guard - v24;
  }
  v7 = 8;
  v16 = 0;
LABEL_15:
  dword_156DC(**((_DWORD **)v3 + 1), &ptr, v7);
  v12 = ptr;
  v13 = 0;
  if ( ptr )
  {
    v14 = _strlen_chk(ptr, -1);
    _aeabi_memclr(v12, v14);
    v13 = ptr;
  }
  free(v13);
  v18 = 0LL;
  v19 = 0LL;
  ptr = 0;
  v21 = 0;
  v22 = 0;
  return _stack_chk_guard - v24;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00006C88) --------------------------------------------------------
int sub_6C88()
{
  return 0;
}

//----- (00006C8C) --------------------------------------------------------
int __fastcall sub_6C8C(int a1, int a2)
{
  sub_9C8C(a1, a2);
  return 0;
}

//----- (00006C98) --------------------------------------------------------
int __fastcall sub_6C98(android::Parcel *this, __int64 *a2)
{
  android::Parcel *v2; // r5
  __int64 *v3; // r9
  signed int v4; // r6
  signed int v5; // r0
  size_t v6; // r8
  void *v7; // r7
  int v8; // r4
  int v9; // r0
  int v10; // r0
  signed int v11; // r1
  const char *v12; // r0
  __int64 v13; // kr08_8
  const char *v14; // r0
  int result; // r0
  int v16; // [sp+8h] [bp-28h]
  size_t nmemb; // [sp+Ch] [bp-24h]
  int v18; // [sp+10h] [bp-20h]

  v2 = this;
  v3 = a2;
  if ( !android::Parcel::readInt32(this, (int *)&nmemb) )
  {
    v4 = nmemb;
    if ( (signed int)nmemb >= 1 )
    {
      v5 = (unsigned __int64)nmemb >> 30;
      v6 = 4 * nmemb;
      if ( !is_mul_ok(4u, nmemb) )
        v5 = 1;
      if ( v5 )
LABEL_19:
        abort();
      v7 = calloc(nmemb, 4u);
      if ( !v7 )
      {
        v12 = j_requestToString(**((_DWORD **)v3 + 1));
        _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v12);
        goto LABEL_18;
      }
      if ( v4 < 1 )
      {
LABEL_14:
        dword_156DC(**((_DWORD **)v3 + 1), v7, v6);
        free(v7);
        goto LABEL_18;
      }
      v8 = 0;
      while ( 1 )
      {
        v9 = android::Parcel::readInt32(v2, &v16);
        *((_DWORD *)v7 + v8) = v16;
        if ( v9 )
          break;
        v10 = v8 + 1;
        v11 = 1;
        if ( v8 + 1 > v8 )
          v11 = 0;
        if ( v11 )
          goto LABEL_19;
        ++v8;
        if ( v10 >= (signed int)nmemb )
          goto LABEL_14;
      }
      free(v7);
    }
  }
  v13 = *v3;
  v14 = j_requestToString(*(_DWORD *)((unsigned __int64)*v3 >> 32));
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v13, v14);
LABEL_18:
  result = _stack_chk_guard - v18;
  if ( _stack_chk_guard != v18 )
    goto LABEL_19;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00006D98) --------------------------------------------------------
int __fastcall sub_6D98(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v5; // r3
  int v7; // [sp+0h] [bp-18h]

  v3 = a2;
  v4 = this;
  if ( a2 || !a3 )
  {
    if ( a3 == 8 )
    {
      android::Parcel::writeInt32(this, *a2);
      sub_9C8C((int)v4, v3[1]);
      return 0;
    }
    if ( a3 == 4 )
    {
      android::Parcel::writeInt32(this, *a2);
      return 0;
    }
    v7 = a3;
    v5 = "responseFailCause: invalid response length %d expected an int or RIL_LastCallFailCauseInfo";
  }
  else
  {
    v5 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v5, v7);
  return -1;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00006E08) --------------------------------------------------------
signed int __fastcall sub_6E08(android::Parcel *a1, int *a2, unsigned int a3)
{
  android::Parcel *v3; // r4
  int *v4; // r5
  unsigned int v5; // r6
  const char *v6; // r3
  int v7; // r1
  android::Parcel *v8; // r0
  int v10; // [sp+0h] [bp-70h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_14:
    _android_log_buf_print(1, 6, "RILC", v6);
    return -1;
  }
  if ( android::s_callbacks > 12 )
  {
    if ( a3 != 56 * (a3 / 0x38) )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_SignalStrength_v10");
      property_get("ro.debuggable", &v10, "0");
      if ( strcmp((const char *)&v10, "1") )
        return -1;
    }
    sub_9CD8(v3, v4);
    sub_9D18(v3, v4);
  }
  else
  {
    if ( a3 < 0x1C )
    {
      v6 = "invalid response length";
      goto LABEL_14;
    }
    sub_9CD8(a1, a2);
    if ( v5 < 0x30 )
    {
      android::Parcel::writeInt32(v3, 99);
      android::Parcel::writeInt32(v3, 0x7FFFFFFF);
      android::Parcel::writeInt32(v3, 0x7FFFFFFF);
      android::Parcel::writeInt32(v3, 0x7FFFFFFF);
      android::Parcel::writeInt32(v3, 0x7FFFFFFF);
LABEL_17:
      v8 = v3;
      v7 = 0x7FFFFFFF;
      goto LABEL_18;
    }
    sub_9D18(v3, v4);
    if ( v5 < 0x38 )
      goto LABEL_17;
  }
  v7 = v4[13];
  v8 = v3;
LABEL_18:
  android::Parcel::writeInt32(v8, v7);
  return 0;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BD8: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;

//----- (00006F48) --------------------------------------------------------
int __fastcall sub_6F48(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r5
  unsigned int v4; // r7
  android::Parcel *v5; // r4
  const char *v6; // r3
  int v7; // r6
  int v9; // r8
  int v10; // r0
  signed int v11; // r1
  int v12; // [sp+0h] [bp-20h]
  signed int v13; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v6, v12, v13);
    return -1;
  }
  if ( a3 & 3 )
  {
    v12 = a3;
    v13 = 4;
    v6 = "responseStrings: invalid response length %d expected multiple of %d\n";
    goto LABEL_6;
  }
  if ( a2 )
  {
    v9 = a3 >> 2;
    android::Parcel::writeInt32(this, a3 >> 2);
    v7 = 0;
    if ( v4 >> 2 )
    {
      do
      {
        sub_9C8C((int)v5, *(_DWORD *)(v3 + 4 * v7));
        v10 = v7 + 1;
        v11 = 1;
        if ( v7 + 1 > v7 )
          v11 = 0;
        if ( v11 )
          abort();
        ++v7;
      }
      while ( v10 < v9 );
      v7 = 0;
    }
  }
  else
  {
    v7 = 0;
    android::Parcel::writeInt32(this, 0);
  }
  return v7;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00006FE0) --------------------------------------------------------
int __fastcall sub_6FE0(android::Parcel *a1, int a2)
{
  int v2; // r6
  int v3; // r0
  void *v4; // r4
  int v6; // [sp+0h] [bp-18h]
  int v7; // [sp+4h] [bp-14h]

  v2 = a2;
  v3 = android::Parcel::readString16Inplace(a1, (unsigned int *)&v6);
  v4 = (void *)strndup16to8(v3, v6);
  dword_156DC(**(_DWORD **)(v2 + 4), v4, 4);
  if ( v4 )
    _strlen_chk(v4, -1);
  free(v4);
  return _stack_chk_guard - v7;
}
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00007048) --------------------------------------------------------
int __fastcall sub_7048(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 12 )
    {
      android::Parcel::writeInt32(this, *a2);
      sub_9C8C((int)v4, v3[1]);
      android::Parcel::writeInt32(v4, v3[2]);
      return 0;
    }
    v7 = a3;
    v8 = 12;
    v6 = "invalid response length %d expected %d";
  }
  else
  {
    v6 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000070B0) --------------------------------------------------------
int __fastcall sub_70B0(android::Parcel *this, __int64 *a2)
{
  android::Parcel *v2; // r5
  __int64 *v3; // r8
  unsigned int v4; // r9
  int v5; // r6
  int v6; // r0
  signed int v7; // r1
  int result; // r0
  int v9; // [sp+0h] [bp-58h]
  char v10; // [sp+4h] [bp-54h]
  int v11; // [sp+38h] [bp-20h]

  v2 = this;
  v3 = a2;
  v4 = android::Parcel::dataPosition(this);
  if ( android::Parcel::readInt32(v2) < 7 || android::s_callbacks > 3 )
  {
    android::Parcel::setDataPosition(v2, v4);
    if ( _stack_chk_guard != v11 )
      goto LABEL_12;
    result = sub_67F4(v2, v3);
  }
  else
  {
    android::Parcel::Parcel((android::Parcel *)&v10);
    v5 = 0;
    android::Parcel::appendFrom((android::Parcel *)&v10, v2, 0, v4);
    android::Parcel::writeInt32((android::Parcel *)&v10, 6);
    do
    {
      android::Parcel::readString16((android::Parcel *)&v9);
      android::Parcel::writeString16((android::Parcel *)&v10, (const android::String16 *)&v9);
      android::String16::~String16((android::String16 *)&v9);
      v6 = v5 + 1;
      v7 = 1;
      if ( v5 + 1 > v5 )
        v7 = 0;
      if ( v7 )
        goto LABEL_12;
      ++v5;
    }
    while ( v6 < 6 );
    android::Parcel::setDataPosition((android::Parcel *)&v10, v4);
    sub_67F4((android::Parcel *)&v10, v3);
    android::Parcel::~Parcel((android::Parcel *)&v10);
    result = _stack_chk_guard - v11;
    if ( _stack_chk_guard != v11 )
LABEL_12:
      abort();
  }
  return result;
}
// 156D8: using guessed type int android::s_callbacks;

//----- (00007198) --------------------------------------------------------
int __fastcall sub_7198(android::Parcel *this, int a2, unsigned int a3)
{
  android::Parcel *v3; // r6
  int v4; // r5
  unsigned int v5; // r4

  v3 = this;
  v4 = a2;
  v5 = a3;
  if ( android::s_callbacks > 4 )
    return sub_75B0(this, a2, a3);
  android::Parcel::writeInt32(this, android::s_callbacks);
  return sub_6F48(v3, v4, v5);
}
// 156D8: using guessed type int android::s_callbacks;

//----- (000071D4) --------------------------------------------------------
int __fastcall sub_71D4(android::Parcel *this, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r4
  int v4; // r0
  int v5; // r6
  int v6; // r0
  int v7; // r0
  int v8; // r0
  unsigned __int64 v9; // kr00_8
  const char *v10; // r0
  signed int v11; // r2
  int v12; // r4
  int v13; // r0
  int v14; // r4
  int v15; // r0
  int v16; // r4
  int v17; // r0
  void *v18; // r4
  int v19; // r0
  int v21; // [sp+Ch] [bp-4h]
  __int64 v22; // [sp+10h] [bp+0h]
  __int64 ptr; // [sp+18h] [bp+8h]
  __int64 v24; // [sp+20h] [bp+10h]
  __int64 v25; // [sp+28h] [bp+18h]
  void *v26; // [sp+30h] [bp+20h]
  unsigned int v27; // [sp+38h] [bp+28h]
  int v28; // [sp+3Ch] [bp+2Ch]

  v2 = this;
  v3 = a2;
  v22 = 0LL;
  ptr = 0LL;
  v24 = 0LL;
  v25 = 0LL;
  android::Parcel::readInt32(this, &v21);
  LODWORD(v22) = v21;
  android::Parcel::readInt32(v2, &v21);
  HIDWORD(v22) = v21;
  v4 = android::Parcel::readString16Inplace(v2, &v27);
  LODWORD(ptr) = strndup16to8(v4, v27);
  android::Parcel::readInt32(v2, &v21);
  HIDWORD(ptr) = v21;
  android::Parcel::readInt32(v2, &v21);
  LODWORD(v24) = v21;
  v5 = android::Parcel::readInt32(v2, &v21);
  HIDWORD(v24) = v21;
  v6 = android::Parcel::readString16Inplace(v2, &v27);
  LODWORD(v25) = strndup16to8(v6, v27);
  v7 = android::Parcel::readString16Inplace(v2, &v27);
  HIDWORD(v25) = strndup16to8(v7, v27);
  v8 = android::Parcel::readString16Inplace(v2, &v27);
  v26 = (void *)strndup16to8(v8, v27);
  if ( v5 )
  {
    v9 = *v3;
    v10 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v9, v10);
  }
  else
  {
    v11 = 36;
    if ( android::s_callbacks < 6 )
      v11 = 32;
    dword_156DC(**((_DWORD **)v3 + 1), &v22, v11);
    v12 = ptr;
    if ( (_DWORD)ptr )
    {
      v13 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v12, v13);
    }
    v14 = v25;
    if ( (_DWORD)v25 )
    {
      v15 = _strlen_chk(v25, -1);
      _aeabi_memclr(v14, v15);
    }
    v16 = HIDWORD(v25);
    if ( HIDWORD(v25) )
    {
      v17 = _strlen_chk(HIDWORD(v25), -1);
      _aeabi_memclr(v16, v17);
    }
    v18 = v26;
    if ( v26 )
    {
      v19 = _strlen_chk(v26, -1);
      _aeabi_memclr(v18, v19);
    }
    free((void *)ptr);
    free((void *)v25);
    free((void *)HIDWORD(v25));
    free(v26);
    v22 = 0LL;
    ptr = 0LL;
    v24 = 0LL;
    v25 = 0LL;
    v26 = 0;
  }
  return _stack_chk_guard - v28;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00007368) --------------------------------------------------------
int __fastcall sub_7368(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 12 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(v4, v3[1]);
      sub_9C8C((int)v4, v3[2]);
      return 0;
    }
    v7 = a3;
    v8 = 12;
    v6 = "invalid response length was %d expected %d";
  }
  else
  {
    v6 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000073D0) --------------------------------------------------------
int __fastcall sub_73D0(android::Parcel *a1, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r8
  int v4; // r0
  _BYTE *v5; // r7
  int v6; // r0
  unsigned __int64 v7; // kr00_8
  const char *v8; // r0
  void *v9; // r4
  void *v10; // r0
  int v11; // r0
  int v13; // [sp+Ch] [bp-4Ch]
  __int64 v14; // [sp+10h] [bp-48h]
  __int64 v15; // [sp+18h] [bp-40h]
  void *ptr; // [sp+20h] [bp-38h]
  int v17; // [sp+24h] [bp-34h]
  unsigned int v18; // [sp+28h] [bp-30h]
  int v19; // [sp+2Ch] [bp-2Ch]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchCallForward");
  v14 = 0LL;
  v15 = 0LL;
  ptr = 0;
  android::Parcel::readInt32(v2, &v13);
  LODWORD(v14) = v13;
  android::Parcel::readInt32(v2, &v13);
  HIDWORD(v14) = v13;
  android::Parcel::readInt32(v2, &v13);
  LODWORD(v15) = v13;
  android::Parcel::readInt32(v2, &v13);
  HIDWORD(v15) = v13;
  v4 = android::Parcel::readString16Inplace(v2, &v18);
  v5 = (_BYTE *)strndup16to8(v4, v18);
  ptr = v5;
  v6 = android::Parcel::readInt32(v2, &v13);
  v17 = v13;
  if ( v6 )
  {
    v7 = *v3;
    v8 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v7, v8);
  }
  else
  {
    if ( v5 && !*v5 )
      ptr = 0;
    dword_156DC(**((_DWORD **)v3 + 1), &v14, 24);
    v9 = ptr;
    v10 = 0;
    if ( ptr )
    {
      v11 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v9, v11);
      v10 = ptr;
    }
    free(v10);
    v14 = 0LL;
    v15 = 0LL;
    ptr = 0;
    v17 = 0;
  }
  return _stack_chk_guard - v19;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (000074FC) --------------------------------------------------------
int __fastcall sub_74FC(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  unsigned int v4; // r7
  android::Parcel *v5; // r5
  const char *v6; // r3
  int result; // r0
  int v8; // r8
  int v9; // r7
  int *v10; // r6
  int v11; // r0
  signed int v12; // r1
  int v13; // [sp+0h] [bp-20h]
  signed int v14; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v6, v13, v14);
    return -1;
  }
  if ( a3 & 3 )
  {
    v13 = a3;
    v14 = 4;
    v6 = "responseCallForwards: invalid response length %d expected multiple of %d";
    goto LABEL_6;
  }
  v8 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  result = 0;
  if ( v4 >> 2 )
  {
    v9 = 0;
    do
    {
      v10 = *(int **)(v3 + 4 * v9);
      android::Parcel::writeInt32(v5, *v10);
      android::Parcel::writeInt32(v5, v10[1]);
      android::Parcel::writeInt32(v5, v10[2]);
      android::Parcel::writeInt32(v5, v10[3]);
      sub_9C8C((int)v5, v10[4]);
      android::Parcel::writeInt32(v5, v10[5]);
      v11 = v9 + 1;
      v12 = 1;
      if ( v9 + 1 > v9 )
        v12 = 0;
      if ( v12 )
        abort();
      ++v9;
    }
    while ( v11 < v8 );
    result = 0;
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000075B0) --------------------------------------------------------
int __fastcall sub_75B0(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r8
  android::Parcel *v4; // r5
  int v5; // r4
  unsigned int v6; // r6
  int result; // r0
  int v8; // r7
  int v9; // r1
  signed int v10; // r0
  int v11; // r7
  int v12; // r1
  signed int v13; // r0
  int v14; // r7
  int v15; // r1
  signed int v16; // r0
  char v17; // [sp+8h] [bp-78h]
  int v18; // [sp+64h] [bp-1Ch]

  v4 = this;
  v5 = a2;
  v6 = a3;
  if ( android::s_callbacks > 12 )
  {
    if ( !(a3 % 0x2C)
      || (_android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_Data_Call_Response_v11"),
          property_get("ro.debuggable", &v17, "0"),
          !strcmp(&v17, "1")) )
    {
      result = sub_9D94(v4, v5, v6);
      goto LABEL_23;
    }
    goto LABEL_22;
  }
  if ( android::s_callbacks <= 4 )
  {
    _android_log_buf_print(1, 3, "RILC", "responseDataCallList: v4");
    if ( v5 || !v6 )
    {
      v3 = v6 / 0x14;
      if ( !(v6 % 0x14) )
        goto LABEL_24;
      _android_log_buf_print(
        1,
        6,
        "RILC",
        "responseDataCallListV4: invalid response length %d expected multiple of %d",
        v6,
        20);
      goto LABEL_22;
    }
LABEL_21:
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
LABEL_22:
    result = -1;
    goto LABEL_23;
  }
  v3 = a3 / 0x24;
  if ( a3 % 0x24 )
  {
    v3 = a3 / 0x28;
    if ( a3 % 0x28 )
    {
      if ( _stack_chk_guard != v18 )
        goto LABEL_24;
      return sub_9D94(this, a2, a3);
    }
    if ( !a2 && a3 )
      goto LABEL_21;
    android::Parcel::writeInt32(this, 10);
    android::Parcel::writeInt32(v4, v6 / 0x28);
    v14 = 0;
    if ( v6 < 0x28 )
      goto LABEL_42;
    do
    {
      android::Parcel::writeInt32(v4, *(_DWORD *)(v5 + 40 * v14));
      v6 = v5 + 40 * v14;
      android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 4));
      android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 8));
      android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 12));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 16));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 20));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 24));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 28));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 32));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 36));
      v15 = v14 + 1;
      v16 = 1;
      if ( v14 + 1 > v14 )
        v16 = 0;
      if ( v16 )
        abort();
      result = 0;
      ++v14;
    }
    while ( v15 < v3 );
  }
  else
  {
    if ( !a2 && a3 )
      goto LABEL_21;
    android::Parcel::writeInt32(this, 6);
    android::Parcel::writeInt32(v4, v6 / 0x24);
    v11 = 0;
    if ( v6 < 0x24 )
      goto LABEL_42;
    do
    {
      android::Parcel::writeInt32(v4, *(_DWORD *)(v5 + 36 * v11));
      v6 = v5 + 36 * v11;
      android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 4));
      android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 8));
      android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 12));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 16));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 20));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 24));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 28));
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 32));
      v12 = v11 + 1;
      v13 = 1;
      if ( v11 + 1 > v11 )
        v13 = 0;
      if ( v13 )
        abort();
      result = 0;
      ++v11;
    }
    while ( v12 < v3 );
  }
LABEL_23:
  while ( _stack_chk_guard != v18 )
  {
LABEL_24:
    android::Parcel::writeInt32(v4, 4);
    android::Parcel::writeInt32(v4, v3);
    v8 = 0;
    if ( v6 < 0x14 )
    {
LABEL_42:
      result = 0;
    }
    else
    {
      do
      {
        android::Parcel::writeInt32(v4, *(_DWORD *)(v5 + 20 * v8));
        v6 = v5 + 20 * v8;
        android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 4));
        sub_9C8C((int)v4, *(_DWORD *)(v6 + 8));
        sub_9C8C((int)v4, *(_DWORD *)(v6 + 16));
        v9 = v8 + 1;
        v10 = 1;
        if ( v8 + 1 > v8 )
          v10 = 0;
        if ( v10 )
          abort();
        result = 0;
        ++v8;
      }
      while ( v9 < v3 );
    }
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BD8: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;

//----- (000078D0) --------------------------------------------------------
int __fastcall sub_78D0(android::Parcel *this, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r4
  unsigned __int64 v4; // kr00_8
  const char *v5; // r0
  int v6; // r1
  int v7; // r0
  int v9; // [sp+8h] [bp-18h]
  int v10; // [sp+Ch] [bp-14h]

  v2 = this;
  v3 = a2;
  if ( android::Parcel::readInt32(this, &v9) )
  {
    v4 = *v3;
    v5 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v4, v5);
  }
  else
  {
    v6 = v9;
    if ( v9 == -1 )
    {
      v6 = 0;
      v9 = 0;
    }
    v7 = android::Parcel::readInplace(v2, v6);
    dword_156DC(**((_DWORD **)v3 + 1), v7, v9);
  }
  return _stack_chk_guard - v10;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (0000795C) --------------------------------------------------------
int __fastcall sub_795C(android::Parcel *this, const void *a2, int a3)
{
  const void *v3; // r6
  unsigned int v4; // r4
  android::Parcel *v5; // r5
  int result; // r0

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( a2 || !a3 )
  {
    if ( a2 )
    {
      android::Parcel::writeInt32(this, a3);
      android::Parcel::write(v5, v3, v4);
    }
    else
    {
      android::Parcel::writeInt32(this, -1);
    }
    result = 0;
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL with responselen != 0");
    result = -1;
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000079AC) --------------------------------------------------------
int __fastcall sub_79AC(android::Parcel *a1, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r4
  int v4; // r6
  int v5; // r0
  void *v6; // r0
  int v7; // r0
  void *v8; // r4
  void *v9; // r0
  int v10; // r0
  unsigned __int64 v11; // kr00_8
  const char *v12; // r0
  int v14; // [sp+Ch] [bp-2Ch]
  int v15; // [sp+10h] [bp-28h]
  void *ptr; // [sp+14h] [bp-24h]
  int v17; // [sp+18h] [bp-20h]
  unsigned int v18; // [sp+20h] [bp-18h]
  int v19; // [sp+24h] [bp-14h]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchSmsWrite");
  v15 = 0;
  ptr = 0;
  v17 = 0;
  v4 = android::Parcel::readInt32(v2, &v14);
  v15 = v14;
  v5 = android::Parcel::readString16Inplace(v2, &v18);
  v6 = (void *)strndup16to8(v5, v18);
  ptr = v6;
  if ( v4 || !v6 )
  {
    v11 = *v3;
    v12 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v11, v12);
  }
  else
  {
    v7 = android::Parcel::readString16Inplace(v2, &v18);
    v17 = strndup16to8(v7, v18);
    dword_156DC(**((_DWORD **)v3 + 1), &v15, 12);
    v8 = ptr;
    v9 = 0;
    if ( ptr )
    {
      v10 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v8, v10);
      v9 = ptr;
    }
    free(v9);
    v15 = 0;
    ptr = 0;
    v17 = 0;
  }
  return _stack_chk_guard - v19;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00007A94) --------------------------------------------------------
int __fastcall sub_7A94(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  unsigned int v4; // r7
  android::Parcel *v5; // r5
  const char *v6; // r3
  int result; // r0
  int v8; // r8
  int v9; // r7
  int *v10; // r6
  int v11; // r0
  signed int v12; // r1
  int v13; // [sp+0h] [bp-20h]
  signed int v14; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v6, v13, v14);
    return -1;
  }
  if ( a3 & 3 )
  {
    v13 = a3;
    v14 = 4;
    v6 = "responseCellList: invalid response length %d expected multiple of %d\n";
    goto LABEL_6;
  }
  v8 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  result = 0;
  if ( v4 >> 2 )
  {
    v9 = 0;
    do
    {
      v10 = *(int **)(v3 + 4 * v9);
      android::Parcel::writeInt32(v5, v10[1]);
      sub_9C8C((int)v5, *v10);
      v11 = v9 + 1;
      v12 = 1;
      if ( v9 + 1 > v9 )
        v12 = 0;
      if ( v12 )
        abort();
      ++v9;
    }
    while ( v11 < v8 );
    result = 0;
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007B28) --------------------------------------------------------
int __fastcall sub_7B28(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r1
  int v5; // r0
  int v6; // r4
  const char *v7; // r0
  char v9; // [sp+8h] [bp-188h]
  int v10; // [sp+17Ch] [bp-14h]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchCdmaSms");
  v4 = sub_9E8C(v2, (int)&v9);
  v5 = *(_DWORD *)v3[1];
  if ( v4 )
  {
    v6 = *v3;
    v7 = j_requestToString(v5);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v6, v7);
  }
  else
  {
    dword_156DC(v5, &v9, 372);
    _aeabi_memclr8(&v9, 372);
  }
  return _stack_chk_guard - v10;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C5C: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00007BC8) --------------------------------------------------------
int __fastcall sub_7BC8(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r4
  int v4; // r0
  bool v5; // zf
  int v6; // r0
  int v7; // r4
  const char *v8; // r0
  int v10; // [sp+Ch] [bp-24h]
  int v11; // [sp+10h] [bp-20h]
  int v12; // [sp+14h] [bp-1Ch]
  int v13; // [sp+18h] [bp-18h]

  v2 = a1;
  v3 = a2;
  _android_log_buf_print(1, 3, "RILC", "dispatchCdmaSmsAck");
  v11 = 0;
  v12 = 0;
  android::Parcel::readInt32(v2, &v10);
  v11 = v10;
  v4 = android::Parcel::readInt32(v2, &v10);
  v12 = v10;
  v5 = v4 == 0;
  v6 = *(_DWORD *)v3[1];
  if ( v5 )
  {
    dword_156DC(v6, &v11, 8);
    v11 = 0;
    v12 = 0;
  }
  else
  {
    v7 = *v3;
    v8 = j_requestToString(v6);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v7, v8);
  }
  return _stack_chk_guard - v13;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00007C78) --------------------------------------------------------
int __fastcall sub_7C78(android::Parcel *a1, int a2, unsigned int a3)
{
  unsigned int v3; // r8
  int v4; // r4
  int v5; // r6
  android::Parcel *v6; // r5
  int v7; // r7
  int v8; // r0
  signed int v9; // r1

  v3 = a3;
  v4 = a2;
  v5 = a3 >> 2;
  v6 = a1;
  android::Parcel::writeInt32(a1, a3 >> 2);
  v7 = 0;
  if ( v3 >> 2 )
  {
    do
    {
      android::Parcel::writeInt32(v6, **(_DWORD **)(v4 + 4 * v7));
      android::Parcel::writeInt32(v6, *(_DWORD *)(*(_DWORD *)(v4 + 4 * v7) + 4));
      android::Parcel::writeInt32(v6, *(_DWORD *)(*(_DWORD *)(v4 + 4 * v7) + 8));
      android::Parcel::writeInt32(v6, *(_DWORD *)(*(_DWORD *)(v4 + 4 * v7) + 12));
      android::Parcel::writeInt32(v6, *(unsigned __int8 *)(*(_DWORD *)(v4 + 4 * v7) + 16));
      v8 = v7 + 1;
      v9 = 1;
      if ( v7 + 1 > v7 )
        v9 = 0;
      if ( v9 )
        abort();
      ++v7;
    }
    while ( v8 < v5 );
  }
  return 0;
}

//----- (00007CEC) --------------------------------------------------------
int __fastcall sub_7CEC(android::Parcel *this, _QWORD *a2)
{
  android::Parcel *v2; // r4
  _QWORD *v3; // r5
  char *v4; // r11
  int v5; // r1
  char *v6; // r9
  int v7; // r6
  int v8; // r10
  int v9; // r0
  int v10; // r2
  signed int v11; // r1
  __int64 v12; // kr00_8
  const char *v13; // r0
  signed int v14; // r0
  int v15; // r4
  signed int v16; // r0
  signed int v17; // r0
  int result; // r0
  int v19; // [sp+0h] [bp-28h]
  int *v20; // [sp+4h] [bp-24h]
  _QWORD *v21; // [sp+8h] [bp-20h]
  int v22; // [sp+Ch] [bp-1Ch]
  int v23; // [sp+10h] [bp-18h]
  int v24; // [sp+14h] [bp-14h]

  v2 = this;
  v3 = a2;
  if ( android::Parcel::readInt32(this, &v22) )
    goto LABEL_10;
  v21 = v3;
  v20 = &v19;
  v4 = (char *)&v19 - ((20 * v22 + 7) & 0xFFFFFFF8);
  v5 = v22;
  v6 = (char *)&v19 - ((4 * v22 + 7) & 0xFFFFFFF8);
  if ( v22 > 0 )
  {
    v7 = 0;
    do
    {
      v8 = (int)&v4[20 * v7];
      *(_DWORD *)&v6[4 * v7] = v8;
      android::Parcel::readInt32(v2, &v23);
      *(_DWORD *)&v4[20 * v7] = v23;
      android::Parcel::readInt32(v2, &v23);
      *(_DWORD *)(v8 + 4) = v23;
      android::Parcel::readInt32(v2, &v23);
      *(_DWORD *)(v8 + 8) = v23;
      android::Parcel::readInt32(v2, &v23);
      *(_DWORD *)(v8 + 12) = v23;
      v9 = android::Parcel::readInt32(v2, &v23);
      v10 = v7 + 1;
      *(_BYTE *)(v8 + 16) = v23;
      v11 = 1;
      if ( v7 + 1 > v7 )
        v11 = 0;
      if ( v11 )
        goto LABEL_22;
      v5 = v22;
      ++v7;
    }
    while ( v10 < v22 );
    if ( v9 )
    {
      v3 = v21;
LABEL_10:
      v12 = *v3;
      v13 = j_requestToString(*(_DWORD *)(*v3 >> 32));
      _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v12, v13);
      goto LABEL_21;
    }
  }
  v14 = (unsigned __int64)(unsigned int)v5 >> 30;
  if ( !is_mul_ok(4u, v5) )
    v14 = 1;
  if ( v14 )
    goto LABEL_22;
  dword_156DC(**((_DWORD **)v21 + 1), v6, 4 * v5);
  v15 = v22;
  v16 = 20 * (unsigned __int64)(unsigned int)v22 >> 32;
  if ( !is_mul_ok(0x14u, v22) )
    v16 = 1;
  if ( v16 )
    goto LABEL_22;
  _aeabi_memclr8(v4, 20 * v22);
  v17 = (unsigned __int64)(unsigned int)v15 >> 30;
  if ( !is_mul_ok(4u, v15) )
    v17 = 1;
  if ( v17 )
LABEL_22:
    abort();
  _aeabi_memclr4(v6, 4 * v15);
LABEL_21:
  result = _stack_chk_guard - v24;
  if ( _stack_chk_guard != v24 )
    goto LABEL_22;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C5C: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 3C68: using guessed type int __fastcall _aeabi_memclr4(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00007E78) --------------------------------------------------------
int __fastcall sub_7E78(android::Parcel *a1, int a2, unsigned int a3)
{
  unsigned int v3; // r8
  int v4; // r4
  int v5; // r6
  android::Parcel *v6; // r5
  int v7; // r7
  int v8; // r0
  signed int v9; // r1

  v3 = a3;
  v4 = a2;
  v5 = a3 >> 2;
  v6 = a1;
  android::Parcel::writeInt32(a1, a3 >> 2);
  v7 = 0;
  if ( v3 >> 2 )
  {
    do
    {
      android::Parcel::writeInt32(v6, **(_DWORD **)(v4 + 4 * v7));
      android::Parcel::writeInt32(v6, *(_DWORD *)(*(_DWORD *)(v4 + 4 * v7) + 4));
      android::Parcel::writeInt32(v6, *(unsigned __int8 *)(*(_DWORD *)(v4 + 4 * v7) + 8));
      v8 = v7 + 1;
      v9 = 1;
      if ( v7 + 1 > v7 )
        v9 = 0;
      if ( v9 )
        abort();
      ++v7;
    }
    while ( v8 < v5 );
  }
  return 0;
}

//----- (00007ED4) --------------------------------------------------------
int __fastcall sub_7ED4(android::Parcel *this, _QWORD *a2)
{
  android::Parcel *v2; // r4
  _QWORD *v3; // r5
  char *v4; // r11
  int v5; // r1
  char *v6; // r9
  int v7; // r6
  int v8; // r8
  int v9; // r0
  int v10; // r2
  signed int v11; // r1
  __int64 v12; // kr00_8
  const char *v13; // r0
  signed int v14; // r0
  int v15; // r4
  signed int v16; // r0
  signed int v17; // r0
  int result; // r0
  int v19; // [sp+0h] [bp-28h]
  int *v20; // [sp+4h] [bp-24h]
  _QWORD *v21; // [sp+8h] [bp-20h]
  int v22; // [sp+Ch] [bp-1Ch]
  int v23; // [sp+10h] [bp-18h]
  int v24; // [sp+14h] [bp-14h]

  v2 = this;
  v3 = a2;
  if ( android::Parcel::readInt32(this, &v22) )
    goto LABEL_10;
  v21 = v3;
  v20 = &v19;
  v4 = (char *)&v19 - ((12 * v22 + 7) & 0xFFFFFFF8);
  v5 = v22;
  v6 = (char *)&v19 - ((4 * v22 + 7) & 0xFFFFFFF8);
  if ( v22 > 0 )
  {
    v7 = 0;
    do
    {
      v8 = (int)&v4[12 * v7];
      *(_DWORD *)&v6[4 * v7] = v8;
      android::Parcel::readInt32(v2, &v23);
      *(_DWORD *)&v4[12 * v7] = v23;
      android::Parcel::readInt32(v2, &v23);
      *(_DWORD *)(v8 + 4) = v23;
      v9 = android::Parcel::readInt32(v2, &v23);
      v10 = v7 + 1;
      *(_BYTE *)(v8 + 8) = v23;
      v11 = 1;
      if ( v7 + 1 > v7 )
        v11 = 0;
      if ( v11 )
        goto LABEL_22;
      v5 = v22;
      ++v7;
    }
    while ( v10 < v22 );
    if ( v9 )
    {
      v3 = v21;
LABEL_10:
      v12 = *v3;
      v13 = j_requestToString(*(_DWORD *)(*v3 >> 32));
      _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v12, v13);
      goto LABEL_21;
    }
  }
  v14 = (unsigned __int64)(unsigned int)v5 >> 30;
  if ( !is_mul_ok(4u, v5) )
    v14 = 1;
  if ( v14 )
    goto LABEL_22;
  dword_156DC(**((_DWORD **)v21 + 1), v6, 4 * v5);
  v15 = v22;
  v16 = 12 * (unsigned __int64)(unsigned int)v22 >> 32;
  if ( !is_mul_ok(0xCu, v22) )
    v16 = 1;
  if ( v16 )
    goto LABEL_22;
  _aeabi_memclr8(v4, 12 * v22);
  v17 = (unsigned __int64)(unsigned int)v15 >> 30;
  if ( !is_mul_ok(4u, v15) )
    v17 = 1;
  if ( v17 )
LABEL_22:
    abort();
  _aeabi_memclr4(v6, 4 * v15);
LABEL_21:
  result = _stack_chk_guard - v24;
  if ( _stack_chk_guard != v24 )
    goto LABEL_22;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C5C: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 3C68: using guessed type int __fastcall _aeabi_memclr4(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00008040) --------------------------------------------------------
int __fastcall sub_8040(android::Parcel *a1, int *a2)
{
  android::Parcel *v2; // r5
  int *v3; // r8
  signed int v4; // r6
  signed int v5; // r7
  int v6; // r4
  int v7; // r0
  signed int v8; // r1
  int v9; // r6
  int v10; // r0
  signed int v11; // r1
  int v12; // r0
  int v13; // r7
  int v14; // r6
  int v15; // r1
  signed int v16; // r2
  int v17; // r4
  const char *v18; // r0
  int result; // r0
  unsigned __int8 v20; // [sp+Bh] [bp-1A5h]
  int v21; // [sp+Ch] [bp-1A4h]
  int v22; // [sp+10h] [bp-1A0h]
  int v23; // [sp+14h] [bp-19Ch]
  unsigned __int8 v24; // [sp+18h] [bp-198h]
  int v25; // [sp+1Ch] [bp-194h]
  int v26; // [sp+20h] [bp-190h]
  int v27; // [sp+24h] [bp-18Ch]
  int v28; // [sp+28h] [bp-188h]
  int v29; // [sp+2Ch] [bp-184h]
  unsigned __int8 v30; // [sp+30h] [bp-180h]
  int v31; // [sp+58h] [bp-158h]
  unsigned __int8 v32; // [sp+5Ch] [bp-154h]
  unsigned __int8 v33; // [sp+5Dh] [bp-153h]
  int v34; // [sp+84h] [bp-12Ch]
  int v35; // [sp+18Ch] [bp-24h]

  v2 = a1;
  v3 = a2;
  _aeabi_memclr8(&v22, 376);
  android::Parcel::readInt32(v2, &v21);
  v22 = v21;
  android::Parcel::readInt32(v2, &v21);
  v23 = v21;
  android::Parcel::read(v2, &v20, 1u);
  v24 = v20;
  android::Parcel::readInt32(v2, &v21);
  v25 = v21;
  android::Parcel::readInt32(v2, &v21);
  v26 = v21;
  android::Parcel::readInt32(v2, &v21);
  v27 = v21;
  android::Parcel::readInt32(v2, &v21);
  v28 = v21;
  android::Parcel::readInt32(v2, &v21);
  v29 = v21;
  android::Parcel::read(v2, &v20, 1u);
  v4 = v20;
  v5 = 36;
  v30 = v20;
  if ( v20 >= 0x24u )
    v4 = 36;
  if ( v4 >= 1 )
  {
    v6 = 0;
    while ( 1 )
    {
      android::Parcel::read(v2, &v20, 1u);
      *((_BYTE *)&v22 + v6 + 33) = v20;
      v7 = v6 + 1;
      v8 = 1;
      if ( v6 + 1 > v6 )
        v8 = 0;
      if ( v8 )
        break;
      ++v6;
      if ( v7 >= v4 )
        goto LABEL_9;
    }
LABEL_29:
    abort();
  }
LABEL_9:
  android::Parcel::readInt32(v2, &v21);
  v31 = v21;
  android::Parcel::read(v2, &v20, 1u);
  v32 = v20;
  android::Parcel::read(v2, &v20, 1u);
  v33 = v20;
  if ( v20 < 0x24u )
    v5 = v20;
  if ( v5 >= 1 )
  {
    v9 = 0;
    do
    {
      android::Parcel::read(v2, &v20, 1u);
      *((_BYTE *)&v22 + v9 + 78) = v20;
      v10 = v9 + 1;
      v11 = 1;
      if ( v9 + 1 > v9 )
        v11 = 0;
      if ( v11 )
        goto LABEL_29;
      ++v9;
    }
    while ( v10 < v5 );
  }
  v12 = android::Parcel::readInt32(v2, &v21);
  v13 = v21;
  v34 = v21;
  if ( v21 >= 255 )
    v13 = 255;
  if ( v13 >= 1 )
  {
    v14 = 0;
    do
    {
      v12 = android::Parcel::read(v2, &v20, 1u);
      *((_BYTE *)&v22 + v14 + 120) = v20;
      v15 = v14 + 1;
      v16 = 1;
      if ( v14 + 1 > v14 )
        v16 = 0;
      if ( v16 )
        goto LABEL_29;
      ++v14;
    }
    while ( v15 < v13 );
  }
  if ( v12 )
  {
    v17 = *v3;
    v18 = j_requestToString(*(_DWORD *)v3[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v17, v18);
  }
  else
  {
    dword_156DC(*(_DWORD *)v3[1], &v22, 376);
    _aeabi_memclr8(&v22, 376);
  }
  result = _stack_chk_guard - v35;
  if ( _stack_chk_guard != v35 )
    goto LABEL_29;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C5C: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (0000824C) --------------------------------------------------------
int __fastcall sub_824C(int a1, int a2)
{
  int v2; // r4
  int v3; // r5
  int result; // r0

  v2 = a2;
  v3 = dword_156E0();
  if ( (v3 | 1) == 1 )
    j_RIL_onRequestComplete(v2, 1, 0, 0);
  if ( v3 == 10 )
    return dword_156DC(**(_DWORD **)(v2 + 4), 0, 0);
  if ( (unsigned int)(v3 - 2) >= 8 )
  {
    _android_log_buf_print(1, 3, "RILC", "decodeCdmaSubscriptionSource: Invoked with incorrect RadioState");
    android::cdmaSubscriptionSource = -1;
    result = j_j_RIL_onRequestComplete(v2, 2, 0, 0);
  }
  else
  {
    android::cdmaSubscriptionSource = dword_131F0[v3 - 2];
    result = j_j_RIL_onRequestComplete(v2, 0, (int)&android::cdmaSubscriptionSource, 4);
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 15010: using guessed type int android::cdmaSubscriptionSource;
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);
// 156E0: using guessed type int (*dword_156E0)(void);

//----- (000082FC) --------------------------------------------------------
int __fastcall sub_82FC(int a1, int a2)
{
  int v2; // r4
  int v3; // r0
  unsigned int v5; // r0

  v2 = a2;
  v3 = dword_156E0();
  if ( !v3 || v3 == 10 )
    return dword_156DC(**(_DWORD **)(v2 + 4), 0, 0);
  if ( v3 == 1 )
  {
    j_RIL_onRequestComplete(v2, 1, 0, 0);
  }
  else
  {
    v5 = v3 - 2;
    if ( v5 < 8 )
    {
      android::voiceRadioTech = dword_13210[v5];
      return j_j_RIL_onRequestComplete(v2, 0, (int)&android::voiceRadioTech, 4);
    }
  }
  _android_log_buf_print(1, 3, "RILC", "decodeVoiceRadioTechnology: Invoked with incorrect RadioState");
  android::voiceRadioTech = -1;
  return j_j_RIL_onRequestComplete(v2, 2, 0, 0);
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 1500C: using guessed type int android::voiceRadioTech;
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);
// 156E0: using guessed type int (*dword_156E0)(void);

//----- (000083A8) --------------------------------------------------------
int __fastcall sub_83A8(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r5
  android::Parcel *v4; // r4
  int v5; // r7
  unsigned int v6; // r6
  const char *v7; // r3
  int result; // r0
  int v9; // r1
  int v10; // r1
  signed int v11; // r0
  unsigned int v12; // [sp+0h] [bp-80h]
  signed int v13; // [sp+4h] [bp-7Ch]
  char v14; // [sp+Ch] [bp-74h]
  int v15; // [sp+68h] [bp-18h]

  v4 = this;
  v5 = a2;
  v6 = a3;
  if ( android::s_callbacks > 12 )
  {
    if ( !(a3 % 0x48)
      || (_android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_CellInfo_v12"),
          v3 = (int)&v14,
          property_get("ro.debuggable", &v14, "0"),
          !strcmp(&v14, "1")) )
    {
      result = sub_A024(v4, v5, v6);
      goto LABEL_16;
    }
  }
  else
  {
    if ( android::s_callbacks > 11 )
    {
      _android_log_buf_print(1, 3, "RILC", "responseCellInfoList: v12");
      if ( _stack_chk_guard != v15 )
        goto LABEL_17;
      return sub_A024(v4, v5, v6);
    }
    _android_log_buf_print(1, 3, "RILC", "responseCellInfoList: v6");
    if ( v5 || !v6 )
    {
      v3 = v6 / 0x48;
      if ( !(v6 % 0x48) )
        goto LABEL_17;
      v12 = v6;
      v13 = 72;
      v7 = "responseCellInfoList: invalid response length %d expected multiple of %d";
    }
    else
    {
      v7 = "invalid response: NULL";
    }
    _android_log_buf_print(1, 6, "RILC", v7, v12, v13);
  }
  result = -1;
LABEL_16:
  while ( _stack_chk_guard != v15 )
  {
LABEL_17:
    android::Parcel::writeInt32(v4, v3);
    if ( v6 < 0x48 )
    {
      result = 0;
    }
    else
    {
      v6 = v5 + 32;
      v5 = 0;
      do
      {
        android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 32));
        android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 28));
        android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 24));
        android::Parcel::writeInt64(v4, *(_QWORD *)(v6 - 16));
        switch ( *(_DWORD *)(v6 - 32) )
        {
          case 1:
          case 5:
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 8));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 4));
            android::Parcel::writeInt32(v4, *(_DWORD *)v6);
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 4));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 8));
            v9 = *(_DWORD *)(v6 + 12);
            goto LABEL_24;
          case 2:
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 8));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 4));
            android::Parcel::writeInt32(v4, *(_DWORD *)v6);
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 4));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 8));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 12));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 16));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 20));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 24));
            v9 = *(_DWORD *)(v6 + 28);
            goto LABEL_24;
          case 3:
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 8));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 4));
            android::Parcel::writeInt32(v4, *(_DWORD *)v6);
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 4));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 8));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 12));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 16));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 20));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 24));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 28));
            v9 = *(_DWORD *)(v6 + 32);
            goto LABEL_24;
          case 4:
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 8));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 - 4));
            android::Parcel::writeInt32(v4, *(_DWORD *)v6);
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 4));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 8));
            android::Parcel::writeInt32(v4, *(_DWORD *)(v6 + 12));
            v9 = *(_DWORD *)(v6 + 16);
LABEL_24:
            android::Parcel::writeInt32(v4, v9);
            break;
          default:
            break;
        }
        v10 = v5 + 1;
        v11 = 1;
        if ( v5 + 1 > v5 )
          v11 = 0;
        if ( v11 )
          abort();
        v6 += 72;
        result = 0;
        ++v5;
      }
      while ( v10 < v3 );
    }
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BD8: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;

//----- (00008684) --------------------------------------------------------
int __fastcall sub_8684(android::Parcel *this, unsigned __int64 *a2)
{
  android::Parcel *v2; // r4
  unsigned __int64 *v3; // r5
  int v4; // r0
  int v5; // r0
  int v6; // r6
  int v7; // r0
  int v8; // r0
  unsigned __int64 v9; // kr00_8
  const char *v10; // r0
  void *v11; // r5
  int v12; // r0
  void *v13; // r5
  int v14; // r0
  int v15; // r5
  int v16; // r0
  void *v17; // r5
  int v18; // r0
  int v20; // [sp+Ch] [bp-4h]
  void *ptr; // [sp+10h] [bp+0h]
  void *v22; // [sp+14h] [bp+4h]
  __int64 v23; // [sp+18h] [bp+8h]
  void *v24; // [sp+20h] [bp+10h]
  unsigned int v25; // [sp+28h] [bp+18h]
  int v26; // [sp+2Ch] [bp+1Ch]

  v2 = this;
  v3 = a2;
  v23 = 0LL;
  v4 = android::Parcel::readString16Inplace(this, &v25);
  ptr = (void *)strndup16to8(v4, v25);
  v5 = android::Parcel::readString16Inplace(v2, &v25);
  v22 = (void *)strndup16to8(v5, v25);
  v6 = android::Parcel::readInt32(v2, &v20);
  LODWORD(v23) = v20;
  v7 = android::Parcel::readString16Inplace(v2, &v25);
  HIDWORD(v23) = strndup16to8(v7, v25);
  v8 = android::Parcel::readString16Inplace(v2, &v25);
  v24 = (void *)strndup16to8(v8, v25);
  if ( v6 )
  {
    v9 = *v3;
    v10 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v9, v10);
  }
  else
  {
    dword_156DC(**((_DWORD **)v3 + 1), &ptr, 20);
    v11 = ptr;
    if ( ptr )
    {
      v12 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v11, v12);
    }
    v13 = v22;
    if ( v22 )
    {
      v14 = _strlen_chk(v22, -1);
      _aeabi_memclr(v13, v14);
    }
    v15 = HIDWORD(v23);
    if ( HIDWORD(v23) )
    {
      v16 = _strlen_chk(HIDWORD(v23), -1);
      _aeabi_memclr(v15, v16);
    }
    v17 = v24;
    if ( v24 )
    {
      v18 = _strlen_chk(v24, -1);
      _aeabi_memclr(v17, v18);
    }
    free(ptr);
    free(v22);
    free((void *)HIDWORD(v23));
    free(v24);
    *(_QWORD *)&ptr = 0LL;
    v23 = 0LL;
    v24 = 0;
  }
  return _stack_chk_guard - v26;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (000087D4) --------------------------------------------------------
int __fastcall sub_87D4(android::Parcel *this, int **a2)
{
  android::Parcel *v2; // r5
  int **v3; // r4
  int v4; // r6
  const char *v5; // r0
  const char *v6; // r3
  int result; // r0
  int v8; // r7
  const char *v9; // r0
  unsigned __int8 v10; // r7
  int v11; // r0
  int *v12; // r1
  size_t v13; // r8
  signed int v14; // r1
  int v15; // r7
  int v16; // r0
  int v17; // r0
  signed int v18; // r1
  signed int v19; // r0
  int v20; // r7
  int v21; // r0
  void *v22; // r0
  int v23; // r0
  signed int v24; // r1
  const char *v25; // r0
  void *v26; // [sp+0h] [bp-1D0h]
  const char *v27; // [sp+4h] [bp-1CCh]
  int v28; // [sp+8h] [bp-1C8h]
  unsigned __int8 v29; // [sp+Fh] [bp-1C1h]
  int v30; // [sp+10h] [bp-1C0h]
  size_t nmemb; // [sp+14h] [bp-1BCh]
  unsigned int v32; // [sp+18h] [bp-1B8h]
  int v33; // [sp+1Ch] [bp-1B4h]
  int v34; // [sp+20h] [bp-1B0h]
  int *v35; // [sp+24h] [bp-1ACh]
  int v36; // [sp+28h] [bp-1A8h]
  char v37; // [sp+2Ch] [bp-1A4h]
  __int64 v38; // [sp+30h] [bp-1A0h]
  int v39; // [sp+19Ch] [bp-34h]

  v2 = this;
  v3 = a2;
  v4 = android::Parcel::readInt32(this, &v30);
  _android_log_buf_print(1, 3, "RILC", "dispatchImsSms");
  if ( !v4 )
  {
    v4 = v30;
    if ( !android::Parcel::read(v2, &v29, 1u) && !android::Parcel::read(v2, &v28, 4u) )
      goto LABEL_8;
  }
  v2 = (android::Parcel *)*(_QWORD *)v3;
  v5 = j_requestToString(*(_DWORD *)(*(_QWORD *)v3 >> 32));
  v26 = (void *)v2;
  v6 = "invalid command block for token %d request %s";
LABEL_5:
  v27 = v5;
LABEL_6:
  _android_log_buf_print(1, 6, "RILC", v6, v26, v27);
  while ( 1 )
  {
    result = _stack_chk_guard - v39;
    if ( _stack_chk_guard == v39 )
      return result;
LABEL_8:
    if ( v4 == 2 )
    {
      v4 = v28;
      v10 = v29;
      _android_log_buf_print(1, 3, "RILC", "dispatchImsCdmaSms: retry=%d, messageRef=%d", v29, v28);
      v11 = sub_9E8C(v2, (int)&v36);
      v12 = v3[1];
      if ( v11 )
      {
        v3 = (int **)*v3;
        v5 = j_requestToString(*v12);
        v26 = v3;
        v6 = "invalid command block for token %d request %s";
        goto LABEL_5;
      }
      v33 = 0;
      v32 = 2;
      LOBYTE(v33) = v10;
      v2 = (android::Parcel *)&v32;
      v34 = v4;
      v35 = &v36;
      dword_156DC(*v12, &v32, 381);
      _aeabi_memclr8(&v36, 372);
      *(_QWORD *)&v32 = 0LL;
      *(_QWORD *)&v34 = 0LL;
    }
    else if ( v4 == 1 )
    {
      v8 = v28;
      v4 = v29;
      _android_log_buf_print(1, 3, "RILC", "dispatchImsGsmSms: retry=%d, messageRef=%d", v29, v28);
      if ( android::Parcel::readInt32(v2, (int *)&nmemb) )
      {
        v2 = (android::Parcel *)"RILC";
        _android_log_print(6, "RILC", "dispatchImsGsmSms invalid block");
        v4 = *(_QWORD *)v3;
        v9 = j_requestToString(*(_DWORD *)(*(_QWORD *)v3 >> 32));
        _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v4, v9);
      }
      else
      {
        *(_QWORD *)&v36 = 0LL;
        v38 = 0LL;
        v36 = 1;
        v37 = v4;
        LODWORD(v38) = v8;
        if ( nmemb )
        {
          v13 = 0;
          if ( (nmemb & 0x80000000) == 0 )
          {
            if ( 0 != nmemb >> 29 )
            {
              v6 = "Invalid value of countStrings: \n";
              goto LABEL_6;
            }
            v14 = (unsigned __int64)nmemb >> 30;
            v13 = 4 * nmemb;
            if ( !is_mul_ok(4u, nmemb) )
              v14 = 1;
            if ( v14 )
              goto LABEL_50;
            v4 = (int)calloc(nmemb, 4u);
            if ( v4 )
            {
              v15 = 0;
              while ( 1 )
              {
                v16 = android::Parcel::readString16Inplace(v2, &v32);
                *(_DWORD *)(v4 + 4 * v15) = strndup16to8(v16, v32);
                v17 = v15 + 1;
                v18 = 1;
                if ( v15 + 1 > v15 )
                  v18 = 0;
                if ( v18 )
                  break;
                ++v15;
                if ( v17 >= (signed int)nmemb )
                  goto LABEL_32;
              }
LABEL_50:
              abort();
            }
            v25 = j_requestToString(*v3[1]);
            v6 = "Memory allocation failed for request %s";
            goto LABEL_49;
          }
          v4 = 0;
        }
        else
        {
          v4 = (int)calloc(1u, 4u);
          if ( !v4 )
          {
            v25 = j_requestToString(*v3[1]);
            v6 = "Memory allocation failed for request %s";
LABEL_49:
            v26 = (void *)v25;
            goto LABEL_6;
          }
          v13 = 0;
        }
LABEL_32:
        v19 = 1;
        HIDWORD(v38) = v4;
        if ( v13 + 9 >= v13 )
          v19 = 0;
        if ( v19 )
          goto LABEL_50;
        v2 = (android::Parcel *)&v36;
        dword_156DC(*v3[1], &v36, v13 + 9);
        if ( v4 )
        {
          if ( (signed int)nmemb > 0 )
          {
            v20 = 0;
            do
            {
              v3 = *(int ***)(v4 + 4 * v20);
              if ( v3 )
              {
                v21 = _strlen_chk(*(_DWORD *)(v4 + 4 * v20), -1);
                _aeabi_memclr(v3, v21);
                v22 = *(void **)(v4 + 4 * v20);
              }
              else
              {
                v22 = 0;
              }
              free(v22);
              v23 = v20 + 1;
              v24 = 1;
              if ( v20 + 1 > v20 )
                v24 = 0;
              if ( v24 )
                goto LABEL_50;
              ++v20;
            }
            while ( v23 < (signed int)nmemb );
          }
          free((void *)v4);
        }
        *(_QWORD *)&v36 = 0LL;
        v38 = 0LL;
      }
    }
    else
    {
      _android_log_print(6, "RILC", "requestImsSendSMS invalid format value =%d", v4);
    }
  }
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 3C5C: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 3C8C: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00008AE4) --------------------------------------------------------
int __fastcall sub_8AE4(android::Parcel *this, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r4
  int v4; // r6
  int v5; // r0
  unsigned __int64 v6; // kr00_8
  const char *v7; // r0
  int v8; // r4
  int v9; // r0
  void *v10; // r0
  int v12; // [sp+8h] [bp+0h]
  int v13; // [sp+Ch] [bp+4h]
  int v14; // [sp+10h] [bp+8h]
  int v15; // [sp+14h] [bp+Ch]
  int v16; // [sp+18h] [bp+10h]
  int v17; // [sp+1Ch] [bp+14h]
  void *v18; // [sp+20h] [bp+18h]
  int v19; // [sp+24h] [bp+1Ch]
  unsigned int v20; // [sp+28h] [bp+20h]
  int v21; // [sp+2Ch] [bp+24h]

  v2 = this;
  v3 = a2;
  android::Parcel::readInt32(this, &v19);
  v12 = v19;
  android::Parcel::readInt32(v2, &v19);
  v13 = v19;
  android::Parcel::readInt32(v2, &v19);
  v14 = v19;
  android::Parcel::readInt32(v2, &v19);
  v15 = v19;
  android::Parcel::readInt32(v2, &v19);
  v16 = v19;
  v4 = android::Parcel::readInt32(v2, &v19);
  v17 = v19;
  v5 = android::Parcel::readString16Inplace(v2, &v20);
  v18 = (void *)strndup16to8(v5, v20);
  if ( v4 )
  {
    v6 = *v3;
    v7 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(
      1,
      6,
      "RILC",
      "invalid command block for token %d request %s",
      (_DWORD)v6,
      v7,
      v12,
      v13,
      v14,
      v15,
      v16,
      v17);
  }
  else
  {
    dword_156DC(**((_DWORD **)v3 + 1), &v12, 28);
    v8 = (int)v18;
    if ( v18 )
    {
      v9 = _strlen_chk(v18, -1);
      _aeabi_memclr(v8, v9);
      v10 = v18;
    }
    else
    {
      v10 = 0;
    }
    free(v10);
    *(_QWORD *)&v15 = 0LL;
    *(_QWORD *)&v17 = 0LL;
    *(_QWORD *)&v12 = 0LL;
    *(_QWORD *)&v14 = 0LL;
  }
  return _stack_chk_guard - v21;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00008BFC) --------------------------------------------------------
int __fastcall sub_8BFC(android::Parcel *a1, int *a2)
{
  int *v2; // r4
  int v3; // r0
  bool v4; // zf
  int v5; // r0
  int v6; // r4
  const char *v7; // r0
  int v9; // [sp+Ch] [bp-14h]
  int v10; // [sp+10h] [bp-10h]
  int v11; // [sp+14h] [bp-Ch]

  v2 = a2;
  v3 = android::Parcel::readInt32(a1, &v9);
  v10 = v9;
  v4 = v3 == 0;
  v5 = *(_DWORD *)v2[1];
  if ( v4 )
  {
    dword_156DC(v5, &v10, 4);
    v10 = 0;
  }
  else
  {
    v6 = *v2;
    v7 = j_requestToString(v5);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v6, v7);
  }
  return _stack_chk_guard - v11;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00008C7C) --------------------------------------------------------
int __fastcall sub_8C7C(android::Parcel *this, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r4
  int v4; // r6
  int v5; // r0
  void *v6; // r0
  void *v7; // r4
  void *v8; // r0
  int v9; // r0
  unsigned __int64 v10; // kr00_8
  const char *v11; // r0
  int v13; // [sp+Ch] [bp-24h]
  int v14; // [sp+10h] [bp-20h]
  void *ptr; // [sp+14h] [bp-1Ch]
  unsigned int v16; // [sp+18h] [bp-18h]
  int v17; // [sp+1Ch] [bp-14h]

  v2 = this;
  v3 = a2;
  v14 = 0;
  ptr = 0;
  v4 = android::Parcel::readInt32(this, &v13);
  v14 = v13;
  v5 = android::Parcel::readString16Inplace(v2, &v16);
  v6 = (void *)strndup16to8(v5, v16);
  ptr = v6;
  if ( v4 || !v6 )
  {
    v10 = *v3;
    v11 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v10, v11);
  }
  else
  {
    dword_156DC(**((_DWORD **)v3 + 1), &v14, 8);
    v7 = ptr;
    v8 = 0;
    if ( ptr )
    {
      v9 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v7, v9);
      v8 = ptr;
    }
    free(v8);
    v14 = 0;
    ptr = 0;
  }
  return _stack_chk_guard - v17;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00008D38) --------------------------------------------------------
int __fastcall sub_8D38(android::Parcel *this, int a2)
{
  int (__fastcall *v2)(_DWORD, _DWORD, _DWORD); // r7
  int v3; // r8
  android::Parcel *v4; // r6
  int v5; // r4
  int *v6; // r5
  const char *v7; // r0
  int result; // r0
  int v9; // [sp+Ch] [bp-44h]
  int v10; // [sp+10h] [bp-40h]
  int v11; // [sp+14h] [bp-3Ch]
  __int64 v12; // [sp+18h] [bp-38h]
  int v13; // [sp+24h] [bp-2Ch]

  v4 = this;
  v5 = a2;
  v6 = &v10;
  *(_QWORD *)&v10 = 0LL;
  v12 = 0LL;
  if ( !android::Parcel::readInt32(this, &v9) )
  {
    v2 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD))v9;
    v10 = v9;
    if ( !android::Parcel::readInt32(v4, &v9) )
    {
      v3 = v9;
      v11 = v9;
      if ( !android::Parcel::readInt32(v4, &v9) )
      {
        LODWORD(v12) = v9;
        if ( !android::Parcel::readInt32(v4, &v9) )
          goto LABEL_7;
      }
    }
  }
  v6 = (int *)*(_QWORD *)v5;
  v7 = j_requestToString(*(_DWORD *)(*(_QWORD *)v5 >> 32));
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v6, v7);
  while ( 1 )
  {
    result = _stack_chk_guard - v13;
    if ( _stack_chk_guard == v13 )
      break;
LABEL_7:
    HIDWORD(v12) = v9;
    _android_log_buf_print(1, 3, "RILC", "dispatchUiccSubscription, slot=%d, app_index=%d, act_status = %d", v2, v3, v9);
    v2 = dword_156DC;
    dword_156DC(**(_DWORD **)(v5 + 4), v6, 16);
    *(_QWORD *)v6 = 0LL;
    *((_QWORD *)v6 + 1) = 0LL;
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00008E1C) --------------------------------------------------------
int __fastcall sub_8E1C(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  unsigned int v4; // r6
  android::Parcel *v5; // r5
  const char *v6; // r3
  signed int v7; // r8
  int v8; // r7
  int v10; // r1
  int *v11; // r6
  int v12; // r6
  int v13; // r0
  signed int v14; // r1
  unsigned int v15; // [sp+0h] [bp-20h]
  signed int v16; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v6, v15, v16);
    return -1;
  }
  v7 = a3 / 0x88;
  if ( a3 % 0x88 )
  {
    v15 = a3;
    v16 = 136;
    v6 = "responseHardwareConfig: invalid response length %d expected multiple of %d";
    goto LABEL_6;
  }
  android::Parcel::writeInt32(this, a3 / 0x88);
  v8 = 0;
  if ( v4 >= 0x88 )
  {
    do
    {
      v10 = *(_DWORD *)(v3 + 136 * v8);
      if ( v10 == 1 )
      {
        v12 = v3 + 136 * v8;
        sub_9C8C((int)v5, v12 + 4);
        android::Parcel::writeInt32(v5, *(_DWORD *)(v12 + 68));
        sub_9C8C((int)v5, v12 + 72);
      }
      else if ( !v10 )
      {
        v11 = (int *)(v3 + 136 * v8);
        sub_9C8C((int)v5, (int)(v11 + 1));
        android::Parcel::writeInt32(v5, v11[17]);
        android::Parcel::writeInt32(v5, v11[19]);
        android::Parcel::writeInt32(v5, v11[20]);
        android::Parcel::writeInt32(v5, v11[21]);
        android::Parcel::writeInt32(v5, v11[22]);
      }
      v13 = v8 + 1;
      v14 = 1;
      if ( v8 + 1 > v8 )
        v14 = 0;
      if ( v14 )
        abort();
      ++v8;
    }
    while ( v13 < v7 );
    v8 = 0;
  }
  return v8;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00008F0C) --------------------------------------------------------
int __fastcall sub_8F0C(android::Parcel *this, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r4
  int v4; // r6
  int v5; // r0
  int v6; // r0
  unsigned __int64 v7; // kr00_8
  const char *v8; // r0
  void *v9; // r4
  int v10; // r0
  void *v11; // r4
  int v12; // r0
  int v14; // [sp+Ch] [bp-2Ch]
  int v15; // [sp+10h] [bp-28h]
  void *ptr; // [sp+14h] [bp-24h]
  void *v17; // [sp+18h] [bp-20h]
  unsigned int v18; // [sp+20h] [bp-18h]
  int v19; // [sp+24h] [bp-14h]

  v2 = this;
  v3 = a2;
  v15 = 0;
  ptr = 0;
  v4 = android::Parcel::readInt32(this, &v14);
  v15 = v14;
  v5 = android::Parcel::readString16Inplace(v2, &v18);
  ptr = (void *)strndup16to8(v5, v18);
  v6 = android::Parcel::readString16Inplace(v2, &v18);
  v17 = (void *)strndup16to8(v6, v18);
  if ( v4 )
  {
    v7 = *v3;
    v8 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v7, v8);
  }
  else
  {
    dword_156DC(**((_DWORD **)v3 + 1), &v15, 12);
    v9 = ptr;
    if ( ptr )
    {
      v10 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v9, v10);
    }
    v11 = v17;
    if ( v17 )
    {
      v12 = _strlen_chk(v17, -1);
      _aeabi_memclr(v11, v12);
    }
    free(ptr);
    free(v17);
    v15 = 0;
    ptr = 0;
    v17 = 0;
  }
  return _stack_chk_guard - v19;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00008FF4) --------------------------------------------------------
int __fastcall sub_8FF4(android::Parcel *this, __int64 *a2, int a3)
{
  __int64 *v3; // r5
  android::Parcel *v4; // r4
  int result; // r0

  v3 = a2;
  v4 = this;
  if ( a3 == 16 )
  {
    android::Parcel::writeInt64(this, *a2);
    android::Parcel::writeInt32(v4, *((_DWORD *)v3 + 2));
    result = 0;
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "responseDcRtInfo: invalid response length %d expected multiple of %d", a3, 16);
    result = -1;
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009040) --------------------------------------------------------
int __fastcall sub_9040(android::Parcel *this, int a2)
{
  _DWORD *v2; // r9
  _DWORD *v3; // r10
  android::Parcel *v4; // r7
  int v5; // r5
  signed int v6; // r4
  int v7; // r8
  _DWORD *v8; // r4
  int v9; // r0
  int v10; // r0
  int v11; // r0
  int v12; // r0
  int v13; // r0
  signed int v14; // r2
  int v15; // r1
  const char *v16; // r0
  const char *v17; // r0
  int result; // r0
  signed int v19; // r0
  signed int v20; // r0
  signed int v21; // r0
  const char *v22; // r0
  size_t nmemb; // [sp+Ch] [bp-34h]
  int v24; // [sp+10h] [bp-30h]
  int v25; // [sp+14h] [bp-2Ch]
  int v26; // [sp+18h] [bp-28h]

  v4 = this;
  v5 = a2;
  if ( android::Parcel::readInt32(this, (int *)&nmemb) )
    goto LABEL_13;
  v6 = nmemb;
  if ( (nmemb & 0x80000000) != 0 )
    goto LABEL_13;
  v3 = calloc(nmemb, 0x2Cu);
  if ( v3 )
  {
    v2 = calloc(v6, 4u);
    if ( v2 )
    {
      if ( v6 < 1 )
        goto LABEL_16;
      v7 = 0;
      do
      {
        v8 = &v3[11 * v7];
        v2[v7] = v8;
        android::Parcel::readInt32(v4, &v24);
        v3[11 * v7] = v24;
        v9 = android::Parcel::readString16Inplace(v4, (unsigned int *)&v25);
        v8[1] = strndup16to8(v9, v25);
        v10 = android::Parcel::readString16Inplace(v4, (unsigned int *)&v25);
        v8[2] = strndup16to8(v10, v25);
        android::Parcel::readInt32(v4, &v24);
        v8[3] = v24;
        v11 = android::Parcel::readString16Inplace(v4, (unsigned int *)&v25);
        v8[4] = strndup16to8(v11, v25);
        v12 = android::Parcel::readString16Inplace(v4, (unsigned int *)&v25);
        v8[5] = strndup16to8(v12, v25);
        android::Parcel::readInt32(v4, &v24);
        v8[6] = v24;
        android::Parcel::readInt32(v4, &v24);
        v8[7] = v24;
        android::Parcel::readInt32(v4, &v24);
        v8[8] = v24;
        android::Parcel::readInt32(v4, &v24);
        v8[9] = v24;
        v13 = android::Parcel::readInt32(v4, &v24);
        v14 = 1;
        v8[10] = v24;
        v15 = v7 + 1;
        if ( v7 + 1 > v7 )
          v14 = 0;
        if ( v14 )
          goto LABEL_27;
        v6 = nmemb;
        ++v7;
      }
      while ( v15 < (signed int)nmemb );
      if ( !v13 )
        goto LABEL_16;
      free(v3);
      free(v2);
LABEL_13:
      v6 = *(_QWORD *)v5;
      v16 = j_requestToString(*(_DWORD *)(*(_QWORD *)v5 >> 32));
      _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v6, v16);
      goto LABEL_15;
    }
    v22 = j_requestToString(**(_DWORD **)(v5 + 4));
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v22);
    free(v3);
  }
  else
  {
    v17 = j_requestToString(**(_DWORD **)(v5 + 4));
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v17);
  }
LABEL_15:
  while ( 1 )
  {
    result = _stack_chk_guard - v26;
    if ( _stack_chk_guard == v26 )
      return result;
LABEL_16:
    v19 = (unsigned __int64)(unsigned int)v6 >> 30;
    if ( !is_mul_ok(4u, v6) )
      v19 = 1;
    if ( v19 )
      goto LABEL_27;
    dword_156DC(**(_DWORD **)(v5 + 4), v2, 4 * v6);
    v6 = nmemb;
    v20 = 44 * (unsigned __int64)nmemb >> 32;
    if ( !is_mul_ok(0x2Cu, nmemb) )
      v20 = 1;
    if ( v20 )
      goto LABEL_27;
    _aeabi_memclr4(v3, 44 * nmemb);
    v21 = (unsigned __int64)(unsigned int)v6 >> 30;
    if ( !is_mul_ok(4u, v6) )
      v21 = 1;
    if ( v21 )
LABEL_27:
      abort();
    _aeabi_memclr4(v2, 4 * v6);
    free(v3);
    free(v2);
  }
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3C68: using guessed type int __fastcall _aeabi_memclr4(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00009258) --------------------------------------------------------
int __fastcall sub_9258(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 84 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(v4, v3[1]);
      android::Parcel::writeInt32(v4, v3[2]);
      android::Parcel::writeInt32(v4, v3[3]);
      sub_9C8C((int)v4, (int)(v3 + 4));
      android::Parcel::writeInt32(v4, v3[20]);
      return 0;
    }
    v7 = a3;
    v8 = 12;
    v6 = "invalid response length was %d expected %d";
  }
  else
  {
    v6 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000092DC) --------------------------------------------------------
int __fastcall sub_92DC(android::Parcel *a1, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r4
  int v4; // r0
  int v5; // r0
  int v6; // r0
  int v7; // r0
  int v8; // r7
  int v9; // r0
  unsigned int v10; // r2
  unsigned int v11; // r0
  signed int v12; // r1
  int v13; // r0
  unsigned __int64 v14; // kr00_8
  const char *v15; // r0
  int result; // r0
  int v17; // [sp+8h] [bp-78h]
  unsigned int v18; // [sp+Ch] [bp-74h]
  int v19; // [sp+10h] [bp-70h]
  int v20; // [sp+14h] [bp-6Ch]
  int v21; // [sp+18h] [bp-68h]
  int v22; // [sp+1Ch] [bp-64h]
  int v23; // [sp+20h] [bp-60h]
  int v24; // [sp+60h] [bp-20h]
  int v25; // [sp+68h] [bp-18h]

  v2 = a1;
  v3 = a2;
  _aeabi_memclr8(&v19, 84);
  v4 = android::Parcel::readInt32(v2, &v17);
  v19 = v17;
  if ( !v4 )
  {
    v5 = android::Parcel::readInt32(v2, &v17);
    v20 = v17;
    if ( !v5 )
    {
      v6 = android::Parcel::readInt32(v2, &v17);
      v21 = v17;
      if ( !v6 )
      {
        v7 = android::Parcel::readInt32(v2, &v17);
        v22 = v17;
        if ( !v7 )
        {
          v8 = android::Parcel::readString16Inplace(v2, &v18);
          if ( v8 )
          {
            v9 = strnlen16to8();
            v10 = v9;
            v11 = v9 + 1;
            v12 = 1;
            if ( v11 >= v10 )
              v12 = 0;
            if ( v12 )
              abort();
            if ( v11 <= 0x40 )
            {
              if ( strncpy16to8(&v23, v8) )
              {
                v13 = android::Parcel::readInt32(v2, &v17);
                v24 = v17;
                if ( !v13 )
                  goto LABEL_14;
              }
            }
          }
        }
      }
    }
  }
  v14 = *v3;
  v15 = j_requestToString(*(_DWORD *)(*v3 >> 32));
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v14, v15);
  while ( 1 )
  {
    result = _stack_chk_guard - v25;
    if ( _stack_chk_guard == v25 )
      break;
LABEL_14:
    dword_156DC(**((_DWORD **)v3 + 1), &v19, 84);
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3C5C: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 3C98: using guessed type int strnlen16to8(void);
// 3CA4: using guessed type int __fastcall strncpy16to8(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (000093DC) --------------------------------------------------------
int __fastcall sub_93DC(android::Parcel *this, void *a2, int a3)
{
  _DWORD *v3; // r4
  android::Parcel *v4; // r5
  int result; // r0

  v3 = a2;
  v4 = this;
  if ( a2 && a3 == 8 )
  {
    android::Parcel::write(this, a2, 1u);
    android::Parcel::writeInt32(v4, v3[1]);
    result = 0;
  }
  else
  {
    if ( a2 )
      _android_log_buf_print(1, 6, "RILC", "responseLceStatus: invalid response length %u expecting len: %u", 8, a3);
    else
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    result = -1;
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009440) --------------------------------------------------------
int __fastcall sub_9440(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  int result; // r0

  v3 = a2;
  v4 = this;
  if ( a2 && a3 == 8 )
  {
    android::Parcel::writeInt32(this, *a2);
    android::Parcel::write(v4, v3 + 1, 1u);
    android::Parcel::write(v4, (char *)v3 + 5, 1u);
    result = 0;
  }
  else
  {
    if ( a2 )
      _android_log_buf_print(1, 6, "RILC", "responseLceData: invalid response length %u expecting len: %u", 8, a3);
    else
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    result = -1;
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000094B4) --------------------------------------------------------
int __fastcall sub_94B4(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r4
  android::Parcel *v4; // r5
  int v5; // r7
  int v6; // r0
  signed int v7; // r1
  int result; // r0

  v3 = a2;
  v4 = this;
  if ( a2 && a3 == 32 )
  {
    android::Parcel::writeInt32(this, *a2);
    android::Parcel::writeInt32(v4, v3[1]);
    v5 = 0;
    do
    {
      android::Parcel::writeInt32(v4, v3[v5 + 2]);
      v6 = v5 + 1;
      v7 = 1;
      if ( v5 + 1 > v5 )
        v7 = 0;
      if ( v7 )
        abort();
      ++v5;
    }
    while ( v6 < 5 );
    android::Parcel::writeInt32(v4, v3[7]);
    result = 0;
  }
  else
  {
    if ( a2 )
      _android_log_buf_print(1, 6, "RILC", "responseActivityData: invalid response length %u expecting len: %u", 32, a3);
    else
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    result = -1;
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009544) --------------------------------------------------------
int __fastcall sub_9544(android::Parcel *this, int a2)
{
  _DWORD *v2; // r11
  android::Parcel *v3; // r7
  int v4; // r5
  _DWORD *v5; // r10
  signed int v6; // r6
  __int64 v7; // kr00_8
  const char *v8; // r0
  int result; // r0
  const char *v10; // r0
  signed int v11; // r8
  _DWORD *v12; // r0
  int v13; // r6
  int v14; // r0
  int v15; // r0
  _DWORD *v16; // r4
  int v17; // r0
  int v18; // r0
  int v19; // r0
  signed int v20; // r1
  int v21; // r6
  int v22; // r0
  int v23; // r0
  _DWORD *v24; // r4
  int v25; // r0
  int v26; // r0
  int v27; // r0
  signed int v28; // r1
  const char *v29; // r0
  size_t nmemb; // [sp+Ch] [bp-44h]
  __int64 v31; // [sp+10h] [bp-40h]
  __int64 v32; // [sp+18h] [bp-38h]
  unsigned int v33; // [sp+24h] [bp-2Ch]
  int v34; // [sp+28h] [bp-28h]

  v3 = this;
  v4 = a2;
  v31 = 0LL;
  v32 = 0LL;
  if ( android::s_callbacks > 13 )
  {
    if ( android::Parcel::readInt32(this, (int *)&nmemb) )
    {
      v5 = 0;
      v2 = 0;
    }
    else
    {
      v6 = nmemb;
      v2 = calloc(nmemb, 0x10u);
      if ( !v2 )
        goto LABEL_14;
      LODWORD(v31) = v6;
      LODWORD(v32) = v2;
      if ( android::Parcel::readInt32(v3, (int *)&nmemb) )
      {
        v5 = 0;
      }
      else
      {
        v11 = nmemb;
        v12 = calloc(nmemb, 0x10u);
        v5 = v12;
        if ( !v12 )
        {
          v29 = j_requestToString(**(_DWORD **)(v4 + 4));
          _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v29);
          goto LABEL_9;
        }
        HIDWORD(v31) = v11;
        HIDWORD(v32) = v12;
        if ( v6 >= 1 )
        {
          v13 = 0;
          do
          {
            v14 = android::Parcel::readString16Inplace(v3, &v33);
            v2[4 * v13] = strndup16to8(v14, v33);
            v15 = android::Parcel::readString16Inplace(v3, &v33);
            v16 = &v2[4 * v13];
            v16[1] = strndup16to8(v15, v33);
            v17 = android::Parcel::readInt32(v3, (int *)&nmemb);
            v16[2] = nmemb;
            if ( v17 )
              goto LABEL_8;
            v18 = android::Parcel::readString16Inplace(v3, &v33);
            v16[3] = strndup16to8(v18, v33);
            v19 = v13 + 1;
            v20 = 1;
            if ( v13 + 1 > v13 )
              v20 = 0;
            if ( v20 )
LABEL_33:
              abort();
            ++v13;
          }
          while ( v19 < (signed int)v31 );
          v11 = HIDWORD(v31);
        }
        if ( v11 < 1 )
        {
LABEL_31:
          dword_156DC(**(_DWORD **)(v4 + 4), &v31, 16);
          goto LABEL_9;
        }
        v21 = 0;
        while ( 1 )
        {
          v22 = android::Parcel::readString16Inplace(v3, &v33);
          v5[4 * v21] = strndup16to8(v22, v33);
          v23 = android::Parcel::readString16Inplace(v3, &v33);
          v24 = &v5[4 * v21];
          v24[1] = strndup16to8(v23, v33);
          v25 = android::Parcel::readInt32(v3, (int *)&nmemb);
          v24[2] = nmemb;
          if ( v25 )
            break;
          v26 = android::Parcel::readString16Inplace(v3, &v33);
          v24[3] = strndup16to8(v26, v33);
          v27 = v21 + 1;
          v28 = 1;
          if ( v21 + 1 > v21 )
            v28 = 0;
          if ( v28 )
            goto LABEL_33;
          ++v21;
          if ( v27 >= SHIDWORD(v31) )
            goto LABEL_31;
        }
      }
    }
LABEL_8:
    v7 = *(_QWORD *)v4;
    v8 = j_requestToString(*(_DWORD *)(*(_QWORD *)v4 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v7, v8);
    j_RIL_onRequestComplete(v4, 44, 0, 0);
    goto LABEL_9;
  }
  _android_log_buf_print(1, 6, "RILC", "Unsuppoted RIL version %d, min version expected %d", android::s_callbacks, 14);
  j_RIL_onRequestComplete(v4, 6, 0, 0);
  while ( 1 )
  {
    result = _stack_chk_guard - v34;
    if ( _stack_chk_guard == v34 )
      break;
LABEL_14:
    v10 = j_requestToString(**(_DWORD **)(v4 + 4));
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v10);
    v5 = 0;
LABEL_9:
    if ( v2 )
      free(v2);
    if ( v5 )
      free(v5);
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (000097A8) --------------------------------------------------------
int __fastcall sub_97A8(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r4
  android::Parcel *v4; // r5
  int v5; // r6
  int v6; // r7
  int *v7; // r7
  int v8; // r0
  signed int v9; // r1
  int v10; // r6
  int v11; // r7
  int *v12; // r7
  int v13; // r0
  signed int v14; // r1
  const char *v16; // r3
  int v17; // [sp+0h] [bp-20h]
  signed int v18; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = this;
  if ( !a2 )
  {
    v16 = "invalid response: NULL";
LABEL_18:
    _android_log_buf_print(1, 6, "RILC", v16, v17, v18);
    return -1;
  }
  if ( a3 != 16 )
  {
    v17 = a3;
    v18 = 16;
    v16 = "responseCarrierRestrictions: invalid response length %u expecting len: %u";
    goto LABEL_18;
  }
  android::Parcel::writeInt32(this, *a2);
  android::Parcel::writeInt32(v4, v3[1]);
  if ( *v3 >= 1 )
  {
    v5 = 0;
    while ( 1 )
    {
      v6 = v3[2];
      sub_9C8C((int)v4, *(_DWORD *)(v6 + 16 * v5));
      v7 = (int *)(v6 + 16 * v5);
      sub_9C8C((int)v4, v7[1]);
      android::Parcel::writeInt32(v4, v7[2]);
      sub_9C8C((int)v4, v7[3]);
      v8 = v5 + 1;
      v9 = 1;
      if ( v5 + 1 > v5 )
        v9 = 0;
      if ( v9 )
        break;
      ++v5;
      if ( v8 >= *v3 )
        goto LABEL_9;
    }
LABEL_20:
    abort();
  }
LABEL_9:
  if ( v3[1] >= 1 )
  {
    v10 = 0;
    while ( 1 )
    {
      v11 = v3[3];
      sub_9C8C((int)v4, *(_DWORD *)(v11 + 16 * v10));
      v12 = (int *)(v11 + 16 * v10);
      sub_9C8C((int)v4, v12[1]);
      android::Parcel::writeInt32(v4, v12[2]);
      sub_9C8C((int)v4, v12[3]);
      v13 = v10 + 1;
      v14 = 1;
      if ( v10 + 1 > v10 )
        v14 = 0;
      if ( v14 )
        break;
      ++v10;
      if ( v13 >= v3[1] )
        return 0;
    }
    goto LABEL_20;
  }
  return 0;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009898) --------------------------------------------------------
int __fastcall sub_9898(android::Parcel *this, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r4
  int v4; // r6
  int v5; // r0
  void *v6; // r0
  void *v7; // r4
  void *v8; // r0
  int v9; // r0
  unsigned __int64 v10; // kr00_8
  const char *v11; // r0
  char v13; // [sp+Fh] [bp-21h]
  int v14; // [sp+10h] [bp-20h]
  void *ptr; // [sp+14h] [bp-1Ch]
  unsigned int v16; // [sp+18h] [bp-18h]
  int v17; // [sp+1Ch] [bp-14h]

  v2 = this;
  v3 = a2;
  v14 = 0;
  ptr = 0;
  v4 = android::Parcel::read(this, &v13, 1u);
  LOBYTE(v14) = v13;
  v5 = android::Parcel::readString16Inplace(v2, &v16);
  v6 = (void *)strndup16to8(v5, v16);
  ptr = v6;
  if ( v4 || !v6 )
  {
    v10 = *v3;
    v11 = j_requestToString(*(_DWORD *)(*v3 >> 32));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v10, v11);
  }
  else
  {
    dword_156DC(**((_DWORD **)v3 + 1), &v14, 8);
    v7 = ptr;
    v8 = 0;
    if ( ptr )
    {
      v9 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v7, v9);
      v8 = ptr;
    }
    free(v8);
    v14 = 0;
    ptr = 0;
  }
  return _stack_chk_guard - v17;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (0000995C) --------------------------------------------------------
int __fastcall sub_995C(android::Parcel *this, unsigned __int64 *a2)
{
  android::Parcel *v2; // r5
  unsigned __int64 *v3; // r8
  int v4; // r0
  int v5; // r0
  int v6; // r0
  int v7; // r0
  int v8; // r4
  int v9; // r0
  int v10; // r0
  signed int v11; // r1
  int v12; // r0
  int v13; // r1
  unsigned __int64 v14; // kr00_8
  const char *v15; // r0
  int result; // r0
  int v17; // r4
  int v18; // r0
  int v19; // r0
  signed int v20; // r1
  void *v21; // r4
  int v22; // r0
  void *v23; // r4
  int v24; // r0
  int v25; // r6
  int *v26; // r7
  int v27; // r4
  void **v28; // r7
  int v29; // t1
  int v30; // r0
  void *v31; // r0
  int v32; // r0
  signed int v33; // r1
  int v34; // r6
  int *v35; // r7
  int v36; // r4
  void **v37; // r7
  int v38; // t1
  int v39; // r0
  void *v40; // r0
  int v41; // r0
  signed int v42; // r1
  int v43; // [sp+8h] [bp-50h]
  unsigned int v44; // [sp+Ch] [bp-4Ch]
  int v45; // [sp+10h] [bp-48h]
  void *ptr; // [sp+14h] [bp-44h]
  void *v47; // [sp+18h] [bp-40h]
  int v48; // [sp+1Ch] [bp-3Ch]
  int v49; // [sp+20h] [bp-38h]
  int v50; // [sp+28h] [bp-30h]
  __int64 v51; // [sp+2Ch] [bp-2Ch]
  __int64 v52; // [sp+34h] [bp-24h]
  int v53; // [sp+3Ch] [bp-1Ch]

  v2 = this;
  v3 = a2;
  v4 = android::Parcel::readInt32(this, &v43);
  v45 = v43;
  if ( !v4 )
  {
    v5 = android::Parcel::readString16Inplace(v2, &v44);
    ptr = (void *)strndup16to8(v5, v44);
    v6 = android::Parcel::readString16Inplace(v2, &v44);
    v47 = (void *)strndup16to8(v6, v44);
    v7 = android::Parcel::readInt32(v2, &v43);
    v48 = v43;
    if ( !v7 )
    {
      if ( v43 >= 1 )
      {
        v8 = 0;
        do
        {
          v9 = android::Parcel::readString16Inplace(v2, &v44);
          *(&v45 + v8 + 4) = strndup16to8(v9, v44);
          v10 = v8 + 1;
          v11 = 1;
          if ( v8 + 1 > v8 )
            v11 = 0;
          if ( v11 )
            goto LABEL_41;
          ++v8;
        }
        while ( v10 < v48 );
      }
      v12 = android::Parcel::readInt32(v2, &v43);
      v13 = v43;
      v50 = v43;
      if ( !v12 )
        goto LABEL_12;
    }
  }
  v14 = *v3;
  v15 = j_requestToString(*(_DWORD *)(*v3 >> 32));
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v14, v15);
  while ( 1 )
  {
    v13 = v53;
    result = _stack_chk_guard - v53;
    if ( _stack_chk_guard == v53 )
      return result;
LABEL_12:
    if ( v13 >= 1 )
    {
      v17 = 0;
      while ( 1 )
      {
        v18 = android::Parcel::readString16Inplace(v2, &v44);
        *(&v45 + v17 + 7) = strndup16to8(v18, v44);
        v19 = v17 + 1;
        v20 = 1;
        if ( v17 + 1 > v17 )
          v20 = 0;
        if ( v20 )
          break;
        ++v17;
        if ( v19 >= v50 )
          goto LABEL_18;
      }
LABEL_41:
      abort();
    }
LABEL_18:
    dword_156DC(**((_DWORD **)v3 + 1), &v45, 44);
    v21 = ptr;
    if ( ptr )
    {
      v22 = _strlen_chk(ptr, -1);
      _aeabi_memclr(v21, v22);
    }
    v23 = v47;
    if ( v47 )
    {
      v24 = _strlen_chk(v47, -1);
      _aeabi_memclr(v23, v24);
    }
    free(ptr);
    free(v47);
    if ( v48 > 0 )
    {
      v25 = 0;
      do
      {
        v26 = &v45 + v25;
        v29 = v26[4];
        v28 = (void **)(v26 + 4);
        v27 = v29;
        if ( v29 )
        {
          v30 = _strlen_chk(v27, -1);
          _aeabi_memclr(v27, v30);
          v31 = *v28;
        }
        else
        {
          v31 = 0;
        }
        free(v31);
        v32 = v25 + 1;
        v33 = 1;
        if ( v25 + 1 > v25 )
          v33 = 0;
        if ( v33 )
          goto LABEL_41;
        ++v25;
      }
      while ( v32 < v48 );
    }
    if ( v50 > 0 )
    {
      v34 = 0;
      do
      {
        v35 = &v45 + v34;
        v38 = v35[7];
        v37 = (void **)(v35 + 7);
        v36 = v38;
        if ( v38 )
        {
          v39 = _strlen_chk(v36, -1);
          _aeabi_memclr(v36, v39);
          v40 = *v37;
        }
        else
        {
          v40 = 0;
        }
        free(v40);
        v41 = v34 + 1;
        v42 = 1;
        if ( v34 + 1 > v34 )
          v42 = 0;
        if ( v42 )
          goto LABEL_41;
        ++v34;
      }
      while ( v41 < v50 );
    }
    v51 = 0LL;
    v52 = 0LL;
    *(_QWORD *)&v45 = 0LL;
    *(_QWORD *)&v47 = 0LL;
    v2 = (android::Parcel *)&v49;
    *(_QWORD *)&v49 = 0LL;
    *(_QWORD *)&v50 = 0LL;
  }
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 39B0: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 3BF0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);

//----- (00009B64) --------------------------------------------------------
int __fastcall sub_9B64(android::Parcel *a1, int *a2)
{
  int *v2; // r4
  android::Parcel *v3; // r5

  v2 = a2;
  v3 = a1;
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(v3, v2[1]);
  android::Parcel::writeInt32(v3, v2[2]);
  android::Parcel::writeInt32(v3, v2[3]);
  android::Parcel::writeInt32(v3, v2[4]);
  sub_9BCC(v3, v2[5], (int)(v2 + 6));
  android::Parcel::writeInt32(v3, v2[102]);
  return _android_log_buf_print(1, 3, "RILC", "FIH: SIM hotswap state: %d", v2[102]);
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009BCC) --------------------------------------------------------
int __fastcall sub_9BCC(android::Parcel *a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r8
  android::Parcel *v5; // r6
  int result; // r0
  int v7; // r7
  int *v8; // r5
  signed int v9; // r1
  int v10; // r5
  int *v11; // r7
  signed int v12; // r1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  result = android::Parcel::writeInt32(a1, a2);
  if ( v4 > 0 )
  {
    v7 = 0;
    do
    {
      android::Parcel::writeInt32(v5, *(_DWORD *)(v3 + 48 * v7));
      v8 = (int *)(v3 + 48 * v7);
      android::Parcel::writeInt32(v5, v8[1]);
      android::Parcel::writeInt32(v5, v8[2]);
      sub_9C8C((int)v5, v8[3]);
      sub_9C8C((int)v5, v8[4]);
      android::Parcel::writeInt32(v5, v8[5]);
      android::Parcel::writeInt32(v5, v8[6]);
      android::Parcel::writeInt32(v5, v8[7]);
      result = v7 + 1;
      v9 = 1;
      if ( v7 + 1 > v7 )
        v9 = 0;
      if ( v9 )
        goto LABEL_14;
      ++v7;
    }
    while ( result < v4 );
    if ( v4 > 0 )
    {
      v10 = 0;
      while ( 1 )
      {
        v11 = (int *)(v3 + 48 * v10);
        android::Parcel::writeInt32(v5, v11[8]);
        android::Parcel::writeInt32(v5, v11[9]);
        android::Parcel::writeInt32(v5, v11[10]);
        android::Parcel::writeInt32(v5, v11[11]);
        result = v10 + 1;
        v12 = 1;
        if ( v10 + 1 > v10 )
          v12 = 0;
        if ( v12 )
          break;
        ++v10;
        if ( result >= v4 )
          return result;
      }
LABEL_14:
      abort();
    }
  }
  return result;
}

//----- (00009C8C) --------------------------------------------------------
int __fastcall sub_9C8C(int a1, int a2)
{
  int v2; // r4
  void *v3; // r5
  int v5; // [sp+0h] [bp-18h]
  int v6; // [sp+4h] [bp-14h]

  v2 = a1;
  v3 = (void *)strdup8to16(a2, &v5);
  android::Parcel::writeString16(v2, v3, v5);
  free(v3);
  return _stack_chk_guard - v6;
}
// 3CB0: using guessed type int __fastcall strdup8to16(_DWORD, _DWORD);
// 3CBC: using guessed type int __fastcall android::Parcel::writeString16(_DWORD, _DWORD, _DWORD);

//----- (00009CD8) --------------------------------------------------------
int __fastcall sub_9CD8(android::Parcel *a1, int *a2)
{
  int *v2; // r5
  android::Parcel *v3; // r4

  v2 = a2;
  v3 = a1;
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(v3, v2[1]);
  android::Parcel::writeInt32(v3, v2[2]);
  android::Parcel::writeInt32(v3, v2[3]);
  android::Parcel::writeInt32(v3, v2[4]);
  android::Parcel::writeInt32(v3, v2[5]);
  return android::Parcel::writeInt32(v3, v2[6]);
}

//----- (00009D18) --------------------------------------------------------
int __fastcall sub_9D18(android::Parcel *this, _DWORD *a2)
{
  _DWORD *v2; // r5
  android::Parcel *v3; // r4
  int v4; // r1
  signed int v5; // r0
  signed int v6; // r3
  int v7; // r0

  v2 = a2;
  v3 = this;
  v4 = a2[7];
  if ( v4 == -1 )
  {
    v4 = 99;
    v2[7] = 99;
  }
  v5 = v2[8];
  if ( v5 == -1 )
  {
    v7 = 0x7FFFFFFF;
  }
  else
  {
    if ( v5 >= -1 )
      goto LABEL_11;
    v6 = 1;
    if ( !__OFSUB__(0, v5) )
      v6 = 0;
    if ( v6 )
      abort();
    v7 = -v5;
  }
  v2[8] = v7;
LABEL_11:
  if ( v2[9] == -1 )
    v2[9] = 0x7FFFFFFF;
  if ( v2[11] == -1 )
    v2[11] = 0x7FFFFFFF;
  android::Parcel::writeInt32(v3, v4);
  android::Parcel::writeInt32(v3, v2[8]);
  android::Parcel::writeInt32(v3, v2[9]);
  android::Parcel::writeInt32(v3, v2[10]);
  return android::Parcel::writeInt32(v3, v2[11]);
}

//----- (00009D94) --------------------------------------------------------
int __fastcall sub_9D94(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r4
  unsigned int v4; // r6
  android::Parcel *v5; // r5
  const char *v6; // r3
  signed int v7; // r8
  int v8; // r7
  int *v10; // r6
  int v11; // r0
  signed int v12; // r1
  unsigned int v13; // [sp+0h] [bp-28h]
  signed int v14; // [sp+4h] [bp-24h]

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v6, v13, v14);
    return -1;
  }
  v7 = a3 / 0x2C;
  if ( a3 % 0x2C )
  {
    v13 = a3;
    v14 = 44;
    v6 = "invalid response length %d expected multiple of %d";
    goto LABEL_6;
  }
  android::Parcel::writeInt32(this, 11);
  android::Parcel::writeInt32(v5, v4 / 0x2C);
  v8 = 0;
  if ( v4 >= 0x2C )
  {
    do
    {
      android::Parcel::writeInt32(v5, *(_DWORD *)(v3 + 44 * v8));
      v10 = (int *)(v3 + 44 * v8);
      android::Parcel::writeInt32(v5, v10[1]);
      android::Parcel::writeInt32(v5, v10[2]);
      android::Parcel::writeInt32(v5, v10[3]);
      sub_9C8C((int)v5, v10[4]);
      sub_9C8C((int)v5, v10[5]);
      sub_9C8C((int)v5, v10[6]);
      sub_9C8C((int)v5, v10[7]);
      sub_9C8C((int)v5, v10[8]);
      sub_9C8C((int)v5, v10[9]);
      android::Parcel::writeInt32(v5, v10[10]);
      v11 = v8 + 1;
      v12 = 1;
      if ( v8 + 1 > v8 )
        v12 = 0;
      if ( v12 )
        abort();
      ++v8;
    }
    while ( v11 < v7 );
    v8 = 0;
  }
  return v8;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009E8C) --------------------------------------------------------
int __fastcall sub_9E8C(android::Parcel *a1, int a2)
{
  android::Parcel *v2; // r5
  int v3; // r4
  signed int v4; // r6
  signed int v5; // r9
  int v6; // r7
  int v7; // r0
  signed int v8; // r1
  unsigned int v9; // r0
  int v10; // r7
  int v11; // r0
  signed int v12; // r1
  int result; // r0
  int v14; // r7
  int v15; // r6
  int v16; // r1
  signed int v17; // r2
  unsigned __int8 v18; // [sp+3h] [bp-25h]
  int v19; // [sp+4h] [bp-24h]
  int v20; // [sp+8h] [bp-20h]

  v2 = a1;
  v3 = a2;
  _aeabi_memclr4(a2, 372);
  android::Parcel::readInt32(v2, &v19);
  *(_DWORD *)v3 = v19;
  android::Parcel::read(v2, &v18, 1u);
  *(_BYTE *)(v3 + 4) = v18;
  android::Parcel::readInt32(v2, &v19);
  *(_DWORD *)(v3 + 8) = v19;
  android::Parcel::readInt32(v2, &v19);
  *(_DWORD *)(v3 + 12) = v19;
  android::Parcel::readInt32(v2, &v19);
  *(_DWORD *)(v3 + 16) = v19;
  android::Parcel::readInt32(v2, &v19);
  *(_DWORD *)(v3 + 20) = v19;
  android::Parcel::readInt32(v2, &v19);
  *(_DWORD *)(v3 + 24) = v19;
  android::Parcel::read(v2, &v18, 1u);
  v4 = v18;
  v5 = 36;
  *(_BYTE *)(v3 + 28) = v18;
  if ( (unsigned int)v4 >= 0x24 )
    v4 = 36;
  if ( v4 )
  {
    v6 = 0;
    while ( 1 )
    {
      android::Parcel::read(v2, &v18, 1u);
      *(_BYTE *)(v3 + v6 + 29) = v18;
      v7 = v6 + 1;
      v8 = 1;
      if ( v6 + 1 > v6 )
        v8 = 0;
      if ( v8 )
        break;
      ++v6;
      if ( v7 >= v4 )
        goto LABEL_9;
    }
LABEL_26:
    abort();
  }
LABEL_9:
  android::Parcel::readInt32(v2, &v19);
  *(_DWORD *)(v3 + 68) = v19;
  android::Parcel::read(v2, &v18, 1u);
  *(_BYTE *)(v3 + 72) = v18;
  android::Parcel::read(v2, &v18, 1u);
  v9 = v18;
  *(_BYTE *)(v3 + 73) = v18;
  if ( v9 < 0x24 )
    v5 = v9;
  if ( v5 )
  {
    v10 = 0;
    do
    {
      android::Parcel::read(v2, &v18, 1u);
      *(_BYTE *)(v3 + v10 + 74) = v18;
      v11 = v10 + 1;
      v12 = 1;
      if ( v10 + 1 > v10 )
        v12 = 0;
      if ( v12 )
        goto LABEL_26;
      ++v10;
    }
    while ( v11 < v5 );
  }
  result = android::Parcel::readInt32(v2, &v19);
  v14 = v19;
  *(_DWORD *)(v3 + 112) = v19;
  if ( v14 >= 255 )
    v14 = 255;
  if ( v14 >= 1 )
  {
    v15 = 0;
    do
    {
      result = android::Parcel::read(v2, &v18, 1u);
      *(_BYTE *)(v3 + v15 + 116) = v18;
      v16 = v15 + 1;
      v17 = 1;
      if ( v15 + 1 > v15 )
        v17 = 0;
      if ( v17 )
        goto LABEL_26;
      ++v15;
    }
    while ( v16 < v14 );
  }
  if ( _stack_chk_guard != v20 )
    goto LABEL_26;
  return result;
}
// 3C68: using guessed type int __fastcall _aeabi_memclr4(_DWORD, _DWORD);

//----- (0000A024) --------------------------------------------------------
int __fastcall sub_A024(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r7
  unsigned int v4; // r6
  android::Parcel *v5; // r4
  const char *v6; // r3
  signed int v7; // r5
  int *v9; // r6
  int v10; // r7
  int v11; // r1
  int v12; // r0
  signed int v13; // r1
  unsigned int v14; // [sp+0h] [bp-20h]
  signed int v15; // [sp+4h] [bp-1Ch]

  v3 = a2;
  v4 = a3;
  v5 = this;
  if ( !a2 && a3 )
  {
    v6 = "invalid response: NULL";
LABEL_6:
    _android_log_buf_print(1, 6, "RILC", v6, v14, v15);
    return -1;
  }
  v7 = a3 / 0x48;
  if ( a3 % 0x48 )
  {
    v14 = a3;
    v15 = 72;
    v6 = "responseCellInfoList: invalid response length %d expected multiple of %d";
    goto LABEL_6;
  }
  android::Parcel::writeInt32(this, a3 / 0x48);
  if ( v4 >= 0x48 )
  {
    v9 = (int *)(v3 + 36);
    v10 = 0;
    do
    {
      android::Parcel::writeInt32(v5, *(v9 - 9));
      android::Parcel::writeInt32(v5, *(v9 - 8));
      android::Parcel::writeInt32(v5, *(v9 - 7));
      android::Parcel::writeInt64(v5, *(_QWORD *)(v9 - 5));
      switch ( *(v9 - 9) )
      {
        case 1:
          android::Parcel::writeInt32(v5, *(v9 - 3));
          android::Parcel::writeInt32(v5, *(v9 - 2));
          android::Parcel::writeInt32(v5, *(v9 - 1));
          android::Parcel::writeInt32(v5, *v9);
          android::Parcel::writeInt32(v5, v9[1]);
          android::Parcel::writeInt32(v5, *((unsigned __int8 *)v9 + 8));
          android::Parcel::writeInt32(v5, v9[3]);
          android::Parcel::writeInt32(v5, v9[4]);
          v11 = v9[5];
          goto LABEL_15;
        case 2:
          android::Parcel::writeInt32(v5, *(v9 - 3));
          android::Parcel::writeInt32(v5, *(v9 - 2));
          android::Parcel::writeInt32(v5, *(v9 - 1));
          android::Parcel::writeInt32(v5, *v9);
          android::Parcel::writeInt32(v5, v9[1]);
          android::Parcel::writeInt32(v5, v9[2]);
          android::Parcel::writeInt32(v5, v9[3]);
          android::Parcel::writeInt32(v5, v9[4]);
          android::Parcel::writeInt32(v5, v9[5]);
          v11 = v9[6];
          goto LABEL_15;
        case 3:
          android::Parcel::writeInt32(v5, *(v9 - 3));
          android::Parcel::writeInt32(v5, *(v9 - 2));
          android::Parcel::writeInt32(v5, *(v9 - 1));
          android::Parcel::writeInt32(v5, *v9);
          android::Parcel::writeInt32(v5, v9[1]);
          android::Parcel::writeInt32(v5, v9[2]);
          android::Parcel::writeInt32(v5, v9[3]);
          android::Parcel::writeInt32(v5, v9[4]);
          android::Parcel::writeInt32(v5, v9[5]);
          android::Parcel::writeInt32(v5, v9[6]);
          android::Parcel::writeInt32(v5, v9[7]);
          v11 = v9[8];
          goto LABEL_15;
        case 4:
          android::Parcel::writeInt32(v5, *(v9 - 3));
          android::Parcel::writeInt32(v5, *(v9 - 2));
          android::Parcel::writeInt32(v5, *(v9 - 1));
          android::Parcel::writeInt32(v5, *v9);
          android::Parcel::writeInt32(v5, v9[1]);
          android::Parcel::writeInt32(v5, v9[2]);
          android::Parcel::writeInt32(v5, v9[3]);
          v11 = v9[4];
          goto LABEL_15;
        case 5:
          android::Parcel::writeInt32(v5, *(v9 - 3));
          android::Parcel::writeInt32(v5, *(v9 - 2));
          android::Parcel::writeInt32(v5, *(v9 - 1));
          android::Parcel::writeInt32(v5, *v9);
          android::Parcel::writeInt32(v5, v9[1]);
          v11 = v9[2];
LABEL_15:
          android::Parcel::writeInt32(v5, v11);
          break;
        default:
          break;
      }
      v12 = v10 + 1;
      v13 = 1;
      if ( v10 + 1 > v10 )
        v13 = 0;
      if ( v13 )
        abort();
      v9 += 18;
      ++v10;
    }
    while ( v12 < v7 );
  }
  return 0;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A268) --------------------------------------------------------
void __fastcall sub_A268(int a1, _DWORD *a2)
{
  int v2; // r5
  _DWORD *v3; // r4
  int v4; // r6
  void *v5; // r0
  int v6; // r0
  signed int v7; // r1

  v2 = a1;
  v3 = a2;
  if ( a1 > 0 )
  {
    v4 = 0;
    do
    {
      v5 = (void *)v3[v4];
      if ( v5 )
        free(v5);
      v6 = v4 + 1;
      v7 = 1;
      if ( v4 + 1 > v4 )
        v7 = 0;
      if ( v7 )
        abort();
      ++v4;
    }
    while ( v6 < v2 );
  }
  j_free(v3);
}

//----- (0000A2A0) --------------------------------------------------------
int __fastcall sub_A2A0(int a1, int a2, int a3)
{
  int v3; // r9
  int v4; // r5
  int v5; // r8
  _BYTE *v6; // r0
  int v7; // r7
  int v8; // r1
  const char *v9; // r0
  int result; // r0
  const char *v11; // r0

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = calloc(1u, 0x18u);
  v7 = (int)v6;
  if ( v6 )
  {
    v6[13] = 1;
    *(_DWORD *)v6 = -1;
    *((_DWORD *)v6 + 1) = (char *)&unk_1501C + 12 * v4;
    pthread_mutex_lock((pthread_mutex_t *)&unk_157D0);
    v8 = dword_157D4;
    dword_157D4 = v7;
    *(_DWORD *)(v7 + 8) = v8;
    pthread_mutex_unlock((pthread_mutex_t *)&unk_157D0);
    v9 = j_requestToString(v4);
    _android_log_buf_print(1, 3, "RILC", "C[locl]> %s", v9);
    result = dword_156DC(v4, v3, v5);
  }
  else
  {
    v11 = j_requestToString(v4);
    result = _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v11);
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 156DC: using guessed type int (__fastcall *dword_156DC)(_DWORD, _DWORD, _DWORD);
// 157D4: using guessed type int dword_157D4;

//----- (0000A35C) --------------------------------------------------------
int sub_A35C()
{
  pthread_t v0; // r0
  int result; // r0

  v0 = pthread_self();
  result = pthread_equal(v0, dword_156FC);
  if ( !result )
  {
    do
    {
      result = _write_chk(dword_157A8, " ", 1, 2);
      if ( result > -1 )
        break;
      result = *(_DWORD *)_errno(result);
    }
    while ( result == 4 );
  }
  return result;
}
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 3BC0: using guessed type int __fastcall _write_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 156FC: using guessed type int dword_156FC;
// 157A8: using guessed type int dword_157A8;

//----- (0000A3A0) --------------------------------------------------------
int __fastcall sub_A3A0(int a1, unsigned int a2)
{
  int v2; // r5
  unsigned int v3; // r4
  int v4; // r7
  signed int v5; // r6
  signed int v6; // r4
  int result; // r0
  unsigned int v8; // [sp+Ch] [bp-1Ch]
  int v9; // [sp+10h] [bp-18h]

  v2 = a1;
  v3 = a2;
  v4 = dword_15710;
  if ( dword_15710 >= 0 )
  {
    if ( a2 <= 0x2000 )
    {
      pthread_mutex_lock((pthread_mutex_t *)&unk_157D8);
      v8 = bswap32(v3);
      v5 = sub_659C(v4, (int)&v8, 4u);
      if ( v5 <= -1 )
      {
        pthread_mutex_unlock((pthread_mutex_t *)&unk_157D8);
      }
      else
      {
        v6 = sub_659C(v4, v2, v3);
        pthread_mutex_unlock((pthread_mutex_t *)&unk_157D8);
        v5 = v6 & (v6 >> 31);
      }
      goto LABEL_8;
    }
    _android_log_buf_print(1, 6, "RILC", "RIL: packet larger than %u (%u)", 0x2000, a2);
  }
  v5 = -1;
LABEL_8:
  result = _stack_chk_guard - v9;
  if ( _stack_chk_guard == v9 )
    result = v5;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 15710: using guessed type int dword_15710;

//----- (0000A458) --------------------------------------------------------
int __fastcall sub_A458(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 20 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(v4, v3[1]);
      android::Parcel::writeInt32(v4, v3[2]);
      android::Parcel::writeInt32(v4, v3[3]);
      sub_9C8C((int)v4, v3[4]);
      return 0;
    }
    v7 = a3;
    v8 = 20;
    v6 = "invalid response length was %d expected %d";
  }
  else
  {
    v6 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A4D0) --------------------------------------------------------
int __fastcall sub_A4D0(android::Parcel *this, int *a2, unsigned int a3)
{
  android::Parcel *v3; // r4
  int *v4; // r5
  signed int v5; // r5
  int result; // r0
  int v7; // [sp+0h] [bp-70h]
  int v8; // [sp+5Ch] [bp-14h]

  v3 = this;
  v4 = a2;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "responseSimRefresh: invalid response: NULL");
LABEL_4:
    v5 = -1;
    goto LABEL_11;
  }
  if ( android::s_callbacks > 12 )
  {
    if ( a3 % 0xC )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_SimRefreshResponse_v7");
      property_get("ro.debuggable", &v7, "0");
      if ( strcmp((const char *)&v7, "1") )
        goto LABEL_4;
    }
  }
  else if ( android::s_callbacks < 7 )
  {
    android::Parcel::writeInt32(this, *a2);
    android::Parcel::writeInt32(v3, v4[1]);
    v5 = 0;
    sub_9C8C((int)v3, 0);
    goto LABEL_11;
  }
  sub_AF58(v3, v4);
  v5 = 0;
LABEL_11:
  result = _stack_chk_guard - v8;
  if ( _stack_chk_guard == v8 )
    result = v5;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BD8: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;

//----- (0000A5BC) --------------------------------------------------------
signed int __fastcall sub_A5BC(android::Parcel *a1, unsigned __int8 *a2, int a3)
{
  android::Parcel *v3; // r3
  signed int result; // r0

  v3 = a1;
  result = 0;
  if ( a2 && a3 )
  {
    if ( a3 == 4 )
    {
      sub_AF78(v3, a2);
      result = 0;
    }
    else
    {
      _android_log_buf_print(
        1,
        6,
        "RILC",
        "invalid response length %d expected sizeof (RIL_CDMA_SignalInfoRecord) of %d\n",
        a3,
        4);
      result = -1;
    }
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A600) --------------------------------------------------------
signed int __fastcall sub_A600(android::Parcel *a1, int *a2, int a3)
{
  int v3; // r6
  int *v4; // r8
  android::Parcel *v5; // r4
  const char *v6; // r3
  signed int v7; // r7
  signed int v8; // r9
  int v9; // r6
  int v10; // r0
  signed int v11; // r1
  int v12; // r6
  int v13; // r0
  signed int v14; // r1
  signed int v15; // r6
  int v16; // r7
  int v17; // r0
  signed int v18; // r1
  int v20; // [sp+0h] [bp-28h]
  signed int v21; // [sp+4h] [bp-24h]

  v3 = a3;
  v4 = a2;
  v5 = a1;
  _android_log_buf_print(1, 3, "RILC", "Inside responseCdmaSms");
  if ( v4 || !v3 )
  {
    if ( v3 == 372 )
    {
      android::Parcel::writeInt32(v5, *v4);
      android::Parcel::write(v5, v4 + 1, 1u);
      android::Parcel::writeInt32(v5, v4[2]);
      android::Parcel::writeInt32(v5, v4[3]);
      android::Parcel::writeInt32(v5, v4[4]);
      android::Parcel::writeInt32(v5, v4[5]);
      android::Parcel::writeInt32(v5, v4[6]);
      android::Parcel::write(v5, v4 + 7, 1u);
      v7 = *((unsigned __int8 *)v4 + 28);
      v8 = 36;
      if ( (unsigned int)v7 >= 0x24 )
        v7 = 36;
      if ( v7 )
      {
        v9 = 0;
        while ( 1 )
        {
          android::Parcel::write(v5, (char *)v4 + v9 + 29, 1u);
          v10 = v9 + 1;
          v11 = 1;
          if ( v9 + 1 > v9 )
            v11 = 0;
          if ( v11 )
            break;
          ++v9;
          if ( v10 >= v7 )
            goto LABEL_13;
        }
      }
      else
      {
LABEL_13:
        android::Parcel::writeInt32(v5, v4[17]);
        android::Parcel::write(v5, v4 + 18, 1u);
        android::Parcel::write(v5, (char *)v4 + 73, 1u);
        if ( *((unsigned __int8 *)v4 + 73) < 0x24u )
          v8 = *((unsigned __int8 *)v4 + 73);
        if ( v8 )
        {
          v12 = 0;
          while ( 1 )
          {
            android::Parcel::write(v5, (char *)v4 + v12 + 74, 1u);
            v13 = v12 + 1;
            v14 = 1;
            if ( v12 + 1 > v12 )
              v14 = 0;
            if ( v14 )
              break;
            ++v12;
            if ( v13 >= v8 )
              goto LABEL_21;
          }
        }
        else
        {
LABEL_21:
          v15 = v4[28];
          android::Parcel::writeInt32(v5, v4[28]);
          if ( v15 >= 255 )
            v15 = 255;
          if ( v15 < 1 )
            return 0;
          v16 = 0;
          while ( 1 )
          {
            android::Parcel::write(v5, (char *)v4 + v16 + 116, 1u);
            v17 = v16 + 1;
            v18 = 1;
            if ( v16 + 1 > v16 )
              v18 = 0;
            if ( v18 )
              break;
            ++v16;
            if ( v17 >= v15 )
              return 0;
          }
        }
      }
      abort();
    }
    v20 = v3;
    v21 = 372;
    v6 = "invalid response length was %d expected %d";
  }
  else
  {
    v6 = "invalid response: NULL";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v20, v21);
  return -1;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A78C) --------------------------------------------------------
int __fastcall sub_A78C(android::Parcel *a1, int a2, unsigned int a3)
{
  android::Parcel *v3; // r4
  int v4; // r5
  unsigned int v5; // r6
  signed int v6; // r5
  int result; // r0
  char v8; // [sp+8h] [bp-70h]
  int v9; // [sp+64h] [bp-14h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
LABEL_4:
    v6 = -1;
    goto LABEL_13;
  }
  if ( a3 <= 0x17 )
    _android_log_buf_print(1, 5, "RILC", "Upgrade to ril version %d\n", 12);
  sub_9C8C((int)v3, *(_DWORD *)v4);
  android::Parcel::writeInt32(v3, *(_DWORD *)(v4 + 4));
  sub_9C8C((int)v3, *(_DWORD *)(v4 + 8));
  sub_AF78(v3, (unsigned __int8 *)(v4 + 12));
  if ( android::s_callbacks > 12 )
  {
    if ( v5 % 0x18 )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_CDMA_CallWaiting_v6");
      property_get("ro.debuggable", &v8, "0");
      if ( strcmp(&v8, "1") )
        goto LABEL_4;
    }
  }
  else if ( v5 < 0x18 )
  {
    v6 = 0;
    android::Parcel::writeInt32(v3, 0);
    android::Parcel::writeInt32(v3, 0);
    goto LABEL_13;
  }
  android::Parcel::writeInt32(v3, *(_DWORD *)(v4 + 16));
  android::Parcel::writeInt32(v3, *(_DWORD *)(v4 + 20));
  v6 = 0;
LABEL_13:
  result = _stack_chk_guard - v9;
  if ( _stack_chk_guard == v9 )
    result = v6;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3BD8: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 156D8: using guessed type int android::s_callbacks;

//----- (0000A8BC) --------------------------------------------------------
int __fastcall sub_A8BC(android::Parcel *this, unsigned __int8 *a2, unsigned int a3)
{
  unsigned __int8 *v3; // r7
  android::Parcel *v4; // r11
  const char *v5; // r3
  int v6; // r9
  int v7; // r8
  int v8; // r10
  int v9; // r6
  unsigned __int8 *v10; // r4
  unsigned int v11; // r5
  _BYTE *v12; // r7
  int v13; // r0
  int v14; // r1
  bool v15; // vf
  signed int v16; // r0
  int v17; // r1
  unsigned __int8 *v18; // r4
  int v19; // r5
  unsigned int v20; // r4
  _BYTE *v21; // r7
  int v22; // r0
  int v23; // r1
  signed int v24; // r0
  int v25; // r4
  _BYTE *v26; // r7
  int v27; // r0
  int v28; // r1
  signed int v29; // r0
  int v30; // r4
  unsigned int v31; // r1
  int v32; // r4
  int v33; // r0
  signed int v34; // r1
  signed int v36; // r0
  unsigned int v37; // [sp+0h] [bp-30h]
  signed int v38; // [sp+4h] [bp-2Ch]

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
    goto LABEL_50;
  }
  if ( a3 != 964 )
  {
    v37 = a3;
    v38 = 4;
    v5 = "responseCdmaInformationRecords: invalid response length %d expected multiple of %d\n";
    goto LABEL_50;
  }
  v6 = *a2;
  if ( (unsigned int)v6 >= 0xA )
    v6 = 10;
  android::Parcel::writeInt32(this, v6);
  v7 = 0;
  if ( v6 )
  {
    v8 = (int)(v3 + 4);
    v9 = 0;
    while ( 1 )
    {
      android::Parcel::writeInt32(v4, *(_DWORD *)(v8 + 96 * v9));
      switch ( *(_DWORD *)(v8 + 96 * v9) )
      {
        case 0:
          v19 = v8 + 96 * v9;
          v20 = *(unsigned __int8 *)(v19 + 4);
          if ( v20 >= 0x41 )
          {
            v36 = 64;
            v37 = *(unsigned __int8 *)(v19 + 4);
            v5 = "invalid display info response length %d                           expected not more than %d\n";
            goto LABEL_60;
          }
          v21 = calloc(v20 + 1, 1u);
          if ( !v21 )
            goto LABEL_61;
          if ( v20 )
          {
            v22 = 0;
            do
            {
              v21[v22] = *(_BYTE *)(v19 + v22 + 5);
              v23 = v22 + 1;
              v15 = v22 + 1 <= v22;
              v24 = 1;
              if ( !v15 )
                v24 = 0;
              if ( v24 )
                goto LABEL_62;
              v22 = v23;
            }
            while ( v23 < (signed int)v20 );
          }
          v21[v20] = 0;
          sub_9C8C((int)v4, (int)v21);
          free(v21);
          goto LABEL_44;
        case 1:
        case 2:
        case 3:
          v10 = (unsigned __int8 *)(v8 + 96 * v9);
          v11 = v10[4];
          if ( v11 >= 0x52 )
          {
            v5 = "invalid display info response length %d                           expected not more than %d\n";
LABEL_58:
            v36 = 81;
            v37 = v11;
            goto LABEL_60;
          }
          v12 = calloc(v11 + 1, 1u);
          if ( !v12 )
            goto LABEL_61;
          if ( v11 )
          {
            v13 = 0;
            do
            {
              v12[v13] = v10[v13 + 5];
              v14 = v13 + 1;
              v15 = v13 + 1 <= v13;
              v16 = 1;
              if ( !v15 )
                v16 = 0;
              if ( v16 )
                goto LABEL_62;
              v13 = v14;
            }
            while ( v14 < (signed int)v11 );
          }
          v12[v11] = 0;
          sub_9C8C((int)v4, (int)v12);
          free(v12);
          android::Parcel::writeInt32(v4, v10[86]);
          android::Parcel::writeInt32(v4, v10[87]);
          android::Parcel::writeInt32(v4, v10[88]);
          v17 = v10[89];
          break;
        case 4:
        case 6:
          v18 = (unsigned __int8 *)(v8 + 96 * v9);
          android::Parcel::writeInt32(v4, v18[4]);
          android::Parcel::writeInt32(v4, v18[5]);
          android::Parcel::writeInt32(v4, v18[6]);
          v17 = v18[7];
          break;
        case 5:
          v25 = v8 + 96 * v9;
          v11 = *(unsigned __int8 *)(v25 + 4);
          if ( v11 >= 0x52 )
          {
            v5 = "invalid display info response length %d                           expected not more than %d\n";
            goto LABEL_58;
          }
          v26 = calloc(v11 + 1, 1u);
          if ( !v26 )
          {
LABEL_61:
            _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for responseCdmaInformationRecords");
            return -12;
          }
          if ( v11 )
          {
            v27 = 0;
            while ( 1 )
            {
              v26[v27] = *(_BYTE *)(v25 + v27 + 5);
              v28 = v27 + 1;
              v15 = v27 + 1 <= v27;
              v29 = 1;
              if ( !v15 )
                v29 = 0;
              if ( v29 )
                break;
              v27 = v28;
              if ( v28 >= (signed int)v11 )
                goto LABEL_38;
            }
LABEL_62:
            abort();
          }
LABEL_38:
          v26[v11] = 0;
          sub_9C8C((int)v4, (int)v26);
          free(v26);
          android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v25 + 86));
          android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v25 + 87));
          android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v25 + 88));
          android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v25 + 89));
          v17 = *(_DWORD *)(v25 + 92);
          break;
        case 7:
          v30 = v8 + 96 * v9;
          v31 = *(unsigned __int8 *)(v30 + 4);
          if ( v31 >= 0x41 )
          {
            v36 = 64;
            v37 = *(unsigned __int8 *)(v30 + 4);
            v5 = "invalid display info response length %d                           expected not more than %d\n";
LABEL_60:
            v38 = v36;
LABEL_50:
            _android_log_buf_print(1, 6, "RILC", v5, v37, v38);
            return -1;
          }
          android::Parcel::writeInt32(v4, v31);
          android::Parcel::write(v4, (const void *)(v30 + 5), *(unsigned __int8 *)(v30 + 4));
          goto LABEL_44;
        case 8:
          v17 = *(unsigned __int8 *)(v8 + 96 * v9 + 4);
          break;
        case 9:
          v5 = "RIL_CDMA_T53_RELEASE_INFO_REC: return INVALID_RESPONSE";
          goto LABEL_50;
        case 0xA:
          v32 = v8 + 96 * v9;
          android::Parcel::writeInt32(v4, *(unsigned __int8 *)(v32 + 4));
          v17 = *(unsigned __int8 *)(v32 + 5);
          break;
        default:
          v5 = "Incorrect name value";
          goto LABEL_50;
      }
      android::Parcel::writeInt32(v4, v17);
LABEL_44:
      v33 = v9 + 1;
      v34 = 1;
      if ( v9 + 1 > v9 )
        v34 = 0;
      if ( v34 )
        goto LABEL_62;
      ++v9;
      if ( v33 >= v6 )
        return 0;
    }
  }
  return v7;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000ABEC) --------------------------------------------------------
signed int __fastcall sub_ABEC(android::Parcel *a1, int *a2, int a3)
{
  int v3; // r5
  int *v4; // r6
  android::Parcel *v5; // r4
  signed int v6; // r0
  const char *v7; // r3
  int v8; // r5
  int v9; // r10
  int v10; // r11
  int v11; // r0
  __int64 v12; // kr00_8
  int v13; // r6
  int v14; // r8
  int v15; // r9
  int v16; // r0
  signed int v17; // r1
  int v19; // r7
  int v20; // r5
  int v21; // r0
  signed int v22; // r1
  int v23; // [sp+1Ch] [bp-2Ch]
  int *v24; // [sp+20h] [bp-28h]

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v24 = a2;
  _android_log_buf_print(1, 3, "RILC", "In responseSSData");
  if ( !v4 && v3 )
  {
    v6 = 12;
    v7 = "invalid response length was %d expected %d";
LABEL_17:
    _android_log_buf_print(1, 6, "RILC", v7, v3, v6);
    return -1;
  }
  if ( v3 != 192 )
  {
    v6 = 192;
    v7 = "invalid response length %d, expected %d";
    goto LABEL_17;
  }
  android::Parcel::writeInt32(v5, *v4);
  android::Parcel::writeInt32(v5, v4[1]);
  android::Parcel::writeInt32(v5, v4[2]);
  android::Parcel::writeInt32(v5, v4[3]);
  android::Parcel::writeInt32(v5, v4[4]);
  if ( v4[1] != 2 || (*v4 | 1u) - 1 > 4 )
  {
    android::Parcel::writeInt32(v5, 4);
    v19 = (int)(v4 + 5);
    v20 = 0;
    while ( 1 )
    {
      _android_log_buf_print(1, 3, "RILC", "Data: %d", *(_DWORD *)(v19 + 4 * v20));
      android::Parcel::writeInt32(v5, *(_DWORD *)(v19 + 4 * v20));
      v21 = v20 + 1;
      v22 = 1;
      if ( v20 + 1 > v20 )
        v22 = 0;
      if ( v22 )
        break;
      ++v20;
      if ( v21 >= 4 )
        return 0;
    }
LABEL_25:
    abort();
  }
  _android_log_buf_print(1, 3, "RILC", "responseSSData CF type, num of Cf elements %d", v4[5]);
  v8 = v4[5];
  if ( v8 >= 8 )
  {
    v8 = 7;
    _android_log_buf_print(1, 6, "RILC", "numValidIndexes is greater than max value %d, truncating it to max value", 7);
    v4[5] = 7;
  }
  android::Parcel::writeInt32(v5, v8);
  if ( v4[5] >= 1 )
  {
    v9 = 0;
    v23 = (int)(v4 + 6);
    while ( 1 )
    {
      v10 = *(_DWORD *)(v23 + 24 * v9);
      v11 = v23 + 24 * v9;
      v12 = *(_QWORD *)(v11 + 4);
      v13 = *(_DWORD *)(v11 + 12);
      v14 = *(_DWORD *)(v11 + 16);
      v15 = *(_DWORD *)(v11 + 20);
      android::Parcel::writeInt32(v5, *(_DWORD *)(v23 + 24 * v9));
      android::Parcel::writeInt32(v5, v12);
      android::Parcel::writeInt32(v5, SHIDWORD(v12));
      android::Parcel::writeInt32(v5, v13);
      sub_9C8C((int)v5, v14);
      android::Parcel::writeInt32(v5, v15);
      _android_log_buf_print(
        1,
        3,
        "RILC",
        "Data: %d,reason=%d,cls=%d,toa=%d,num=%s,tout=%d],",
        v10,
        (_DWORD)v12,
        HIDWORD(v12),
        v13,
        v14,
        v15);
      v16 = v9 + 1;
      v17 = 1;
      if ( v9 + 1 > v9 )
        v17 = 0;
      if ( v17 )
        break;
      ++v9;
      if ( v16 >= v24[5] )
        return 0;
    }
    goto LABEL_25;
  }
  return 0;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000ADC8) --------------------------------------------------------
int __fastcall sub_ADC8(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r5
  android::Parcel *v4; // r4
  const char *v6; // r3
  int v7; // [sp+0h] [bp-18h]
  signed int v8; // [sp+4h] [bp-14h]

  v3 = a2;
  v4 = this;
  if ( a2 )
  {
    if ( a3 == 20 )
    {
      android::Parcel::writeInt32(this, *a2);
      sub_9C8C((int)v4, v3[1]);
      android::Parcel::writeInt32(v4, v3[2]);
      android::Parcel::writeInt32(v4, v3[3]);
      android::Parcel::write(v4, (const void *)(*(_QWORD *)(v3 + 3) >> 32), *(_QWORD *)(v3 + 3));
      return 0;
    }
    v7 = a3;
    v8 = 20;
    v6 = "responsePcoData: invalid response length %u, expecting %u";
  }
  else
  {
    v6 = "responsePcoData: invalid NULL response";
  }
  _android_log_buf_print(1, 6, "RILC", v6, v7, v8);
  return -1;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000AE44) --------------------------------------------------------
int __fastcall sub_AE44(android::Parcel *this, int *a2, int a3)
{
  int *v3; // r10
  android::Parcel *v4; // r5
  const char *v5; // r3
  int v6; // r9
  int v7; // r10
  signed int v8; // t1
  int v9; // r11
  int *v10; // r7
  int v11; // r6
  int v12; // r0
  signed int v13; // r1
  int v14; // r6
  int v15; // r0
  signed int v16; // r1
  int v17; // r0
  signed int v18; // r1

  v3 = a2;
  v4 = this;
  if ( !a2 && a3 )
  {
    v5 = "invalid response: NULL";
LABEL_24:
    _android_log_buf_print(1, 6, "RILC", v5);
    return -1;
  }
  if ( a3 != 444 )
  {
    v5 = "responseAdnRecords: A RIL_AdnRecord_v1 expected\n";
    goto LABEL_24;
  }
  android::Parcel::writeInt32(this, *a2);
  v8 = *v3;
  v7 = (int)(v3 + 1);
  v6 = v8;
  v9 = 0;
  if ( v8 >= 1 )
  {
    while ( 1 )
    {
      android::Parcel::writeInt32(v4, *(_DWORD *)(v7 + 44 * v9));
      v10 = (int *)(v7 + 44 * v9);
      sub_9C8C((int)v4, v10[1]);
      sub_9C8C((int)v4, v10[2]);
      android::Parcel::writeInt32(v4, v10[3]);
      if ( v10[3] > 0 )
        break;
LABEL_12:
      android::Parcel::writeInt32(v4, v10[6]);
      if ( v10[6] > 0 )
      {
        v14 = 0;
        do
        {
          sub_9C8C((int)v4, v10[v14 + 7]);
          v15 = v14 + 1;
          v16 = 1;
          if ( v14 + 1 > v14 )
            v16 = 0;
          if ( v16 )
            goto LABEL_26;
          ++v14;
        }
        while ( v15 < v10[6] );
      }
      v17 = v9 + 1;
      v18 = 1;
      if ( v9 + 1 > v9 )
        v18 = 0;
      if ( v18 )
        goto LABEL_26;
      ++v9;
      if ( v17 >= v6 )
        return 0;
    }
    v11 = 0;
    while ( 1 )
    {
      sub_9C8C((int)v4, v10[v11 + 4]);
      v12 = v11 + 1;
      v13 = 1;
      if ( v11 + 1 > v11 )
        v13 = 0;
      if ( v13 )
        break;
      ++v11;
      if ( v12 >= v10[3] )
        goto LABEL_12;
    }
LABEL_26:
    abort();
  }
  return v9;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000AF58) --------------------------------------------------------
int __fastcall sub_AF58(android::Parcel *a1, int *a2)
{
  int *v2; // r4
  android::Parcel *v3; // r5

  v2 = a2;
  v3 = a1;
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(v3, v2[1]);
  return sub_9C8C((int)v3, v2[2]);
}

//----- (0000AF78) --------------------------------------------------------
int __fastcall sub_AF78(android::Parcel *a1, unsigned __int8 *a2)
{
  unsigned __int8 *v2; // r4
  android::Parcel *v3; // r5

  v2 = a2;
  v3 = a1;
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(v3, v2[1]);
  android::Parcel::writeInt32(v3, v2[2]);
  return android::Parcel::writeInt32(v3, v2[3]);
}

//----- (0000AFA0) --------------------------------------------------------
void __fastcall sub_AFA0(int a1, int a2, _QWORD *a3)
{
  void *v3; // r4

  v3 = a3;
  ((void (__fastcall *)(_DWORD))*a3)(*a3 >> 32);
  if ( dword_15798 && (void *)dword_15798 == v3 )
    dword_15798 = 0;
  j_free(v3);
}
// 15798: using guessed type int dword_15798;

//----- (0000AFD0) --------------------------------------------------------
signed int ril_event_init(void)
{
  unsigned int v0; // r2
  unsigned int v1; // r1
  bool v2; // cf
  signed int v3; // r2
  signed int result; // r0

  pthread_mutex_init((pthread_mutex_t *)&unk_157E0, 0);
  v0 = 0;
  do
  {
    v1 = v0 + 1;
    dword_157E8[v0] = 0;
    v2 = v0 + 1 >= v0;
    v3 = 1;
    if ( v2 )
      v3 = 0;
    if ( v3 )
      abort();
    v0 = v1;
  }
  while ( v1 < 0x20 );
  dword_15888 = 0;
  *(_QWORD *)&dword_15870 = 0LL;
  unk_15878 = 0LL;
  unk_15880 = 0LL;
  result = -1;
  dword_15868 = (int)&dword_15868;
  *(_DWORD *)algn_1586C = &dword_15868;
  dword_158B0 = 0;
  *(_QWORD *)&dword_15898 = 0LL;
  dword_15870 = -1;
  unk_158A0 = 0LL;
  unk_158A8 = 0LL;
  dword_15890 = (int)&dword_15890;
  dword_15894 = (int)&dword_15890;
  *(_QWORD *)dword_158B8 = 0LL;
  unk_158C0 = 0LL;
  dword_15898 = -1;
  unk_158C8 = 0LL;
  unk_158D0 = 0LL;
  return result;
}
// 15868: using guessed type int dword_15868;
// 15870: using guessed type int dword_15870;
// 15888: using guessed type int dword_15888;
// 15890: using guessed type int dword_15890;
// 15894: using guessed type int dword_15894;
// 15898: using guessed type int dword_15898;
// 158B0: using guessed type int dword_158B0;

//----- (0000B058) --------------------------------------------------------
int __fastcall ril_event_set(int a1, int fd, int a3, int a4, int a5)
{
  _QWORD *v5; // lr

  *(_QWORD *)a1 = 0LL;
  *(_QWORD *)(a1 + 8) = 0LL;
  v5 = (_QWORD *)(a1 + 16);
  *v5 = 0LL;
  v5[1] = 0LL;
  *(_DWORD *)(a1 + 8) = fd;
  *(_DWORD *)(a1 + 12) = -1;
  *(_BYTE *)v5 = a3;
  *(_DWORD *)(a1 + 28) = a4;
  *(_DWORD *)(a1 + 32) = a5;
  return fcntl(fd, 4, 2048);
}

//----- (0000B08C) --------------------------------------------------------
int __fastcall ril_event_add(int a1)
{
  int v1; // r4
  int v2; // r2
  int v3; // r1
  bool v4; // vf
  signed int v5; // r2
  int v6; // r1
  signed int v7; // r2

  v1 = a1;
  pthread_mutex_lock((pthread_mutex_t *)&unk_157E0);
  v2 = 0;
  while ( dword_158B8[v2] )
  {
    v3 = v2 + 1;
    v4 = v2 + 1 <= v2;
    v5 = 1;
    if ( !v4 )
      v5 = 0;
    if ( v5 )
      goto LABEL_14;
    v2 = v3;
    if ( v3 >= 8 )
      return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_157E0);
  }
  dword_158B8[v2] = v1;
  *(_DWORD *)(v1 + 12) = v2;
  _FD_SET_chk(*(_DWORD *)(v1 + 8), dword_157E8, 128);
  v6 = *(_DWORD *)(v1 + 8);
  if ( v6 >= dword_158D8 )
  {
    v7 = 1;
    if ( v6 + 1 > v6 )
      v7 = 0;
    if ( v7 )
LABEL_14:
      abort();
    dword_158D8 = v6 + 1;
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_157E0);
}
// 3CEC: using guessed type int __fastcall _FD_SET_chk(_DWORD, _DWORD, _DWORD);
// 158D8: using guessed type int dword_158D8;

//----- (0000B11C) --------------------------------------------------------
int __fastcall ril_timer_add(int **a1, _DWORD *a2)
{
  int **v2; // r4
  _DWORD *v3; // r5
  signed int v4; // r7
  int *v5; // r6
  int v6; // r0
  signed int v7; // r1
  int v8; // r1
  int v9; // r3
  int v10; // r1
  signed int v11; // r3
  signed int v12; // r2
  int v13; // r3
  int v14; // r3
  int *v15; // r0
  int result; // r0
  int v17; // [sp+0h] [bp-20h]
  int v18; // [sp+4h] [bp-1Ch]
  int v19; // [sp+8h] [bp-18h]

  v2 = a1;
  v3 = a2;
  pthread_mutex_lock((pthread_mutex_t *)&unk_157E0);
  if ( v3 )
  {
    v4 = 1;
    v5 = (int *)dword_15868;
    v2[2] = (int *)-1;
    clock_gettime(1, (struct timespec *)&v17);
    v6 = *v3 + v17;
    v7 = 1;
    if ( !__OFSUB__(v6, v17) )
      v7 = 0;
    if ( !v7 )
    {
      v8 = v18;
      v2[5] = (int *)v6;
      v9 = v8 / 1000;
      v10 = v8 / 1000 + v3[1];
      if ( !__OFSUB__(v10, v9) )
        v4 = 0;
      if ( !v4 )
      {
        v2[6] = (int *)v10;
        if ( v10 < 1000000 )
          goto LABEL_18;
        v11 = 1;
        v12 = 1;
        if ( !__OFSUB__(v10, 1000000) )
          v11 = 0;
        if ( !v11 )
        {
          v10 -= 1000000;
          v13 = v6 + 1;
          v2[6] = (int *)v10;
          if ( v6 + 1 > v6 )
            v12 = 0;
          if ( !v12 )
          {
            ++v6;
            v2[5] = (int *)v13;
            while ( 1 )
            {
LABEL_18:
              v14 = v5[5];
              if ( v14 == v6 )
              {
                if ( v5 == &dword_15868 || v5[6] >= v10 )
                  goto LABEL_24;
              }
              else if ( v5 == &dword_15868 || v14 >= v6 )
              {
LABEL_24:
                *v2 = v5;
                v15 = (int *)v5[1];
                v2[1] = v15;
                *v15 = (int)v2;
                v5[1] = (int)v2;
                goto LABEL_25;
              }
              v5 = (int *)*v5;
            }
          }
        }
      }
    }
LABEL_26:
    abort();
  }
LABEL_25:
  pthread_mutex_unlock((pthread_mutex_t *)&unk_157E0);
  result = _stack_chk_guard - v19;
  if ( _stack_chk_guard != v19 )
    goto LABEL_26;
  return result;
}
// 15868: using guessed type int dword_15868;

//----- (0000B224) --------------------------------------------------------
int __fastcall ril_event_del(int a1)
{
  int v1; // r4
  unsigned int v2; // r1

  v1 = a1;
  pthread_mutex_lock((pthread_mutex_t *)&unk_157E0);
  v2 = *(_DWORD *)(v1 + 12);
  if ( v2 < 8 )
    sub_B260(v1, v2);
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_157E0);
}

//----- (0000B260) --------------------------------------------------------
int *__fastcall sub_B260(int a1, int a2)
{
  int v2; // r4
  int v3; // r1
  signed int v4; // r2
  int *result; // r0
  int v6; // r0
  int v7; // r2
  int v8; // r3
  int v9; // r3
  int v10; // r3
  bool v11; // vf
  signed int v12; // r2
  int v13; // r1
  signed int v14; // r2

  v2 = a1;
  dword_158B8[a2] = 0;
  *(_DWORD *)(a1 + 12) = -1;
  _FD_CLR_chk(*(_DWORD *)(a1 + 8), dword_157E8, 128);
  v3 = *(_DWORD *)(v2 + 8);
  v4 = 1;
  result = (int *)(v3 + 1);
  if ( v3 + 1 > v3 )
    v4 = 0;
  if ( v4 )
    goto LABEL_17;
  if ( result != (int *)dword_158D8 )
    return result;
  v6 = 0;
  v7 = 0;
  do
  {
    v8 = dword_158B8[v7];
    if ( v8 )
    {
      v9 = *(_DWORD *)(v8 + 8);
      if ( v9 > v6 )
        v6 = v9;
    }
    v10 = v7 + 1;
    v11 = v7 + 1 <= v7;
    v12 = 1;
    if ( !v11 )
      v12 = 0;
    if ( v12 )
      goto LABEL_17;
    v7 = v10;
  }
  while ( v10 < 8 );
  v13 = v6 + 1;
  v14 = 1;
  if ( v6 + 1 > v6 )
    v14 = 0;
  if ( v14 )
LABEL_17:
    abort();
  result = &dword_158D8;
  dword_158D8 = v13;
  return result;
}
// 3D04: using guessed type int __fastcall _FD_CLR_chk(_DWORD, _DWORD, _DWORD);
// 158D8: using guessed type int dword_158D8;

//----- (0000B2F4) --------------------------------------------------------
int ril_event_loop(void)
{
  int *v0; // r4
  int v1; // r1
  int v2; // r2
  bool v3; // zf
  bool v4; // nf
  bool v5; // vf
  int v6; // r3
  signed int v7; // r3
  int v8; // r0
  int v9; // r2
  signed int v10; // r3
  int v11; // r2
  int v12; // r1
  signed int v13; // r2
  signed int v14; // r1
  struct timeval *timeout; // r1
  int v16; // r0
  signed int v17; // r4
  int *v18; // r6
  int v19; // r0
  int v20; // r1
  int v21; // r2
  bool v22; // zf
  bool v23; // nf
  unsigned __int8 v24; // vf
  int v25; // r2
  __int64 v26; // r2
  int v27; // r6
  int v28; // r7
  int *v29; // r0
  signed int v30; // r0
  signed int v31; // r1
  int v32; // r1
  __int64 v33; // kr00_8
  _DWORD *v34; // r0
  int result; // r0
  int v36; // [sp+8h] [bp-8h]
  int v37; // [sp+Ch] [bp-4h]
  int v38; // [sp+10h] [bp+0h]
  int v39; // [sp+14h] [bp+4h]
  int v40; // [sp+18h] [bp+8h]
  int v41; // [sp+98h] [bp+88h]

  do
  {
    while ( 1 )
    {
      _aeabi_memcpy8(&v40, dword_157E8, 128);
      v0 = (int *)dword_15868;
      clock_gettime(1, (struct timespec *)&v38);
      if ( v0 == &dword_15868 )
      {
        timeout = 0;
      }
      else
      {
        v1 = v39 / 1000;
        v2 = v0[5];
        v5 = __OFSUB__(v2, v38);
        v3 = v2 == v38;
        v4 = v2 - v38 < 0;
        if ( v2 == v38 )
        {
          v6 = v0[6];
          v5 = __OFSUB__(v6, v1);
          v3 = v6 == v1;
          v4 = v6 - v1 < 0;
        }
        if ( (unsigned __int8)(v4 ^ v5) | v3 )
        {
          v36 = 0;
          v37 = 0;
        }
        else
        {
          v7 = 1;
          if ( !__OFSUB__(v2, v38) )
            v7 = 0;
          if ( v7 )
            goto LABEL_51;
          v8 = v2 - v38;
          v36 = v2 - v38;
          v9 = v0[6];
          v10 = 1;
          if ( !__OFSUB__(v9, v1) )
            v10 = 0;
          if ( v10 )
LABEL_51:
            abort();
          v11 = v9 - v1;
          v37 = v11;
          if ( v11 <= -1 )
          {
            v12 = v11 + 1000000;
            v5 = v11 + 1000000 <= v11;
            v13 = 1;
            if ( !v5 )
              v13 = 0;
            if ( v13 )
              goto LABEL_51;
            v37 = v12;
            v14 = 1;
            if ( !__OFSUB__(v8, 1) )
              v14 = 0;
            if ( v14 )
              goto LABEL_51;
            v36 = v8 - 1;
          }
        }
        timeout = (struct timeval *)&v36;
      }
      v16 = select(dword_158D8, (fd_set *)&v40, 0, 0, timeout);
      v17 = v16;
      if ( v16 <= -1 )
        break;
      pthread_mutex_lock((pthread_mutex_t *)&unk_157E0);
      v18 = (int *)dword_15868;
      clock_gettime(1, (struct timespec *)&v38);
      if ( v18 != &dword_15868 )
      {
        v19 = v38;
        v20 = v39 / 1000;
        do
        {
          v21 = v18[5];
          v24 = __OFSUB__(v19, v21);
          v22 = v19 == v21;
          v23 = v19 - v21 < 0;
          if ( v19 == v21 )
          {
            v25 = v18[6];
            v24 = __OFSUB__(v20, v25);
            v22 = v20 == v25;
            v23 = v20 - v25 < 0;
          }
          if ( (unsigned __int8)(v23 ^ v24) | v22 )
            break;
          v26 = *(_QWORD *)v18;
          v3 = (unsigned int)*(_QWORD *)v18 == (_DWORD)&dword_15868;
          *(_DWORD *)(v26 + 4) = HIDWORD(v26);
          *(_DWORD *)(*(_QWORD *)v18 >> 32) = *(_QWORD *)v18;
          *v18 = (int)&dword_15890;
          v18[1] = 0;
          HIDWORD(v26) = dword_15894;
          v18[1] = dword_15894;
          *(_DWORD *)HIDWORD(v26) = v18;
          dword_15894 = (int)v18;
          v18 = (int *)v26;
        }
        while ( !v3 );
      }
      pthread_mutex_unlock((pthread_mutex_t *)&unk_157E0);
      pthread_mutex_lock((pthread_mutex_t *)&unk_157E0);
      if ( v17 >= 1 )
      {
        v27 = 0;
        while ( 1 )
        {
          v28 = dword_158B8[v27];
          if ( v28 && _FD_ISSET_chk(*(_DWORD *)(v28 + 8), &v40, 128) )
          {
            *(_DWORD *)v28 = &dword_15890;
            v29 = (int *)dword_15894;
            *(_DWORD *)(v28 + 4) = dword_15894;
            *v29 = v28;
            dword_15894 = v28;
            if ( !*(_BYTE *)(v28 + 16) )
              sub_B260(v28, v27);
            v30 = 1;
            if ( !__OFSUB__(v17, 1) )
              v30 = 0;
            if ( v30 )
              goto LABEL_50;
            --v17;
          }
          v31 = 1;
          if ( v27 + 1 > v27 )
            v31 = 0;
          if ( v31 )
            goto LABEL_50;
          if ( v27 + 1 <= 7 )
          {
            ++v27;
            if ( v17 > 0 )
              continue;
          }
          break;
        }
      }
      pthread_mutex_unlock((pthread_mutex_t *)&unk_157E0);
      v32 = dword_15890;
      if ( (int *)dword_15890 != &dword_15890 )
      {
        do
        {
          v33 = *(_QWORD *)v32;
          *(_DWORD *)(v33 + 4) = HIDWORD(v33);
          *(_DWORD *)(*(_QWORD *)v32 >> 32) = *(_QWORD *)v32;
          *(_DWORD *)v32 = 0;
          *(_DWORD *)(v32 + 4) = 0;
          ((void (__fastcall *)(_DWORD, _DWORD, _DWORD))*(_QWORD *)(v32 + 28))(
            *(_DWORD *)(v32 + 8),
            0,
            *(_QWORD *)(v32 + 28) >> 32);
          v32 = v33;
        }
        while ( (int *)v33 != &dword_15890 );
      }
    }
    v34 = (_DWORD *)_errno(v16);
  }
  while ( *v34 == 4 );
  _android_log_buf_print(1, 6, "RILC", "ril_event: select error (%d)", *v34);
  result = _stack_chk_guard - v41;
  if ( _stack_chk_guard != v41 )
LABEL_50:
    abort();
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 3D10: using guessed type int __fastcall _aeabi_memcpy8(_DWORD, _DWORD, _DWORD);
// 3D28: using guessed type int __fastcall _FD_ISSET_chk(_DWORD, _DWORD, _DWORD);
// 15868: using guessed type int dword_15868;
// 15890: using guessed type int dword_15890;
// 15894: using guessed type int dword_15894;
// 158D8: using guessed type int dword_158D8;

//----- (0000B548) --------------------------------------------------------
int __fastcall RilSocket::socketInit(RilSocket *this)
{
  RilSocket *v1; // r4
  __int64 v2; // r1
  char *v3; // r0
  const char *v4; // r6
  int v5; // r5
  _DWORD *v6; // r0
  _DWORD *v7; // r7
  int v8; // r0
  int v9; // r0
  int v10; // r5
  int v11; // r1
  int v12; // r3
  int v13; // ST00_4
  int v14; // r4
  int v15; // r6
  int v16; // r4
  int *v17; // r0
  char *v18; // r0
  int result; // r0
  char v20; // [sp+Ch] [bp-5Ch]
  int v21; // [sp+4Ch] [bp-1Ch]

  v1 = this;
  HIDWORD(v2) = RilSocket::sSocketRequestsHandler;
  LODWORD(v2) = RilSocket::sSocketListener;
  *((_QWORD *)this + 3) = v2;
  _snprintf_chk(&v20, 64, 0, 64, "ANDROID_SOCKET_%s", *((_DWORD *)this + 1));
  v3 = getenv(&v20);
  v4 = v3;
  v5 = -1;
  if ( v3 )
  {
    v6 = (_DWORD *)_errno(v3);
    v7 = v6;
    *v6 = 0;
    v8 = strtol(v4, 0, 10);
    if ( !*v7 )
      v5 = v8;
  }
  *((_DWORD *)v1 + 3) = v5;
  v9 = listen(v5, 0);
  v10 = v9;
  if ( v9 <= -1 )
  {
    v15 = *((_DWORD *)v1 + 1);
    v16 = *((_DWORD *)v1 + 3);
    v17 = (int *)_errno(v9);
    v18 = strerror(*v17);
    _android_log_buf_print(1, 6, 0, "Failed to listen on %s socket '%d': %s", v15, v16, v18);
  }
  else
  {
    v11 = *((_DWORD *)v1 + 3);
    v12 = *((_DWORD *)v1 + 6);
    v13 = (int)v1;
    v14 = (int)v1 + 32;
    ril_event_set(v14, v11, 0, v12, v13);
    rilEventAddWakeup_helper(v14);
  }
  result = _stack_chk_guard - v21;
  if ( _stack_chk_guard == v21 )
    result = v10;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 3980: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B630) --------------------------------------------------------
int __fastcall RilSocket::sSocketListener(RilSocket *this, int a2, int a3, void *a4)
{
  char v5; // [sp+4h] [bp-34h]
  int v6; // [sp+24h] [bp-14h]
  int v7; // [sp+28h] [bp-10h]
  int v8; // [sp+2Ch] [bp-Ch]

  v7 = a3;
  v6 = 1;
  listenCallback_helper((int)this, a2, &v5);
  return _stack_chk_guard - v8;
}

//----- (0000B668) --------------------------------------------------------
int __fastcall RilSocket::sSocketRequestsHandler(RilSocket *this, int a2, int a3, void *a4)
{
  return j_RilSocket::socketRequestsHandler((int *)*(_QWORD *)a3, a2, 0, *(_QWORD *)a3 >> 32);
}

//----- (0000B674) --------------------------------------------------------
int __fastcall RilSocket::onNewCommandConnect(RilSocket *this)
{
  pthread_t *v1; // r4
  int v2; // r0
  pthread_attr_t attr; // [sp+4h] [bp-2Ch]

  v1 = (pthread_t *)this;
  pthread_attr_init(&attr);
  pthread_attr_setdetachstate(&attr, 1);
  v2 = pthread_create(v1 + 5, &attr, (void *(*)(void *))ril_socket_process_requests_loop, v1);
  if ( v2 <= -1 )
    _android_log_buf_print(1, 6, 0, "pthread_create failed with result:%d", v2);
  _android_log_buf_print(1, 6, 0, "New socket command connected and socket request thread started");
  return _stack_chk_guard - *(&attr.__align + 6);
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B6F4) --------------------------------------------------------
int __fastcall ril_socket_process_requests_loop(int a1)
{
  (*(void (**)(void))(*(_DWORD *)a1 + 4))();
  return 0;
}

//----- (0000B700) --------------------------------------------------------
int __fastcall RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4)
{
  int *v4; // r4
  int v5; // r5
  __int64 v6; // r0
  signed int v7; // r3
  signed int v8; // r2
  signed int v9; // r3
  signed int v10; // r1
  const char *v11; // r3
  int *v12; // r0
  bool v13; // zf
  int v15; // [sp+0h] [bp-28h]
  int v16; // [sp+8h] [bp-20h]
  int v17; // [sp+Ch] [bp-1Ch]
  int v18; // [sp+10h] [bp-18h]

  v4 = a1;
  v5 = a4;
  LODWORD(v6) = record_stream_get_next(a4, &v17, &v16);
  HIDWORD(v6) = v17;
  v7 = 0;
  v8 = 0;
  if ( !(_DWORD)v6 )
    v8 = 1;
  if ( !v6 )
    v7 = 1;
  if ( (signed int)v6 >= 0 && !v7 )
  {
    do
    {
      if ( v8 & 1 )
        (*(void (__fastcall **)(int *))*v4)(v4);
      LODWORD(v6) = record_stream_get_next(v5, &v17, &v16);
      HIDWORD(v6) = v17;
      v8 = 0;
      if ( !(_DWORD)v6 )
        v8 = 1;
      v9 = 0;
      if ( !v6 )
        v9 = 1;
    }
    while ( (signed int)v6 >= 0 && v9 != 1 );
  }
  if ( v8 )
  {
    v10 = 5;
    v11 = "EOS.  Closing command socket.";
LABEL_21:
    _android_log_buf_print(1, v10, 0, v11, v15);
    close(v4[4]);
    v4[4] = -1;
    ril_event_del((int)(v4 + 17));
    record_stream_free(v5);
    rilEventAddWakeup_helper((int)(v4 + 8));
    (*(void (__fastcall **)(int *))(*v4 + 8))(v4);
    return _stack_chk_guard - v18;
  }
  v12 = (int *)_errno(v6);
  v13 = *v12 == 11;
  if ( *v12 != 11 )
    v13 = *v12 == 4;
  if ( !v13 )
  {
    v10 = 6;
    v15 = *v12;
    v11 = "error on reading command socket errno:%d\n";
    goto LABEL_21;
  }
  return _stack_chk_guard - v18;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);
// 39E0: using guessed type int __fastcall record_stream_get_next(_DWORD, _DWORD, _DWORD);
// 3A70: using guessed type int __fastcall record_stream_free(_DWORD);

//----- (0000B7F4) --------------------------------------------------------
int __fastcall RilSocket::setListenFd(int result, int a2)
{
  *(_DWORD *)(result + 12) = a2;
  return result;
}

//----- (0000B7F8) --------------------------------------------------------
int __fastcall RilSocket::setCommandFd(int result, int a2)
{
  *(_DWORD *)(result + 16) = a2;
  return result;
}

//----- (0000B7FC) --------------------------------------------------------
int __fastcall RilSocket::getListenFd(RilSocket *this)
{
  return *((_DWORD *)this + 3);
}

//----- (0000B800) --------------------------------------------------------
int __fastcall RilSocket::getCommandFd(RilSocket *this)
{
  return *((_DWORD *)this + 4);
}

//----- (0000B804) --------------------------------------------------------
int __fastcall RilSocket::setListenCb(int result, void (__cdecl *a2)(int, __int16, void *))
{
  *(_DWORD *)(result + 24) = a2;
  return result;
}

//----- (0000B808) --------------------------------------------------------
int __fastcall RilSocket::setCommandCb(int result, void (__cdecl *a2)(int, __int16, void *))
{
  *(_DWORD *)(result + 28) = a2;
  return result;
}

//----- (0000B80C) --------------------------------------------------------
int __fastcall RilSocket::getListenCb(RilSocket *this)
{
  return *((_DWORD *)this + 6);
}

//----- (0000B810) --------------------------------------------------------
int __fastcall RilSocket::getCommandCb(RilSocket *this)
{
  return *((_DWORD *)this + 7);
}

//----- (0000B814) --------------------------------------------------------
int __fastcall RilSocket::setListenEvent(_DWORD *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10)
{
  _DWORD *v10; // r0

  a1[8] = a2;
  a1[9] = a3;
  a1[10] = a4;
  a1[11] = a5;
  a1[12] = a6;
  a1[13] = a7;
  v10 = a1 + 14;
  *v10 = a8;
  v10[1] = a9;
  v10[2] = a10;
  return (int)(v10 + 3);
}

//----- (0000B838) --------------------------------------------------------
int __fastcall RilSocket::setCallbackEvent(_DWORD *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10)
{
  _DWORD *v10; // r0

  a1[17] = a2;
  a1[18] = a3;
  a1[19] = a4;
  a1[20] = a5;
  a1[21] = a6;
  a1[22] = a7;
  v10 = a1 + 23;
  *v10 = a8;
  v10[1] = a9;
  v10[2] = a10;
  return (int)(v10 + 3);
}

//----- (0000B85C) --------------------------------------------------------
char *__fastcall RilSocket::getListenEvent(RilSocket *this)
{
  return (char *)this + 32;
}

//----- (0000B860) --------------------------------------------------------
char *__fastcall RilSocket::getCallbackEvent(RilSocket *this)
{
  return (char *)this + 68;
}

//----- (0000B864) --------------------------------------------------------
void __fastcall RilSapSocket::sOnRequestComplete(_DWORD *a1, int a2, int a3, unsigned int a4)
{
  unsigned int v4; // r7
  int v5; // r5
  _DWORD *v6; // r4
  int v7; // r6
  int v8; // r0
  void **v9; // r0

  v4 = a4;
  v5 = a3;
  v6 = a1;
  v7 = a2;
  _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Socket id:%d", a1[3]);
  v8 = RilSapSocket::getSocketById(v6[3]);
  if ( v8 )
  {
    RilSapSocket::onRequestComplete(v8, (int)v6, v7, v5, v4);
  }
  else
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Invalid socket id");
    v9 = (void **)v6[1];
    if ( v9[4] )
    {
      free(v9[4]);
      v9 = (void **)v6[1];
    }
    free(v9);
    j_free(v6);
  }
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B8DC) --------------------------------------------------------
RilSapSocket *__fastcall RilSapSocket::sOnUnsolicitedResponse(RilSapSocket *this, int a2, const void *a3, unsigned int a4)
{
  RilSapSocket *v4; // r6
  const void *v5; // r4
  void *v6; // r5
  RilSapSocket *result; // r0

  v4 = this;
  v5 = a3;
  v6 = (void *)a2;
  result = (RilSapSocket *)RilSapSocket::getSocketById(0);
  if ( result )
    result = (RilSapSocket *)j_RilSapSocket::onUnsolicitedResponse(result, (int)v4, v6, (unsigned int)v5);
  return result;
}

//----- (0000B8FC) --------------------------------------------------------
int __fastcall RilSapSocket::getSocketById(int a1)
{
  int v1; // r4
  _DWORD *v2; // r5
  RilSapSocket *v3; // r0
  int result; // r0

  v1 = a1;
  v2 = (_DWORD *)dword_158DC;
  v3 = (RilSapSocket *)_android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Entered getSocketById");
  RilSapSocket::printList(v3);
  while ( v2 )
  {
    result = *v2;
    if ( *(_DWORD *)(*v2 + 8) == v1 )
      return result;
    v2 = (_DWORD *)v2[1];
  }
  return 0;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 158DC: using guessed type int dword_158DC;

//----- (0000B93C) --------------------------------------------------------
int __fastcall RilSapSocket::onRequestComplete(int a1, int a2, int a3, int a4, unsigned int a5)
{
  int v5; // r8
  int v6; // r6
  int *v7; // r4
  signed int v8; // r0
  unsigned int *v9; // r0
  unsigned int *v10; // r5
  int result; // r0
  int v12; // [sp+8h] [bp-30h]
  int v13; // [sp+Ch] [bp-2Ch]
  int v14; // [sp+10h] [bp-28h]
  int v15; // [sp+14h] [bp-24h]
  void *ptr; // [sp+18h] [bp-20h]
  int v17; // [sp+1Ch] [bp-1Ch]

  v5 = a1;
  v6 = a4;
  v7 = *(int **)(a2 + 4);
  v12 = *v7;
  v13 = 2;
  v14 = v7[2];
  v15 = a3;
  v8 = 1;
  if ( a5 + 8 >= a5 )
    v8 = 0;
  if ( v8 )
    goto LABEL_16;
  v9 = (unsigned int *)calloc(1u, a5 + 8);
  v10 = v9;
  ptr = v9;
  if ( v9 )
  {
    if ( v6 && a5 )
    {
      _aeabi_memcpy(v9 + 1, v6, a5);
      *v10 = a5;
    }
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Token:%d, MessageId:%d", *v7, v7[2], v12, v13, v14, v15);
    RilSapSocket::sendResponse(v5, &v12);
    free(ptr);
  }
  else
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "onRequestComplete: OOM");
  }
  if ( !Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(v5 + 132, v7[2], *v7) )
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Token:%d, MessageId:%d", *v7, v7[2], v12, v13, v14, v15, ptr);
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "RilSapSocket::onRequestComplete: invalid Token or Message Id");
  }
  free(v7);
  result = _stack_chk_guard - v17;
  if ( _stack_chk_guard != v17 )
LABEL_16:
    abort();
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3B18: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);

//----- (0000BA48) --------------------------------------------------------
int __fastcall RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4)
{
  RilSapSocket *v4; // r8
  void *v5; // r7
  unsigned int v6; // r6
  int v7; // r5
  signed int v8; // r0
  unsigned int *v9; // r0
  unsigned int *v10; // r4
  int result; // r0
  int v12; // [sp+0h] [bp-30h]
  int v13; // [sp+4h] [bp-2Ch]
  int v14; // [sp+8h] [bp-28h]
  int v15; // [sp+Ch] [bp-24h]
  unsigned int *v16; // [sp+10h] [bp-20h]
  int v17; // [sp+14h] [bp-1Ch]

  v4 = this;
  v5 = a3;
  v6 = a4;
  v7 = a2;
  if ( a3 && a4 )
  {
    v8 = 1;
    if ( a4 + 8 >= a4 )
      v8 = 0;
    if ( v8 )
LABEL_11:
      abort();
    v9 = (unsigned int *)calloc(1u, a4 + 8);
    v10 = v9;
    if ( v9 )
    {
      _aeabi_memcpy(v9 + 1, v5, v6);
      *v10 = v6;
      v16 = v10;
      v13 = 3;
      v14 = v7;
      v15 = 0;
      RilSapSocket::sendResponse((int)v4, &v12);
      free(v10);
    }
    else
    {
      _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "onUnsolicitedResponse: OOM");
    }
  }
  result = _stack_chk_guard - v17;
  if ( _stack_chk_guard != v17 )
    goto LABEL_11;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3B18: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);

//----- (0000BAEC) --------------------------------------------------------
int __fastcall RilSapSocket::printList(RilSapSocket *this)
{
  _DWORD *v1; // r7
  int result; // r0

  v1 = (_DWORD *)dword_158DC;
  for ( result = _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Printing socket list"); v1; v1 = (_DWORD *)v1[1] )
  {
    _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "SocketName:%s", *(_DWORD *)(*v1 + 4));
    result = _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Socket id:%d", *(_DWORD *)(*v1 + 8));
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 158DC: using guessed type int dword_158DC;

//----- (0000BB5C) --------------------------------------------------------
int __fastcall RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2)
{
  pthread_mutexattr_t v2; // r4
  RilSapSocket *v3; // r5
  int result; // r0
  const char *v5; // r1

  v2 = a2;
  v3 = (RilSapSocket *)a1;
  result = strcmp(a1, "sap_uim_socket1");
  if ( !result )
  {
    result = RilSapSocket::SocketExists(v3, v5);
    if ( !result )
      result = j_RilSapSocket::addSocketToList(v3, 0, v2);
  }
  return result;
}

//----- (0000BB88) --------------------------------------------------------
signed int __fastcall RilSapSocket::SocketExists(RilSapSocket *this, const char *a2)
{
  RilSapSocket *v2; // r4
  _DWORD *i; // r5

  v2 = this;
  for ( i = (_DWORD *)dword_158DC; i; i = (_DWORD *)i[1] )
  {
    if ( !strcmp(*(const char **)(*i + 4), (const char *)v2) )
      return 1;
  }
  return 0;
}
// 158DC: using guessed type int dword_158DC;

//----- (0000BBB4) --------------------------------------------------------
signed int __fastcall RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3)
{
  pthread_mutexattr_t v3; // r5
  pthread_mutexattr_t v4; // r6
  pthread_mutexattr_t v5; // r7
  signed int result; // r0
  pthread_mutexattr_t *v7; // r4
  _DWORD *v8; // r0
  int v9; // r5
  int v10; // r0
  int v11; // r1

  v3 = a3;
  v4.__align = (int)a2;
  v5.__align = (int)a1;
  result = RilSapSocket::SocketExists(a1, a2);
  if ( !result )
  {
    v7 = (pthread_mutexattr_t *)operator new(0x94u);
    RilSapSocket::RilSapSocket(v7, v5, v4, v3);
    v8 = malloc(8u);
    v9 = (int)v8;
    if ( v8 )
    {
      *v8 = v7;
      v8[1] = 0;
      _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Adding socket with id: %d", v7[2].__align);
      v10 = dword_158DC;
      if ( dword_158DC )
      {
        do
        {
          v11 = v10;
          v10 = *(_DWORD *)(v10 + 4);
        }
        while ( v10 );
        *(_DWORD *)(v11 + 4) = v9;
      }
      else
      {
        *(_DWORD *)(v9 + 4) = 0;
        dword_158DC = v9;
      }
      result = j_RilSocket::socketInit((RilSocket *)v7);
    }
    else
    {
      result = _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "addSocketToList: OOM");
    }
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 158DC: using guessed type int dword_158DC;

//----- (0000BC50) --------------------------------------------------------
void __fastcall __noreturn RilSapSocket::processRequestsLoop(RilSapSocket *this)
{
  RilSapSocket *v1; // r4
  _DWORD **v2; // r7

  v1 = this;
  _android_log_buf_print(1, 4, "RIL_UIM_SOCKET", "UIM_SOCKET:Request loop started");
  while ( 1 )
  {
    v2 = (_DWORD **)Ril_queue<RilSapSocket::SapSocketRequest>::dequeue((int)v1 + 116);
    _android_log_buf_print(1, 4, "RIL_UIM_SOCKET", "New request from the dispatch Queue");
    if ( v2 )
    {
      RilSapSocket::dispatchRequest((int)v1, v2[1]);
      free(v2);
    }
    else
    {
      _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Fetched null buffer from queue!");
    }
  }
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000BCC0) --------------------------------------------------------
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::dequeue(int a1)
{
  int v1; // r5
  pthread_mutex_t *v2; // r4
  int i; // r6

  v1 = a1;
  v2 = (pthread_mutex_t *)(a1 + 4);
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 4));
  for ( i = *(_DWORD *)(v1 + 12); !i; i = *(_DWORD *)(v1 + 12) )
    pthread_cond_wait((pthread_cond_t *)(v1 + 8), v2);
  *(_DWORD *)(v1 + 12) = *(_DWORD *)(i + 8);
  pthread_mutex_unlock(v2);
  return i;
}

//----- (0000BCF4) --------------------------------------------------------
void __fastcall RilSapSocket::dispatchRequest(int a1, _DWORD *a2)
{
  int v2; // r6
  _DWORD *v3; // r4
  _DWORD *v4; // r0
  _DWORD *v5; // r5

  v2 = a1;
  v3 = a2;
  v4 = malloc(0x10u);
  v5 = v4;
  if ( v4 )
  {
    *v4 = *v3;
    v4[1] = v3;
    v4[2] = 0;
    v4[3] = *(_DWORD *)(v2 + 8);
    Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(v2 + 132, (int)v4);
    if ( *(_DWORD *)(v2 + 112) )
    {
      _android_log_buf_print(
        1,
        4,
        "RIL_UIM_SOCKET",
        "[%d] > SAP REQUEST type: %d. id: %d. error: %d",
        *v3,
        v3[1],
        v3[2],
        v3[3]);
      (*(void (__fastcall **)(_DWORD, int, _DWORD, _DWORD *))(*(_DWORD *)(v2 + 112) + 4))(
        v3[2],
        v3[4] + 4,
        *(_DWORD *)v3[4],
        v5);
    }
  }
  else
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "dispatchRequest: OOM");
    j_free(v3);
  }
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000BD84) --------------------------------------------------------
pthread_mutexattr_t *__fastcall RilSapSocket::RilSapSocket(pthread_mutexattr_t *a1, pthread_mutexattr_t a2, pthread_mutexattr_t a3, pthread_mutexattr_t a4)
{
  pthread_mutexattr_t *v4; // r5
  const pthread_mutexattr_t *v5; // r6
  pthread_mutexattr_t v6; // r4

  v4 = a1;
  v5 = a1 + 29;
  v6 = a4;
  a1[3].__align = -1;
  a1[4].__align = -1;
  a1[26].__align = 0;
  a1[1] = a2;
  a1[2] = a3;
  a1->__align = (int)&off_14B70;
  pthread_mutexattr_init(a1 + 29);
  pthread_mutex_init((pthread_mutex_t *)&v4[30], v5);
  v4[31].__align = 0;
  v4[32].__align = 0;
  pthread_mutexattr_init(v4 + 33);
  pthread_mutex_init((pthread_mutex_t *)&v4[34], v4 + 33);
  v4[35].__align = 0;
  v4[36].__align = 0;
  if ( v6.__align )
    v4[28] = v6;
  return v4;
}
// 14B70: using guessed type void *;

//----- (0000BDE4) --------------------------------------------------------
int __fastcall log_hex(const char *a1, const unsigned __int8 *a2, int a3)
{
  int v3; // r4
  const unsigned __int8 *v4; // r5
  int v5; // r10
  signed int v6; // r8
  int v7; // r9
  int v8; // r0
  signed int v9; // r1
  int v10; // lr
  const unsigned __int8 *v11; // r12
  int v12; // r2
  int v13; // r1
  signed int v14; // r3
  signed int v15; // r11
  int v16; // r3
  signed int v17; // r6
  unsigned int v18; // r5
  int v19; // r4
  int v20; // r6
  signed int v21; // r0
  char v22; // r4
  signed int v23; // r3
  bool v24; // vf
  signed int v25; // r2
  signed int v26; // r1
  signed int v27; // r1
  signed int v28; // r1
  signed int v29; // r0
  int result; // r0
  const char *v31; // [sp+Ch] [bp-4h]
  int v32; // [sp+10h] [bp+0h]
  int v33; // [sp+60h] [bp+50h]

  v31 = a1;
  v3 = a3;
  v4 = a2;
  v5 = 0;
  v6 = 0;
  v7 = 0;
  do
  {
    v8 = _snprintf_chk(&v32, 80, 0, 80, "%8.8s [%8.8x] ", v31, v7) + v6;
    v9 = 1;
    if ( !__OFSUB__(v8, v6) )
      v9 = 0;
    v10 = v3;
    v11 = v4;
    if ( v9 )
      goto LABEL_47;
    if ( v7 >= v3 )
    {
LABEL_32:
      v4 = v11;
      v3 = v10;
      v15 = 0;
    }
    else
    {
      v12 = v7;
      v13 = v5;
      while ( 1 )
      {
        v14 = 1;
        if ( !__OFSUB__(80, v8) )
          v14 = 0;
        if ( v14 )
          goto LABEL_47;
        v15 = 1;
        if ( v13 > 15 || 80 - v8 < 4 )
          break;
        v16 = v8 + 1;
        v17 = 1;
        if ( v8 + 1 > v8 )
          v17 = 0;
        if ( v17 )
          goto LABEL_47;
        v18 = v11[v12];
        v19 = (v18 >> 4) | 0x30;
        if ( v18 > 0x9F )
          v19 = (v18 >> 4) + 55;
        v20 = v8 + 2;
        *((_BYTE *)&v32 + v8) = v19;
        v21 = 1;
        if ( v16 + 1 > v16 )
          v21 = 0;
        if ( v21 )
          goto LABEL_47;
        v22 = v18 & 0xF | 0x30;
        if ( (v18 & 0xE) > 9 )
          v22 = (v18 & 0xF) + 55;
        v8 = v16 + 2;
        *((_BYTE *)&v32 + v16) = v22;
        v23 = 1;
        if ( v20 + 1 > v20 )
          v23 = 0;
        if ( v23 )
          goto LABEL_47;
        v7 = v12 + 1;
        v24 = v12 + 1 <= v12;
        v25 = 1;
        *((_BYTE *)&v32 + v20) = 32;
        if ( !v24 )
          v25 = 0;
        if ( v25 )
          goto LABEL_47;
        v5 = v13 + 1;
        v24 = v13 + 1 <= v13;
        v26 = 1;
        if ( !v24 )
          v26 = 0;
        if ( v26 )
          goto LABEL_47;
        v12 = v7;
        v13 = v5;
        if ( v7 >= v10 )
          goto LABEL_32;
      }
      v4 = v11;
      v3 = v10;
      v7 = v12;
      v5 = v13;
    }
    if ( v8 > 79 )
      break;
    v27 = 0;
    if ( v5 != 16 )
      v27 = 1;
    if ( v27 & v15 )
    {
      v6 = v8;
    }
    else
    {
      v28 = 1;
      if ( v8 + 1 > v8 )
        v28 = 0;
      if ( v28 )
        goto LABEL_47;
      v5 = 0;
      *((_BYTE *)&v32 + v8) = 0;
      _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "%s\n", &v32);
      v6 = 0;
    }
    v29 = 0;
    if ( v6 < 80 )
      v29 = 1;
  }
  while ( v15 & v29 );
  result = _stack_chk_guard - v33;
  if ( _stack_chk_guard != v33 )
LABEL_47:
    abort();
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3980: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000BF7C) --------------------------------------------------------
int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::enqueue(int a1, int a2)
{
  int v2; // r5
  pthread_mutex_t *v3; // r4
  int v4; // r6
  int v5; // r0

  v2 = a1;
  v3 = (pthread_mutex_t *)(a1 + 4);
  v4 = a2;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 4));
  v5 = *(_DWORD *)(v2 + 12);
  if ( v5 )
  {
    *(_DWORD *)(v4 + 8) = v5;
    *(_DWORD *)(v2 + 12) = v4;
  }
  else
  {
    *(_DWORD *)(v2 + 12) = v4;
    *(_DWORD *)(v4 + 8) = 0;
  }
  pthread_cond_broadcast((pthread_cond_t *)(v2 + 8));
  return j_pthread_mutex_unlock(v3);
}

//----- (0000BFAC) --------------------------------------------------------
int __fastcall RilSapSocket::sendResponse(int a1, int *a2)
{
  int v2; // r7
  pthread_mutex_t *v3; // r4
  int *v4; // r6
  int v5; // r0
  signed int v6; // r1
  int v7; // r5
  unsigned int v8; // r10
  signed int v9; // r0
  unsigned __int8 *v10; // r8
  int v11; // r0
  _DWORD *v12; // r0
  const char *v13; // r3
  const char *v14; // r3
  const char *v15; // r0
  signed int v16; // r1
  int result; // r0
  int v18; // [sp+0h] [bp-68h]
  __int64 v19; // [sp+0h] [bp-68h]
  int v20; // [sp+4h] [bp-64h]
  signed int v21; // [sp+8h] [bp-60h]
  unsigned int v22; // [sp+8h] [bp-60h]
  int v23; // [sp+Ch] [bp-5Ch]
  const char *v24; // [sp+Ch] [bp-5Ch]
  char v25; // [sp+10h] [bp-58h]
  __int64 v26; // [sp+18h] [bp-50h]
  const char *v27; // [sp+20h] [bp-48h]
  __int64 v28; // [sp+28h] [bp-40h]
  __int64 v29; // [sp+30h] [bp-38h]
  const char *v30; // [sp+38h] [bp-30h]
  unsigned int v31; // [sp+3Ch] [bp-2Ch]
  int v32; // [sp+40h] [bp-28h]
  int v33; // [sp+44h] [bp-24h]

  v2 = a1;
  v3 = (pthread_mutex_t *)(a1 + 104);
  v4 = a2;
  v32 = 0;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 104));
  v5 = j_pb_get_encoded_size(&v32, (unsigned __int8 *)&MsgHeader_fields, v4);
  v6 = *(_DWORD *)(v2 + 16);
  v7 = v32;
  if ( v5 != 1 || v32 < 0 )
    goto LABEL_12;
  if ( v6 == -1 )
  {
    v6 = -1;
LABEL_12:
    v18 = v4[1];
    v20 = v32;
    v14 = "Not sending response type %d: encoded_size: %zu. commandFd: %d. encoded size result:                %d";
    v21 = v6;
    v23 = v5;
LABEL_13:
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", v14, v18, v20, v21, v23);
    goto LABEL_21;
  }
  v8 = v32 + 4;
  v9 = 1;
  if ( v32 + 4 >= (unsigned int)v32 )
    v9 = 0;
  if ( v9 )
LABEL_22:
    abort();
  v10 = (unsigned __int8 *)malloc(v32 + 4);
  if ( !v10 )
  {
    v14 = "sendResponse: OOM";
    goto LABEL_13;
  }
  v31 = bswap32(v7);
  j_pb_ostream_from_buffer((int)&v25, (int)v10, v8);
  v28 = *(_QWORD *)&v25;
  v29 = v26;
  v30 = v27;
  j_pb_write((int)&v28, (int)&v31, 4);
  if ( j_pb_encode(&v28, (unsigned __int8 *)&MsgHeader_fields, v4) == 1 )
  {
    _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Size: %zu (0x%zx) Size as written: 0x%x", v32, v32, v31);
    log_hex("onRequestComplete", v10 + 4, v32);
    _android_log_buf_print(
      1,
      4,
      "RIL_UIM_SOCKET",
      "[%d] < SAP RESPONSE type: %d. id: %d. error: %d",
      *(_QWORD *)v4,
      v4[2],
      v4[3]);
    v11 = blockingWrite_helper(*(_DWORD *)(v2 + 16), v10, v8);
    if ( !v11 )
    {
      v16 = 3;
      v13 = "Write successful";
      goto LABEL_20;
    }
    v12 = (_DWORD *)_errno(v11);
    v13 = "Error %d while writing to fd";
    LODWORD(v19) = *v12;
  }
  else
  {
    v15 = "(none)";
    v13 = "Error while encoding response of type %d id %d buffer_size: %zu: %s.";
    if ( v30 )
      v15 = v30;
    v19 = *(_QWORD *)(v4 + 1);
    v22 = v8;
    v24 = v15;
  }
  v16 = 6;
LABEL_20:
  _android_log_buf_print(1, v16, "RIL_UIM_SOCKET", v13, v19, v22, v24);
  free(v10);
LABEL_21:
  pthread_mutex_unlock(v3);
  result = _stack_chk_guard - v33;
  if ( _stack_chk_guard != v33 )
    goto LABEL_22;
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3950: using guessed type int __fastcall _errno(_DWORD);

//----- (0000C17C) --------------------------------------------------------
signed int __fastcall Ril_queue<RilSapSocket::SapSocketRequest>::checkAndDequeue(int a1, int a2, int a3)
{
  int v3; // r7
  pthread_mutex_t *v4; // r4
  int v5; // r5
  int v6; // r6
  _DWORD *i; // r0
  _DWORD *v8; // r7
  _DWORD *v9; // t1
  signed int v10; // r5

  v3 = a1;
  v4 = (pthread_mutex_t *)(a1 + 4);
  v5 = a3;
  v6 = a2;
  pthread_mutex_lock((pthread_mutex_t *)(a1 + 4));
  v9 = *(_DWORD **)(v3 + 12);
  v8 = (_DWORD *)(v3 + 12);
  for ( i = v9; i; i = (_DWORD *)i[2] )
  {
    if ( *i == v5 && *(_DWORD *)(i[1] + 8) == v6 )
    {
      *v8 = i[2];
      free(i);
      v10 = 1;
      goto LABEL_8;
    }
    v8 = i + 2;
  }
  v10 = 0;
LABEL_8:
  pthread_mutex_unlock(v4);
  return v10;
}

//----- (0000C1C4) --------------------------------------------------------
int __fastcall RilSapSocket::pushRecord(RilSapSocket *this, void *a2, unsigned int a3)
{
  RilSapSocket *v3; // r5
  int v4; // r6
  const unsigned __int8 *v5; // r7
  _QWORD *v6; // r4
  _DWORD *v7; // r0
  const char *v8; // r0
  char v10; // [sp+8h] [bp-28h]
  const char *v11; // [sp+14h] [bp-1Ch]
  int v12; // [sp+18h] [bp-18h]

  v3 = this;
  v4 = a3;
  v5 = (const unsigned __int8 *)a2;
  j_pb_istream_from_buffer(&v10, (int)a2, a3);
  v6 = malloc(0x14u);
  if ( !v6 )
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "pushRecord: OOM");
    return _stack_chk_guard - v12;
  }
  *v6 = 0LL;
  v6[1] = 0LL;
  *((_DWORD *)v6 + 4) = 0;
  log_hex("BtSapTest-Payload", v5, v4);
  if ( !j_pb_decode((int)&v10, (int)&MsgHeader_fields, (int)v6) )
  {
    v8 = "(none)";
    if ( v11 )
      v8 = v11;
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Error decoding protobuf buffer : %s", v8);
    goto LABEL_10;
  }
  v7 = malloc(0x10u);
  if ( !v7 )
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "pushRecord: OOM");
LABEL_10:
    free(v6);
    return _stack_chk_guard - v12;
  }
  *v7 = *(_DWORD *)v6;
  v7[1] = v6;
  v7[3] = *((_DWORD *)v3 + 2);
  Ril_queue<RilSapSocket::SapSocketRequest>::enqueue((int)v3 + 116, (int)v7);
  return _stack_chk_guard - v12;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000C2B4) --------------------------------------------------------
int __fastcall RilSapSocket::sendDisconnect(RilSapSocket *this)
{
  char *v1; // r6
  RilSapSocket *v2; // r4
  unsigned int v3; // r7
  signed int v4; // r0
  int *v5; // r5
  unsigned int v6; // r7
  signed int v7; // r0
  char *v8; // r0
  char *v9; // r0
  _DWORD *v10; // r12
  void *i; // r0
  int result; // r0
  char v13; // [sp+0h] [bp-50h]
  __int64 v14; // [sp+8h] [bp-48h]
  int v15; // [sp+10h] [bp-40h]
  char v16; // [sp+17h] [bp-39h]
  __int64 v17; // [sp+18h] [bp-38h]
  __int64 v18; // [sp+20h] [bp-30h]
  int v19; // [sp+28h] [bp-28h]
  unsigned int v20; // [sp+30h] [bp-20h]
  unsigned int v21; // [sp+34h] [bp-1Ch]
  int v22; // [sp+38h] [bp-18h]

  v2 = this;
  v21 = 0;
  if ( j_pb_get_encoded_size(&v21, (unsigned __int8 *)&RIL_SIM_SAP_DISCONNECT_REQ_fields, (int *)&v16) != 1 )
    goto LABEL_19;
  v3 = v21;
  if ( (v21 & 0x80000000) != 0 )
    goto LABEL_19;
  v1 = (char *)(v21 + 4);
  v4 = 1;
  if ( v21 + 4 >= v21 )
    v4 = 0;
  if ( v4 )
    goto LABEL_21;
  v5 = (int *)malloc(v21 + 4);
  if ( !v5 )
    goto LABEL_18;
  v20 = bswap32(v3);
  j_pb_ostream_from_buffer((int)&v13, (int)v5, (unsigned int)v1);
  v1 = (char *)&v17;
  v17 = *(_QWORD *)&v13;
  v18 = v14;
  v19 = v15;
  j_pb_write((int)&v17, (int)&v20, 4);
  if ( j_pb_encode(&v17, (unsigned __int8 *)&RIL_SIM_SAP_DISCONNECT_REQ_fields, v5) == 1 )
  {
    v6 = v20;
    v7 = 1;
    if ( v20 + 8 >= v20 )
      v7 = 0;
    if ( !v7 )
    {
      v8 = (char *)calloc(1u, v20 + 8);
      v1 = v8;
      if ( v8 )
      {
        _aeabi_memcpy(v8 + 4, v5, v6);
        *(_DWORD *)v1 = v6;
        v9 = (char *)malloc(0x14u);
        if ( !v9 )
          goto LABEL_20;
        v10 = v9 + 4;
        *v10 = 1;
        v10[1] = 2;
        v10[2] = 0;
        v10[3] = v1;
        RilSapSocket::dispatchDisconnect((int)v2, (int)v9);
        goto LABEL_16;
      }
LABEL_18:
      _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "sendDisconnect: OOM");
      goto LABEL_19;
    }
LABEL_21:
    abort();
  }
  _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Encode failed in send disconnect!");
LABEL_16:
  for ( i = v5; ; i = v1 )
  {
    free(i);
LABEL_19:
    result = _stack_chk_guard - v22;
    if ( _stack_chk_guard == v22 )
      break;
LABEL_20:
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "sendDisconnect: OOM");
  }
  return result;
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3B18: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);

//----- (0000C410) --------------------------------------------------------
void __fastcall RilSapSocket::dispatchDisconnect(int a1, int a2)
{
  int v2; // r6
  int v3; // r4
  _DWORD *v4; // r0
  _DWORD *v5; // r5

  v2 = a1;
  v3 = a2;
  v4 = malloc(0x10u);
  v5 = v4;
  if ( v4 )
  {
    *v4 = -1;
    v4[1] = v3;
    v4[2] = 0;
    v4[3] = 99;
    _android_log_buf_print(1, 3, "RIL_UIM_SOCKET", "Sending disconnect on command close!");
    (*(void (__fastcall **)(_DWORD, int, _DWORD, _DWORD *))(*(_DWORD *)(v2 + 112) + 4))(
      *(_DWORD *)(v3 + 8),
      *(_DWORD *)(v3 + 16) + 4,
      **(_DWORD **)(v3 + 16),
      v5);
  }
  else
  {
    _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "dispatchDisconnect: OOM");
    free(*(void **)(v3 + 16));
    j_free((void *)v3);
  }
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000C488) --------------------------------------------------------
int __fastcall RilSapSocket::onCommandsSocketClosed(RilSapSocket *this)
{
  RilSapSocket::sendDisconnect(this);
  return _android_log_buf_print(1, 6, "RIL_UIM_SOCKET", "Socket command closed");
}
// 38CC: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000C4AC) --------------------------------------------------------
signed int __fastcall pb_read(int a1, int a2, unsigned int a3)
{
  int v3; // r4
  unsigned int v4; // r5
  const char *v6; // r0
  char v7; // [sp+4h] [bp-24h]

  v3 = a1;
  v4 = a3;
  if ( !a2 && *(int (**)())a1 != sub_C54C )
  {
    if ( a3 < 0x11 )
      return j_pb_read(v3, (int)&v7, v4);
    while ( j_pb_read(v3, (int)&v7, 16) == 1 )
    {
      v4 -= 16;
      if ( v4 <= 0x10 )
        return j_pb_read(v3, (int)&v7, v4);
    }
    return 0;
  }
  if ( *(_DWORD *)(a1 + 8) >= a3 )
  {
    if ( (*(int (__fastcall **)(int))a1)(a1) )
    {
      *(_DWORD *)(v3 + 8) -= v4;
      return 1;
    }
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v6 = "io error";
      goto LABEL_14;
    }
  }
  else if ( !*(_DWORD *)(a1 + 12) )
  {
    v6 = "end-of-stream";
LABEL_14:
    *(_DWORD *)(v3 + 12) = v6;
    return 0;
  }
  return 0;
}
// C54C: using guessed type int sub_C54C();

//----- (0000C56C) --------------------------------------------------------
_DWORD *__fastcall pb_istream_from_buffer(_DWORD *result, int a2, int a3)
{
  *result = sub_C54C;
  result[1] = a2;
  result[2] = a3;
  result[3] = 0;
  return result;
}
// C54C: using guessed type int sub_C54C();

//----- (0000C584) --------------------------------------------------------
signed int __fastcall pb_decode_varint(int a1, _DWORD *a2)
{
  int v2; // r4
  _DWORD *v3; // r8
  int v4; // r7
  int v5; // r5
  unsigned __int8 v6; // r0
  int v7; // r6
  unsigned int v8; // r2
  unsigned int v9; // r3
  signed int result; // r0
  char v11; // [sp+7h] [bp-21h]

  v2 = a1;
  v3 = a2;
  v4 = 0;
  v5 = 0;
  v6 = 0;
  while ( 1 )
  {
    v7 = v6;
    if ( v6 >= 0x40u )
      break;
    if ( sub_C618(v2, (int)&v11) != 1 )
      return 0;
    v8 = v11 & 0x7F;
    v9 = v8 >> (32 - v7);
    if ( v7 - 32 >= 0 )
      v9 = v8 << (v7 - 32);
    v4 |= v8 << v7;
    v5 |= v9;
    v6 = v7 + 7;
    if ( !(v11 & 0x80) )
    {
      result = 1;
      *v3 = v4;
      v3[1] = v5;
      return result;
    }
  }
  if ( !*(_DWORD *)(v2 + 12) )
    *(_DWORD *)(v2 + 12) = "varint overflow";
  return 0;
}

//----- (0000C618) --------------------------------------------------------
signed int __fastcall sub_C618(int a1, int a2)
{
  int v2; // r4
  const char *v4; // r0

  v2 = a1;
  if ( *(_DWORD *)(a1 + 8) )
  {
    if ( (*(int (__fastcall **)(int, int, signed int))a1)(a1, a2, 1) )
    {
      --*(_DWORD *)(v2 + 8);
      return 1;
    }
    if ( !*(_DWORD *)(v2 + 12) )
    {
      v4 = "io error";
      goto LABEL_8;
    }
  }
  else if ( !*(_DWORD *)(a1 + 12) )
  {
    v4 = "end-of-stream";
LABEL_8:
    *(_DWORD *)(v2 + 12) = v4;
    return 0;
  }
  return 0;
}

//----- (0000C654) --------------------------------------------------------
signed int __fastcall pb_decode_tag(int a1, int *a2, unsigned int *a3, _BYTE *a4)
{
  int v4; // r7
  int *v5; // r5
  _BYTE *v6; // r4
  unsigned int *v7; // r6
  char v8; // r0
  unsigned int v10; // [sp+4h] [bp-1Ch]

  v4 = a1;
  v5 = a2;
  v6 = a4;
  v7 = a3;
  *a4 = 0;
  *a2 = 0;
  *a3 = 0;
  if ( sub_C6B8(a1, (int *)&v10) )
  {
    v8 = v10;
    if ( v10 )
    {
      *v7 = v10 >> 3;
      *v5 = v8 & 7;
      return 1;
    }
    goto LABEL_5;
  }
  if ( !*(_DWORD *)(v4 + 8) )
LABEL_5:
    *v6 = 1;
  return 0;
}

//----- (0000C6B8) --------------------------------------------------------
signed int __fastcall sub_C6B8(int a1, int *a2)
{
  int v2; // r4
  int *v3; // r8
  int v4; // r7
  unsigned __int8 v5; // r0
  unsigned __int8 v6; // r5
  signed int result; // r0
  unsigned __int8 v8; // [sp+3h] [bp-1Dh]

  v2 = a1;
  v3 = a2;
  if ( sub_C618(a1, (int)&v8) == 1 )
  {
    v4 = v8;
    if ( !(v8 & 0x80) )
    {
LABEL_7:
      result = 1;
      *v3 = v4;
      return result;
    }
    v4 = v8 & 0x7F;
    v5 = 7;
    while ( 1 )
    {
      v6 = v5;
      if ( v5 >= 0x20u )
        break;
      if ( sub_C618(v2, (int)&v8) != 1 )
        return 0;
      v4 |= (v8 & 0x7F) << v6;
      v5 = v6 + 7;
      if ( !(v8 & 0x80) )
        goto LABEL_7;
    }
    if ( !*(_DWORD *)(v2 + 12) )
      *(_DWORD *)(v2 + 12) = "varint overflow";
  }
  return 0;
}

//----- (0000C754) --------------------------------------------------------
int __fastcall pb_skip_field(int a1, int a2)
{
  int v2; // r4
  int result; // r0
  char v4; // [sp+7h] [bp-19h]
  int v5; // [sp+8h] [bp-18h]

  v2 = a1;
  switch ( a2 )
  {
    case 0:
      do
      {
        if ( j_pb_read(v2, (int)&v4, 1) != 1 )
          goto LABEL_10;
      }
      while ( v4 < 0 );
      result = 1;
      break;
    case 1:
      result = j_pb_read(a1, 0, 8);
      break;
    case 2:
      if ( sub_C6B8(a1, &v5) != 1 )
        goto LABEL_10;
      result = j_pb_read(v2, 0, v5);
      break;
    case 5:
      result = j_pb_read(a1, 0, 4);
      break;
    default:
      if ( !*(_DWORD *)(a1 + 12) )
        *(_DWORD *)(a1 + 12) = "invalid wire_type";
LABEL_10:
      result = 0;
      break;
  }
  return result;
}

//----- (0000C7F0) --------------------------------------------------------
signed int __fastcall pb_make_string_substream(int a1, _QWORD *a2)
{
  int v2; // r4
  _QWORD *v3; // r5
  __int64 v4; // d17
  unsigned int v5; // r0
  unsigned int v7; // [sp+0h] [bp-18h]

  v2 = a1;
  v3 = a2;
  if ( sub_C6B8(a1, (int *)&v7) != 1 )
    return 0;
  v4 = *(_QWORD *)(v2 + 8);
  *v3 = *(_QWORD *)v2;
  v3[1] = v4;
  v5 = v7;
  if ( *((_DWORD *)v3 + 2) < v7 )
  {
    if ( !*(_DWORD *)(v2 + 12) )
      *(_DWORD *)(v2 + 12) = "parent stream too short";
    return 0;
  }
  *((_DWORD *)v3 + 2) = v7;
  *(_DWORD *)(v2 + 8) -= v5;
  return 1;
}

//----- (0000C858) --------------------------------------------------------
int __fastcall pb_close_string_substream(int result, int a2)
{
  *(_DWORD *)(result + 4) = *(_DWORD *)(a2 + 4);
  *(_DWORD *)(result + 12) = *(_DWORD *)(a2 + 12);
  return result;
}

//----- (0000C864) --------------------------------------------------------
int __fastcall pb_decode_noinit(int a1, unsigned __int8 *a2, int a3)
{
  int v3; // r9
  int v4; // r11
  signed int v5; // r10
  unsigned int v6; // r5
  int v7; // r7
  int v8; // r0
  unsigned int v9; // r0
  signed int v10; // r0
  bool v11; // zf
  int v12; // r0
  int v13; // r8
  int v14; // r7
  int v15; // r0
  int (__fastcall *v16)(int, int, unsigned int, int); // r4
  unsigned __int8 *v17; // r0
  unsigned int v18; // r5
  unsigned __int8 v19; // r6
  int v20; // r1
  unsigned int v21; // r0
  int result; // r0
  unsigned int v23; // [sp+4h] [bp-74h]
  int v24; // [sp+8h] [bp-70h]
  unsigned __int8 *v25; // [sp+Ch] [bp-6Ch]
  unsigned __int8 *v26; // [sp+10h] [bp-68h]
  int v27; // [sp+14h] [bp-64h]
  unsigned int v28; // [sp+18h] [bp-60h]
  int v29; // [sp+1Ch] [bp-5Ch]
  int *v30; // [sp+20h] [bp-58h]
  _DWORD *v31; // [sp+24h] [bp-54h]
  int v32; // [sp+28h] [bp-50h]
  int v33; // [sp+2Ch] [bp-4Ch]
  unsigned int v34; // [sp+34h] [bp-44h]
  unsigned __int8 *v35; // [sp+38h] [bp-40h]
  int v36; // [sp+3Ch] [bp-3Ch]
  int v37; // [sp+40h] [bp-38h]
  int v38; // [sp+44h] [bp-34h]
  int v39; // [sp+48h] [bp-30h]
  int v40; // [sp+4Ch] [bp-2Ch]
  int v41; // [sp+50h] [bp-28h]

  v3 = a1;
  v4 = 0;
  v32 = 0;
  v33 = 0;
  v25 = a2;
  v26 = a2;
  v27 = 0;
  v28 = 0;
  v30 = (int *)(a2[2] + a3);
  v31 = (int *)((char *)v30 + (char)a2[3]);
  v29 = a3;
  if ( !*(_DWORD *)(a1 + 8) )
    goto LABEL_43;
  v5 = 0;
  v23 = 0;
  while ( 1 )
  {
    if ( sub_C6B8(v3, (int *)&v34) )
    {
      if ( v34 )
      {
        v6 = v34 >> 3;
        v7 = v4;
        v24 = v34 & 7;
        do
        {
          if ( *v26 == v6 && (v26[1] & 0xF) != 8 )
          {
            if ( !(v26[1] & 0x30) && v28 <= 0x3F )
              *((_BYTE *)&v32 + (v28 >> 3)) |= 1 << (v28 & 7);
            v12 = sub_CA94(v3, v24, &v25) ^ 1;
            v4 = v7;
            goto LABEL_38;
          }
          sub_CE80((int *)&v25);
          v7 = v27;
        }
        while ( v27 != v4 );
        v8 = v4;
        if ( v6 < v23 )
          goto LABEL_36;
        while ( (v26[1] & 0xF) != 8 )
        {
          sub_CE80((int *)&v25);
          v8 = v27;
          if ( v27 == v4 )
          {
            v9 = -1;
            goto LABEL_25;
          }
        }
        v4 = v8;
        v9 = *v26;
LABEL_25:
        if ( v6 < v9 )
        {
          v23 = v9;
LABEL_36:
          v11 = j_pb_skip_field(v3, v24) == 0;
          v12 = 1;
          if ( !v11 )
            v12 = 2;
          goto LABEL_38;
        }
        v23 = v9;
        v13 = *(_DWORD *)(v3 + 8);
        v14 = *v30;
        v15 = *(_DWORD *)(v3 + 8);
        if ( *v30 )
        {
          do
          {
            v16 = **(int (__fastcall ***)(int, int, unsigned int, int))v14;
            if ( v16 )
            {
              if ( !v16(v3, v14, v6, v24) )
                goto LABEL_56;
            }
            else
            {
              v17 = *(unsigned __int8 **)(*(_DWORD *)v14 + 8);
              if ( *v17 == v6 )
              {
                v34 = *(_DWORD *)(*(_DWORD *)v14 + 8);
                v35 = v17;
                v36 = 0;
                v37 = 0;
                v38 = *(_DWORD *)(v14 + 4);
                v39 = v38;
                v40 = v14 + 12;
                if ( sub_CA94(v3, v24, &v34) != 1 )
                  goto LABEL_57;
              }
            }
            v14 = *(_DWORD *)(v14 + 8);
            v15 = *(_DWORD *)(v3 + 8);
          }
          while ( v14 && v13 == v15 );
        }
        if ( v13 == v15 )
          goto LABEL_36;
        goto LABEL_40;
      }
      v10 = 1;
    }
    else
    {
      v10 = 0;
      if ( !*(_DWORD *)(v3 + 8) )
        v10 = 1;
    }
    v11 = v10 == 0;
    v12 = 3;
    if ( v11 )
      v12 = 1;
LABEL_38:
    if ( v12 && v12 != 2 )
      break;
LABEL_40:
    if ( !*(_DWORD *)(v3 + 8) )
      goto LABEL_43;
  }
  if ( v12 != 3 )
    goto LABEL_56;
  do
  {
LABEL_43:
    v18 = v28;
    v19 = v26[1];
  }
  while ( sub_CE80((int *)&v25) );
  if ( !(v19 & 0x30) && *v26 )
    ++v18;
  v20 = 0;
  v21 = v18 >> 3;
  if ( v18 >> 3 )
  {
    while ( *((unsigned __int8 *)&v32 + v20) == 255 )
    {
      if ( ++v20 >= v21 )
        goto LABEL_50;
    }
    if ( !*(_DWORD *)(v3 + 12) )
LABEL_55:
      *(_DWORD *)(v3 + 12) = "missing required field";
LABEL_56:
    v5 = 0;
  }
  else
  {
LABEL_50:
    if ( *((unsigned __int8 *)&v32 + v21) != 0xFFu >> (8 - (v18 & 7)) )
    {
      if ( !*(_DWORD *)(v3 + 12) )
        goto LABEL_55;
      goto LABEL_56;
    }
    v5 = 1;
  }
LABEL_57:
  result = _stack_chk_guard - v41;
  if ( _stack_chk_guard == v41 )
    result = v5;
  return result;
}

//----- (0000CA94) --------------------------------------------------------
int __fastcall sub_CA94(int a1, int a2, _DWORD *a3)
{
  int v3; // r10
  _DWORD *v4; // r5
  int v5; // r2
  _BYTE *v6; // r1
  char v7; // r0
  unsigned int v8; // r3
  int v9; // r0
  int (__fastcall *v10)(_DWORD); // r4
  const char *v11; // r0
  unsigned int v12; // r3
  int v13; // r0
  int (__fastcall *v14)(int (**)(), _BYTE *, _DWORD *); // r9
  _DWORD *v15; // r2
  int (__fastcall **v16)(int (**)(), _DWORD, int); // r4
  int *v17; // r6
  int v18; // r6
  int v19; // t1
  int result; // r0
  int v21; // r7
  int v22; // r0
  int v23; // r2
  unsigned int *v24; // r7
  int v25; // r2
  unsigned int v26; // r0
  int v27; // r1
  int v28; // r2
  int v29; // r2
  int *v30; // r6
  unsigned int v31; // r4
  int v32; // r1
  int v33; // r0
  void **v34; // r7
  unsigned int v35; // r0
  void *v36; // r0
  int v37; // r1
  _DWORD *v38; // r7
  int v39; // r0
  void **v40; // r4
  void *v41; // r0
  int v42; // r0
  _DWORD *v43; // r1
  int v44; // r2
  unsigned int v45; // r0
  int v46; // r1
  int v47; // r2
  int v48; // r0
  void **v49; // r4
  void *v50; // r0
  int v51; // r0
  _DWORD *v52; // r7
  int v53; // r1
  int v54; // r7
  bool v55; // cf
  bool v56; // zf
  const char *v57; // r1
  int (*v58)(); // [sp+4h] [bp-44h]
  char *v59; // [sp+8h] [bp-40h]
  int v60; // [sp+Ch] [bp-3Ch]
  const char *v61; // [sp+10h] [bp-38h]
  char v62[10]; // [sp+16h] [bp-32h]
  int v63; // [sp+20h] [bp-28h]

  v3 = a1;
  v4 = a3;
  v5 = a2;
  v6 = (_BYTE *)v4[1];
  v7 = v6[1];
  if ( (v7 & 0xC0) == 128 )
  {
    v12 = v7 & 0xF;
    v13 = v7 & 0x30;
    v14 = (int (__fastcall *)(int (**)(), _BYTE *, _DWORD *))*(&off_14B84 + v12);
    if ( v13 )
    {
      if ( v13 == 32 )
      {
        v30 = (int *)v4[6];
        v31 = *v30;
        if ( v5 == 2 && v12 <= 4 )
        {
          if ( j_pb_make_string_substream(v3, &v58) == 1 )
          {
            v32 = v60;
            if ( v60 )
            {
              v33 = *v30;
              do
              {
                if ( v33 + 1 > v31 )
                {
                  v34 = (void **)v4[5];
                  v35 = *(unsigned __int8 *)(v4[1] + 4);
                  v31 += (v32 - 1) / v35 + 1;
                  v36 = realloc(*v34, v31 * v35);
                  if ( !v36 )
                    goto LABEL_100;
                  *v34 = v36;
                  v33 = *v30;
                }
                v37 = v4[1];
                v38 = (_DWORD *)(*(_DWORD *)v4[5] + *(unsigned __int8 *)(v37 + 4) * v33);
                v39 = *(_BYTE *)(v37 + 1) & 0xF;
                if ( (unsigned int)(v39 - 5) >= 2 )
                {
                  if ( v39 == 7 )
                    sub_CF28(*(_DWORD *)(v37 + 6), (int)v38);
                }
                else
                {
                  *v38 = 0;
                }
                if ( v14(&v58, (_BYTE *)v4[1], v38) != 1 )
                  goto LABEL_102;
                v33 = *v30 + 1;
                *v30 = v33;
                v32 = v60;
              }
              while ( v60 );
            }
            result = 1;
            goto LABEL_103;
          }
          goto LABEL_98;
        }
        v48 = v31 + 1;
        *v30 = v31 + 1;
        v49 = (void **)v4[5];
        v50 = realloc(*v49, *(unsigned __int8 *)(v4[1] + 4) * v48);
        if ( !v50 )
        {
          if ( !*(_DWORD *)(v3 + 12) )
          {
            v11 = "realloc failed";
            goto LABEL_97;
          }
          goto LABEL_98;
        }
        *v49 = v50;
        v51 = v4[1];
        v52 = (_DWORD *)(*(_DWORD *)v4[5] + (*v30 - 1) * *(unsigned __int8 *)(v51 + 4));
        v53 = *(_BYTE *)(v51 + 1) & 0xF;
        if ( (unsigned int)(v53 - 5) >= 2 )
        {
          if ( v53 == 7 )
            sub_CF28(*(_DWORD *)(v51 + 6), (int)v52);
        }
        else
        {
          *v52 = 0;
        }
        result = v14((int (**)())v3, (_BYTE *)v4[1], v52);
        goto LABEL_99;
      }
      if ( v13 != 16 )
      {
        if ( !*(_DWORD *)(v3 + 12) )
        {
          v11 = "invalid field type";
          goto LABEL_97;
        }
        goto LABEL_98;
      }
    }
    if ( v12 - 5 > 1 )
    {
      v40 = (void **)v4[5];
      v41 = realloc(*v40, (unsigned __int8)v6[4]);
      if ( !v41 )
      {
        if ( !*(_DWORD *)(v3 + 12) )
        {
          v11 = "realloc failed";
          goto LABEL_97;
        }
        goto LABEL_98;
      }
      *v40 = v41;
      v42 = v4[1];
      v43 = *(_DWORD **)v4[5];
      v44 = *(_BYTE *)(v42 + 1) & 0xF;
      if ( (unsigned int)(v44 - 5) >= 2 )
      {
        if ( v44 == 7 )
          sub_CF28(*(_DWORD *)(v42 + 6), (int)v43);
      }
      else
      {
        *v43 = 0;
      }
      v6 = (_BYTE *)v4[1];
      v15 = *(_DWORD **)v4[5];
    }
    else
    {
      v15 = (_DWORD *)v4[5];
    }
    result = v14((int (**)())v3, v6, v15);
    goto LABEL_99;
  }
  if ( (v7 & 0xC0) == 64 )
  {
    v16 = (int (__fastcall **)(int (**)(), _DWORD, int))v4[5];
    v17 = (int *)v4[5];
    v19 = *v17;
    v18 = (int)(v17 + 1);
    if ( !v19 )
    {
      result = j_pb_skip_field(v3, v5);
      goto LABEL_99;
    }
    switch ( v5 )
    {
      case 2:
        if ( j_pb_make_string_substream(v3, &v58) != 1 )
          goto LABEL_98;
        while ( (*v16)(&v58, v4[1], v18) )
        {
          if ( !v60 )
          {
            *(_DWORD *)(v3 + 4) = v59;
            *(_DWORD *)(v3 + 12) = v61;
            result = 1;
            goto LABEL_99;
          }
        }
        if ( *(_DWORD *)(v3 + 12) )
          goto LABEL_98;
        v11 = "callback failed";
        goto LABEL_97;
      case 0:
        v54 = 0;
        while ( j_pb_read(v3, (int)&v62[v54], 1) == 1 )
        {
          if ( v62[v54] >= 0 )
          {
            v21 = v54 + 1;
            goto LABEL_91;
          }
          v55 = (unsigned int)(v54 + 2) >= 0xA;
          v56 = v54++ == 8;
          if ( !v56 && v55 )
            goto LABEL_98;
        }
        goto LABEL_98;
      case 1:
        v21 = 8;
        v22 = v3;
        v23 = 8;
        break;
      case 5:
        v21 = 4;
        v22 = v3;
        v23 = 4;
        break;
      default:
        if ( !*(_DWORD *)(v3 + 12) )
        {
          v11 = "invalid wire_type";
          goto LABEL_97;
        }
        goto LABEL_98;
    }
    if ( j_pb_read(v22, (int)v62, v23) )
    {
LABEL_91:
      v58 = sub_C54C;
      v59 = v62;
      v60 = v21;
      v61 = 0;
      result = (*v16)(&v58, v4[1], v18);
      goto LABEL_99;
    }
    goto LABEL_98;
  }
  if ( v7 & 0xC0 )
  {
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v11 = "invalid field type";
      goto LABEL_97;
    }
LABEL_98:
    result = 0;
    goto LABEL_99;
  }
  v8 = v7 & 0xF;
  v9 = v7 & 0x30;
  v10 = (int (__fastcall *)(_DWORD))*(&off_14B84 + v8);
  if ( v9 != 32 )
  {
    if ( v9 == 16 )
    {
      *(_BYTE *)v4[6] = 1;
      v6 = (_BYTE *)v4[1];
    }
    else if ( v9 )
    {
      if ( !*(_DWORD *)(v3 + 12) )
      {
        v11 = "invalid field type";
LABEL_97:
        *(_DWORD *)(v3 + 12) = v11;
        goto LABEL_98;
      }
      goto LABEL_98;
    }
    v29 = v4[5];
LABEL_38:
    result = ((int (__fastcall *)(int, _BYTE *, int))v10)(v3, v6, v29);
    goto LABEL_99;
  }
  v24 = (unsigned int *)v4[6];
  if ( v5 != 2 || v8 > 4 )
  {
    v45 = *v24;
    if ( *v24 >= (unsigned __int8)v6[5] )
    {
      if ( !*(_DWORD *)(v3 + 12) )
      {
        v11 = "array overflow";
        goto LABEL_97;
      }
      goto LABEL_98;
    }
    v46 = (unsigned __int8)v6[4];
    v47 = v4[5];
    *v24 = v45 + 1;
    v29 = v47 + v46 * v45;
    v6 = (_BYTE *)v4[1];
    goto LABEL_38;
  }
  if ( j_pb_make_string_substream(v3, &v58) != 1 )
    goto LABEL_98;
  v25 = v60;
  if ( v60 )
  {
    v26 = *v24;
    while ( 1 )
    {
      v27 = v4[1];
      if ( v26 >= *(unsigned __int8 *)(v27 + 5) )
      {
        result = 1;
        goto LABEL_94;
      }
      v28 = v4[5] + *(unsigned __int8 *)(v27 + 4) * v26;
      if ( !v10(&v58) )
        break;
      v26 = *v24 + 1;
      *v24 = v26;
      v25 = v60;
      if ( !v60 )
        goto LABEL_35;
    }
    v25 = v60;
    result = 0;
  }
  else
  {
LABEL_35:
    result = 1;
    v25 = 0;
  }
LABEL_94:
  *(_DWORD *)(v3 + 4) = v59;
  v57 = v61;
  *(_DWORD *)(v3 + 12) = v61;
  if ( v25 )
  {
    if ( !v57 )
    {
      v11 = "array overflow";
      goto LABEL_97;
    }
    goto LABEL_98;
  }
LABEL_99:
  while ( _stack_chk_guard != v63 )
  {
LABEL_100:
    if ( !v61 )
      v61 = "realloc failed";
LABEL_102:
    result = 0;
LABEL_103:
    *(_DWORD *)(v3 + 4) = v59;
    *(_DWORD *)(v3 + 12) = v61;
  }
  return result;
}
// C54C: using guessed type int sub_C54C();
// 14B84: using guessed type void *off_14B84;
// CA94: using guessed type char var_32[10];

//----- (0000CE80) --------------------------------------------------------
signed int __fastcall sub_CE80(int *a1)
{
  _BYTE *v1; // r1
  char v2; // r3
  signed int v3; // lr
  int v4; // r3
  int v5; // r12
  signed int v6; // r4
  int v7; // r1

  v1 = (_BYTE *)a1[1];
  v2 = v1[1];
  v3 = (unsigned __int8)v1[4];
  if ( (v2 & 0xF0) == 32 )
  {
    v3 *= (unsigned __int8)v1[5];
  }
  else if ( (v2 & 0xC0) == 128 )
  {
    v3 = 4;
  }
  if ( !*v1 )
    return 0;
  if ( !(v1[1] & 0x30) )
    ++a1[3];
  v4 = (int)(v1 + 10);
  a1[1] = (int)(v1 + 10);
  ++a1[2];
  if ( v1[10] )
  {
    v5 = a1[5];
    v6 = 1;
  }
  else
  {
    v4 = *a1;
    v6 = 0;
    a1[1] = *a1;
    v3 = 0;
    a1[2] = 0;
    a1[3] = 0;
    v5 = a1[4];
    a1[5] = v5;
  }
  v7 = v5 + v3 + *(unsigned __int8 *)(v4 + 2);
  a1[5] = v7;
  a1[6] = v7 + *(char *)(v4 + 3);
  return v6;
}

//----- (0000CEFE) --------------------------------------------------------
int __fastcall pb_decode(int a1, int a2, int a3)
{
  int v3; // r4
  unsigned __int8 *v4; // r5
  int v5; // r6
  int v6; // r6

  v3 = a3;
  v4 = (unsigned __int8 *)a2;
  v5 = a1;
  sub_CF28(a2, a3);
  v6 = j_pb_decode_noinit(v5, v4, v3);
  if ( !v6 )
    j_pb_release((int)v4, v3);
  return v6;
}

//----- (0000CF28) --------------------------------------------------------
int __fastcall sub_CF28(int a1, int a2)
{
  char v2; // r1
  int v3; // r3
  int v4; // r2
  int v6; // [sp+0h] [bp-30h]
  int v7; // [sp+4h] [bp-2Ch]
  int v8; // [sp+8h] [bp-28h]
  int v9; // [sp+Ch] [bp-24h]
  int v10; // [sp+10h] [bp-20h]
  _DWORD *v11; // [sp+14h] [bp-1Ch]
  _DWORD *v12; // [sp+18h] [bp-18h]
  int v13; // [sp+1Ch] [bp-14h]

  v6 = a1;
  v7 = a1;
  v8 = 0;
  v9 = 0;
  v11 = (_DWORD *)(*(unsigned __int8 *)(a1 + 2) + a2);
  v12 = (_DWORD *)((char *)v11 + *(char *)(a1 + 3));
  v10 = a2;
  while ( 1 )
  {
    if ( !*(_BYTE *)a1 )
      goto LABEL_16;
    v2 = *(_BYTE *)(a1 + 1);
    if ( (v2 & 0xC0) == 128 )
    {
      *v11 = 0;
      if ( (v2 & 0x30) != 32 )
        goto LABEL_16;
LABEL_12:
      *v12 = 0;
      goto LABEL_16;
    }
    if ( *(_BYTE *)(a1 + 1) & 0xC0 )
      goto LABEL_16;
    if ( (v2 & 0x30) == 32 )
      goto LABEL_12;
    if ( (v2 & 0x30) == 16 )
    {
      *(_BYTE *)v12 = 0;
      v2 = *(_BYTE *)(a1 + 1);
    }
    v3 = *(_DWORD *)(a1 + 6);
    if ( (v2 & 0xF) == 7 )
    {
      sub_CF28(*(_DWORD *)(a1 + 6), v11);
    }
    else
    {
      v4 = *(unsigned __int8 *)(a1 + 4);
      if ( v3 )
        _aeabi_memcpy(v11, v3, v4);
      else
        _aeabi_memclr(v11, v4);
    }
LABEL_16:
    if ( sub_CE80(&v6) != 1 )
      return _stack_chk_guard - v13;
    a1 = v7;
  }
}
// 3B18: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);
// 3BFC: using guessed type int __fastcall _aeabi_memclr(_DWORD, _DWORD);

//----- (0000CFE0) --------------------------------------------------------
int __fastcall pb_release(int a1, int a2)
{
  int v2; // r5
  char v3; // r1
  int v4; // r0
  int v5; // r1
  signed int v6; // r4
  void **v7; // r5
  char *v8; // r6
  signed int v9; // r4
  void **v10; // r4
  int v12; // [sp+0h] [bp-38h]
  int v13; // [sp+4h] [bp-34h]
  int v14; // [sp+8h] [bp-30h]
  int v15; // [sp+Ch] [bp-2Ch]
  int v16; // [sp+10h] [bp-28h]
  void **v17; // [sp+14h] [bp-24h]
  signed int *v18; // [sp+18h] [bp-20h]
  int v19; // [sp+1Ch] [bp-1Ch]

  v2 = a1;
  v12 = a1;
  v13 = a1;
  v14 = 0;
  v15 = 0;
  v17 = (void **)(*(unsigned __int8 *)(a1 + 2) + a2);
  v18 = (signed int *)((char *)v17 + *(char *)(a1 + 3));
  v16 = a2;
  while ( 1 )
  {
    if ( *(_BYTE *)v2 )
    {
      v3 = *(_BYTE *)(v2 + 1);
      if ( (v3 & 0xC0) == 128 )
      {
        v4 = v3 & 0x30;
        v5 = v3 & 0xF;
        if ( v4 != 32 || (unsigned int)(v5 - 5) > 1 )
        {
          if ( v5 == 7 )
          {
            v8 = (char *)*v17;
            v9 = (signed int)*v17;
            if ( *v17 )
              v9 = 1;
            if ( v4 == 32 )
              v9 = *v18;
            for ( ; v9; v8 += *(unsigned __int8 *)(v2 + 4) )
            {
              j_pb_release(*(_DWORD *)(v2 + 6), (int)v8);
              --v9;
            }
          }
        }
        else
        {
          v6 = *v18;
          if ( *v18 )
          {
            v7 = (void **)*v17;
            do
            {
              free(*v7);
              *v7 = 0;
              ++v7;
              --v6;
            }
            while ( v6 );
          }
        }
        v10 = v17;
        free(*v17);
        *v10 = 0;
      }
    }
    if ( sub_CE80(&v12) != 1 )
      break;
    v2 = v13;
  }
  return _stack_chk_guard - v19;
}

//----- (0000D0AC) --------------------------------------------------------
int __fastcall pb_decode_delimited(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r6
  int v5; // r5
  int result; // r0
  char v7; // [sp+4h] [bp-24h]
  int v8; // [sp+8h] [bp-20h]
  int v9; // [sp+10h] [bp-18h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( j_pb_make_string_substream(a1, &v7) != 1 )
    return 0;
  result = j_pb_decode((int)&v7, v4, v5);
  *(_DWORD *)(v3 + 4) = v8;
  *(_DWORD *)(v3 + 12) = v9;
  return result;
}

//----- (0000D100) --------------------------------------------------------
signed int __fastcall pb_decode_svarint(int a1, _QWORD *a2)
{
  _QWORD *v2; // r4
  int v3; // t2
  __int64 v4; // r0
  int v6; // [sp+0h] [bp-18h]
  unsigned int v7; // [sp+4h] [bp-14h]

  v2 = a2;
  if ( j_pb_decode_varint(a1, &v6) != 1 )
    return 0;
  v3 = __RCR__(v6, 1);
  HIDWORD(v4) = (v7 >> 1) ^ (v6 << 31 >> 31);
  LODWORD(v4) = v3 ^ (v6 << 31 >> 31);
  *v2 = v4;
  return 1;
}

//----- (0000D15C) --------------------------------------------------------
int __fastcall pb_decode_fixed32(int a1, int a2)
{
  return j_j_pb_read(a1, a2, 4);
}

//----- (0000D162) --------------------------------------------------------
int __fastcall pb_decode_fixed64(int a1, int a2)
{
  return j_j_pb_read(a1, a2, 8);
}

//----- (0000D168) --------------------------------------------------------
signed int __fastcall sub_D168(int a1, int a2, _BYTE *a3)
{
  int v3; // r5
  int v4; // r6
  _BYTE *v5; // r4
  signed int result; // r0
  int v7; // [sp+0h] [bp-20h]
  int v8; // [sp+Ch] [bp-14h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( j_pb_decode_varint(a1, &v7) == 1 )
  {
    switch ( *(unsigned __int8 *)(v4 + 4) )
    {
      case 1u:
        *v5 = v7;
        result = 1;
        goto LABEL_8;
      case 2u:
        *(_WORD *)v5 = v7;
        result = 1;
        goto LABEL_8;
      case 4u:
        goto LABEL_9;
      case 8u:
        *(_QWORD *)v5 = *(_QWORD *)&v7;
        result = 1;
        goto LABEL_8;
      default:
        if ( !*(_DWORD *)(v3 + 12) )
          *(_DWORD *)(v3 + 12) = "invalid data_size";
        break;
    }
  }
  result = 0;
LABEL_8:
  while ( _stack_chk_guard != v8 )
  {
LABEL_9:
    *(_DWORD *)v5 = v7;
    result = 1;
  }
  return result;
}

//----- (0000D1F4) --------------------------------------------------------
signed int __fastcall sub_D1F4(int a1, int a2, _QWORD *a3)
{
  int v3; // r5
  int v4; // r6
  _QWORD *v5; // r4
  int v6; // r0
  int v8; // [sp+0h] [bp-20h]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( j_pb_decode_varint(a1, &v8) == 1 )
  {
    v6 = *(unsigned __int8 *)(v4 + 4);
    if ( v6 == 8 )
    {
      *v5 = *(_QWORD *)&v8;
      return 1;
    }
    if ( v6 == 4 )
    {
      *(_DWORD *)v5 = v8;
      return 1;
    }
    if ( !*(_DWORD *)(v3 + 12) )
      *(_DWORD *)(v3 + 12) = "invalid data_size";
  }
  return 0;
}

//----- (0000D260) --------------------------------------------------------
signed int __fastcall sub_D260(int a1, int a2, _QWORD *a3)
{
  int v3; // r5
  int v4; // r6
  _QWORD *v5; // r4
  int v6; // t2
  __int64 v7; // r0
  int v9; // [sp+0h] [bp-20h]
  unsigned int v10; // [sp+4h] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( j_pb_decode_varint(a1, &v9) )
  {
    HIDWORD(v7) = *(unsigned __int8 *)(v4 + 4);
    v6 = __RCR__(v9, 1);
    LODWORD(v7) = v6 ^ (v9 << 31 >> 31);
    if ( HIDWORD(v7) == 8 )
    {
      HIDWORD(v7) = (v10 >> 1) ^ (v9 << 31 >> 31);
      *v5 = v7;
      return 1;
    }
    if ( HIDWORD(v7) == 4 )
    {
      *(_DWORD *)v5 = v7;
      return 1;
    }
    if ( !*(_DWORD *)(v3 + 12) )
      *(_DWORD *)(v3 + 12) = "invalid data_size";
  }
  return 0;
}

//----- (0000D2DC) --------------------------------------------------------
int __fastcall sub_D2DC(int a1, int a2, int a3)
{
  return j_j_pb_read(a1, a3, 4);
}

//----- (0000D2E4) --------------------------------------------------------
int __fastcall sub_D2E4(int a1, int a2, int a3)
{
  return j_j_pb_read(a1, a3, 8);
}

//----- (0000D2EC) --------------------------------------------------------
int __fastcall sub_D2EC(int a1, int a2, void **a3)
{
  int v3; // r4
  int v4; // r7
  void **v5; // r5
  int v6; // r6
  size_t v7; // r1
  void *v8; // r0
  const char *v9; // r0
  int v11; // [sp+4h] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( sub_C6B8(a1, &v11) != 1 )
    return 0;
  v6 = v11;
  v7 = v11 + 4;
  if ( (*(_BYTE *)(v4 + 1) & 0xC0) == 128 )
  {
    v8 = realloc(*v5, v7);
    if ( v8 )
    {
      *v5 = v8;
      v5 = (void **)v8;
LABEL_8:
      *v5 = (void *)v6;
      return j_pb_read(v3, (int)(v5 + 1), v6);
    }
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v9 = "realloc failed";
      goto LABEL_11;
    }
  }
  else
  {
    if ( v7 <= *(unsigned __int8 *)(v4 + 4) )
      goto LABEL_8;
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v9 = "bytes overflow";
LABEL_11:
      *(_DWORD *)(v3 + 12) = v9;
      return 0;
    }
  }
  return 0;
}

//----- (0000D37C) --------------------------------------------------------
int __fastcall sub_D37C(int a1, int a2, void **a3)
{
  int v3; // r4
  int v4; // r7
  void **v5; // r5
  int v6; // r6
  size_t v7; // r1
  void *v8; // r0
  const char *v9; // r0
  int result; // r0
  int v11; // [sp+4h] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( sub_C6B8(a1, &v11) != 1 )
    return 0;
  v6 = v11;
  v7 = v11 + 1;
  if ( (*(_BYTE *)(v4 + 1) & 0xC0) == 128 )
  {
    v8 = realloc(*v5, v7);
    if ( v8 )
    {
      *v5 = v8;
      v5 = (void **)v8;
LABEL_8:
      result = j_pb_read(v3, (int)v5, v6);
      *((_BYTE *)v5 + v6) = 0;
      return result;
    }
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v9 = "realloc failed";
      goto LABEL_11;
    }
  }
  else
  {
    if ( v7 <= *(unsigned __int8 *)(v4 + 4) )
      goto LABEL_8;
    if ( !*(_DWORD *)(v3 + 12) )
    {
      v9 = "string overflow";
LABEL_11:
      *(_DWORD *)(v3 + 12) = v9;
      return 0;
    }
  }
  return 0;
}

//----- (0000D40C) --------------------------------------------------------
int __fastcall sub_D40C(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r7
  int v5; // r5
  unsigned __int8 *v6; // r6
  int result; // r0
  int v8; // [sp+0h] [bp-28h]
  int v9; // [sp+4h] [bp-24h]
  int v10; // [sp+Ch] [bp-1Ch]

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = *(unsigned __int8 **)(a2 + 6);
  if ( j_pb_make_string_substream(a1, &v8) != 1 )
    return 0;
  if ( !*(_DWORD *)(v4 + 6) )
  {
    if ( !*(_DWORD *)(v3 + 12) )
      *(_DWORD *)(v3 + 12) = "invalid field descriptor";
    return 0;
  }
  if ( (*(_BYTE *)(v4 + 1) & 0x30) == 32 )
    result = j_pb_decode((int)&v8, (int)v6, v5);
  else
    result = j_pb_decode_noinit((int)&v8, v6, v5);
  *(_DWORD *)(v3 + 4) = v9;
  *(_DWORD *)(v3 + 12) = v10;
  return result;
}

//----- (0000D490) --------------------------------------------------------
int __fastcall pb_ostream_from_buffer(int result, int a2, unsigned int a3)
{
  *(_DWORD *)result = sub_D4A8;
  *(_DWORD *)(result + 4) = a2;
  *(_QWORD *)(result + 8) = a3;
  *(_DWORD *)(result + 16) = 0;
  return result;
}
// D4A8: using guessed type int sub_D4A8();

//----- (0000D4C8) --------------------------------------------------------
signed int __fastcall pb_write(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r5
  const char *v5; // r0

  v3 = a1;
  v4 = a3;
  if ( !*(_DWORD *)a1 )
    goto LABEL_13;
  if ( (unsigned int)((*(_QWORD *)(a1 + 8) >> 32) + a3) > (unsigned int)*(_QWORD *)(a1 + 8) )
  {
    if ( !*(_DWORD *)(a1 + 16) )
    {
      v5 = "stream full";
LABEL_9:
      *(_DWORD *)(v3 + 16) = v5;
      return 0;
    }
    return 0;
  }
  if ( (*(int (__fastcall **)(int, int, int))a1)(a1, a2, a3) )
  {
LABEL_13:
    *(_DWORD *)(v3 + 12) += v4;
    return 1;
  }
  if ( !*(_DWORD *)(v3 + 16) )
  {
    v5 = "io error";
    goto LABEL_9;
  }
  return 0;
}

//----- (0000D510) --------------------------------------------------------
signed int __fastcall pb_encode(__int64 *a1, unsigned __int8 *a2, int *a3)
{
  unsigned __int8 *v3; // r4
  __int64 *v4; // r5
  int *v5; // r6
  signed int v6; // r8
  unsigned __int8 v7; // r0
  int v8; // r2
  int i; // r7
  int (__fastcall *v10)(__int64 *, int); // r2
  int v11; // t1

  v3 = a2;
  v4 = a1;
  v5 = a3;
  if ( !*a2 )
    return 1;
  v6 = 0;
  while ( 1 )
  {
    v7 = v3[1];
    v8 = (int)v5 + v6;
    if ( (v7 & 0xC0) == 128 )
      v6 = 4;
    else
      v6 = v3[4];
    v5 = (int *)(v8 + v3[2]);
    if ( (v7 & 0xF0) == 32 )
      v6 *= v3[5];
    if ( (v7 & 0xF) == 8 )
    {
      for ( i = *v5; i; i = *(_DWORD *)(i + 8) )
      {
        v10 = *(int (__fastcall **)(__int64 *, int))(*(_DWORD *)i + 4);
        if ( v10 )
        {
          if ( !v10(v4, i) )
            return 0;
        }
        else if ( sub_D5A0(v4, *(unsigned __int8 **)(*(_DWORD *)i + 8), *(int (__fastcall **)(__int64 *))(i + 4)) != 1 )
        {
          return 0;
        }
      }
      goto LABEL_18;
    }
    if ( sub_D5A0(v4, v3, (int (__fastcall *)(__int64 *))(v8 + v3[2])) != 1 )
      return 0;
LABEL_18:
    v11 = v3[10];
    v3 += 10;
    if ( !v11 )
      return 1;
  }
}

//----- (0000D5A0) --------------------------------------------------------
signed int __fastcall sub_D5A0(__int64 *a1, unsigned __int8 *a2, int (__fastcall *a3)(__int64 *))
{
  unsigned int v3; // r4
  __int64 *v4; // r11
  unsigned __int8 *v5; // r6
  int (__fastcall *v6)(__int64 *); // r8
  unsigned __int8 v7; // r2
  int v8; // r0
  unsigned int v9; // r1
  char *v10; // r3
  char v11; // r5
  int (__fastcall *v12)(__int64 *, unsigned __int8 *, int (__fastcall *)(__int64 *)); // r9
  int v13; // r2
  const char *v14; // r0
  unsigned int v15; // r10
  signed int v16; // r7
  int v17; // r1
  int v18; // r0
  unsigned int v19; // r7
  unsigned __int8 v20; // r0
  int (__fastcall *v21)(__int64 *); // r7
  char v23; // [sp+7h] [bp-41h]
  __int64 v24; // [sp+8h] [bp-40h]
  __int64 v25; // [sp+10h] [bp-38h]
  int v26; // [sp+18h] [bp-30h]
  int v27; // [sp+20h] [bp-28h]

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a2[1];
  v8 = v7 & 0xC0;
  if ( v8 != 128 )
  {
    if ( v8 == 64 )
    {
      if ( *(_DWORD *)v6 && !(*(int (__fastcall **)(__int64 *))v6)(v4) )
      {
        if ( !*((_DWORD *)v4 + 4) )
        {
          v14 = "callback error";
          goto LABEL_33;
        }
LABEL_34:
        v16 = 0;
        goto LABEL_60;
      }
      goto LABEL_59;
    }
    if ( v7 & 0xC0 )
    {
      if ( !*((_DWORD *)v4 + 4) )
      {
        v14 = "invalid field type";
        goto LABEL_33;
      }
      goto LABEL_34;
    }
  }
  v23 = 1;
  v9 = v7 & 0xF;
  v3 = v5[3];
  v10 = &v23;
  if ( v5[3] )
    v10 = (char *)v6 + (char)v3;
  if ( v8 == 128 )
  {
    v6 = *(int (__fastcall **)(__int64 *))v6;
    v11 = (char)v6;
    if ( v6 )
      v11 = 1;
    v23 = v11;
  }
  v12 = (int (__fastcall *)(__int64 *, unsigned __int8 *, _DWORD *))*(&off_14BA8 + v9);
  v13 = v7 & 0x30;
  if ( v13 != 32 )
  {
    if ( v13 != 16 )
    {
      if ( v13 )
      {
        if ( !*((_DWORD *)v4 + 4) )
        {
          v14 = "invalid field type";
          goto LABEL_33;
        }
        goto LABEL_34;
      }
      if ( !v6 )
      {
        if ( !*((_DWORD *)v4 + 4) )
        {
          v14 = "missing required field";
LABEL_33:
          *((_DWORD *)v4 + 4) = v14;
          goto LABEL_34;
        }
        goto LABEL_34;
      }
      goto LABEL_28;
    }
    if ( *v10 )
    {
LABEL_28:
      if ( j_pb_encode_tag_for_field((int)v4, v5) != 1 || !v12(v4, v5, v6) )
        goto LABEL_34;
    }
LABEL_59:
    v16 = 1;
    goto LABEL_60;
  }
  v15 = *(_DWORD *)v10;
  if ( !*(_DWORD *)v10 )
    goto LABEL_59;
  if ( v8 != 128 && v5[5] < v15 )
  {
    if ( !*((_DWORD *)v4 + 4) )
    {
      v14 = "array max size exceeded";
      goto LABEL_33;
    }
    goto LABEL_34;
  }
  if ( v9 >= 5 )
  {
    v19 = 0;
    while ( j_pb_encode_tag_for_field((int)v4, v5) == 1 )
    {
      v20 = v5[1];
      if ( (v20 & 0xC0) != 128 || (v20 & 0xFu) - 5 > 1 )
      {
        if ( v12(v4, v5, v6) != 1 )
          goto LABEL_34;
      }
      else if ( !v12(v4, v5, *(_DWORD **)v6) )
      {
        goto LABEL_34;
      }
      ++v19;
      v6 = (int (__fastcall *)(__int64 *))((char *)v6 + v5[4]);
      if ( v19 >= v15 )
        goto LABEL_59;
    }
    goto LABEL_34;
  }
  v16 = 0;
  if ( j_pb_encode_varint((int)v4, 2, 8 * (unsigned int)*v5 | 2LL) == 1 )
  {
    v18 = v5[1] & 0xF;
    if ( v18 == 4 )
    {
      v3 = 8 * v15;
    }
    else
    {
      if ( v18 != 3 )
      {
        v3 = 0;
        v21 = v6;
        v24 = 0LL;
        v25 = 0LL;
        v26 = 0;
        while ( v12(&v24, v5, v21) == 1 )
        {
          ++v3;
          v21 = (int (__fastcall *)(__int64 *))((char *)v21 + v5[4]);
          if ( v3 >= v15 )
          {
            v3 = HIDWORD(v25);
            goto LABEL_54;
          }
        }
        goto LABEL_34;
      }
      v3 = 4 * v15;
    }
LABEL_54:
    v16 = 0;
    if ( j_pb_encode_varint((int)v4, v17, v3) == 1 )
    {
      if ( !*(_DWORD *)v4 )
        goto LABEL_62;
      v3 = 0;
      while ( v12(v4, v5, v6) == 1 )
      {
        ++v3;
        v6 = (int (__fastcall *)(__int64 *))((char *)v6 + v5[4]);
        if ( v3 >= v15 )
          goto LABEL_59;
      }
      goto LABEL_34;
    }
  }
LABEL_60:
  while ( _stack_chk_guard != v27 )
  {
LABEL_62:
    v16 = 0;
    if ( j_pb_write((int)v4, 0, v3) )
      v16 = 1;
  }
  return v16;
}
// D5A0: too many cbuild loops
// 14BA8: using guessed type void *off_14BA8;

//----- (0000D7D4) --------------------------------------------------------
signed int __fastcall pb_encode_submessage(int a1, unsigned __int8 *a2, int *a3)
{
  int v3; // r8
  int v4; // r4
  unsigned __int8 *v5; // r6
  int *v6; // r5
  int v7; // r1
  signed int v8; // r7
  const char *v9; // r0
  bool v11; // zf
  int v12; // r0
  __int64 v13; // [sp+0h] [bp-30h]
  __int64 v14; // [sp+8h] [bp-28h]
  const char *v15; // [sp+10h] [bp-20h]
  int v16; // [sp+14h] [bp-1Ch]

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v13 = 0LL;
  v14 = 0LL;
  v15 = 0;
  if ( !j_pb_encode(&v13, a2, a3) )
  {
    v9 = v15;
    goto LABEL_8;
  }
  v3 = HIDWORD(v14);
  v8 = 0;
  if ( j_pb_encode_varint(v4, v7, HIDWORD(v14)) != 1 )
    goto LABEL_10;
  if ( !*(_DWORD *)v4 )
    goto LABEL_12;
  if ( (unsigned int)((*(_QWORD *)(v4 + 8) >> 32) + v3) > (unsigned int)*(_QWORD *)(v4 + 8) )
  {
    if ( *(_DWORD *)(v4 + 16) )
    {
LABEL_9:
      v8 = 0;
      goto LABEL_10;
    }
    v9 = "stream full";
LABEL_8:
    *(_DWORD *)(v4 + 16) = v9;
    goto LABEL_9;
  }
  v13 = *(_QWORD *)v4;
  v14 = (unsigned int)v3;
  v15 = 0;
  v8 = j_pb_encode(&v13, v5, v6);
  v11 = HIDWORD(v14) == v3;
  *(_DWORD *)(v4 + 12) += HIDWORD(v14);
  *(_DWORD *)(v4 + 4) = HIDWORD(v13);
  v12 = (int)v15;
  *(_DWORD *)(v4 + 16) = v15;
  if ( !v11 )
  {
    if ( v12 )
      goto LABEL_9;
    v9 = "submsg size changed";
    goto LABEL_8;
  }
LABEL_10:
  while ( _stack_chk_guard != v16 )
LABEL_12:
    v8 = j_pb_write(v4, 0, v3);
  return v8;
}

//----- (0000D8A8) --------------------------------------------------------
int __fastcall pb_get_encoded_size(_DWORD *a1, unsigned __int8 *a2, int *a3)
{
  _DWORD *v3; // r5
  signed int v4; // r4
  int result; // r0
  __int64 v6; // [sp+0h] [bp-28h]
  __int64 v7; // [sp+8h] [bp-20h]
  int v8; // [sp+10h] [bp-18h]
  int v9; // [sp+14h] [bp-14h]

  v3 = a1;
  v4 = 0;
  v6 = 0LL;
  v7 = 0LL;
  v8 = 0;
  if ( j_pb_encode(&v6, a2, a3) == 1 )
  {
    *v3 = HIDWORD(v7);
    v4 = 1;
  }
  result = _stack_chk_guard - v9;
  if ( _stack_chk_guard == v9 )
    result = v4;
  return result;
}

//----- (0000D8F8) --------------------------------------------------------
signed int __fastcall pb_encode_varint(int a1, int a2, __int64 a3)
{
  unsigned int v3; // r12
  __int64 *v4; // r1
  char v5; // lr
  int v6; // r4
  __int64 v8; // [sp+0h] [bp-20h]
  char v9[10]; // [sp+Ah] [bp-16h]

  v3 = a3;
  v8 = a3;
  if ( a3 )
  {
    v4 = (__int64 *)v9;
    LODWORD(a3) = 0;
    do
    {
      v5 = v3;
      v9[a3] = v3 | 0x80;
      v3 = (v3 >> 7) | (HIDWORD(a3) << 25);
      LODWORD(a3) = a3 + 1;
      v6 = v3 | (HIDWORD(a3) >> 7);
      HIDWORD(a3) >>= 7;
    }
    while ( v6 );
    v8 = 0LL;
    v9[(_DWORD)a3 - 1] = v5 & 0x7F;
  }
  else
  {
    v4 = &v8;
    LODWORD(a3) = 1;
  }
  return j_pb_write(a1, (int)v4, a3);
}
// D8F8: using guessed type char var_16[10];

//----- (0000D970) --------------------------------------------------------
signed int __fastcall pb_encode_svarint(int a1, int a2, int a3, int a4)
{
  unsigned __int8 v4; // cf
  __int64 v5; // r2
  int v6; // r1

  v4 = __CFADD__(a3, a3);
  LODWORD(v5) = 2 * a3 ^ (a4 >> 31);
  v6 = a4 + v4 + a4;
  HIDWORD(v5) = v6 ^ (a4 >> 31);
  return j_j_pb_encode_varint(a1, v6, v5);
}

//----- (0000D982) --------------------------------------------------------
signed int __fastcall pb_encode_fixed32(int a1, int a2)
{
  return j_j_pb_write(a1, a2, 4);
}

//----- (0000D988) --------------------------------------------------------
signed int __fastcall pb_encode_fixed64(int a1, int a2)
{
  return j_j_pb_write(a1, a2, 8);
}

//----- (0000D98E) --------------------------------------------------------
signed int __fastcall pb_encode_tag(int a1, int a2, unsigned int a3)
{
  __int64 v3; // r2

  HIDWORD(v3) = a3 >> 29;
  LODWORD(v3) = a2 | 8 * a3;
  return j_j_pb_encode_varint(a1, v3, v3);
}

//----- (0000D99C) --------------------------------------------------------
signed int __fastcall pb_encode_tag_for_field(int a1, unsigned __int8 *a2)
{
  unsigned int v2; // r2

  v2 = a2[1] & 0xF;
  if ( v2 < 8 )
    return j_pb_encode_varint(a1, *a2, dword_13250[v2] | (unsigned __int64)(8 * (unsigned int)*a2));
  if ( !*(_DWORD *)(a1 + 16) )
    *(_DWORD *)(a1 + 16) = "invalid field type";
  return 0;
}

//----- (0000D9D4) --------------------------------------------------------
signed int __fastcall pb_encode_string(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r5
  int v5; // r7
  signed int v6; // r6

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0;
  if ( j_pb_encode_varint(a1, a2, (unsigned int)a3) == 1 )
    v6 = j_pb_write(v5, v4, v3);
  return v6;
}

//----- (0000D9FC) --------------------------------------------------------
signed int __fastcall sub_D9FC(int a1, int a2, _DWORD *a3)
{
  int v3; // r1
  __int64 v4; // r2
  signed int result; // r0

  v3 = *(unsigned __int8 *)(a2 + 4) - 1;
  switch ( v3 )
  {
    case 0:
      LODWORD(v4) = *(char *)a3;
      goto LABEL_8;
    case 1:
      LODWORD(v4) = *(signed __int16 *)a3;
      goto LABEL_8;
    case 3:
      LODWORD(v4) = *a3;
LABEL_8:
      v4 = (signed int)v4;
      goto LABEL_10;
    case 7:
      v4 = *(_QWORD *)a3;
LABEL_10:
      result = j_pb_encode_varint(a1, v3, v4);
      break;
    default:
      if ( !*(_DWORD *)(a1 + 16) )
        *(_DWORD *)(a1 + 16) = "invalid data_size";
      result = 0;
      break;
  }
  return result;
}

//----- (0000DA40) --------------------------------------------------------
signed int __fastcall sub_DA40(int a1, int a2, __int64 *a3)
{
  int v3; // r1
  __int64 v4; // r2

  v3 = *(unsigned __int8 *)(a2 + 4);
  if ( v3 == 8 )
  {
    v4 = *a3;
    return j_pb_encode_varint(a1, v3, v4);
  }
  if ( v3 == 4 )
  {
    v4 = *(unsigned int *)a3;
    return j_pb_encode_varint(a1, v3, v4);
  }
  if ( !*(_DWORD *)(a1 + 16) )
    *(_DWORD *)(a1 + 16) = "invalid data_size";
  return 0;
}

//----- (0000DA70) --------------------------------------------------------
signed int __fastcall sub_DA70(int a1, int a2, _QWORD *a3)
{
  int v3; // r1
  int v4; // r2
  int v5; // r1
  unsigned __int8 v6; // cf
  __int64 v7; // r2

  v3 = *(unsigned __int8 *)(a2 + 4);
  if ( v3 == 8 )
  {
    v5 = *a3 >> 32;
    v4 = *a3;
    goto LABEL_5;
  }
  if ( v3 == 4 )
  {
    v4 = *(_DWORD *)a3;
    v5 = v4 >> 31;
LABEL_5:
    v6 = __CFADD__(v4, v4);
    LODWORD(v7) = 2 * v4 ^ (v5 >> 31);
    HIDWORD(v7) = (v5 + v6 + v5) ^ (v5 >> 31);
    return j_pb_encode_varint(a1, v5, v7);
  }
  if ( !*(_DWORD *)(a1 + 16) )
    *(_DWORD *)(a1 + 16) = "invalid data_size";
  return 0;
}

//----- (0000DAAC) --------------------------------------------------------
signed int __fastcall sub_DAAC(int a1, int a2, int a3)
{
  return j_j_pb_write(a1, a3, 4);
}

//----- (0000DAB4) --------------------------------------------------------
signed int __fastcall sub_DAB4(int a1, int a2, int a3)
{
  return j_j_pb_write(a1, a3, 8);
}

//----- (0000DABC) --------------------------------------------------------
int __fastcall sub_DABC(int a1, int a2, int *a3)
{
  int v3; // r4
  int v4; // r5
  signed int v5; // r0
  int result; // r0
  int v7; // [sp+0h] [bp-20h]
  int v8; // [sp+4h] [bp-1Ch]
  int v9; // [sp+Ch] [bp-14h]

  v3 = a1;
  if ( !a3 )
  {
    v4 = 0;
    v7 = 0;
    v8 = 0;
    if ( j_pb_write(a1, (int)&v7, 1) != 1 )
      goto LABEL_11;
    v5 = j_pb_write(v3, 0, 0);
    goto LABEL_10;
  }
  if ( *(unsigned __int8 *)(a2 + 1) > 0x3Fu || *a3 + 4 <= (unsigned int)*(unsigned __int8 *)(a2 + 4) )
  {
    v5 = j_pb_encode_string(a1, (int)(a3 + 1), *a3);
LABEL_10:
    v4 = v5;
    goto LABEL_11;
  }
  if ( !*(_DWORD *)(a1 + 16) )
    *(_DWORD *)(a1 + 16) = "bytes size exceeded";
  v4 = 0;
LABEL_11:
  result = _stack_chk_guard - v9;
  if ( _stack_chk_guard == v9 )
    result = v4;
  return result;
}

//----- (0000DB40) --------------------------------------------------------
signed int __fastcall sub_DB40(int a1, int a2, int a3)
{
  unsigned int v3; // r12
  unsigned int v4; // r3

  v3 = *(unsigned __int8 *)(a2 + 4);
  if ( (*(_BYTE *)(a2 + 1) & 0xC0) == 128 )
    v3 = -1;
  v4 = 0;
  if ( a3 && v3 )
  {
    do
    {
      if ( !*(_BYTE *)(a3 + v4) )
        break;
      ++v4;
    }
    while ( v4 < v3 );
  }
  return j_j_pb_encode_string(a1, a3, v4);
}

//----- (0000DB70) --------------------------------------------------------
signed int __fastcall sub_DB70(int a1, int a2, int *a3)
{
  unsigned __int8 *v3; // r1

  v3 = *(unsigned __int8 **)(a2 + 6);
  if ( v3 )
    return j_pb_encode_submessage(a1, v3, a3);
  if ( !*(_DWORD *)(a1 + 16) )
    *(_DWORD *)(a1 + 16) = "invalid field descriptor";
  return 0;
}

//----- (0000DB90) --------------------------------------------------------
unsigned int *__fastcall sub_DB90(unsigned int *result, signed int *a2, int *a3)
{
  unsigned int v3; // r3
  unsigned int v4; // t1
  int v5; // r12
  bool v6; // zf
  int v7; // r3
  signed int v8; // r12

  v3 = *result;
  if ( (*result & 0x80000000) == 0 )
  {
    *a2 = 1;
    v4 = result[1];
    ++result;
    *a3 = 4 * (v4 >> 24) + 4;
    return result;
  }
  v5 = (v3 >> 24) & 0xF;
  if ( v5 )
  {
    v6 = v5 == 3;
    if ( v5 != 3 )
      v6 = v5 == 1;
    if ( !v6 )
      return 0;
    v7 = 4 * ((v3 >> 16) & 0xFF) + 4;
    v8 = 2;
  }
  else
  {
    v8 = 1;
    v7 = 4;
  }
  *a3 = v7;
  *a2 = v8;
  return result;
}

//----- (0000DBE4) --------------------------------------------------------
signed int __fastcall sub_DBE4(int a1, int a2, unsigned int a3, unsigned int a4)
{
  int v4; // r4
  unsigned int v5; // r5
  unsigned int v6; // r11
  int v7; // r9
  unsigned int v8; // r7
  int v9; // r10
  int v10; // r0
  int v11; // r2
  int v12; // r1
  signed int result; // r0
  int v14; // r3
  int v15; // r2
  int v16; // r0
  int v17; // r1
  int v18; // r1
  int v19; // r6
  int v20; // r2
  int v21; // r0
  int v22; // r1
  int v23; // r3
  int v24; // r0
  int v25; // r0
  unsigned int v32; // r1
  unsigned int v33; // r0
  int v34; // r1
  unsigned int v35; // r0
  int v36; // [sp+0h] [bp-30h]
  int v37; // [sp+4h] [bp-2Ch]

  v4 = a1;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  if ( a3 >= a4 )
  {
LABEL_54:
    sub_E4DC(v4, 14, &v37);
    sub_E50A(v4, 15, v37);
    return 8;
  }
  v36 = 0;
  do
  {
    v8 = v6 + 1;
    v9 = *(unsigned __int8 *)(v7 + (v6 ^ 3));
    if ( !(v9 & 0x80) )
    {
      sub_E4DC(v4, 13, &v37);
      v10 = 4 * v9;
      if ( v9 & 0x40 )
        v11 = -4 - (v10 & 0xFC) + v37;
      else
        v11 = v10 + v37 + 4;
LABEL_12:
      v37 = v11;
LABEL_13:
      sub_E50A(v4, 13, v11);
LABEL_36:
      v6 = v8;
      continue;
    }
    v12 = v9 & 0xF0;
    result = 9;
    if ( v12 > 175 )
    {
      switch ( v12 )
      {
        case 176:
          result = 9;
          v18 = 0;
          v19 = 0;
          switch ( v9 )
          {
            case 176:
              goto LABEL_53;
            case 177:
              if ( v8 >= v5 )
                return 9;
              v20 = *(unsigned __int8 *)(v7 + (v8 ^ 3));
              result = 9;
              if ( !*(_BYTE *)(v7 + (v8 ^ 3)) || v20 & 0xF0 )
                return result;
              v21 = v4;
              v22 = 0;
              v23 = 0;
              goto LABEL_48;
            case 178:
              break;
            case 179:
              v23 = 1;
              v25 = *(unsigned __int8 *)(v7 + (v8 ^ 3));
              _R1 = v25 << 12;
              __asm { UXTB16.W        R1, R1 }
              v20 = ((v25 & 0xF) + 1) | _R1;
              v21 = v4;
              v22 = 1;
LABEL_48:
              sub_DFC4(v21, v22, v20, v23);
              goto LABEL_49;
            case 180:
            case 181:
            case 182:
            case 183:
              return result;
            default:
              v17 = 1;
              v14 = 1;
              v15 = ((v9 & 7) + 1) | 0x80000;
              v16 = v4;
              goto LABEL_35;
          }
          while ( v8 < v5 )
          {
            v24 = v8++ ^ 3;
            LOBYTE(v24) = *(_BYTE *)(v7 + v24);
            v19 |= (v24 & 0x7F) << v18;
            v18 += 7;
            if ( !(v24 & 0x80) )
            {
              sub_E4DC(v4, 13, &v37);
              v11 = v37 + 4 * v19 + 516;
              goto LABEL_12;
            }
          }
          break;
        case 192:
          switch ( v9 )
          {
            case 192:
            case 193:
            case 194:
            case 195:
            case 196:
            case 197:
              v17 = 3;
              v15 = ((v9 & 7) + 1) | 0xA0000;
              v16 = v4;
              goto LABEL_34;
            case 198:
              v35 = *(unsigned __int8 *)(v7 + (v8 ^ 3));
              if ( (v35 & 0xF) + (v35 >> 4) > 0xF )
                return 9;
              v20 = ((v35 & 0xF) + 1) | (v35 >> 4 << 16);
              v21 = v4;
              v22 = 3;
              goto LABEL_47;
            case 199:
              if ( !*(_BYTE *)(v7 + (v8 ^ 3)) || *(unsigned __int8 *)(v7 + (v8 ^ 3)) >= 0x10u )
                return 9;
              goto LABEL_49;
            case 200:
            case 201:
              v32 = *(unsigned __int8 *)(v7 + (v8 ^ 3));
              v33 = v32 >> 4;
              if ( v9 == 200 )
                v33 = (v32 >> 4) | 0x10;
              v34 = v32 & 0xF;
              if ( v33 + v34 > 0x1F )
                return 9;
              v20 = (v34 + 1) | (v33 << 16);
              v21 = v4;
              v22 = 1;
LABEL_47:
              v23 = 5;
              goto LABEL_48;
            default:
              return 9;
          }
        case 208:
          if ( v9 & 8 )
            return 9;
          v17 = 1;
          v15 = ((v9 & 7) + 1) | 0x80000;
          v16 = v4;
LABEL_34:
          v14 = 5;
          goto LABEL_35;
        default:
          return result;
      }
      return 9;
    }
    if ( v12 != 128 )
    {
      if ( v12 == 144 )
      {
        if ( (v9 & 0xF | 2) == 15 )
          return 9;
        sub_E4DC(v4, v9 & 0xF, &v37);
        v11 = v37;
        goto LABEL_13;
      }
      if ( v12 != 160 )
        return result;
      v14 = 0;
      v15 = ((16 << ((*(_BYTE *)(v7 + (v6 ^ 3)) & 7) + 1)) - 16) | (*(unsigned __int8 *)(v7 + (v6 ^ 3)) << 11) & 0x4000;
      v16 = v4;
      v17 = 0;
LABEL_35:
      sub_DFC4(v16, v17, v15, v14);
      goto LABEL_36;
    }
    if ( v8 >= v5 || !((unsigned __int16)((_WORD)v9 << 12) | 16 * *(unsigned __int8 *)(v7 + ((v6 + 1) ^ 3))) )
      return 9;
    sub_DFC4(v4, 0, (unsigned __int16)((_WORD)v9 << 12) | 16 * *(unsigned __int8 *)(v7 + (v8 ^ 3)), 0);
    v36 |= (((_WORD)v9 << 12) & 0x8000u) >> 15;
LABEL_49:
    v6 += 2;
  }
  while ( v6 < v5 );
LABEL_53:
  if ( !(v36 & 1) )
    goto LABEL_54;
  return 8;
}

//----- (0000DF28) --------------------------------------------------------
signed int __fastcall sub_DF28(int a1, int a2, unsigned int a3, int a4, int *a5)
{
  int v5; // r5
  int v6; // r4
  signed int result; // r0
  int v8; // r2
  int v9; // r0
  int v10; // r1
  __int64 v11; // r2
  int v12; // r1

  v5 = a3;
  v6 = a1;
  switch ( a2 )
  {
    case 0:
      result = 2;
      if ( a3 > 0xF || a4 )
        return result;
      v8 = *a5;
      v9 = v6;
      v10 = v5;
      goto LABEL_11;
    case 1:
      if ( a4 == 5 )
      {
        if ( a3 <= 0x1F )
          goto LABEL_19;
        return 2;
      }
      if ( a4 != 1 || a3 > 0xF )
        return 2;
      sub_E5EC(a1);
LABEL_19:
      v11 = *(_QWORD *)a5;
      v12 = v5 + 256;
LABEL_20:
      result = sub_E57E(v6, v12, v11, SHIDWORD(v11));
LABEL_21:
      if ( result )
        result = 2;
      return result;
    case 3:
      result = 2;
      if ( a3 > 0x1F || a4 != 5 )
        return result;
      v11 = *(_QWORD *)a5;
      v12 = v5 + 112;
      goto LABEL_20;
    case 4:
      result = 2;
      if ( a3 > 3 || a4 )
        return result;
      v8 = *a5;
      v10 = v5 + 192;
      v9 = v6;
LABEL_11:
      result = sub_E50A(v9, v10, v8);
      goto LABEL_21;
    default:
      sub_E344(
        (int)"_Unwind_VRS_Result _Unwind_VRS_Set(_Unwind_Context *, _Unwind_VRS_RegClass, uint32_t, _Unwind_VRS_DataRepre"
             "sentation, void *)",
        837,
        (int)"unsupported register class");
      return result;
  }
}

//----- (0000DFC4) --------------------------------------------------------
signed int __fastcall sub_DFC4(int a1, int a2, unsigned int a3, int a4)
{
  int v4; // r8
  int v5; // r5
  int v6; // r7
  unsigned int v7; // r6
  int v8; // r4
  unsigned int v9; // r7
  int *v10; // r0
  signed int v11; // r0
  signed int v12; // r1
  signed int v13; // r2
  signed int result; // r0
  unsigned int v15; // r4
  unsigned int v16; // r6
  int *v17; // r0
  int v18; // r2
  int v19; // r0
  int v20; // r2
  int *v21; // [sp+8h] [bp-30h]
  int v22; // [sp+Ch] [bp-2Ch]
  int *v23; // [sp+10h] [bp-28h]
  int v24; // [sp+14h] [bp-24h]

  v4 = a1;
  v5 = a2;
  v6 = a4;
  v7 = a3;
  switch ( a2 )
  {
    case 0:
    case 4:
      if ( a4 || sub_E4DC(a1, 13, &v21) )
        goto LABEL_23;
      v8 = 0;
      v9 = 0;
      break;
    case 1:
    case 3:
      if ( (a4 | 4) != 5 || sub_E4DC(a1, 13, &v23) )
        goto LABEL_23;
      if ( !(_WORD)v7 )
        goto LABEL_21;
      v15 = v7 >> 16;
      v16 = (v7 >> 16) + (unsigned __int16)v7;
      while ( 1 )
      {
        v17 = v23;
        ++v23;
        v18 = *v17;
        v23 = v17 + 2;
        v19 = v17[1];
        v21 = (int *)v18;
        v22 = v19;
        if ( sub_DF28(v4, v5, v15, v6, (int *)&v21) )
          goto LABEL_23;
        if ( ++v15 >= v16 )
        {
LABEL_21:
          if ( v6 == 1 )
          {
            v20 = (int)(v23 + 1);
            ++v23;
            goto LABEL_27;
          }
          goto LABEL_25;
        }
      }
    default:
      sub_E344(
        (int)"_Unwind_VRS_Result _Unwind_VRS_Pop(_Unwind_Context *, _Unwind_VRS_RegClass, uint32_t, _Unwind_VRS_DataRepresentation)",
        971,
        (int)"unsupported register class");
      return result;
  }
  do
  {
    if ( (1 << v9) & v7 )
    {
      v10 = v21;
      ++v21;
      v23 = (int *)*v10;
      v11 = sub_DF28(v4, v5, v9, 0, (int *)&v23);
      v12 = 0;
      v13 = 0;
      if ( v9 == 13 )
        v12 = 1;
      if ( !v5 )
        v13 = 1;
      if ( v11 )
      {
LABEL_23:
        result = 2;
        goto LABEL_24;
      }
      v8 |= v13 & v12;
    }
    ++v9;
  }
  while ( v9 < 0x10 );
  if ( !(v8 & 1) )
  {
    v20 = (int)v21;
    goto LABEL_27;
  }
  result = 0;
LABEL_24:
  while ( _stack_chk_guard != v24 )
  {
LABEL_25:
    v20 = (int)v23;
LABEL_27:
    result = sub_E50A(v4, 13, v20);
    if ( result )
      result = 2;
  }
  return result;
}

//----- (0000E104) --------------------------------------------------------
signed int __fastcall sub_E104(int a1, int a2, int a3)
{
  return sub_E10C(a2, a3);
}

//----- (0000E10C) --------------------------------------------------------
signed int __fastcall sub_E10C(int a1, int a2)
{
  int v2; // r5
  int v3; // r4
  signed int result; // r0
  int v5; // r1
  char v6; // [sp+4h] [bp-3Ch]
  _DWORD *v7; // [sp+Ch] [bp-34h]

  v2 = a1;
  v3 = a2;
  sub_E5BC(a2, (int)&v6);
  if ( !(*(_BYTE *)(v2 + 80) & 1) && *v7 )
    return 9;
  v5 = sub_E5B6(v3);
  result = 9;
  if ( v5 == 1 )
    result = 8;
  return result;
}

//----- (0000E168) --------------------------------------------------------
signed int __fastcall sub_E168(int a1, int a2, int a3)
{
  return sub_E10C(a2, a3);
}

//----- (0000E170) --------------------------------------------------------
signed int __fastcall sub_E170(int a1, int a2, int a3)
{
  return sub_E10C(a2, a3);
}

//----- (0000E224) --------------------------------------------------------
int __fastcall sub_E224(int a1, int *a2, char a3)
{
  int *v3; // r4
  char v4; // r10
  signed int i; // r6
  signed int v6; // r7
  int (__fastcall *v7)(signed int, int *, char *); // r3
  int v8; // r0
  int v10; // [sp+0h] [bp-4B8h]
  int v11; // [sp+4h] [bp-4B4h]
  int (__fastcall *v12)(signed int, int *, char *); // [sp+10h] [bp-4A8h]
  int v13; // [sp+18h] [bp-4A0h]
  int v14; // [sp+24h] [bp-494h]
  int v15; // [sp+2Ch] [bp-48Ch]
  char v16; // [sp+30h] [bp-488h]
  int v17; // [sp+494h] [bp-24h]

  v3 = a2;
  v4 = a3;
  sub_E498((int)&v16, a1);
  for ( i = 1; ; --i )
  {
    v6 = 1;
    if ( v4 & 1 )
    {
      v6 = 2;
      if ( !i )
      {
        sub_E50A((int)&v16, -1, v3[4]);
        v4 = 0;
      }
    }
    sub_E4DC((int)&v16, -2, &v15);
    if ( sub_E5BC((int)&v16, (int)&v11) )
      break;
    v7 = v12;
    if ( v12 )
    {
      v3[18] = v11;
      v3[19] = v14;
      v3[20] = v13;
      v8 = v7(v6, v3, &v16);
      if ( v8 == 7 )
      {
        sub_E4DC((int)&v16, -1, &v10);
        v3[4] = v10;
        sub_E5DA((int)&v16);
        return _stack_chk_guard - v17;
      }
      if ( v8 != 8 )
      {
        if ( v8 == 9 )
          abort();
        return _stack_chk_guard - v17;
      }
      if ( v15 == v3[8] )
        sub_E344(
          (int)"_Unwind_Reason_Code unwind_phase2(unw_context_t *, _Unwind_Exception *, bool)",
          653,
          (int)"during phase1 personality function said it would stop here, but now in phase2 it did not stop here");
    }
  }
  return _stack_chk_guard - v17;
}

//----- (0000E344) --------------------------------------------------------
void __fastcall __noreturn sub_E344(int a1, int a2, int a3)
{
  fprintf((FILE *)stderr, "libunwind: %s %s:%d - %s\n", a1, "external/libunwind_llvm/src/Unwind-EHABI.cpp", a2, a3);
  abort();
}

//----- (0000E410) --------------------------------------------------------
int __fastcall sub_E410(_DWORD *a1, int a2, int a3, int a4, int a5)
{
  int v5; // r4
  int v6; // r5
  int v7; // r6
  int v8; // r7
  int v9; // r8
  int v10; // r9
  int v11; // r10
  int v12; // r11
  int v13; // r12
  int v14; // lr

  *a1 = a1;
  a1[1] = a2;
  a1[2] = a3;
  a1[3] = a4;
  a1[4] = v5;
  a1[5] = v6;
  a1[6] = v7;
  a1[7] = v8;
  a1[8] = v9;
  a1[9] = v10;
  a1[10] = v11;
  a1[11] = v12;
  a1[12] = v13;
  a1[13] = &a5;
  a1[14] = v14;
  a1[15] = v14;
  return 0;
}

//----- (0000E428) --------------------------------------------------------
_QWORD *__fastcall sub_E428(_QWORD *result)
{
  __int64 v1; // d0
  __int64 v2; // d1
  __int64 v3; // d2
  __int64 v4; // d3
  __int64 v5; // d4
  __int64 v6; // d5
  __int64 v7; // d6
  __int64 v8; // d7
  __int64 v9; // d8
  __int64 v10; // d9
  __int64 v11; // d10
  __int64 v12; // d11
  __int64 v13; // d12
  __int64 v14; // d13
  __int64 v15; // d14
  __int64 v16; // d15

  *result = v1;
  result[1] = v2;
  result[2] = v3;
  result[3] = v4;
  result[4] = v5;
  result[5] = v6;
  result[6] = v7;
  result[7] = v8;
  result[8] = v9;
  result[9] = v10;
  result[10] = v11;
  result[11] = v12;
  result[12] = v13;
  result[13] = v14;
  result[14] = v15;
  result[15] = v16;
  return result;
}

//----- (0000E430) --------------------------------------------------------
_QWORD *__fastcall sub_E430(_QWORD *result)
{
  __int64 v1; // d0
  __int64 v2; // d1
  __int64 v3; // d2
  __int64 v4; // d3
  __int64 v5; // d4
  __int64 v6; // d5
  __int64 v7; // d6
  __int64 v8; // d7
  __int64 v9; // d8
  __int64 v10; // d9
  __int64 v11; // d10
  __int64 v12; // d11
  __int64 v13; // d12
  __int64 v14; // d13
  __int64 v15; // d14
  __int64 v16; // d15

  *result = v1;
  result[1] = v2;
  result[2] = v3;
  result[3] = v4;
  result[4] = v5;
  result[5] = v6;
  result[6] = v7;
  result[7] = v8;
  result[8] = v9;
  result[9] = v10;
  result[10] = v11;
  result[11] = v12;
  result[12] = v13;
  result[13] = v14;
  result[14] = v15;
  result[15] = v16;
  return result;
}

//----- (0000E438) --------------------------------------------------------
_QWORD *__fastcall sub_E438(_QWORD *result)
{
  __int64 v1; // d16
  __int64 v2; // d17
  __int64 v3; // d18
  __int64 v4; // d19
  __int64 v5; // d20
  __int64 v6; // d21
  __int64 v7; // d22
  __int64 v8; // d23
  __int64 v9; // d24
  __int64 v10; // d25
  __int64 v11; // d26
  __int64 v12; // d27
  __int64 v13; // d28
  __int64 v14; // d29
  __int64 v15; // d30
  __int64 v16; // d31

  *result = v1;
  result[1] = v2;
  result[2] = v3;
  result[3] = v4;
  result[4] = v5;
  result[5] = v6;
  result[6] = v7;
  result[7] = v8;
  result[8] = v9;
  result[9] = v10;
  result[10] = v11;
  result[11] = v12;
  result[12] = v13;
  result[13] = v14;
  result[14] = v15;
  result[15] = v16;
  return result;
}

//----- (0000E440) --------------------------------------------------------
void sub_E440()
{
  __asm
  {
    STCL            p1, c0, [R0],#8
    STCL            p1, c1, [R0],#8
    STCL            p1, c2, [R0],#8
    STCL            p1, c3, [R0],#8
    STCL            p1, c4, [R0],#8
    STCL            p1, c5, [R0],#8
    STCL            p1, c6, [R0],#8
    STCL            p1, c7, [R0],#8
    STCL            p1, c8, [R0],#8
    STCL            p1, c9, [R0],#8
    STCL            p1, c10, [R0],#8
    STCL            p1, c11, [R0],#8
    STCL            p1, c12, [R0],#8
    STCL            p1, c13, [R0],#8
    STCL            p1, c14, [R0],#8
    STCL            p1, c15, [R0],#8
  }
}

//----- (0000E484) --------------------------------------------------------
void sub_E484()
{
  __asm
  {
    STC2            p1, c8, [R0],#4
    STC2            p1, c9, [R0],#4
    STC2            p1, c10, [R0],#4
    STC2            p1, c11, [R0],#4
  }
}

//----- (0000E498) --------------------------------------------------------
int __fastcall sub_E498(int a1, int a2)
{
  int v2; // r4

  v2 = a1;
  *(_DWORD *)a1 = &off_14BD4;
  *(_DWORD *)(a1 + 4) = &unk_158E0;
  *(_BYTE *)(a1 + 76) = 0;
  *(_DWORD *)(a1 + 72) = 0;
  _aeabi_memcpy(a1 + 8, a2, 64);
  _aeabi_memclr8(v2 + 80, 450);
  sub_E9B0(v2, 0);
  return 0;
}
// 3B18: using guessed type int __fastcall _aeabi_memcpy(_DWORD, _DWORD, _DWORD);
// 3C5C: using guessed type int __fastcall _aeabi_memclr8(_DWORD, _DWORD);
// 14BD4: using guessed type void *;

//----- (0000E4DC) --------------------------------------------------------
signed int __fastcall sub_E4DC(int a1, int a2, _DWORD *a3)
{
  int v3; // r6
  _DWORD *v4; // r4
  int v5; // r5

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 8))(a1) != 1 )
    return -6542;
  *v4 = (*(int (__fastcall **)(int, int))(*(_DWORD *)v3 + 12))(v3, v5);
  return 0;
}

//----- (0000E50A) --------------------------------------------------------
signed int __fastcall sub_E50A(int a1, int a2, int a3)
{
  int v3; // r4
  int v4; // r6
  int v5; // r5
  int v6; // r5

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 8))(a1) != 1 )
    return -6542;
  (*(void (__fastcall **)(int, int, int))(*(_DWORD *)v3 + 16))(v3, v5, v4);
  if ( v5 != -1 )
    return 0;
  v6 = 0;
  (*(void (__fastcall **)(int, _DWORD))(*(_DWORD *)v3 + 52))(v3, 0);
  return v6;
}

//----- (0000E54E) --------------------------------------------------------
signed int __fastcall sub_E54E(int a1, int a2, _QWORD *a3)
{
  int v3; // r6
  _QWORD *v4; // r4
  int v5; // r5
  __int64 v6; // r0

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 20))(a1) != 1 )
    return -6542;
  LODWORD(v6) = (*(int (__fastcall **)(int, int))(*(_DWORD *)v3 + 24))(v3, v5);
  *v4 = v6;
  return 0;
}

//----- (0000E57E) --------------------------------------------------------
signed int __fastcall sub_E57E(int a1, int a2, int a3, int a4)
{
  int v4; // r7
  int v5; // r5
  int v6; // r8
  int v7; // r6

  v4 = a1;
  v5 = a3;
  v6 = a4;
  v7 = a2;
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 20))(a1) != 1 )
    return -6542;
  (*(void (__fastcall **)(int, int, int, int))(*(_DWORD *)v4 + 28))(v4, v7, v5, v6);
  return 0;
}

//----- (0000E5B6) --------------------------------------------------------
int __fastcall sub_E5B6(int a1)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 32))();
}

//----- (0000E5BC) --------------------------------------------------------
signed int __fastcall sub_E5BC(int a1, int a2)
{
  int v2; // r4
  signed int result; // r0

  v2 = a2;
  (*(void (**)(void))(*(_DWORD *)a1 + 36))();
  result = 0;
  if ( !*(_DWORD *)(v2 + 4) )
    result = -6549;
  return result;
}

//----- (0000E5DA) --------------------------------------------------------
signed int __fastcall sub_E5DA(int a1)
{
  (*(void (**)(void))(*(_DWORD *)a1 + 40))();
  return -6540;
}

//----- (0000E5EC) --------------------------------------------------------
int __fastcall sub_E5EC(int a1)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 60))();
}

//----- (0000E5F2) --------------------------------------------------------
int __fastcall sub_E5F2(int a1, int a2)
{
  signed int v2; // r2
  bool v3; // zf
  signed int v4; // r0
  unsigned int v5; // r1

  v2 = 0;
  v3 = (a2 & 0xFFFFFFFC) == 192;
  v4 = 0;
  v5 = a2 - 16;
  if ( v3 )
    v4 = 1;
  if ( v5 > 0xFFFFFFED )
    v2 = 1;
  return v4 | v2;
}

//----- (0000E614) --------------------------------------------------------
int __fastcall sub_E614(int a1, signed int a2)
{
  signed int v2; // r5
  int v3; // r4
  int v4; // r0

  v2 = a2;
  v3 = a1;
  if ( a2 > 12 )
  {
    if ( a2 != 15 )
    {
      if ( a2 == 14 )
      {
        v4 = a1 + 64;
        return *(_DWORD *)v4;
      }
      if ( a2 != 13 )
        goto LABEL_11;
LABEL_9:
      v4 = a1 + 60;
      return *(_DWORD *)v4;
    }
    goto LABEL_8;
  }
  if ( a2 == -2 )
    goto LABEL_9;
  if ( a2 == -1 )
  {
LABEL_8:
    v4 = a1 + 68;
    return *(_DWORD *)v4;
  }
LABEL_11:
  if ( (unsigned int)a2 > 0xC )
  {
    if ( (a2 & 0xFFFFFFFC) != 192 )
      sub_EA30(
        (int)"uint32_t libunwind::Registers_arm::getRegister(int)",
        (int)"external/libunwind_llvm/src/Registers.hpp",
        1452,
        (int)"unsupported arm register");
    if ( !*(_BYTE *)(a1 + 76) )
    {
      *(_BYTE *)(a1 + 76) = 1;
      sub_E484();
    }
    v4 = v3 + 4 * v2 - 296;
  }
  else
  {
    v4 = a1 + 4 * a2 + 8;
  }
  return *(_DWORD *)v4;
}

//----- (0000E6A0) --------------------------------------------------------
int __fastcall sub_E6A0(int result, signed int a2, int a3)
{
  signed int v3; // r6
  int v4; // r4
  int v5; // r5

  v3 = a2;
  v4 = a3;
  v5 = result;
  if ( a2 > 12 )
  {
    if ( a2 != 15 )
    {
      if ( a2 == 14 )
      {
        *(_DWORD *)(result + 64) = a3;
        return result;
      }
      if ( a2 != 13 )
        goto LABEL_11;
LABEL_10:
      *(_DWORD *)(result + 60) = a3;
      return result;
    }
    goto LABEL_9;
  }
  if ( a2 == -2 )
    goto LABEL_10;
  if ( a2 == -1 )
  {
LABEL_9:
    *(_DWORD *)(result + 68) = a3;
    return result;
  }
LABEL_11:
  if ( (unsigned int)a2 > 0xC )
  {
    if ( (a2 & 0xFFFFFFFC) != 192 )
      sub_EA30(
        (int)"void libunwind::Registers_arm::setRegister(int, uint32_t)",
        (int)"external/libunwind_llvm/src/Registers.hpp",
        1471,
        (int)"unsupported arm register");
    if ( !*(_BYTE *)(result + 76) )
    {
      *(_BYTE *)(result + 76) = 1;
      sub_E484();
    }
    result = v5 + 4 * v3;
    *(_DWORD *)(result - 296) = v4;
  }
  else
  {
    result += 4 * a2;
    *(_DWORD *)(result + 8) = a3;
  }
  return result;
}

//----- (0000E72C) --------------------------------------------------------
int __fastcall sub_E72C(int a1, int a2)
{
  signed int v2; // r2
  bool v3; // zf
  signed int v4; // r0
  unsigned int v5; // r1

  v2 = 0;
  v3 = (a2 & 0xFFFFFFF0) == 112;
  v4 = 0;
  v5 = a2 & 0xFFFFFFE0;
  if ( v3 )
    v4 = 1;
  if ( v5 == 256 )
    v2 = 1;
  return v4 | v2;
}

//----- (0000E74C) --------------------------------------------------------
__int64 __fastcall sub_E74C(int a1, int a2)
{
  int v2; // r4
  int v3; // r5
  unsigned int v4; // r0
  _QWORD *v5; // r0
  int v6; // r0

  v2 = a2;
  v3 = a1;
  v4 = a2 & 0xFFFFFFF0;
  if ( (a2 & 0xFFFFFFF0) == 112 )
  {
    if ( !*(_BYTE *)(v3 + 75) )
    {
      *(_BYTE *)(v3 + 75) = 1;
      sub_E440();
    }
    v6 = v3 + 8 * v2 - 552;
  }
  else if ( v4 == 272 )
  {
    if ( !*(_BYTE *)(v3 + 74) )
    {
      *(_BYTE *)(v3 + 74) = 1;
      sub_E438((_QWORD *)(v3 + 216));
    }
    v6 = v3 + 8 * v2 - 1960;
  }
  else
  {
    if ( v4 != 256 )
      sub_EA30(
        (int)"unw_fpreg_t libunwind::Registers_arm::getFloatRegister(int)",
        (int)"external/libunwind_llvm/src/Registers.hpp",
        1673,
        (int)"Unknown ARM float register");
    if ( !*(_BYTE *)(v3 + 73) )
    {
      *(_BYTE *)(v3 + 73) = 1;
      v5 = (_QWORD *)(v3 + 80);
      if ( *(_BYTE *)(v3 + 72) )
        sub_E430(v5);
      else
        sub_E428(v5);
    }
    v6 = v3 + 8 * v2 - 1968;
  }
  return *(_QWORD *)v6;
}

//----- (0000E7F0) --------------------------------------------------------
int __fastcall sub_E7F0(int a1, int a2, int a3, int a4)
{
  int v4; // r6
  int v5; // r7
  unsigned int v6; // r0
  int v7; // r5
  int v8; // r4
  _QWORD *v9; // r0
  int result; // r0
  int v11; // r1

  v4 = a2;
  v5 = a1;
  v6 = a2 & 0xFFFFFFF0;
  v7 = a4;
  v8 = a3;
  if ( (a2 & 0xFFFFFFF0) == 112 )
  {
    if ( !*(_BYTE *)(v5 + 75) )
    {
      *(_BYTE *)(v5 + 75) = 1;
      sub_E440();
    }
    result = v5 + 8 * v4;
    *(_DWORD *)(result - 548) = v7;
    LOWORD(v11) = -552;
  }
  else if ( v6 == 272 )
  {
    if ( !*(_BYTE *)(v5 + 74) )
    {
      *(_BYTE *)(v5 + 74) = 1;
      sub_E438((_QWORD *)(v5 + 216));
    }
    result = v5 + 8 * v4;
    *(_DWORD *)(result - 1956) = v7;
    LOWORD(v11) = -1960;
  }
  else
  {
    if ( v6 != 256 )
      sub_EA30(
        (int)"void libunwind::Registers_arm::setFloatRegister(int, unw_fpreg_t)",
        (int)"external/libunwind_llvm/src/Registers.hpp",
        1700,
        (int)"Unknown ARM float register");
    if ( !*(_BYTE *)(v5 + 73) )
    {
      *(_BYTE *)(v5 + 73) = 1;
      v9 = (_QWORD *)(v5 + 80);
      if ( *(_BYTE *)(v5 + 72) )
        sub_E430(v9);
      else
        sub_E428(v9);
    }
    result = v5 + 8 * v4;
    *(_DWORD *)(result - 1964) = v7;
    LOWORD(v11) = -1968;
  }
  HIWORD(v11) = -1;
  *(_DWORD *)(result + v11) = v8;
  return result;
}

//----- (0000E8BC) --------------------------------------------------------
int __fastcall sub_E8BC(int a1)
{
  _DWORD *v1; // r4
  int result; // r0
  __int64 v3; // kr00_8
  int v4; // r0

  v1 = (_DWORD *)a1;
  if ( *(_BYTE *)(a1 + 528) )
    return 0;
  result = sub_EA5C(a1);
  if ( result != 1 )
    return result;
  (*(void (__fastcall **)(_DWORD *, signed int))(*v1 + 52))(v1, 1);
  if ( *((_BYTE *)v1 + 528) )
    return 0;
  if ( v1[126] )
  {
    v3 = *(_QWORD *)(*v1 + 12);
    v4 = ((int (__fastcall *)(_DWORD *, signed int))v3)(v1, -2);
    ((void (__fastcall *)(_DWORD *, signed int, int))HIDWORD(v3))(v1, -2, v1[126] + v4);
  }
  return 1;
}

//----- (0000E90C) --------------------------------------------------------
_DWORD *__fastcall sub_E90C(int a1, _DWORD *a2)
{
  int *v2; // r0
  _DWORD *result; // r0
  int v4; // r2
  int v5; // r3
  int v6; // r4
  int v7; // r12
  int v8; // lr
  _DWORD *v9; // r1
  int v10; // r3
  int v11; // r4
  int v12; // r12
  int v13; // lr

  v2 = (int *)(a1 + 488);
  v4 = *v2;
  v5 = v2[1];
  v6 = v2[2];
  v7 = v2[3];
  v8 = v2[4];
  result = v2 + 5;
  *a2 = v4;
  a2[1] = v5;
  a2[2] = v6;
  a2[3] = v7;
  a2[4] = v8;
  v9 = a2 + 5;
  v10 = result[1];
  v11 = result[2];
  v12 = result[3];
  v13 = result[4];
  *v9 = *result;
  v9[1] = v10;
  v9[2] = v11;
  v9[3] = v12;
  v9[4] = v13;
  return result;
}

//----- (0000E924) --------------------------------------------------------
void __fastcall sub_E924(int a1)
{
  sub_EAB0(a1 + 8);
  sub_F2DC();
}

//----- (0000E93A) --------------------------------------------------------
int __fastcall sub_E93A(int a1)
{
  return *(unsigned __int8 *)(a1 + 529);
}

//----- (0000E940) --------------------------------------------------------
signed int __fastcall sub_E940(int a1, int a2, int a3, _DWORD *a4)
{
  int v4; // r6
  int v5; // r5
  _DWORD *v6; // r4
  int v7; // r7
  int v9; // [sp+10h] [bp-20h]
  int v10; // [sp+14h] [bp-1Ch]

  v4 = a2;
  v5 = a3;
  v6 = a4;
  v7 = (*(int (**)(void))(*(_DWORD *)a1 + 12))();
  if ( !dladdr() || !v9 )
    return 0;
  _snprintf_chk(v4, v5, 0, -1, "%s", v9);
  *v6 = v7 - v10;
  return 1;
}
// 3980: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);
// 3F68: using guessed type int dladdr(void);

//----- (0000E9B0) --------------------------------------------------------
int __fastcall sub_E9B0(int a1, int a2)
{
  int v2; // r4
  int v3; // r6
  int v4; // r5
  int v6; // [sp+0h] [bp-20h]
  int v7; // [sp+4h] [bp-1Ch]
  int v8; // [sp+8h] [bp-18h]
  int v9; // [sp+Ch] [bp-14h]

  v2 = a1;
  v3 = a2;
  v4 = (*(int (__fastcall **)(int, signed int))(*(_DWORD *)a1 + 12))(a1, -1) & 0xFFFFFFFE;
  v8 = 0;
  if ( v3 )
    --v4;
  v6 = _gnu_Unwind_Find_exidx(v4, &v8);
  v7 = v8;
  if ( !v6 || !v8 || !sub_EB08((_DWORD *)v2, v4, &v6) )
    *(_BYTE *)(v2 + 528) = 1;
  return _stack_chk_guard - v9;
}
// 3F74: using guessed type int __fastcall _gnu_Unwind_Find_exidx(_DWORD, _DWORD);

//----- (0000EA20) --------------------------------------------------------
const char *__fastcall sub_EA20(int a1, int a2)
{
  const char *result; // r0

  result = "pc";
  switch ( a2 + 2 )
  {
    case 0:
    case 15:
      result = "sp";
      break;
    case 1:
    case 17:
      return result;
    case 2:
      result = "r0";
      break;
    case 3:
      result = "r1";
      break;
    case 4:
      result = "r2";
      break;
    case 5:
      result = "r3";
      break;
    case 6:
      result = "r4";
      break;
    case 7:
      result = "r5";
      break;
    case 8:
      result = "r6";
      break;
    case 9:
      result = "r7";
      break;
    case 10:
      result = "r8";
      break;
    case 11:
      result = "r9";
      break;
    case 12:
      result = "r10";
      break;
    case 13:
      result = "r11";
      break;
    case 14:
      result = "r12";
      break;
    case 16:
      result = "lr";
      break;
    case 18:
    case 19:
    case 20:
    case 21:
    case 22:
    case 23:
    case 24:
    case 25:
    case 26:
    case 27:
    case 28:
    case 29:
    case 30:
    case 31:
    case 32:
    case 33:
    case 34:
    case 35:
    case 36:
    case 37:
    case 38:
    case 39:
    case 40:
    case 41:
    case 42:
    case 43:
    case 44:
    case 45:
    case 46:
    case 47:
    case 48:
    case 49:
    case 50:
    case 51:
    case 52:
    case 53:
    case 54:
    case 55:
    case 56:
    case 57:
    case 58:
    case 59:
    case 60:
    case 61:
    case 62:
    case 63:
    case 64:
    case 65:
def_EDD6:
      result = "unknown register";
      break;
    case 66:
      result = "s0";
      break;
    case 67:
      result = "s1";
      break;
    case 68:
      result = "s2";
      break;
    case 69:
      result = "s3";
      break;
    case 70:
      result = "s4";
      break;
    case 71:
      result = "s5";
      break;
    case 72:
      result = "s6";
      break;
    case 73:
      result = "s7";
      break;
    case 74:
      result = "s8";
      break;
    case 75:
      result = "s9";
      break;
    case 76:
      result = "s10";
      break;
    case 77:
      result = "s11";
      break;
    case 78:
      result = "s12";
      break;
    case 79:
      result = "s13";
      break;
    case 80:
      result = "s14";
      break;
    case 81:
      result = "s15";
      break;
    case 82:
      result = "s16";
      break;
    case 83:
      result = "s17";
      break;
    case 84:
      result = "s18";
      break;
    case 85:
      result = "s19";
      break;
    case 86:
      result = "s20";
      break;
    case 87:
      result = "s21";
      break;
    case 88:
      result = "s22";
      break;
    case 89:
      result = "s23";
      break;
    case 90:
      result = "s24";
      break;
    case 91:
      result = "s25";
      break;
    case 92:
      result = "s26";
      break;
    case 93:
      result = "s27";
      break;
    case 94:
      result = "s28";
      break;
    case 95:
      result = "s29";
      break;
    case 96:
      result = "s30";
      break;
    case 97:
      result = "s31";
      break;
    default:
      switch ( a2 )
      {
        case 256:
          result = "d0";
          break;
        case 257:
          result = "d1";
          break;
        case 258:
          result = "d2";
          break;
        case 259:
          result = "d3";
          break;
        case 260:
          result = "d4";
          break;
        case 261:
          result = "d5";
          break;
        case 262:
          result = "d6";
          break;
        case 263:
          result = "d7";
          break;
        case 264:
          result = "d8";
          break;
        case 265:
          result = "d9";
          break;
        case 266:
          result = "d10";
          break;
        case 267:
          result = "d11";
          break;
        case 268:
          result = "d12";
          break;
        case 269:
          result = "d13";
          break;
        case 270:
          result = "d14";
          break;
        case 271:
          result = "d15";
          break;
        case 272:
          result = "d16";
          break;
        case 273:
          result = "d17";
          break;
        case 274:
          result = "d18";
          break;
        case 275:
          result = "d19";
          break;
        case 276:
          result = "d20";
          break;
        case 277:
          result = "d21";
          break;
        case 278:
          result = "d22";
          break;
        case 279:
          result = "d23";
          break;
        case 280:
          result = "d24";
          break;
        case 281:
          result = "d25";
          break;
        case 282:
          result = "d26";
          break;
        case 283:
          result = "d27";
          break;
        case 284:
          result = "d28";
          break;
        case 285:
          result = "d29";
          break;
        case 286:
          result = "d30";
          break;
        case 287:
          result = "d31";
          break;
        default:
          goto def_EDD6;
      }
      break;
  }
  return result;
}

//----- (0000EA26) --------------------------------------------------------
int __fastcall sub_EA26(int result)
{
  *(_BYTE *)(result + 72) = 1;
  return result;
}

//----- (0000EA30) --------------------------------------------------------
void __fastcall __noreturn sub_EA30(int a1, int a2, int a3, int a4)
{
  fprintf((FILE *)stderr, "libunwind: %s %s:%d - %s\n", a1, a2, a3, a4);
  abort();
}

//----- (0000EA5C) --------------------------------------------------------
int __fastcall sub_EA5C(int a1)
{
  int v1; // r5
  signed int v2; // r4
  unsigned int *v3; // r0
  int result; // r0
  unsigned int v5; // [sp+4h] [bp-1Ch]
  unsigned int v6; // [sp+8h] [bp-18h]
  int v7; // [sp+Ch] [bp-14h]

  v1 = a1;
  v2 = 0;
  v5 = 0;
  v6 = 0;
  v3 = sub_DB90(*(unsigned int **)(a1 + 520), (signed int *)&v5, (int *)&v6);
  if ( sub_DBE4(v1, (int)v3, v5, v6) == 8 )
    v2 = 1;
  result = _stack_chk_guard - v7;
  if ( _stack_chk_guard == v7 )
    result = v2;
  return result;
}

//----- (0000EAB0) --------------------------------------------------------
int __fastcall sub_EAB0(int a1)
{
  int v1; // r4
  __int64 *v2; // r0
  unsigned int v3; // r0
  unsigned int v4; // r0
  int result; // r0

  v1 = a1;
  if ( *(_BYTE *)(a1 + 65) )
  {
    v2 = (__int64 *)(a1 + 72);
    if ( *(_BYTE *)(v1 + 64) )
      sub_F154(v2);
    else
      sub_F14C(v2);
  }
  v3 = *(unsigned __int16 *)(v1 + 66);
  if ( (_BYTE)v3 )
  {
    sub_F15C((__int64 *)(v1 + 208));
    v4 = *(unsigned __int8 *)(v1 + 67);
  }
  else
  {
    v4 = v3 >> 8;
  }
  if ( v4 )
    sub_F164((int *)(v1 + 336));
  result = *(unsigned __int8 *)(v1 + 68);
  if ( *(_BYTE *)(v1 + 68) )
    result = sub_F2EC((int *)(v1 + 464));
  return result;
}

//----- (0000EB08) --------------------------------------------------------
signed int __fastcall sub_EB08(_DWORD *a1, int a2, _DWORD *a3)
{
  _DWORD *v3; // r4
  signed int v4; // r5
  int v5; // r6
  char *v6; // r5
  signed int *v7; // r0
  int v8; // r3
  signed int v9; // r7
  unsigned int v10; // r7
  int v11; // r6
  signed int (__fastcall *v12)(int, int, int); // lr
  signed int v13; // r12
  int v14; // r9
  int v15; // r6
  signed int v16; // r6
  int v17; // r2
  unsigned int v18; // r2
  _DWORD *v19; // r0
  int v21; // [sp+14h] [bp-34h]
  _DWORD *v22; // [sp+1Ch] [bp-2Ch]
  int v23; // [sp+20h] [bp-28h]
  int v24; // [sp+28h] [bp-20h]

  v3 = a1;
  v4 = 0;
  v23 = a2;
  v5 = a3[1];
  sub_ECAC(&v21, 0, a1[1], a3, a3[1], a1[1], (int)a3, &v23);
  if ( !v21 || v21 == v5 )
    goto LABEL_27;
  v6 = (char *)(*v22 + 8 * v21);
  v7 = (signed int *)(v6 - 4);
  v8 = *(_DWORD *)v6;
  if ( v6 == &byte_4 || (v9 = *v7, *v7 == 1) )
  {
    v4 = 0;
    goto LABEL_27;
  }
  if ( v9 < 0 )
  {
    v13 = 1;
    goto LABEL_11;
  }
  v10 = v9 | 2 * v9 & 0x80000000;
  v11 = (int)v7 + v10;
  v9 = *(signed int *)((char *)v7 + v10);
  if ( v9 <= -1 )
  {
    v13 = 0;
    v7 = (signed int *)v11;
LABEL_11:
    v15 = ((unsigned int)v9 >> 24) & 0xF;
    if ( v15 == 2 )
    {
      v12 = sub_E170;
      v16 = 1;
    }
    else
    {
      if ( v15 != 1 )
      {
        if ( v15 )
          goto LABEL_29;
        v14 = (int)(v7 + 1);
        if ( v13 )
          v14 = 0;
        v12 = sub_E104;
        goto LABEL_17;
      }
      v12 = sub_E168;
      v16 = 0;
    }
    v17 = ((unsigned int)v9 >> 16) & 0xFF;
    if ( ((v17 != 0) & (unsigned __int8)v13) == 1 )
      sub_EA30(
        (int)"bool libunwind::UnwindCursor<libunwind::LocalAddressSpace, libunwind::Registers_arm>::getInfoFromEHABISecti"
             "on(pint_t, const libunwind::UnwindInfoSections &) [A = libunwind::LocalAddressSpace, R = libunwind::Registers_arm]",
        (int)"external/libunwind_llvm/src/UnwindCursor.hpp",
        783,
        (int)"index inlined table detected but pr function requires extra words");
    v14 = (int)&v7[v17 + 1];
    goto LABEL_22;
  }
  v12 = (signed int (__fastcall *)(int, int, int))((2 * v9 & 0x80000000 | v9) + v11);
  v13 = 0;
  v14 = v11 + 4 + 4 * (*(_DWORD *)(v11 + 4) >> 24) + 4;
  v7 = (signed int *)v11;
LABEL_17:
  v16 = 0;
LABEL_22:
  v18 = 2 * *((_DWORD *)v6 - 2) & 0x80000000 | *((_DWORD *)v6 - 2);
  v3[130] = v7;
  v19 = v3 + 122;
  *v19 = &v6[v18 - 8];
  v19[1] = &v6[v8 | 2 * v8 & 0x80000000];
  v19[2] = v14;
  v19[3] = v12;
  if ( v16 )
    v16 = 2;
  if ( v13 )
    v16 = 1;
  v4 = 1;
  v3[127] = v16;
LABEL_27:
  if ( _stack_chk_guard != v24 )
LABEL_29:
    sub_EA30(
      (int)"bool libunwind::UnwindCursor<libunwind::LocalAddressSpace, libunwind::Registers_arm>::getInfoFromEHABISection"
           "(pint_t, const libunwind::UnwindInfoSections &) [A = libunwind::LocalAddressSpace, R = libunwind::Registers_arm]",
      (int)"external/libunwind_llvm/src/UnwindCursor.hpp",
      776,
      (int)"unknown personality routine");
  return v4;
}
// 4: using guessed type char;

//----- (0000ECAC) --------------------------------------------------------
int __fastcall sub_ECAC(int *a1, int a2, int a3, _DWORD *a4, int a5, int a6, int a7, _DWORD *a8)
{
  unsigned int v8; // r4
  unsigned int v9; // r5
  int v10; // r6

  v8 = a5 - a2;
  while ( 1 )
  {
    v9 = v8;
    if ( !v8 )
      break;
    v10 = a2 + (v8 >> 1);
    v8 >>= 1;
    if ( *a8 >= *a4 + 8 * v10 + (2 * *(_DWORD *)(*a4 + 8 * v10) & 0x80000000 | *(_DWORD *)(*a4 + 8 * v10)) )
    {
      v8 = v9 - 1 - v8;
      a2 = v10 + 1;
    }
  }
  *a1 = a2;
  a1[1] = a3;
  a1[2] = (int)a4;
  return (int)(a1 + 3);
}

//----- (0000F14C) --------------------------------------------------------
__int64 *__fastcall sub_F14C(__int64 *result)
{
  __int64 v1; // d0

  v1 = *result;
  return result;
}

//----- (0000F154) --------------------------------------------------------
__int64 *__fastcall sub_F154(__int64 *result)
{
  __int64 v1; // d0

  v1 = *result;
  return result;
}

//----- (0000F15C) --------------------------------------------------------
__int64 *__fastcall sub_F15C(__int64 *result)
{
  __int64 v1; // d16

  v1 = *result;
  return result;
}

//----- (0000F164) --------------------------------------------------------
int __fastcall sub_F164(int *a1)
{
  int *v5; // r0
  int result; // r0

  _T1 = *a1;
  v5 = a1 + 2;
  __asm { LDCL            p1, c0, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c1, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c2, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c3, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c4, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c5, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c6, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c7, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c8, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c9, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c10, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c11, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c12, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c13, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c14, [R0],#8 }
  _T1 = *v5;
  result = (int)(v5 + 2);
  __asm { LDCL            p1, c15, [R0],#8 }
  return result;
}

//----- (0000F1A8) --------------------------------------------------------
int __fastcall sub_F1A8(int *a1)
{
  int *v5; // r0
  int result; // r0

  _T1 = *a1;
  v5 = a1 + 1;
  __asm { LDC2            p1, c8, [R0],#4 }
  _T1 = *v5;
  ++v5;
  __asm { LDC2            p1, c9, [R0],#4 }
  _T1 = *v5;
  ++v5;
  __asm { LDC2            p1, c10, [R0],#4 }
  _T1 = *v5;
  result = (int)(v5 + 1);
  __asm { LDC2            p1, c11, [R0],#4 }
  return result;
}

//----- (0000F1BC) --------------------------------------------------------
char *__fastcall j_strncpy(char *dest, const char *src, size_t n)
{
  return strncpy(dest, src, n);
}

//----- (0000F1CC) --------------------------------------------------------
int __fastcall j_RilSapSocket::initSapSocket(const char *a1, pthread_mutexattr_t a2)
{
  return RilSapSocket::initSapSocket(a1, a2);
}

//----- (0000F1DC) --------------------------------------------------------
int __fastcall j_acquire_wake_lock(int a1, int a2)
{
  return acquire_wake_lock(a1, a2);
}
// 3AE8: using guessed type int __fastcall acquire_wake_lock(_DWORD, _DWORD);

//----- (0000F1EC) --------------------------------------------------------
int __fastcall j_pthread_mutex_unlock(pthread_mutex_t *mutex)
{
  return pthread_mutex_unlock(mutex);
}

//----- (0000F1FC) --------------------------------------------------------
int __fastcall j_release_wake_lock(int a1)
{
  return release_wake_lock(a1);
}
// 3AF4: using guessed type int __fastcall release_wake_lock(_DWORD);

//----- (0000F20C) --------------------------------------------------------
int __fastcall j_j_RIL_onRequestComplete(int a1, int a2, int a3, int a4)
{
  return j_RIL_onRequestComplete(a1, a2, a3, a4);
}

//----- (0000F21C) --------------------------------------------------------
int __fastcall android::Parcel::writeInt32(android::Parcel *this, int a2)
{
  return android::Parcel::writeInt32(this, a2);
}

//----- (0000F22C) --------------------------------------------------------
void __fastcall j_free(void *ptr)
{
  free(ptr);
}

//----- (0000F23C) --------------------------------------------------------
int __fastcall j_RilSocket::socketRequestsHandler(int *a1, int a2, int a3, int a4)
{
  return RilSocket::socketRequestsHandler(a1, a2, a3, a4);
}

//----- (0000F24C) --------------------------------------------------------
int __fastcall j_RilSapSocket::onUnsolicitedResponse(RilSapSocket *this, int a2, void *a3, unsigned int a4)
{
  return RilSapSocket::onUnsolicitedResponse(this, a2, a3, a4);
}

//----- (0000F25C) --------------------------------------------------------
signed int __fastcall j_RilSapSocket::addSocketToList(RilSapSocket *a1, const char *a2, pthread_mutexattr_t a3)
{
  return RilSapSocket::addSocketToList(a1, a2, a3);
}

//----- (0000F26C) --------------------------------------------------------
int __fastcall j_RilSocket::socketInit(RilSocket *this)
{
  return RilSocket::socketInit(this);
}

//----- (0000F27C) --------------------------------------------------------
void __fastcall operator delete(void *a1)
{
  operator delete(a1);
}

//----- (0000F28C) --------------------------------------------------------
int __fastcall j_j_pb_read(int a1, int a2, int a3)
{
  return j_pb_read(a1, a2, a3);
}

//----- (0000F29C) --------------------------------------------------------
signed int __fastcall j_j_pb_encode_submessage(int a1, unsigned __int8 *a2, int *a3)
{
  return j_pb_encode_submessage(a1, a2, a3);
}

//----- (0000F2AC) --------------------------------------------------------
signed int __fastcall j_j_pb_encode_varint(int a1, int a2, __int64 a3)
{
  return j_pb_encode_varint(a1, a2, a3);
}

//----- (0000F2BC) --------------------------------------------------------
signed int __fastcall j_j_pb_write(int a1, int a2, int a3)
{
  return j_pb_write(a1, a2, a3);
}

//----- (0000F2CC) --------------------------------------------------------
signed int __fastcall j_j_pb_encode_string(int a1, int a2, int a3)
{
  return j_pb_encode_string(a1, a2, a3);
}

//----- (0000F2DC) --------------------------------------------------------
void sub_F2DC()
{
  JUMPOUT(sub_F138);
}
// F138: using guessed type int sub_F138();

//----- (0000F2EC) --------------------------------------------------------
int __fastcall sub_F2EC(int *a1)
{
  return sub_F1A8(a1);
}

// ALL OK, 327 function(s) have been successfully decompiled
